{"version":3,"sources":["ChalkBoard/css/variables.module.scss","ChalkBoard/locales lazy /^/.*/.json$/ groupOptions: {} namespace object","ChalkBoard/data/encryption.js","ChalkBoard/analytics.js","ChalkBoard/constants.js","ChalkBoard/i18n.js","ChalkBoard/colors.js","ChalkBoard/keys.js","ChalkBoard/utils.js","ChalkBoard/appState.js","ChalkBoard/hooks/useCallbackRefState.js","ChalkBoard/element/typeChecks.js","ChalkBoard/math.js","ChalkBoard/points.js","ChalkBoard/element/bounds.js","ChalkBoard/renderer/renderElement.js","ChalkBoard/scene/Scene.js","ChalkBoard/random.js","ChalkBoard/element/mutateElement.js","ChalkBoard/element/sizeHelpers.js","ChalkBoard/groups.js","ChalkBoard/element/newElement.js","ChalkBoard/element/transformHandles.js","ChalkBoard/ga.js","ChalkBoard/galines.js","ChalkBoard/gapoints.js","ChalkBoard/gadirections.js","ChalkBoard/gatransforms.js","ChalkBoard/element/collision.js","ChalkBoard/element/resizeTest.js","ChalkBoard/element/linearElementEditor.js","ChalkBoard/element/binding.js","ChalkBoard/element/resizeElements.js","ChalkBoard/element/dragElements.js","ChalkBoard/element/textWysiwyg.jsx","ChalkBoard/element/textElement.js","ChalkBoard/element/showSelectedShapeActions.js","ChalkBoard/element/index.js","ChalkBoard/scene/scrollbars.js","ChalkBoard/scene/selection.js","ChalkBoard/scene/scroll.js","ChalkBoard/scene/comparisons.js","ChalkBoard/scene/zoom.js","ChalkBoard/errors.js","ChalkBoard/components/Spinner.jsx","ChalkBoard/components/ToolButton.jsx","ChalkBoard/components/icons.jsx","ChalkBoard/actions/register.js","ChalkBoard/actions/actionDeleteSelected.jsx","ChalkBoard/zindex.js","ChalkBoard/actions/actionZindex.jsx","ChalkBoard/actions/actionSelectAll.js","ChalkBoard/actions/actionDuplicateSelection.jsx","ChalkBoard/components/ButtonIconSelect.jsx","ChalkBoard/components/Popover.jsx","ChalkBoard/components/ColorPicker.jsx","ChalkBoard/components/IconPicker.jsx","ChalkBoard/actions/actionProperties.jsx","ChalkBoard/types.js","ChalkBoard/components/DarkModeToggle.jsx","ChalkBoard/components/Tooltip.jsx","ChalkBoard/components/ClearCanvas.jsx","ChalkBoard/actions/actionCanvas.jsx","ChalkBoard/actions/actionFinalize.jsx","ChalkBoard/components/ProjectName.jsx","ChalkBoard/renderer/roundRect.js","ChalkBoard/clients.js","ChalkBoard/renderer/renderScene.js","ChalkBoard/data/filesystem.js","ChalkBoard/data/restore.js","ChalkBoard/data/blob.js","ChalkBoard/data/json.js","ChalkBoard/element/image.js","ChalkBoard/scene/export.js","ChalkBoard/charts.js","ChalkBoard/clipboard.js","ChalkBoard/data/index.js","ChalkBoard/data/resave.js","ChalkBoard/components/CheckboxItem.jsx","ChalkBoard/components/Stack.jsx","ChalkBoard/components/ActiveFile.jsx","ChalkBoard/actions/actionExport.jsx","ChalkBoard/actions/actionStyles.js","ChalkBoard/components/HelpIcon.jsx","ChalkBoard/actions/actionGroup.jsx","ChalkBoard/actions/actionMenu.jsx","ChalkBoard/components/Avatar.jsx","ChalkBoard/actions/actionAddToLibrary.js","ChalkBoard/actions/actionNavigate.jsx","ChalkBoard/align.js","ChalkBoard/actions/actionAlign.jsx","ChalkBoard/disitrubte.js","ChalkBoard/actions/actionDistribute.jsx","ChalkBoard/actions/actionFlip.js","ChalkBoard/actions/actionClipboard.jsx","ChalkBoard/actions/actionToggleGridMode.jsx","ChalkBoard/actions/actionToggleZenMode.jsx","ChalkBoard/actions/actionToggleStats.jsx","ChalkBoard/actions/actionHistory.jsx","ChalkBoard/actions/manager.jsx","ChalkBoard/data/library.js","ChalkBoard/gesture.js","ChalkBoard/history.js","ChalkBoard/shapes.jsx","ChalkBoard/actions/shortcuts.js","ChalkBoard/components/ContextMenu.jsx","ChalkBoard/components/Actions.jsx","ChalkBoard/components/BackgroundPickerAndDarkModeToggle.jsx","ChalkBoard/components/CollabButton.jsx","ChalkBoard/data/Libraries.js","ChalkBoard/components/ImageExportDialog.jsx","ChalkBoard/components/FixedSideContainer.jsx","ChalkBoard/components/HintViewer.jsx","ChalkBoard/components/Island.jsx","ChalkBoard/components/LibraryUnit.jsx","ChalkBoard/components/LoadingMessage.jsx","ChalkBoard/components/LockButton.jsx","ChalkBoard/components/Section.jsx","ChalkBoard/components/UserList.jsx","ChalkBoard/components/LibraryButton.jsx","ChalkBoard/components/MobileMenu.jsx","ChalkBoard/components/PasteChartDialog.jsx","ChalkBoard/components/HelpDialog.jsx","ChalkBoard/components/Card.jsx","ChalkBoard/components/JSONExportDialog.jsx","ChalkBoard/components/LayerUI.jsx","ChalkBoard/components/Stats.jsx","ChalkBoard/components/Toast.jsx","ChalkBoard/actions/actionToggleViewMode.jsx","ChalkBoard/components/App.jsx","ChalkBoard/excalidraw-app/app_constants.js","ChalkBoard/components/Modal.jsx","ChalkBoard/components/Dialog.jsx","ChalkBoard/components/ErrorDialog.jsx","ChalkBoard/components/TopErrorBoundary.jsx","ChalkBoard/components/InitializeApp.jsx","ChalkBoard/packages/excalidraw/index.jsx","ChalkBoard/excalidraw-app/data/FileManager.js","ChalkBoard/excalidraw-app/data/firebase.js","ChalkBoard/excalidraw-app/data/index.js","ChalkBoard/excalidraw-app/data/localStorage.js","ChalkBoard/excalidraw-app/collab/Portal.jsx","ChalkBoard/excalidraw-app/collab/RoomDialog.jsx","ChalkBoard/excalidraw-app/collab/reconciliation.js","ChalkBoard/excalidraw-app/collab/CollabWrapper.jsx","ChalkBoard/createInverseContext.jsx","ChalkBoard/excalidraw-app/CustomStats.jsx","ChalkBoard/excalidraw-app/components/icons.jsx","ChalkBoard/excalidraw-app/components/ExportToExcalidrawPlus.jsx","ChalkBoard/excalidraw-app/index.jsx","ChalkBoard/excalidraw-app/sentry.js","ChalkBoard/index.js","assets/files.js","actions/index.js","TextEditor/TextEditor.js","MultilanguageEditor/multiFile.js","actions/outputAction.js","IDE.js","Recorder/index.js","assets/Gear-0.2s-200px.png","Player/index.js","TestComponent/index.js","UserSection/index.js","RecorderForm/recorderForm.js","LiveClasses/liveClassEmitter.js","LiveClasses/liveClassReceiver.js","Card/card.js","Lectures/allLectures.js","reducers/filenameSelection.js","reducers/outputModalReducer.js","reducers/languageSelection.js","reducers/index.js","App.js","index.js","ChalkBoard/data/encode.js"],"names":["module","exports","map","webpackAsyncContext","req","Promise","resolve","then","__webpack_require__","o","e","Error","code","id","t","keys","Object","IV_LENGTH_BYTES","createIV","arr","Uint8Array","window","crypto","getRandomValues","generateEncryptionKey","a","subtle","generateKey","name","length","key","exportKey","k","getImportedKey","usage","importKey","alg","ext","key_ops","kty","encryptData","data","importedKey","iv","TextEncoder","encode","Blob","arrayBuffer","buffer","encrypt","encryptedBuffer","decryptData","encrypted","privateKey","decrypt","trackEvent","process","REACT_APP_GOOGLE_ANALYTICS_ID","gtag","category","label","value","event_category","event_label","JEST_WORKER_ID","EVENT","APP_NAME","DRAGGING_THRESHOLD","LINE_CONFIRM_THRESHOLD","ELEMENT_SHIFT_TRANSLATE_AMOUNT","ELEMENT_TRANSLATE_AMOUNT","TEXT_TO_CENTER_SNAP_THRESHOLD","SHIFT_LOCKING_ANGLE","Math","PI","CURSOR_TYPE","TEXT","CROSSHAIR","GRABBING","GRAB","POINTER","MOVE","AUTO","POINTER_BUTTON","MAIN","WHEEL","SECONDARY","TOUCH","ENV","TEST","DEVELOPMENT","CLASSES","SHAPE_ACTIONS_MENU","FONT_FAMILY","Virgil","Helvetica","Cascadia","THEME","LIGHT","DARK","WINDOWS_EMOJI_FALLBACK_FONT","DEFAULT_FONT_SIZE","DEFAULT_FONT_FAMILY","DEFAULT_TEXT_ALIGN","DEFAULT_VERTICAL_ALIGN","DEFAULT_VERSION","GRID_SIZE","MIME_TYPES","excalidraw","excalidrawlib","json","svg","png","jpg","gif","binary","EXPORT_DATA_TYPES","excalidrawClipboard","excalidrawLibrary","EXPORT_SOURCE","location","origin","STORAGE_KEYS","LOCAL_STORAGE_LIBRARY","IMAGE_RENDER_TIMEOUT","TAP_TWICE_TIMEOUT","TOUCH_CTX_MENU_TIMEOUT","TITLE_TIMEOUT","TOAST_TIMEOUT","VERSION_TIMEOUT","SCROLL_TIMEOUT","ZOOM_STEP","IDLE_THRESHOLD","ACTIVE_THRESHOLD","MODES","VIEW","ZEN","GRID","THEME_FILTER","cssVariables","themeFilter","URL_QUERY_KEYS","addLibrary","URL_HASH_KEYS","DEFAULT_UI_OPTIONS","canvasActions","changeViewBackgroundColor","clearCanvas","export","saveFileToDisk","loadScene","saveToActiveFile","theme","saveAsImage","MQ_MAX_WIDTH_PORTRAIT","MQ_MAX_WIDTH_LANDSCAPE","MQ_MAX_HEIGHT_LANDSCAPE","MAX_DECIMALS_FOR_SVG_EXPORT","EXPORT_SCALES","DEFAULT_EXPORT_PADDING","DEFAULT_MAX_IMAGE_WIDTH_OR_HEIGHT","ALLOWED_IMAGE_MIME_TYPES","MAX_ALLOWED_FILE_BYTES","SVG_NS","defaultLang","languages","rtl","concat","sort","left","right","filter","lang","percentages","TEST_LANG_CODE","unshift","currentLang","currentLangData","setLanguage","document","documentElement","dir","startsWith","getLanguage","findPartsForData","parts","index","part","undefined","path","replacement","JSON","stringify","slice","split","translation","fallbackLangData","replace","shades","oc","red","pink","grape","violet","indigo","blue","cyan","teal","green","lime","yellow","orange","canvasBackground","white","gray","elementBackground","elementStroke","black","isDarwin","test","navigator","platform","isWindows","CODES","KEYS","isArrowKey","shouldResizeFromCenter","event","altKey","shouldMaintainAspectRatio","shiftKey","shouldRotateWithDiscreteAngle","mockDateTime","getDateTime","date","Date","year","getFullYear","month","getMonth","padStart","day","getDate","hr","getHours","min","getMinutes","capitalizeString","str","charAt","toUpperCase","isWritableElement","target","HTMLElement","dataset","type","HTMLBRElement","HTMLTextAreaElement","HTMLInputElement","getFontFamilyString","fontFamily","entries","fontFamilyString","getFontString","fontSize","measureText","text","font","line","createElement","body","style","position","whiteSpace","appendChild","innerText","x","join","width","offsetWidth","height","offsetHeight","span","display","overflow","baseline","offsetTop","removeChild","debounce","fn","timeout","handle","lastArgs","ret","args","clearTimeout","setTimeout","flush","_lastArgs","cancel","distance","y","abs","resetCursor","canvas","cursor","setCursor","setCursorForShape","shape","isFullScreen","fullscreenElement","nodeName","getShortcutKey","shortcut","viewportCoordsToSceneCoords","clientX","clientY","zoom","offsetLeft","scrollX","scrollY","invScale","sceneCoordsToViewportCoords","sceneX","sceneY","getGlobalCSSVariable","getComputedStyle","getPropertyValue","RE_RTL_CHECK","RegExp","isRTL","tupleToCoors","xyTuple","muteFSAbortError","error","isTransparent","color","isRGBTransparent","substr","isRRGGBBTransparent","colors","resolvablePromise","reject","promise","_resolve","_reject","withBatchedUpdates","func","unstable_batchedUpdates","nFormatter","num","digits","si","symbol","toFixed","getVersion","querySelector","content","preventUnload","preventDefault","returnValue","defaultExportScale","includes","devicePixelRatio","getDefaultAppState","collaborators","Map","currentChartType","currentItemBackgroundColor","currentItemEndArrowhead","currentItemFillStyle","currentItemFontFamily","currentItemFontSize","currentItemLinearStrokeSharpness","currentItemOpacity","currentItemRoughness","currentItemStartArrowhead","currentItemStrokeColor","currentItemStrokeSharpness","currentItemStrokeStyle","currentItemStrokeWidth","currentItemTextAlign","cursorButton","draggingElement","editingElement","editingGroupId","editingLinearElement","elementLocked","elementType","errorMessage","exportBackground","exportScale","exportEmbedScene","exportWithDarkMode","fileHandle","gridSize","isBindingEnabled","isLibraryOpen","isLoading","isResizing","isRotating","lastPointerDownWith","multiElement","openMenu","openPopup","pasteDialog","shown","previousSelectedElementIds","resizingElement","scrolledOutside","selectedElementIds","selectedGroupIds","selectionElement","shouldCacheIgnoreZoom","showHelpDialog","showStats","startBoundElement","suggestedBindings","toastMessage","viewBackgroundColor","zenModeEnabled","viewModeEnabled","pendingImageElement","APP_STATE_STORAGE_CONF","browser","server","_clearAppStateForStorage","appState","exportType","stateForExport","propConfig","nextValue","clearAppStateForLocalStorage","cleanAppStateForExport","clearAppStateForDatabase","useCallbackRefState","useState","refValue","setRefValue","useCallback","isInitializedImageElement","element","fileId","isImageElement","isTextElement","isFreeDrawElement","isFreeDrawElementType","isLinearElement","isLinearElementType","isBindingElement","isBindingElementType","isBindableElement","rotate","x1","y1","x2","y2","angle","cos","sin","rotatePoint","point","center","adjustXYWithRotation","sides","deltaX1","deltaY1","deltaX2","deltaY2","w","n","s","distance2d","xd","yd","hypot","isPathALoop","points","zoomValue","first","last","isPointInPolygon","vertices","extreme","Number","MAX_SAFE_INTEGER","p","count","i","current","next","doSegmentsIntersect","orderedColinearOrientation","isPointWithinBounds","q","r","max","val","p1","q1","p2","q2","o1","o2","o3","o4","getGridPoint","round","getSizeFromPoints","xs","ys","rescalePoints","dimension","nextDimensionSize","prevPoints","prevDimValues","prevMaxDimension","prevMinDimension","prevDimensionSize","dimensionScaleFactor","nextMinDimension","Infinity","scaledPoints","prevPoint","currentDimension","scaledValue","scaledPoint","getElementAbsoluteCoords","getFreeDrawElementAbsoluteCoords","getLinearElementAbsoluteCoords","getCurvePathOps","sets","set","ops","getMinMaxXYFromCurvePathOps","transformXY","currentP","reduce","limits","op","p3","p0","equation","idx","pow","minY","minX","maxX","maxY","getBoundsFromPoints","coords","getShapeForElement","getElementBounds","bounds","cx","cy","getLinearElementRotatedBounds","x11","y11","x12","y12","x22","y22","x21","y21","h","ww","hh","getCommonBounds","elements","forEach","getResizedElementAbsoluteCoords","nextWidth","nextHeight","gen","rough","generator","curve","strokeSharpness","linearPath","generateRoughOptions","getElementPointsCoords","sharpness","defaultAppState","isPendingImageElement","sceneState","imageCache","has","getDashArrayDashed","strokeWidth","getDashArrayDotted","getCanvasPadding","IMAGE_PLACEHOLDER_IMG","src","encodeURIComponent","IMAGE_ERROR_PLACEHOLDER_IMG","drawElementOnCanvas","rc","context","globalAlpha","opacity","lineJoin","lineCap","draw","save","fillStyle","strokeColor","pathsCache","get","getFreeDrawPath2D","fill","restore","img","image","fillRect","imageMinWidthOrHeight","size","drawImage","status","drawImagePlaceholder","shouldTemporarilyAttach","isConnected","setAttribute","textAlign","lines","lineHeight","verticalOffset","horizontalOffset","fillText","remove","elementWithCanvasCache","WeakMap","shapeCache","invalidateShapeForElement","delete","continuousPath","options","seed","strokeLineDash","strokeStyle","disableMultiStroke","fillWeight","hachureGap","roughness","stroke","preserveVertices","fixedDecimalPlaceDigits","backgroundColor","curveFitting","generateElementShape","rectangle","topX","floor","rightX","rightY","getDiamondPoints","topY","bottomX","bottomY","leftX","leftY","polygon","ellipse","startArrowhead","endArrowhead","getArrowheadShapes","arrowhead","arrowheadPoints","prevOp","nx","ny","arrow","bar","dot","triangle","px","py","minSize","x3","y3","getArrowheadPoints","circle","x4","y4","dash","shapes","push","generateFreeDrawShape","generateElementWithCanvas","prevElementWithCanvas","shouldRegenerateBecauseZoom","canvasZoom","elementWithCanvas","getContext","padding","canvasOffsetX","canvasOffsetY","ceil","translate","scale","mimeType","generateElementCanvas","drawElementFromCanvas","_isPendingImageElement","scaleXFactor","scaleYFactor","renderElement","renderOptimizations","shiftX","shiftY","roughSVGDrawWithPrecision","rsvg","drawable","precision","pshape","renderElementToSvg","svgRoot","files","offsetX","offsetY","degree","node","group","ownerDocument","createElementNS","getFreeDrawSvgPath","fileData","symbolId","dataURL","prepend","use","direction","textAnchor","textContent","svgPathData","Path2D","inputPoints","simulatePressure","pressures","thinning","smoothing","streamline","easing","lastCommittedPoint","acc","med","TO_FIXED_PRECISION","getSvgPathFromStroke","getStroke","A","B","isIdKey","elementKey","Scene","this","callbacks","Set","nonDeletedElements","elementsMap","getElement","isNonDeletedElement","ids","result","getNonDeletedElement","nextElements","clear","mapElementToScene","getNonDeletedElements","informMutation","Array","from","callback","cb","add","sceneMapById","scene","sceneMapByElement","random","Random","now","randomInteger","randomId","nanoid","mutateElement","updates","didChange","prevScale","nextScale","nextPoints","didChangePoints","nextPoint","version","versionNonce","getScene","newElementWith","bumpVersion","isInvisiblySmallElement","getPerfectElementSize","absWidth","absHeight","lockedAngle","atan","tan","sign","getNormalizedDimensions","selectGroup","groupId","elementsInGroup","groupIds","fromEntries","isSelectedViaGroup","getSelectedGroupForElement","find","getSelectedGroupIds","selectGroupsForSelectedElements","nextAppState","selectedElements","getSelectedElements","indexOfEditingGroup","indexOf","isElementInGroup","getElementsInGroup","addToGroup","prevGroupIds","newGroupId","positionOfEditingGroupId","positionToInsert","splice","_newElementBase","boundElementIds","rest","isDeleted","newElement","opts","getTextElementPositionOffsets","metrics","verticalAlign","newTextElement","offsets","updateTextElement","nextText","nextBaseline","prevMetrics","isFinite","getAdjustedDimensions","newLinearElement","startBinding","endBinding","deepCopyElement","depth","prototype","toString","call","tmp","constructor","create","getPrototypeOf","hasOwnProperty","isArray","duplicateElement","groupIdMapForOperation","overrides","copy","mapper","endIndex","getNewGroupIdsForDuplication","assign","transformHandleSizes","mouse","pen","touch","OMIT_SIDES_FOR_MULTIPLE_ELEMENTS","OMIT_SIDES_FOR_TEXT_ELEMENT","OMIT_SIDES_FOR_LINE_SLASH","nw","se","OMIT_SIDES_FOR_LINE_BACKSLASH","ne","sw","generateTransformHandle","getTransformHandlesFromCoords","pointerType","omitSides","handleWidth","handleHeight","handleMarginX","handleMarginY","dashedLineMargin","centeringOffset","transformHandles","rotation","minimumSizeForEightHandles","getTransformHandles","nvector","reverse","b","isNumber","sub","mul","mulScalar","meet","joinScalar","norm","sqrt","inorm","normalized","inormalized","c","GA","through","to","orthogonal","toTuple","intersect","line1","line2","point1","point2","distanceToLine","pivot","apply","motor","isHittingElementBoundingBoxWithoutHittingElement","threshold","isHittingElementNotConsideringBoundingBox","isPointHittingElementBoundingBox","check","isStrictlyInside","isDraggableFromInside","isElementDraggableFromInside","isInsideCheck","isNearCheck","hitTestPointAgainstElement","isElementSelected","rotatedX","rotatedY","bindingBorderTest","maxBindingGap","isOutsideCheck","elementWidth","elementHeight","smallerDimension","distanceToBindableElement","distanceToRectangle","hitTestFreeDrawElement","hitTestLinear","console","warn","distanceToDiamond","distanceToEllipse","pointRelativeToElement","pointRel","hwidth","hheight","GAPoint","GALine","side","ellipseParamsForTest","tangent","tx","ty","_","xx","yy","ex","ey","rx","ry","qx","qy","intersection","closestPoint","rotatedPoint","P","delta","U","C","d","da","db","pointAbs","side1","side2","relX","relY","some","subshape","hitTestCurveInside","hitTestRoughShape","pointTuple","elementCoords","coordsCenter","GATransform","pointRotated","pointRelToCenterAbs","GADirection","elementPos","pointRelToPos","ax","ay","relativizationToElementCenter","bx","by","determineFocusDistance","relateToCenter","aRel","bRel","m","mabs","nabs","getSortedElementLineIntersections","nearPoint","intersections","gap","corners","getCorners","flatMap","edge","intersectSegment","offsetSegment","getCircleIntersections","getEllipseIntersections","sortedIntersections","i1","i2","hx","hy","segment","offset","squares","discr","discrRoot","xn","yn","radius","findFocusPointForEllipse","relativeDistance","relativeDistanceAbs","orientation","pyo","findFocusPointForRectangulars","maxDistance","tangentPoint","corner","odd","operation","polygonPoints","pointsOnBezierCurves","lineThreshold","retVal","mx","my","pointInBezierEquation","isInsideTransformHandle","transformHandle","getElementWithTransformHandleType","scenePointerX","scenePointerY","transformHandleType","rotationTransformHandle","resizeTest","getTransformHandleTypeFromCoords","RESIZE_CURSORS","getCursorForResizingElement","shouldSwapCursors","rotateResizeCursor","LinearElementEditor","elementId","normalizePoints","activePointIndex","lastUncommittedPoint","isDragging","pointerOffset","startBindingElement","endBindingElement","setState","maybeSuggestBinding","newPoint","createPointAt","movePoint","binding","bindingElement","getHoveredElementForBinding","getPointAtIndexGlobalCoordinates","history","scenePointer","didAddPoint","hitElement","resumeRecording","clickedPointIndex","getPointIndexUnderCursor","bindOrUnbindLinearElement","targetPoint","lastPoint","indexMaybeFromEnd","absoluteCoords","pointHandles","getPointsGlobalCoordinates","POINT_HANDLE_SIZE","pointerOnGrid","_idx","getNormalizedPoints","pointIndex","targetPosition","otherUpdates","deltaX","deltaY","nextCoords","prevCoords","nextCenterX","nextCenterY","prevCenterX","prevCenterY","rotated","linearElement","boundToElementIds","unboundFromElementIds","bindOrUnbindLinearElementEdge","onlyUnbound","bindableElement","otherEdgeBindableElement","startOrEnd","isLinearElementSimpleAndAlreadyBoundOnOppositeEdge","bindLinearElement","unbound","unbindLinearElement","bindOrUnbindSelectedElements","getElligibleElementForBindingElement","maybeBindBindableElement","getElligibleElementsForBindableElementAndWhere","where","maybeBindLinearElement","pointerCoords","hoveredElement","calculateFocusAndGap","otherBinding","isLinearElementSimpleAndAlreadyBound","alreadyBoundToId","unbindLinearElements","field","getElementAtPosition","getElements","edgePointIndex","adjacentPointIndex","edgePoint","adjacentPoint","focus","updateBoundElements","changedElement","newSize","simultaneouslyUpdated","simultaneouslyUpdatedElementIds","getSimultaneouslyUpdatedElementIds","doesNeedUpdate","maybeCalculateNewGapWhenScaling","updateBoundPoint","boundElement","newEdgePoint","focusPointAbsolute","adjecentPoint","adjecentPointRel","reverseRelateToCenter","determineFocusPoint","intersectElementWithLine","pointFromAbsoluteCoords","currentBinding","newWidth","newHeight","getElligibleElementsForBindingElement","getLinearElementEdgeCoors","canBindStart","isLinearElementEligibleForNewBindingByBindable","canBindEnd","maybeElement","fixBindingsAfterDuplication","sceneElements","oldElements","oldIdToDuplicatedId","duplicatesServeAsOld","allBoundElementIds","allBindableElementIds","shouldReverseRoles","oldElement","boundElementId","newBindingAfterDuplication","fixBindingsAfterDeletion","deletedElements","deletedElementIds","deletedElement","newBindingAfterDeletion","normalizeAngle","rotateSingleElement","pointerX","pointerY","atan2","reshapeSingleTwoPointElement","resizeArrowDirection","getPerfectElementSizeWithRotation","nextElementX","nextElementY","rescalePointsInElement","measureFontSizeFromWH","nextFontSize","resizeSingleTextElement","nextFont","getSidesForTransformHandle","resizeSingleElement","stateAtResizeStart","transformHandleDirection","startTopLeft","startBottomRight","startCenter","rotatedPointer","esx1","esy1","boundsCurrentWidth","boundsCurrentHeight","scaleX","scaleY","eleInitialWidth","eleInitialHeight","eleNewWidth","eleNewHeight","widthRatio","heightRatio","ratio","newBoundsX1","newBoundsY1","newBoundsWidth","newBoundsHeight","newTopLeft","bottomLeft","topRight","rotatedTopLeft","newCenter","rotatedNewCenter","rescaledPoints","newOrigin","resizedElement","resizeMultipleElements","getNextXY","origX1","origY1","finalX1","finalY1","origX2","origY2","finalX2","finalY2","prev","origCoords","finalCoords","rotateMultipleElements","pointerDownState","centerX","centerY","centerAngle","origAngle","originalElements","rotatedCX","rotatedCY","dragNewElement","originX","originY","widthAspectRatio","newX","newY","normalizeText","getTransform","maxWidth","translateX","translateY","redrawTextBoundingBox","showSelectedShapeActions","Boolean","getElementMap","getSceneVersion","el","_clearElements","clearElementsForDatabase","clearElementsForExport","clearElementsForLocalStorage","SCROLLBAR_COLOR","getScrollBars","viewportWidth","viewportHeight","horizontal","vertical","elementsMinX","elementsMinY","elementsMaxX","elementsMaxY","viewportWidthWithZoom","viewportHeightWithZoom","viewportWidthDiff","viewportHeightDiff","safeArea","top","parseInt","bottom","viewportMinX","viewportMinY","viewportMaxX","viewportMaxY","sceneMinX","sceneMinY","sceneMaxX","sceneMaxY","SCROLLBAR_MARGIN","isOverScrollBars","scrollBars","scrollBar","isOverHorizontal","isOverVertical","isOverEither","isSomeElementSelected","getTargetElements","centerScrollOn","scenePoint","viewportDimensions","calculateScrollCenter","getVisibleElements","cords","viewportX1","viewportY1","viewportX2","viewportY2","isOutsideViewPort","minDistance","closestElement","getClosestElementBounds","hasBackground","hasStrokeColor","hasStrokeWidth","hasStrokeStyle","canChangeSharpness","hasText","canHaveArrowheads","isAtPositionFn","getNewZoom","newZoomValue","prevZoom","canvasOffset","zoomOnViewportPoint","getNormalizedZoom","normalizedZoom","parseFloat","CanvasError","message","AbortError","DOMException","Spinner","circleWidth","className","viewBox","strokeMiterlimit","ToolButton","React","forwardRef","props","ref","excalId","useExcalidrawContainer","innerRef","useRef","useImperativeHandle","sizeCn","setIsLoading","isMountedRef","onClick","useEffect","lastPointerTypeRef","clsx","visible","hidden","ToolIcon","selected","title","disabled","icon","keyBindingLabel","showAriaLabel","children","onPointerDown","onPointerUp","requestAnimationFrame","onChange","checked","defaultProps","activeElementColor","iconFillColor","handlerColor","createIcon","mirror","focusable","role","checkIcon","link","saveAs","load","clipboard","trash","palette","exportFile","exportImage","exportToFileIcon","zoomIn","zoomOut","done","menu","undo","redo","questionCircle","share","shareIOS","shareWindows","BringForwardIcon","memo","SendBackwardIcon","BringToFrontIcon","SendToBackIcon","AlignTopIcon","strokeLinecap","AlignBottomIcon","AlignLeftIcon","AlignRightIcon","DistributeHorizontallyIcon","DistributeVerticallyIcon","CenterVerticallyIcon","strokeDasharray","CenterHorizontallyIcon","start","stop","close","back","marginLeft","clone","file","GroupIcon","UngroupIcon","FillHachureIcon","fillRule","clipRule","FillCrossHatchIcon","FillSolidIcon","StrokeWidthIcon","StrokeStyleSolidIcon","StrokeStyleDashedIcon","StrokeStyleDottedIcon","SloppinessArchitectIcon","SloppinessArtistIcon","SloppinessCartoonistIcon","EdgeSharpIcon","EdgeRoundIcon","ArrowheadNoneIcon","ArrowheadArrowIcon","flip","transform","ArrowheadDotIcon","ArrowheadBarIcon","ArrowheadTriangleIcon","FontSizeSmallIcon","FontSizeMediumIcon","FontSizeLargeIcon","FontSizeExtraLargeIcon","FontFamilyHandDrawnIcon","FontFamilyNormalIcon","FontFamilyCodeIcon","TextAlignLeftIcon","TextAlignCenterIcon","TextAlignRightIcon","actions","register","action","handleGroupEditingState","siblingElements","actionDeleteSelected","perform","commitToHistory","deleteSelectedElements","contextItemLabel","keyTest","PanelComponent","updateData","getIndicesToMove","selectedIndices","deletedIndices","includeDeletedIndex","getTargetIndex","boundaryIndex","sourceElement","indexFilter","candidateIndex","array","fromIndex","findLastIndex","findIndex","nextElement","siblingGroupId","elementsInSiblingGroup","getTargetElementsMap","indices","shiftElements","indicesToMove","targetElementsMap","groupedIndices","toContiguousGroups","leadingIndex","trailingIndex","targetIndex","leadingElements","targetElements","displacedElements","trailingElements","shiftElementsToEnd","groupElements","values","moveOneLeft","moveOneRight","moveAllLeft","moveAllRight","actionSendBackward","keyPriority","actionBringForward","actionSendToBack","actionBringToFront","actionSelectAll","actionDuplicateSelection","selectedPoint","duplicateElements","groupIdMap","newElements","duplicateAndOffsetElement","finalElements","ButtonIconSelect","option","active","Popover","onCloseRequest","fitInViewport","popoverRef","useLayoutEffect","getBoundingClientRect","innerWidth","innerHeight","handler","contains","addEventListener","removeEventListener","isValidColor","Option","keyBindings","flat","Picker","onClose","showInput","firstItem","activeItem","gallery","colorInput","onKeyDown","activeElement","nextIndex","toLowerCase","nativeEvent","stopImmediatePropagation","stopPropagation","tabIndex","_color","_colorWithoutHash","currentTarget","log","onFocus","ColorInput","innerValue","setInnerValue","inputRef","changeColor","inputValue","getColor","spellCheck","onBlur","ColorPicker","isActive","setActive","pickerButton","Suspense","fallback","changedColor","rFirstItem","rActiveItem","rGallery","pressedOption","keyBinding","metaKey","ctrlKey","IconPicker","rPickerButton","UserIdleState","changeProperty","getFormValue","getAttribute","defaultValue","attributes","getCommonAttributeOfSelectedElements","DarkModeToggle","step","onWheel","shouldUpdateForNonLinearElements","every","shouldUpdateForLinearElements","ICONS","MOON","SUN","getTooltipDiv","existingDiv","div","classList","Tooltip","long","onPointerEnter","item","tooltip","minWidth","itemX","itemBottom","itemTop","itemWidth","labelWidth","labelHeight","margin","updateTooltip","onPointerLeave","ClearCanvas","onConfirm","showDialog","setShowDialog","toggleDialog","useIsMobile","small","zoomToFitElements","app","_elements","zoomToSelection","commonBounds","commonBoundsWidth","zoomValueForWidth","commonBoundsHeight","zoomValueForHeight","smallestZoomValue","zoomAdjustedToSteps","zoomValueToFitBoundsOnViewport","newZoom","actionFinalize","marginInlineStart","focusContainer","multiPointElement","isLoop","linePoints","firstPoint","ProjectName","fileName","setFileName","htmlFor","isNameEditable","parent","parentElement","focusNearestParent","isComposing","keyCode","blur","roundRect","beginPath","moveTo","lineTo","quadraticCurveTo","closePath","getClientColors","clientId","currentUser","sum","charCodeAt","backgrounds","strokes","background","hasEmojiSupport","ctx","textBaseline","getImageData","supportsEmoji","strokeRectWithRotation","strokeRect","fillCircle","arc","strokeGrid","renderLinearPointHandles","lineWidth","setLineDash","renderScene","renderScrollbars","renderSelection","renderGrid","isExport","atLeastOneVisibleElement","setTransform","normalizedCanvasWidth","normalizedCanvasHeight","hasTransparence","clearRect","zoomTranslationX","zoomTranslationY","visibleElements","isVisibleElement","suggestedBinding","renderBindingHighlight","selections","selectionColors","remoteSelectedElementIds","socketId","elementX1","elementY1","elementX2","elementY2","addSelectionForGroupId","selection","renderSelectionBorder","locallySelectedElements","renderTransformHandles","dashedLinePadding","initialLineDash","getLineDash","remotePointerViewportCoords","isOutOfBounds","userState","remotePointerUserStates","AWAY","remotePointerButton","username","remotePointerUsernames","idleState","IDLE","ACTIVE","usernameAndIdleState","paddingHorizontal","paddingVertical","measure","measureHeight","actualBoundingBoxDescent","actualBoundingBoxAscent","SCROLLBAR_WIDTH","elementProperties","dashWidth","spaceWidth","lineDashOffset","renderHighlight","renderBindingHighlightForSuggestedPointBinding","renderBindingHighlightForBindableElement","strokeOffset","strokeDiamondWithRotation","strokeEllipseWithRotation","canvasWidth","canvasHeight","viewTransformations","topLeftSceneCoords","bottomRightSceneCoords","renderSceneToSvg","fileOpen","mimeTypes","extensions","_fileOpen","description","multiple","legacySetup","input","scheduleRejection","focusHandler","checkForFile","KEYUP","POINTER_UP","FOCUS","interval","setInterval","rejectPromise","clearInterval","fileSave","blob","_fileSave","extension","AllowedExcalidrawElementTypes","diamond","freedraw","restoreElementWithProperties","extra","base","restoreElement","fontFamilyName","fontPx","_fontFamily","restoreElements","localElements","localElementsMap","migratedElement","localElement","restoreAppState","localAppState","suppliedValue","localValue","parseFileContents","decodePngMetadata","contents","reader","FileReader","readAsText","onloadend","readyState","DONE","decodeSvgMetadata","getFileHandleType","match","isImageFileHandle","isSupportedImageFile","loadFromBlob","parse","isValidExcalidrawData","loadLibraryFromBlob","canvasToBlob","toBlob","generateIdFromFile","digest","hashBuffer","byte","getDataURL","onload","onerror","readAsDataURL","dataURLToFile","filename","dataIndexStart","byteString","atob","ab","ArrayBuffer","ia","File","resizeImageFile","maxWidthOrHeight","all","res","default","pica","imageBlobReduce","features","fileType","SVGStringToFile","SVGString","filterOutDeletedFiles","nextFiles","serializeAsJSON","source","saveAsJSON","serialized","loadFromJSON","isValidLibrary","saveLibraryAsJSON","library","loadLibrary","libraryItems","importLibraryFromJSON","importLibrary","loadHTMLImageElement","Image","updateImageCache","fileIds","updatedFiles","erroredFiles","promises","imagePromise","getInitializedImageElements","normalizeSVG","doc","DOMParser","parseFromString","hasAttribute","outerHTML","SVG_EXPORT_TAG","exportToCanvas","exportPadding","createCanvas","getCanvasSize","exportToSvg","metadata","encodeSvgMetadata","innerHTML","rect","BAR_WIDTH","BAR_GAP","BAR_HEIGHT","NOT_SPREADSHEET","VALID_SPREADSHEET","tryParseNumber","exec","isNumericColumn","columnIndex","tryParseCells","cells","numCols","reason","hasHeader","spreadsheet","labels","valueColumnIndex","labelColumnIndex","rows","row","bgColors","commonProps","getChartDimentions","chartWidth","chartHeight","chartBaseElements","debug","debugRect","chartXLabels","minYLabel","toLocaleString","chartYLabels","chartLines","renderSpreadsheet","chartType","dots","chartTypeLine","bars","barHeight","chartTypeBar","CLIPBOARD","PREFER_APP_CLIPBOARD","probablySupportsClipboardReadText","probablySupportsClipboardWriteText","probablySupportsClipboardBlob","HTMLCanvasElement","copyToClipboard","copyTextToSystemClipboard","getAppClipboard","parsePotentialSpreadsheet","trim","numColsFirstLine","transposedResults","nextCells","col","nextCellRow","transposeCells","tryParseSpreadsheet","getSystemClipboard","clipboardData","getData","readText","parseClipboard","systemClipboard","spreadsheetResult","appClipboardData","systemClipboardData","copyBlobToClipboardAsPng","write","ClipboardItem","copied","writeText","copyTextViaExecCommand","textarea","border","yPosition","pageYOffset","scrollTop","success","select","setSelectionRange","execCommand","exportCanvas","tempSvg","tempCanvas","encodePngMetadata","resaveAsImageWithScene","fileHandleType","CheckboxItem","align","justifyContent","alignItems","justifyItems","ActiveFile","onSave","actionSaveFileToDisk","appProps","allElements","exportedElements","trunc","getExportSize","scaleButtonTitle","fileHandleExists","nativeFileSystemSupported","copiedStyles","loadedElements","loadedAppState","marginTop","marginBottom","actionCopyStyles","actionPasteStyles","pastedElement","HelpIcon","enableActionGroup","requestFullscreen","exitFullscreen","allElementsInSameGroup","actionGroup","selectedGroupId","elementIdsInGroup","updatedElements","lastElementInGroup","lastGroupElementIndex","lastIndexOf","elementsAfterGroup","elementsBeforeGroup","updatedElement","updatedElementsInOrder","contextItemPredicate","actionUngroup","nextGroupIds","removeFromSelectedGroups","Avatar","actionAddToLibrary","collaborator","shortName","names","substring","firstName","lastName","getClientInitials","pointer","items","saveLibrary","getMaximumGroups","groups","currentGroupMembers","calculateTranslation","selectionBoundingBox","axis","groupBoundingBox","getCommonBoundingBox","noTranslation","alignSelectedElements","alignment","alignElements","updatedElementsMap","midX","midY","distributeSelectedElements","distribution","mid","end","extent","index0","g","index1","pos","box","distributeElements","actionFlipHorizontal","space","flipSelectedElements","eligibleElements","enableActionFlipHorizontal","actionFlipVertical","enableActionFlipVertical","flipDirection","flipElements","flipElement","rotateElement","originalX","originalY","originalAngle","finalOffsetX","usingNWHandle","newNCoordsX","nHandle","rotationAngle","actionCopy","actionCut","actionCopyAsSvg","_data","actionCopyAsPng","exportSelection","exportColorScheme","actionToggleGridMode","actionToggleZenMode","actionToggleStats","writeData","prevElements","updater","prevElementMap","nextElementMap","prevElement","syncHistory","ActionManager","getAppState","getElementsIncludingDeleted","renderAction","UIOptions","formState","actionResult","registerAction","Library","libraryCache","resetLibrary","onLibraryChange","restoreLibraryItem","libraryItem","libraryItemsFromStorage","prevLibraryItems","serializedItems","libraryFile","isUniqueitem","existingLibraryItems","targetLibraryItem","libItemExcalidrawItem","filtered","restoredItem","getCenter","pointers","allCoords","getDistance","clearAppStatePropertiesForHistory","History","elementCache","recording","stateHistory","redoStack","lastEntry","generateEntry","dehydrateHistoryEntry","dehydratedExcalidrawElement","versions","dehydratedHistoryEntry","hydrateHistoryEntry","nextEntry","newEntryDehydrated","newEntry","shouldCreateEntry","clearRedoStack","entryToRestore","pop","currentEntry","state","pushEntry","SHAPES","shortcutMap","cut","paste","copyStyles","pasteStyles","selectAll","duplicateSelection","sendBackward","bringForward","sendToBack","bringToFront","copyAsPng","copyAsSvg","ungroup","gridMode","zenMode","stats","addToLibrary","flipHorizontal","flipVertical","viewMode","getShortcutFromShortcutName","shortcuts","ContextMenu","actionManager","onContextMenu","actionName","dangerous","checkmark","executeAction","contextMenuNodeByContainer","params","of","render","container","contextMenuNode","unmountComponentAtNode","handleClose","getContextMenuNode","SelectedShapeActions","isEditing","isMobile","showFillIcons","showChangeBackgroundIcons","commonSelectedType","ShapesSwitcher","setAppState","onImageAction","letter","ZoomActions","BackgroundPickerAndDarkModeToggle","showThemeBtn","CollabButton","isCollaborating","collaboratorCount","libraries","supportsContextFilters","ErrorCanvasPreview","renderPreview","previewNode","ExportButton","shade","OpenColor","ImageExportModal","onExportToPng","onExportToSvg","onExportToClipboard","someElementIsSelected","exportSelected","setExportSelected","previewRef","catch","gridTemplateColumns","userSelect","ImageExportDialog","modalIsShown","setModalIsShown","FixedSideContainer","HintViewer","hint","multiMode","targetElement","getHints","Island","PLUS_ICON","LibraryUnit","pendingElements","onRemoveFromLibrary","elementsToRender","isHovered","setIsHovered","adder","onMouseEnter","onMouseLeave","draggable","onDragStart","dataTransfer","setData","LoadingMessage","CHECKED","xmlns","UNCHECKED","LockButton","Section","heading","header","UserList","mobile","UserList_mobile","LIBRARY_ICON","LibraryButton","MobileMenu","libraryMenu","renderJSONExportDialog","renderImageExportDialog","onCollabButtonClick","onLockToggle","renderCustomFooter","renderTopRightUI","insertOnCanvasDirectly","marginRight","client","Fragment","ChartPreviewBtn","chartElements","setChartElements","parentNode","PasteChartDialog","onInsertChart","handleChartClick","autofocus","Columns","flexDirection","flexWrap","Column","ShortcutIsland","caption","Shortcut","flex","isOr","ShortcutKey","HelpDialog","Card","JSONExportModal","exportOpts","onExportToBackend","renderCustomUI","JSONExportDialog","LibraryMenuItems","onAddToLibrary","onInsertShape","setLibraryItems","libraryReturnUrl","numCells","CELLS_PER_ROW","numRows","addedPendingElements","pathname","confirm","shouldAddPendingElements","bind","LibraryMenu","onClickOutside","listener","Element","useOnClickOutside","closest","loadingState","libraryParam","setLibraryParam","loadingTimerRef","race","removeFromLibrary","indexToRemove","nextItems","LayerUI","onInsertElements","showExitZenModeBtn","toggleZenMode","createExporter","renderSelectedShapeActions","maxHeight","closeLibrary","deselectItems","dialogs","shouldRenderSelectedShapeActions","renderSideContainer","areEqual","getNecessaryObj","prevAppState","langCode","Stats","boundingBox","selectedBoundingBox","colSpan","renderCustomStats","Toast","clearToast","timerRef","scheduleTimeout","actionToggleViewMode","IsMobileContext","createContext","useContext","ExcalidrawContainerContext","didTapTwice","tappedTwiceTimer","cursorX","cursorY","isHoldingSpace","isPanning","isDraggingScrollBar","currentScrollBars","touchTimeout","invalidateContextMenu","lastPointerUp","gesture","lastCenter","initialDistance","initialScale","App","unmounted","trusted","excalidrawContainerRef","createRef","autoFocus","getSceneElementsIncludingDeleted","getSceneElements","syncActionResult","replaceAllElements","replaceFiles","addNewImagesToImageCache","gridModeEnabled","setCurrentState","onUnload","disableEvent","onFontLoaded","onSceneUpdated","importLibraryFromUrl","url","token","hash","URLSearchParams","replaceState","search","query","fetch","decodeURIComponent","request","numShapes","alert","resetHistory","resetScene","resetLoadingState","initializeScene","launchQueue","setConsumer","launchParams","getFile","initialData","scrollToContent","libraryUrl","onResize","onScroll","getCanvasOffsets","onCut","cutAll","onCopy","copyAll","onTapStart","resetTapTwice","touches","handleCanvasDoubleClick","onTapEnd","pasteFromClipboard","elementUnderCursor","elementFromPoint","string","endsWith","imageElement","createImageElement","insertImageElement","initializeImageDimensions","onPaste","addElementsFromPasteOrLibrary","addTextFromPaste","selectShapeTool","elementsCenterX","elementsCenterY","dx","dy","gridX","gridY","obj","removePointer","pointerId","toggleLock","prevState","toggleStats","setToastMessage","restoreFileFromShare","caches","open","webShareTargetCache","loadFileToCanvas","addFiles","filesMap","updateScene","sceneData","updateCurrentCursorPosition","Proxy","ev","prop","HTMLSelectElement","handleKeyDown","maybeSuggestBindingForAll","selectedElement","startTextEditing","findShapeByKey","onKeyUp","onGestureStart","onGestureChange","onGestureEnd","insertAtParentCenter","existingTextElement","getTextElementAtPosition","parentCenterPosition","getTextWysiwygSnappedToCenterPosition","elementCenterX","elementCenterY","handleTextWysiwyg","isExistingElement","getSelectedGroupIdForElement","handleCanvasPointerMove","savePointer","scaleFactor","resetShouldCacheIgnoreZoomDebounced","isOverScrollBar","handlePointerMove","maybeSuggestBindingAtCursor","maybeSuggestBindingForLinearElementAtCursor","buttons","elementWithTransformHandleType","isHittingCommonBoundingBoxOfSelectedElements","handleTouchMove","handleCanvasPointerDown","isTrusted","getSelection","anchorNode","removeAllRanges","maybeOpenContextMenuAfterPointerDownOnTouchDevices","maybeCleanupAfterMissingPointerUp","handleCanvasPanUsingWheelOrSpaceDrag","button","updateGestureOnPointerDown","initialPointerDownState","handleDraggingScrollBar","clearSelectionIfNotUsingSelection","updateBindingEnabledOnPointerMove","handleSelectionOnPointerDown","handleTextOnPointerDown","handleLinearElementOnPointerDown","handleFreeDrawElementOnPointerDown","createGenericElementOnPointerDown","onPointerMove","onPointerMoveFromPointerDownHandler","onPointerUpFromPointerDownHandler","onKeyDownFromPointerDownHandler","onKeyUpFromPointerDownHandler","POINTER_MOVE","KEYDOWN","eventListeners","onMove","onUp","handleCanvasContextMenu","nextPastePrevented","isLinux","lastX","lastY","preventNextPaste","PASTE","enableNextPaste","teardown","BLUR","passive","resize","handleType","getResizeOffsetXY","arrowDirection","getResizeArrowDirection","handlePointerDown","hit","allHitElements","getElementsAtPosition","someHitElementIsSelected","isASelectedElement","hasHitCommonBoundingBoxOfSelectedElements","clearSelection","wasAddedToSelection","pressure","initializeImage","imageFile","_imageElement","showCursorImagePreview","generateIdForFile","existingFileData","maxSize","resizedFile","setImagePreviewCursor","created","cachedImageData","cursorImageSizePx","imagePreview","previewDataURL","toDataURL","forceNaturalSize","placeholderSize","minHeight","naturalHeight","naturalWidth","_updateImageCache","imageElements","uncachedImageElements","scheduleImageRefresh","throttle","shouldEnableBinding","shouldEnableBindingForPointerEvent","hoveredBindableElement","oppositeBindingBoundElement","handleCanvasRef","handleWheel","TOUCH_START","TOUCH_END","handleAppOnDrop","getAsFileSystemHandle","libraryShapes","preferSelected","_openContextMenu","maybeDragNewGenericElement","lastCoords","aspectRatio","originInGrid","maybeHandleResize","resizeX","resizeY","transformElements","maybeGroupAction","maybeUngroupAction","maybeFlipHorizontal","maybeFlipVertical","separator","viewModeOptions","appStates","log10","isNaN","onPointerUpdate","pointersMap","updateDOMRect","currentWidth","currentHeight","currentOffsetTop","currentOffsetLeft","refresh","excalidrawRef","readyPromise","api","ready","getFiles","excalidrawContainerValue","registerAll","undoOnce","redoOnce","createRedoAction","canvasScale","canvasDOMWidth","canvasDOMHeight","onPointerCancel","onTouchMove","onDoubleClick","renderFooter","onDrop","handleKeyboardGlobally","Provider","renderCanvas","defineProperties","configurable","addCallback","addEventListeners","resizeObserver","ResizeObserver","observe","matchMedia","mediaQuery","matches","addListener","detachIsMobileMqHandler","removeListener","disconnect","removeEventListeners","destroy","COPY","CUT","nearestScrollableContainer","SCROLL","MOUSE_MOVE","RESIZE","UNLOAD","DRAG_OVER","DROP","GESTURE_START","GESTURE_CHANGE","GESTURE_END","detail","fonts","detectScroll","overflowY","scrollHeight","clientHeight","getNearestScrollableContainer","prevProps","updateLanguage","deselectElements","toggle","pointerViewportCoords","pointerUsernames","pointerUserStates","user","renderingElements","record","updateElement","_element","onSubmit","getViewportCoords","excalidrawContainer","updateWysiwygStyle","viewportX","viewportY","editable","wrap","backfaceVisibility","outline","zIndex","oninput","onkeydown","submittedViaKeyboard","handleSubmit","outdent","indent","dispatchEvent","Event","TAB","repeat","RE_LEADING_TAB","selectionStart","selectionEnd","linesStartIndices","getSelectedLinesStartIndices","startIndex","startValue","endValue","removedTabs","tabMatch","startOffset","startIndices","stopEvent","cleanup","viaKeyboard","isDestroyed","onblur","observer","bindBlurEvent","unbindUpdate","SVGElement","capture","textWysiwyg","elementWithHighestZIndex","hitTest","withCmdOrCtrl","scrollbars","hasBeenDuplicated","drag","hasOccurred","handlePointerMoveOverScrollbars","getDragOffsetXY","didDrag","handlePointDragging","hasHitASelectedElement","dragX","dragY","dragDistanceX","dragDistanceY","lockDirection","distanceX","distanceY","lockX","lockY","original","dragSelectedElements","elementsToAppend","duplicatedElement","originDragX","originDragY","nextSceneElements","elementsWithinSelection","selectionX1","selectionY1","selectionX2","selectionY2","getElementsWithinSelection","childEvent","handlePointerUp","idsOfSelectedElementsThatAreInGroups","prevId","_prevState","gId","includedElementIds","getEligibleElementsForBinding","elementClickedInside","getElementContainingPosition","Component","SCENE","Modal","modalRoot","useBodyRoot","createPortal","labelledBy","setDiv","isMobileRef","isDarkTheme","Dialog","islandNode","setIslandNode","lastActiveElement","focusableElements","queryFocusableElements","currentIndex","querySelectorAll","ErrorDialog","TopErrorBoundary","arguments","hasError","sentryEventId","localStorage","errorSplash","errorInfo","_localStorage","Sentry","scope","setExtras","eventId","templateStrFn","reload","createGithubIssue","selectTextArea","readOnly","InitializeApp","loading","setLoading","updateLang","Excalidraw","nextProps","prevUIOptions","nextUIOptions","prevUIOptionsKeys","nextUIOptionsKeys","isUIOptionsSame","prevKeys","nextKeys","forwardedRefComp","FILE_UPLOAD_MAX_BYTES","BROADCAST","FIREBASE_STORAGE_PREFIXES","FileManager","saveFiles","fetchingFiles","savingFiles","savedFiles","isFileHandled","isFileSaved","addedFiles","_saveFiles","loadedFiles","_getFiles","shouldPreventUnload","shouldUpdateImageElementStatus","encodeFilesForUpload","maxBytes","encryptionKey","processedFiles","compressData","encodedFile","byteLength","updateStaleImageStatuses","excalidrawAPI","FIREBASE_CONFIG","firebasePromise","firestorePromise","firebaseStoragePromise","isFirebaseInitialized","_loadFirebase","firebase","initializeApp","_getFirebase","loadFirestore","loadFirebaseStorage","encryptElements","encoded","ciphertext","decryptElements","decrypted","decodedData","TextDecoder","decode","firebaseSceneVersionCache","isSavedToFirebase","portal","socket","roomId","roomKey","sceneVersion","saveFilesToFirebase","prefix","storage","put","cacheControl","saveToFirebase","nextDocData","firestore","fromUint8Array","docRef","collection","runTransaction","transaction","exists","update","didUpdate","loadFromFirebase","storedScene","toUint8Array","loadFilesFromFirebase","decryptionKey","filesIds","storageBucket","response","decompressData","byteToHex","generateRandomID","encryptAESGEM","decryptAESGEM","getCollaborationLinkData","URL","generateCollaborationLinkData","decryptImported","importFromBackend","ok","fixedIv","localDataState","exportToBackend","cryptoKey","payloadBlob","Response","payload","exportedKey","filesToUpload","method","href","urlString","prompt","error_class","importUsernameFromLocalStorage","getItem","saveToLocalStorage","setItem","getElementsStorageSize","getTotalStorageSize","collab","APP_STORAGE_KEYS","Portal","socketInitialized","broadcastedElementVersions","queueFileUpload","fileManager","broadcastScene","sceneType","syncAll","INIT","syncableElements","isSyncableElement","syncableElement","broadcastPromise","_broadcastSocketData","saveCollabRoomToFirebase","broadcastIdleChange","broadcastMouseLocation","on","emit","_socketId","clients","setCollaborators","volatile","isOpen","getShareIcon","isAppleBrowser","vendor","isWindowsBrowser","appVersion","RoomDialog","activeRoomLink","onUsernameChange","onRoomCreate","onRoomDestroy","setErrorMessage","roomLinkInput","copyRoomLink","shareRoomLink","selectInput","onKeyPress","shouldDiscardRemoteElement","local","remote","initialValue","Context","InverseConsumer","_updateProviderValue","InverseProvider","Consumer","createInverseContext","CollabContext","CollabContextConsumer","CollabContextProvider","CollabWrapper","lastBroadcastedOrReceivedSceneVersion","destroySocketClient","isUnload","beforeUnload","getSyncableElements","timestamp","room","openPortal","initializeSocketClient","closePortal","queueBroadcastAllElements","loadImageFiles","pushState","onRoomClose","reset","fetchImageFilesFromFirebase","unfetchedImages","existingRoomLinkData","scenePromise","socketIOClient","broadcastElements","socketInitializationTimer","initializeSocket","encryptedData","decryptedData","UPDATE","remoteElements","reconciledElements","reconcileElements","handleRemoteSceneUpdate","init","socketID","off","initializeIdleDetector","localElementsData","duplicates","remoteElementIdx","remoteElement","_reconcileElements","setLastBroadcastedOrReceivedSceneVersion","idleTimeoutId","reportIdle","activeIntervalId","reportActive","onVisibilityChange","onIdleStateChange","VISIBILITY_CHANGE","getLastBroadcastedOrReceivedSceneVersion","currentVersion","newVersion","saveUsernameToLocalStorage","contextValue","getContextValue","BEFORE_UNLOAD","sockets","PureComponent","getStorageSizes","total","CustomStats","storageSizes","setStorageSizes","sizes","excalidrawPlusIcon","exportToExcalidrawPlus","customMetadata","ExportToExcalidrawPlus","onError","filesStore","createStore","clearObsoleteFilesFromIndexedDB","allIds","currentFileIds","del","localFileStorage","getMany","filesData","languageDetector","LanguageDetector","languageUtils","formatLanguageCode","isWhitelisted","checkWhitelist","saveDebounced","onFilesSaved","searchParams","jsonBackendMatch","externalUrlMatch","roomLinkData","isExternalScene","once","collabAPI","ExcalidrawWrapper","currentLangCode","detect","initialStatePromiseRef","excalidrawRefCallback","loadImages","isInitialLoad","onHashChange","oldURL","titleTimeout","HASHCHANGE","unloadHandler","cacheUserLanguage","isTinyDevice","borderRadius","removeItem","newEl","ExcalidrawApp","SentryEnvHostnameMap","onlineEnv","REACT_APP_DISABLE_SENTRY","hostname","dsn","environment","release","REACT_APP_GIT_SHA","ignoreErrors","integrations","SentryIntegrations","levels","beforeSend","__EXCALIDRAW_SHA__","ChalkBoard","JSCode","webDFiles","language","class","btntext","TextEditor","srcDoc","useSelector","srcDocs","logs","setLogs","Ln","setLn","Col","setCol","dispatch","useDispatch","editorRef","editorLang","curr","timer","consoleView","selectedSidebar","codeText","getElementsByClassName","getPosition","lineNumber","column","handleFolder","child","directoryhandle","kind","fileContent","showDirectoryPicker","directoryHandle","folderName","contentWindow","Hook","currLogs","frame","contentDocument","eve2","KeyboardEvent","bubbles","cancelBubble","cancelable","charCode","composed","defaultPrevented","eventPhase","eve","trigger","class_name","class_name_span","class_name_icon","f_id","defaultLanguage","saveViewState","onMount","editor","monaco","defineTheme","inherit","rules","foreground","fontStyle","cursorSmoothCaretAnimation","frameBorder","variant","MultiFile","setModal","outputValue","setOutputValue","setInputValue","selectLang","words","axios","post","stdin","versionIndex","script","runCode","output","CustomEvent","fontWeight","beforeMount","cols","placeholder","startTime","Recorder","lectureType","languageType","audioString","childValue","Recording","events","lastMouse","handlers","eventName","time","pageX","pageY","Mp3Recorder","MicRecorder","bitRate","startRecording","stopRecording","getMp3","recordingString","lectureData","audio","lectureName","creator","lectureCreator","imageString","IDE","parentCallBack","childData","Preloader","Video","useParams","setRefresh","startPlay","playerBlock","videoPlayer","playButton","audioPlayer","getElementById","offsetPlay","paused","fakeCursor","playerPlay","playfunction","playerPause","pausefunction","frames","PointerEvent","handleButtonEvents","tar","MouseEvent","clickEvent","click","flashClass","drawEvent","play","pause","curTime","currentTime","controls","controlsList","Test","apps","apiKey","authDomain","projectId","messagingSenderId","appId","measurementId","pc","RTCPeerConnection","iceServers","urls","iceCandidatePoolSize","localStream","remoteStream","webcamButton","webcamVideo","callButton","callInput","answerButton","remoteVideo","hangupButton","onclick","mediaDevices","getUserMedia","video","MediaStream","getTracks","track","addTrack","ontrack","streams","srcObject","callDoc","offerCandidates","answerCandidates","onicecandidate","candidate","toJSON","createOffer","offerDescription","setLocalDescription","offer","sdp","onSnapshot","snapshot","currentRemoteDescription","answer","answerDescription","RTCSessionDescription","setRemoteDescription","docChanges","change","RTCIceCandidate","addIceCandidate","callId","callData","createAnswer","autoPlay","playsInline","UserSection","uuidv4","motion","section","initial","animate","transition","duration","RecorderForm","socketUrl","classid","useHistory","languageList","thumNailButton","thumNailPreview","constraints","echoCancellationType","echoCancellation","noiseSuppression","sampleRate","sampleSize","channelCount","volume","LiveClassEmitter","joinLink","socketRef","stream","setStream","io","myVideo","inviteButton","inviteLink","sendData","startLive","peer","Peer","initiator","trickle","config","credential","signalData","signal","dragConstraints","dragTransition","bounceStiffness","bounceDamping","dragElastic","whileTap","muted","LiveClassReceiver","callerSignal","setCallerSignal","userVideo","paddingRight","lectures","lecture","thumbnail","imageThumnail","backgroundImage","AllLectures","setLectures","fi","filenameReducer","outputModalReducer","languageReducer","allReducers","combineReducers","outputModal","middleware","thunk","composeEnhancer","__REDUX_DEVTOOLS_EXTENSION_COMPOSE__","compose","store","allReducer","applyMiddleware","exact","component","Player","ide","ReactDOM","toByteString","readAsBinaryString","byteStringToArrayBuffer","bufferView","len","byteStringToString","stringToBase64","btoa","base64ToString","base64","isByteString","compress","deflate","deflated","encoding","compressed","decoded","inflate","DATA_VIEW_BITS_MAP","dataView","bytes","DataView","concatBuffers","buffers","splitBuffers","concatenatedBuffer","chunkSize","_encryptAndCompress","dataBuffer","fileInfo","compression","encryption","encodingMetadataBuffer","contentsMetadataBuffer","_decryptAndDecompress","decryptedBuffer","isCompressed","encodingMetadata","contentsBuffer"],"mappings":"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","file":"static/js/main.929e86f4.chunk.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"themeFilter\":\"invert(93%) hue-rotate(180deg)\"};","var map = {\n\t\"./en.json\": 113,\n\t\"./percentages.json\": 114\n};\n\nfunction webpackAsyncContext(req) {\n\treturn Promise.resolve().then(function() {\n\t\tif(!__webpack_require__.o(map, req)) {\n\t\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\t\te.code = 'MODULE_NOT_FOUND';\n\t\t\tthrow e;\n\t\t}\n\n\t\tvar id = map[req];\n\t\treturn __webpack_require__.t(id, 3);\n\t});\n}\nwebpackAsyncContext.keys = function webpackAsyncContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackAsyncContext.id = 181;\nmodule.exports = webpackAsyncContext;","export const IV_LENGTH_BYTES = 12;\r\nexport const createIV = () => {\r\n    const arr = new Uint8Array(IV_LENGTH_BYTES);\r\n    return window.crypto.getRandomValues(arr);\r\n};\r\nexport const generateEncryptionKey = async () => {\r\n    const key = await window.crypto.subtle.generateKey({\r\n        name: \"AES-GCM\",\r\n        length: 128,\r\n    }, true, // extractable\r\n    [\"encrypt\", \"decrypt\"]);\r\n    return (await window.crypto.subtle.exportKey(\"jwk\", key)).k;\r\n};\r\nexport const getImportedKey = (key, usage) => window.crypto.subtle.importKey(\"jwk\", {\r\n    alg: \"A128GCM\",\r\n    ext: true,\r\n    k: key,\r\n    key_ops: [\"encrypt\", \"decrypt\"],\r\n    kty: \"oct\",\r\n}, {\r\n    name: \"AES-GCM\",\r\n    length: 128,\r\n}, false, // extractable\r\n[usage]);\r\nexport const encryptData = async (key, data) => {\r\n    const importedKey = await getImportedKey(key, \"encrypt\");\r\n    const iv = createIV();\r\n    const buffer = typeof data === \"string\"\r\n        ? new TextEncoder().encode(data)\r\n        : data instanceof Uint8Array\r\n            ? data\r\n            : data instanceof Blob\r\n                ? await data.arrayBuffer()\r\n                : data;\r\n    const encryptedBuffer = await window.crypto.subtle.encrypt({\r\n        name: \"AES-GCM\",\r\n        iv,\r\n    }, importedKey, buffer);\r\n    return { encryptedBuffer, iv };\r\n};\r\nexport const decryptData = async (iv, encrypted, privateKey) => {\r\n    const key = await getImportedKey(privateKey, \"decrypt\");\r\n    return window.crypto.subtle.decrypt({\r\n        name: \"AES-GCM\",\r\n        iv,\r\n    }, key, encrypted);\r\n};\r\n","export const trackEvent = typeof process !== \"undefined\" &&\r\n    process.env?.REACT_APP_GOOGLE_ANALYTICS_ID &&\r\n    typeof window !== \"undefined\" &&\r\n    window.gtag\r\n    ? (category, name, label, value) => {\r\n        window.gtag(\"event\", name, {\r\n            event_category: category,\r\n            event_label: label,\r\n            value,\r\n        });\r\n    }\r\n    : typeof process !== \"undefined\" && process.env?.JEST_WORKER_ID\r\n        ? (category, name, label, value) => { }\r\n        : (category, name, label, value) => {\r\n            // Uncomment the next line to track locally\r\n            // console.info(\"Track Event\", category, name, label, value);\r\n        };\r\n","import cssVariables from \"./css/variables.module.scss\";\r\nexport const APP_NAME = \"ChalkBoard\";\r\nexport const DRAGGING_THRESHOLD = 10; // px\r\nexport const LINE_CONFIRM_THRESHOLD = 8; // px\r\nexport const ELEMENT_SHIFT_TRANSLATE_AMOUNT = 5;\r\nexport const ELEMENT_TRANSLATE_AMOUNT = 1;\r\nexport const TEXT_TO_CENTER_SNAP_THRESHOLD = 30;\r\nexport const SHIFT_LOCKING_ANGLE = Math.PI / 12;\r\nexport const CURSOR_TYPE = {\r\n    TEXT: \"text\",\r\n    CROSSHAIR: \"crosshair\",\r\n    GRABBING: \"grabbing\",\r\n    GRAB: \"grab\",\r\n    POINTER: \"pointer\",\r\n    MOVE: \"move\",\r\n    AUTO: \"\",\r\n};\r\nexport const POINTER_BUTTON = {\r\n    MAIN: 0,\r\n    WHEEL: 1,\r\n    SECONDARY: 2,\r\n    TOUCH: -1,\r\n};\r\nexport var EVENT;\r\n(function (EVENT) {\r\n    EVENT[\"COPY\"] = \"copy\";\r\n    EVENT[\"PASTE\"] = \"paste\";\r\n    EVENT[\"CUT\"] = \"cut\";\r\n    EVENT[\"KEYDOWN\"] = \"keydown\";\r\n    EVENT[\"KEYUP\"] = \"keyup\";\r\n    EVENT[\"MOUSE_MOVE\"] = \"mousemove\";\r\n    EVENT[\"RESIZE\"] = \"resize\";\r\n    EVENT[\"UNLOAD\"] = \"unload\";\r\n    EVENT[\"FOCUS\"] = \"focus\";\r\n    EVENT[\"BLUR\"] = \"blur\";\r\n    EVENT[\"DRAG_OVER\"] = \"dragover\";\r\n    EVENT[\"DROP\"] = \"drop\";\r\n    EVENT[\"GESTURE_END\"] = \"gestureend\";\r\n    EVENT[\"BEFORE_UNLOAD\"] = \"beforeunload\";\r\n    EVENT[\"GESTURE_START\"] = \"gesturestart\";\r\n    EVENT[\"GESTURE_CHANGE\"] = \"gesturechange\";\r\n    EVENT[\"POINTER_MOVE\"] = \"pointermove\";\r\n    EVENT[\"POINTER_UP\"] = \"pointerup\";\r\n    EVENT[\"STATE_CHANGE\"] = \"statechange\";\r\n    EVENT[\"WHEEL\"] = \"wheel\";\r\n    EVENT[\"TOUCH_START\"] = \"touchstart\";\r\n    EVENT[\"TOUCH_END\"] = \"touchend\";\r\n    EVENT[\"HASHCHANGE\"] = \"hashchange\";\r\n    EVENT[\"VISIBILITY_CHANGE\"] = \"visibilitychange\";\r\n    EVENT[\"SCROLL\"] = \"scroll\";\r\n})(EVENT || (EVENT = {}));\r\nexport const ENV = {\r\n    TEST: \"test\",\r\n    DEVELOPMENT: \"development\",\r\n};\r\nexport const CLASSES = {\r\n    SHAPE_ACTIONS_MENU: \"App-menu__left\",\r\n};\r\n// 1-based in case we ever do `if(element.fontFamily)`\r\nexport const FONT_FAMILY = {\r\n    Virgil: 1,\r\n    Helvetica: 2,\r\n    Cascadia: 3,\r\n};\r\nexport const THEME = {\r\n    LIGHT: \"light\",\r\n    DARK: \"dark\",\r\n};\r\nexport const WINDOWS_EMOJI_FALLBACK_FONT = \"Segoe UI Emoji\";\r\nexport const DEFAULT_FONT_SIZE = 20;\r\nexport const DEFAULT_FONT_FAMILY = FONT_FAMILY.Virgil;\r\nexport const DEFAULT_TEXT_ALIGN = \"left\";\r\nexport const DEFAULT_VERTICAL_ALIGN = \"top\";\r\nexport const DEFAULT_VERSION = \"{version}\";\r\nexport const CANVAS_ONLY_ACTIONS = [\"selectAll\"];\r\nexport const GRID_SIZE = 20; // TODO make it configurable?\r\nexport const MIME_TYPES = {\r\n    excalidraw: \"application/vnd.excalidraw+json\",\r\n    excalidrawlib: \"application/vnd.excalidrawlib+json\",\r\n    json: \"application/json\",\r\n    svg: \"image/svg+xml\",\r\n    png: \"image/png\",\r\n    jpg: \"image/jpeg\",\r\n    gif: \"image/gif\",\r\n    binary: \"application/octet-stream\",\r\n};\r\nexport const EXPORT_DATA_TYPES = {\r\n    excalidraw: \"excalidraw\",\r\n    excalidrawClipboard: \"excalidraw/clipboard\",\r\n    excalidrawLibrary: \"chalkboardlib\",\r\n};\r\nexport const EXPORT_SOURCE = window.location.origin;\r\nexport const STORAGE_KEYS = {\r\n    LOCAL_STORAGE_LIBRARY: \"excalidraw-library\",\r\n};\r\n// time in milliseconds\r\nexport const IMAGE_RENDER_TIMEOUT = 500;\r\nexport const TAP_TWICE_TIMEOUT = 300;\r\nexport const TOUCH_CTX_MENU_TIMEOUT = 500;\r\nexport const TITLE_TIMEOUT = 10000;\r\nexport const TOAST_TIMEOUT = 5000;\r\nexport const VERSION_TIMEOUT = 30000;\r\nexport const SCROLL_TIMEOUT = 100;\r\nexport const ZOOM_STEP = 0.1;\r\n// Report a user inactive after IDLE_THRESHOLD milliseconds\r\nexport const IDLE_THRESHOLD = 60000;\r\n// Report a user active each ACTIVE_THRESHOLD milliseconds\r\nexport const ACTIVE_THRESHOLD = 3000;\r\nexport const MODES = {\r\n    VIEW: \"viewMode\",\r\n    ZEN: \"zenMode\",\r\n    GRID: \"gridMode\",\r\n};\r\nexport const THEME_FILTER = cssVariables.themeFilter;\r\nexport const URL_QUERY_KEYS = {\r\n    addLibrary: \"addLibrary\",\r\n};\r\nexport const URL_HASH_KEYS = {\r\n    addLibrary: \"addLibrary\",\r\n};\r\nexport const DEFAULT_UI_OPTIONS = {\r\n    canvasActions: {\r\n        changeViewBackgroundColor: true,\r\n        clearCanvas: true,\r\n        export: { saveFileToDisk: true },\r\n        loadScene: true,\r\n        saveToActiveFile: true,\r\n        theme: true,\r\n        saveAsImage: true,\r\n    },\r\n};\r\nexport const MQ_MAX_WIDTH_PORTRAIT = 730;\r\nexport const MQ_MAX_WIDTH_LANDSCAPE = 1000;\r\nexport const MQ_MAX_HEIGHT_LANDSCAPE = 500;\r\nexport const MAX_DECIMALS_FOR_SVG_EXPORT = 2;\r\nexport const EXPORT_SCALES = [1, 2, 3];\r\nexport const DEFAULT_EXPORT_PADDING = 10; // px\r\nexport const DEFAULT_MAX_IMAGE_WIDTH_OR_HEIGHT = 1440;\r\nexport const ALLOWED_IMAGE_MIME_TYPES = [\r\n    MIME_TYPES.png,\r\n    MIME_TYPES.jpg,\r\n    MIME_TYPES.svg,\r\n    MIME_TYPES.gif,\r\n];\r\nexport const MAX_ALLOWED_FILE_BYTES = 2 * 1024 * 1024;\r\nexport const SVG_NS = \"http://www.w3.org/2000/svg\";\r\n","import fallbackLangData from \"./locales/en.json\";\r\nimport percentages from \"./locales/percentages.json\";\r\nimport { ENV } from \"./constants\";\r\nconst COMPLETION_THRESHOLD = 85;\r\nexport const defaultLang = { code: \"en\", label: \"English\" };\r\nconst allLanguages = [\r\n    { code: \"ar-SA\", label: \"\", rtl: true },\r\n    { code: \"bg-BG\", label: \"\" },\r\n    { code: \"ca-ES\", label: \"Catal\" },\r\n    { code: \"de-DE\", label: \"Deutsch\" },\r\n    { code: \"el-GR\", label: \"\" },\r\n    { code: \"es-ES\", label: \"Espaol\" },\r\n    { code: \"fa-IR\", label: \"\", rtl: true },\r\n    { code: \"fi-FI\", label: \"Suomi\" },\r\n    { code: \"fr-FR\", label: \"Franais\" },\r\n    { code: \"he-IL\", label: \"\", rtl: true },\r\n    { code: \"hi-IN\", label: \"\" },\r\n    { code: \"hu-HU\", label: \"Magyar\" },\r\n    { code: \"id-ID\", label: \"Bahasa Indonesia\" },\r\n    { code: \"it-IT\", label: \"Italiano\" },\r\n    { code: \"ja-JP\", label: \"\" },\r\n    { code: \"kab-KAB\", label: \"Taqbaylit\" },\r\n    { code: \"ko-KR\", label: \"\" },\r\n    { code: \"my-MM\", label: \"Burmese\" },\r\n    { code: \"nb-NO\", label: \"Norsk bokml\" },\r\n    { code: \"nl-NL\", label: \"Nederlands\" },\r\n    { code: \"nn-NO\", label: \"Norsk nynorsk\" },\r\n    { code: \"oc-FR\", label: \"Occitan\" },\r\n    { code: \"pa-IN\", label: \"\" },\r\n    { code: \"pl-PL\", label: \"Polski\" },\r\n    { code: \"pt-BR\", label: \"Portugus Brasileiro\" },\r\n    { code: \"pt-PT\", label: \"Portugus\" },\r\n    { code: \"ro-RO\", label: \"Romn\" },\r\n    { code: \"ru-RU\", label: \"\" },\r\n    { code: \"sk-SK\", label: \"Slovenina\" },\r\n    { code: \"sv-SE\", label: \"Svenska\" },\r\n    { code: \"tr-TR\", label: \"Trke\" },\r\n    { code: \"uk-UA\", label: \"\" },\r\n    { code: \"zh-CN\", label: \"\" },\r\n    { code: \"zh-TW\", label: \"\" },\r\n    { code: \"lv-LV\", label: \"Latvieu\" },\r\n    { code: \"cs-CZ\", label: \"esky\" },\r\n    { code: \"kk-KZ\", label: \" \" },\r\n].concat([defaultLang]);\r\nexport const languages = allLanguages\r\n    .sort((left, right) => (left.label > right.label ? 1 : -1))\r\n    .filter((lang) => percentages[lang.code] >=\r\n    COMPLETION_THRESHOLD);\r\nconst TEST_LANG_CODE = \"__test__\";\r\nif (process.env.NODE_ENV === ENV.DEVELOPMENT) {\r\n    languages.unshift({ code: TEST_LANG_CODE, label: \"test language\" }, {\r\n        code: `${TEST_LANG_CODE}.rtl`,\r\n        label: \"\\u{202a}test language (rtl)\\u{202c}\",\r\n        rtl: true,\r\n    });\r\n}\r\nlet currentLang = defaultLang;\r\nlet currentLangData = {};\r\nexport const setLanguage = async (lang) => {\r\n    currentLang = lang;\r\n    document.documentElement.dir = currentLang.rtl ? \"rtl\" : \"ltr\";\r\n    document.documentElement.lang = currentLang.code;\r\n    if (lang.code.startsWith(TEST_LANG_CODE)) {\r\n        currentLangData = {};\r\n    }\r\n    else {\r\n        currentLangData = await import(\r\n        /* webpackChunkName: \"i18n-[request]\" */ `./locales/${currentLang.code}.json`);\r\n    }\r\n};\r\nexport const getLanguage = () => currentLang;\r\nconst findPartsForData = (data, parts) => {\r\n    for (let index = 0; index < parts.length; ++index) {\r\n        const part = parts[index];\r\n        if (data[part] === undefined) {\r\n            return undefined;\r\n        }\r\n        data = data[part];\r\n    }\r\n    if (typeof data !== \"string\") {\r\n        return undefined;\r\n    }\r\n    return data;\r\n};\r\nexport const t = (path, replacement) => {\r\n    if (currentLang.code.startsWith(TEST_LANG_CODE)) {\r\n        const name = replacement\r\n            ? `${path}(${JSON.stringify(replacement).slice(1, -1)})`\r\n            : path;\r\n        return `\\u{202a}[[${name}]]\\u{202c}`;\r\n    }\r\n    const parts = path.split(\".\");\r\n    let translation = findPartsForData(currentLangData, parts) ||\r\n        findPartsForData(fallbackLangData, parts);\r\n    if (translation === undefined) {\r\n        throw new Error(`Can't find translation for ${path}`);\r\n    }\r\n    if (replacement) {\r\n        for (const key in replacement) {\r\n            translation = translation.replace(`{{${key}}}`, replacement[key]);\r\n        }\r\n    }\r\n    return translation;\r\n};\r\n","import oc from \"open-color\";\r\nconst shades = (index) => [\r\n    oc.red[index],\r\n    oc.pink[index],\r\n    oc.grape[index],\r\n    oc.violet[index],\r\n    oc.indigo[index],\r\n    oc.blue[index],\r\n    oc.cyan[index],\r\n    oc.teal[index],\r\n    oc.green[index],\r\n    oc.lime[index],\r\n    oc.yellow[index],\r\n    oc.orange[index],\r\n];\r\nexport default {\r\n    canvasBackground: [oc.white, oc.gray[0], oc.gray[1], ...shades(0)],\r\n    elementBackground: [\"transparent\", oc.gray[4], oc.gray[6], ...shades(6)],\r\n    elementStroke: [oc.black, oc.gray[8], oc.gray[7], ...shades(9)],\r\n};\r\n","export const isDarwin = /Mac|iPod|iPhone|iPad/.test(window.navigator.platform);\r\nexport const isWindows = /^Win/.test(window.navigator.platform);\r\nexport const CODES = {\r\n    EQUAL: \"Equal\",\r\n    MINUS: \"Minus\",\r\n    NUM_ADD: \"NumpadAdd\",\r\n    NUM_SUBTRACT: \"NumpadSubtract\",\r\n    NUM_ZERO: \"Numpad0\",\r\n    BRACKET_RIGHT: \"BracketRight\",\r\n    BRACKET_LEFT: \"BracketLeft\",\r\n    ONE: \"Digit1\",\r\n    TWO: \"Digit2\",\r\n    NINE: \"Digit9\",\r\n    QUOTE: \"Quote\",\r\n    ZERO: \"Digit0\",\r\n    SLASH: \"Slash\",\r\n    C: \"KeyC\",\r\n    D: \"KeyD\",\r\n    G: \"KeyG\",\r\n    F: \"KeyF\",\r\n    H: \"KeyH\",\r\n    V: \"KeyV\",\r\n    X: \"KeyX\",\r\n    Z: \"KeyZ\",\r\n    R: \"KeyR\",\r\n};\r\nexport const KEYS = {\r\n    ARROW_DOWN: \"ArrowDown\",\r\n    ARROW_LEFT: \"ArrowLeft\",\r\n    ARROW_RIGHT: \"ArrowRight\",\r\n    ARROW_UP: \"ArrowUp\",\r\n    BACKSPACE: \"Backspace\",\r\n    ALT: \"Alt\",\r\n    CTRL_OR_CMD: isDarwin ? \"metaKey\" : \"ctrlKey\",\r\n    DELETE: \"Delete\",\r\n    ENTER: \"Enter\",\r\n    ESCAPE: \"Escape\",\r\n    QUESTION_MARK: \"?\",\r\n    SPACE: \" \",\r\n    TAB: \"Tab\",\r\n    A: \"a\",\r\n    D: \"d\",\r\n    E: \"e\",\r\n    G: \"g\",\r\n    I: \"i\",\r\n    L: \"l\",\r\n    O: \"o\",\r\n    P: \"p\",\r\n    Q: \"q\",\r\n    R: \"r\",\r\n    S: \"s\",\r\n    T: \"t\",\r\n    V: \"v\",\r\n    X: \"x\",\r\n    Y: \"y\",\r\n    Z: \"z\",\r\n};\r\nexport const isArrowKey = (key) => key === KEYS.ARROW_LEFT ||\r\n    key === KEYS.ARROW_RIGHT ||\r\n    key === KEYS.ARROW_DOWN ||\r\n    key === KEYS.ARROW_UP;\r\nexport const shouldResizeFromCenter = (event) => event.altKey;\r\nexport const shouldMaintainAspectRatio = (event) => event.shiftKey;\r\nexport const shouldRotateWithDiscreteAngle = (event) => event.shiftKey;\r\n","import colors from \"./colors\";\r\nimport { CURSOR_TYPE, DEFAULT_VERSION, FONT_FAMILY, WINDOWS_EMOJI_FALLBACK_FONT, } from \"./constants\";\r\nimport { unstable_batchedUpdates } from \"react-dom\";\r\nimport { isDarwin } from \"./keys\";\r\nlet mockDateTime = null;\r\nexport const setDateTimeForTests = (dateTime) => {\r\n    mockDateTime = dateTime;\r\n};\r\nexport const getDateTime = () => {\r\n    if (mockDateTime) {\r\n        return mockDateTime;\r\n    }\r\n    const date = new Date();\r\n    const year = date.getFullYear();\r\n    const month = `${date.getMonth() + 1}`.padStart(2, \"0\");\r\n    const day = `${date.getDate()}`.padStart(2, \"0\");\r\n    const hr = `${date.getHours()}`.padStart(2, \"0\");\r\n    const min = `${date.getMinutes()}`.padStart(2, \"0\");\r\n    return `${year}-${month}-${day}-${hr}${min}`;\r\n};\r\nexport const capitalizeString = (str) => str.charAt(0).toUpperCase() + str.slice(1);\r\nexport const isToolIcon = (target) => target instanceof HTMLElement && target.className.includes(\"ToolIcon\");\r\nexport const isInputLike = (target) => (target instanceof HTMLElement && target.dataset.type === \"wysiwyg\") ||\r\n    target instanceof HTMLBRElement || // newline in wysiwyg\r\n    target instanceof HTMLInputElement ||\r\n    target instanceof HTMLTextAreaElement ||\r\n    target instanceof HTMLSelectElement;\r\nexport const isWritableElement = (target) => (target instanceof HTMLElement && target.dataset.type === \"wysiwyg\") ||\r\n    target instanceof HTMLBRElement || // newline in wysiwyg\r\n    target instanceof HTMLTextAreaElement ||\r\n    (target instanceof HTMLInputElement &&\r\n        (target.type === \"text\" || target.type === \"number\"));\r\nexport const getFontFamilyString = ({ fontFamily, }) => {\r\n    for (const [fontFamilyString, id] of Object.entries(FONT_FAMILY)) {\r\n        if (id === fontFamily) {\r\n            return `${fontFamilyString}, ${WINDOWS_EMOJI_FALLBACK_FONT}`;\r\n        }\r\n    }\r\n    return WINDOWS_EMOJI_FALLBACK_FONT;\r\n};\r\n/** returns fontSize+fontFamily string for assignment to DOM elements */\r\nexport const getFontString = ({ fontSize, fontFamily, }) => {\r\n    return `${fontSize}px ${getFontFamilyString({ fontFamily })}`;\r\n};\r\n// https://github.com/grassator/canvas-text-editor/blob/master/lib/FontMetrics.js\r\nexport const measureText = (text, font) => {\r\n    const line = document.createElement(\"div\");\r\n    const body = document.body;\r\n    line.style.position = \"absolute\";\r\n    line.style.whiteSpace = \"pre\";\r\n    line.style.font = font;\r\n    body.appendChild(line);\r\n    line.innerText = text\r\n        .split(\"\\n\")\r\n        // replace empty lines with single space because leading/trailing empty\r\n        // lines would be stripped from computation\r\n        .map((x) => x || \" \")\r\n        .join(\"\\n\");\r\n    const width = line.offsetWidth;\r\n    const height = line.offsetHeight;\r\n    // Now creating 1px sized item that will be aligned to baseline\r\n    // to calculate baseline shift\r\n    const span = document.createElement(\"span\");\r\n    span.style.display = \"inline-block\";\r\n    span.style.overflow = \"hidden\";\r\n    span.style.width = \"1px\";\r\n    span.style.height = \"1px\";\r\n    line.appendChild(span);\r\n    // Baseline is important for positioning text on canvas\r\n    const baseline = span.offsetTop + span.offsetHeight;\r\n    document.body.removeChild(line);\r\n    return { width, height, baseline };\r\n};\r\nexport const debounce = (fn, timeout) => {\r\n    let handle = 0;\r\n    let lastArgs = null;\r\n    const ret = (...args) => {\r\n        lastArgs = args;\r\n        clearTimeout(handle);\r\n        handle = window.setTimeout(() => {\r\n            lastArgs = null;\r\n            fn(...args);\r\n        }, timeout);\r\n    };\r\n    ret.flush = () => {\r\n        clearTimeout(handle);\r\n        if (lastArgs) {\r\n            const _lastArgs = lastArgs;\r\n            lastArgs = null;\r\n            fn(..._lastArgs);\r\n        }\r\n    };\r\n    ret.cancel = () => {\r\n        lastArgs = null;\r\n        clearTimeout(handle);\r\n    };\r\n    return ret;\r\n};\r\nexport const selectNode = (node) => {\r\n    const selection = window.getSelection();\r\n    if (selection) {\r\n        const range = document.createRange();\r\n        range.selectNodeContents(node);\r\n        selection.removeAllRanges();\r\n        selection.addRange(range);\r\n    }\r\n};\r\nexport const removeSelection = () => {\r\n    const selection = window.getSelection();\r\n    if (selection) {\r\n        selection.removeAllRanges();\r\n    }\r\n};\r\nexport const distance = (x, y) => Math.abs(x - y);\r\nexport const resetCursor = (canvas) => {\r\n    if (canvas) {\r\n        canvas.style.cursor = \"\";\r\n    }\r\n};\r\nexport const setCursor = (canvas, cursor) => {\r\n    if (canvas) {\r\n        canvas.style.cursor = cursor;\r\n    }\r\n};\r\nexport const setCursorForShape = (canvas, shape) => {\r\n    if (!canvas) {\r\n        return;\r\n    }\r\n    if (shape === \"selection\") {\r\n        resetCursor(canvas);\r\n        // do nothing if image tool is selected which suggests there's\r\n        // a image-preview set as the cursor\r\n    }\r\n    else if (shape !== \"image\") {\r\n        canvas.style.cursor = CURSOR_TYPE.CROSSHAIR;\r\n    }\r\n};\r\nexport const isFullScreen = () => document.fullscreenElement?.nodeName === \"HTML\";\r\nexport const allowFullScreen = () => document.documentElement.requestFullscreen();\r\nexport const exitFullScreen = () => document.exitFullscreen();\r\nexport const getShortcutKey = (shortcut) => {\r\n    shortcut = shortcut\r\n        .replace(/\\bAlt\\b/i, \"Alt\")\r\n        .replace(/\\bShift\\b/i, \"Shift\")\r\n        .replace(/\\b(Enter|Return)\\b/i, \"Enter\")\r\n        .replace(/\\bDel\\b/i, \"Delete\");\r\n    if (isDarwin) {\r\n        return shortcut\r\n            .replace(/\\bCtrlOrCmd\\b/i, \"Cmd\")\r\n            .replace(/\\bAlt\\b/i, \"Option\");\r\n    }\r\n    return shortcut.replace(/\\bCtrlOrCmd\\b/i, \"Ctrl\");\r\n};\r\nexport const viewportCoordsToSceneCoords = ({ clientX, clientY }, { zoom, offsetLeft, offsetTop, scrollX, scrollY, }) => {\r\n    const invScale = 1 / zoom.value;\r\n    const x = (clientX - zoom.translation.x - offsetLeft) * invScale - scrollX;\r\n    const y = (clientY - zoom.translation.y - offsetTop) * invScale - scrollY;\r\n    return { x, y };\r\n};\r\nexport const sceneCoordsToViewportCoords = ({ sceneX, sceneY }, { zoom, offsetLeft, offsetTop, scrollX, scrollY, }) => {\r\n    const x = (sceneX + scrollX + offsetLeft) * zoom.value + zoom.translation.x;\r\n    const y = (sceneY + scrollY + offsetTop) * zoom.value + zoom.translation.y;\r\n    return { x, y };\r\n};\r\nexport const getGlobalCSSVariable = (name) => getComputedStyle(document.documentElement).getPropertyValue(`--${name}`);\r\nconst RS_LTR_CHARS = \"A-Za-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02B8\\u0300-\\u0590\\u0800-\\u1FFF\" +\r\n    \"\\u2C00-\\uFB1C\\uFDFE-\\uFE6F\\uFEFD-\\uFFFF\";\r\nconst RS_RTL_CHARS = \"\\u0591-\\u07FF\\uFB1D-\\uFDFD\\uFE70-\\uFEFC\";\r\nconst RE_RTL_CHECK = new RegExp(`^[^${RS_LTR_CHARS}]*[${RS_RTL_CHARS}]`);\r\n/**\r\n * Checks whether first directional character is RTL. Meaning whether it starts\r\n *  with RTL characters, or indeterminate (numbers etc.) characters followed by\r\n *  RTL.\r\n * See https://github.com/excalidraw/excalidraw/pull/1722#discussion_r436340171\r\n */\r\nexport const isRTL = (text) => RE_RTL_CHECK.test(text);\r\nexport const tupleToCoors = (xyTuple) => {\r\n    const [x, y] = xyTuple;\r\n    return { x, y };\r\n};\r\n/** use as a rejectionHandler to mute filesystem Abort errors */\r\nexport const muteFSAbortError = (error) => {\r\n    if (error?.name === \"AbortError\") {\r\n        return;\r\n    }\r\n    throw error;\r\n};\r\nexport const findIndex = (array, cb, fromIndex = 0) => {\r\n    if (fromIndex < 0) {\r\n        fromIndex = array.length + fromIndex;\r\n    }\r\n    fromIndex = Math.min(array.length, Math.max(fromIndex, 0));\r\n    let index = fromIndex - 1;\r\n    while (++index < array.length) {\r\n        if (cb(array[index], index, array)) {\r\n            return index;\r\n        }\r\n    }\r\n    return -1;\r\n};\r\nexport const findLastIndex = (array, cb, fromIndex = array.length - 1) => {\r\n    if (fromIndex < 0) {\r\n        fromIndex = array.length + fromIndex;\r\n    }\r\n    fromIndex = Math.min(array.length - 1, Math.max(fromIndex, 0));\r\n    let index = fromIndex + 1;\r\n    while (--index > -1) {\r\n        if (cb(array[index], index, array)) {\r\n            return index;\r\n        }\r\n    }\r\n    return -1;\r\n};\r\nexport const isTransparent = (color) => {\r\n    const isRGBTransparent = color.length === 5 && color.substr(4, 1) === \"0\";\r\n    const isRRGGBBTransparent = color.length === 9 && color.substr(7, 2) === \"00\";\r\n    return (isRGBTransparent ||\r\n        isRRGGBBTransparent ||\r\n        color === colors.elementBackground[0]);\r\n};\r\nexport const resolvablePromise = () => {\r\n    let resolve;\r\n    let reject;\r\n    const promise = new Promise((_resolve, _reject) => {\r\n        resolve = _resolve;\r\n        reject = _reject;\r\n    });\r\n    promise.resolve = resolve;\r\n    promise.reject = reject;\r\n    return promise;\r\n};\r\n/**\r\n * @param func handler taking at most single parameter (event).\r\n */\r\nexport const withBatchedUpdates = (func) => ((event) => {\r\n    unstable_batchedUpdates(func, event);\r\n});\r\n//https://stackoverflow.com/a/9462382/8418\r\nexport const nFormatter = (num, digits) => {\r\n    const si = [\r\n        { value: 1, symbol: \"b\" },\r\n        { value: 1e3, symbol: \"k\" },\r\n        { value: 1e6, symbol: \"M\" },\r\n        { value: 1e9, symbol: \"G\" },\r\n    ];\r\n    const rx = /\\.0+$|(\\.[0-9]*[1-9])0+$/;\r\n    let index;\r\n    for (index = si.length - 1; index > 0; index--) {\r\n        if (num >= si[index].value) {\r\n            break;\r\n        }\r\n    }\r\n    return ((num / si[index].value).toFixed(digits).replace(rx, \"$1\") + si[index].symbol);\r\n};\r\nexport const getVersion = () => {\r\n    return (document.querySelector('meta[name=\"version\"]')?.content ||\r\n        DEFAULT_VERSION);\r\n};\r\n// Adapted from https://github.com/Modernizr/Modernizr/blob/master/feature-detects/emoji.js\r\nexport const supportsEmoji = () => {\r\n    const canvas = document.createElement(\"canvas\");\r\n    const ctx = canvas.getContext(\"2d\");\r\n    if (!ctx) {\r\n        return false;\r\n    }\r\n    const offset = 12;\r\n    ctx.fillStyle = \"#f00\";\r\n    ctx.textBaseline = \"top\";\r\n    ctx.font = \"32px Arial\";\r\n    // Modernizr used , but it is sort of supported on Windows 7.\r\n    // Luckily  isn't supported.\r\n    ctx.fillText(\"\", 0, 0);\r\n    return ctx.getImageData(offset, offset, 1, 1).data[0] !== 0;\r\n};\r\nexport const getNearestScrollableContainer = (element) => {\r\n    let parent = element.parentElement;\r\n    while (parent) {\r\n        if (parent === document.body) {\r\n            return document;\r\n        }\r\n        const { overflowY } = window.getComputedStyle(parent);\r\n        const hasScrollableContent = parent.scrollHeight > parent.clientHeight;\r\n        if (hasScrollableContent &&\r\n            (overflowY === \"auto\" || overflowY === \"scroll\")) {\r\n            return parent;\r\n        }\r\n        parent = parent.parentElement;\r\n    }\r\n    return document;\r\n};\r\nexport const focusNearestParent = (element) => {\r\n    let parent = element.parentElement;\r\n    while (parent) {\r\n        if (parent.tabIndex > -1) {\r\n            parent.focus();\r\n            return;\r\n        }\r\n        parent = parent.parentElement;\r\n    }\r\n};\r\nexport const preventUnload = (event) => {\r\n    event.preventDefault();\r\n    // NOTE: modern browsers no longer allow showing a custom message here\r\n    event.returnValue = \"\";\r\n};\r\n","import oc from \"open-color\";\r\nimport { DEFAULT_FONT_FAMILY, DEFAULT_FONT_SIZE, DEFAULT_TEXT_ALIGN, EXPORT_SCALES, THEME, } from \"./constants\";\r\nimport { t } from \"./i18n\";\r\nimport { getDateTime } from \"./utils\";\r\nconst defaultExportScale = EXPORT_SCALES.includes(devicePixelRatio)\r\n    ? devicePixelRatio\r\n    : 1;\r\nexport const getDefaultAppState = () => {\r\n    return {\r\n        theme: THEME.LIGHT,\r\n        collaborators: new Map(),\r\n        currentChartType: \"bar\",\r\n        currentItemBackgroundColor: \"transparent\",\r\n        currentItemEndArrowhead: \"arrow\",\r\n        currentItemFillStyle: \"hachure\",\r\n        currentItemFontFamily: DEFAULT_FONT_FAMILY,\r\n        currentItemFontSize: DEFAULT_FONT_SIZE,\r\n        currentItemLinearStrokeSharpness: \"round\",\r\n        currentItemOpacity: 100,\r\n        currentItemRoughness: 1,\r\n        currentItemStartArrowhead: null,\r\n        currentItemStrokeColor: oc.black,\r\n        currentItemStrokeSharpness: \"sharp\",\r\n        currentItemStrokeStyle: \"solid\",\r\n        currentItemStrokeWidth: 1,\r\n        currentItemTextAlign: DEFAULT_TEXT_ALIGN,\r\n        cursorButton: \"up\",\r\n        draggingElement: null,\r\n        editingElement: null,\r\n        editingGroupId: null,\r\n        editingLinearElement: null,\r\n        elementLocked: false,\r\n        elementType: \"selection\",\r\n        errorMessage: null,\r\n        exportBackground: true,\r\n        exportScale: defaultExportScale,\r\n        exportEmbedScene: false,\r\n        exportWithDarkMode: false,\r\n        fileHandle: null,\r\n        gridSize: null,\r\n        isBindingEnabled: true,\r\n        isLibraryOpen: false,\r\n        isLoading: false,\r\n        isResizing: false,\r\n        isRotating: false,\r\n        lastPointerDownWith: \"mouse\",\r\n        multiElement: null,\r\n        name: `${t(\"labels.untitled\")}-${getDateTime()}`,\r\n        openMenu: null,\r\n        openPopup: null,\r\n        pasteDialog: { shown: false, data: null },\r\n        previousSelectedElementIds: {},\r\n        resizingElement: null,\r\n        scrolledOutside: false,\r\n        scrollX: 0,\r\n        scrollY: 0,\r\n        selectedElementIds: {},\r\n        selectedGroupIds: {},\r\n        selectionElement: null,\r\n        shouldCacheIgnoreZoom: false,\r\n        showHelpDialog: false,\r\n        showStats: false,\r\n        startBoundElement: null,\r\n        suggestedBindings: [],\r\n        toastMessage: null,\r\n        viewBackgroundColor: oc.white,\r\n        zenModeEnabled: false,\r\n        zoom: { value: 1, translation: { x: 0, y: 0 } },\r\n        viewModeEnabled: false,\r\n        pendingImageElement: null,\r\n    };\r\n};\r\n/**\r\n * Config containing all AppState keys. Used to determine whether given state\r\n *  prop should be stripped when exporting to given storage type.\r\n */\r\nconst APP_STATE_STORAGE_CONF = ((config) => config)({\r\n    theme: { browser: true, export: false, server: false },\r\n    collaborators: { browser: false, export: false, server: false },\r\n    currentChartType: { browser: true, export: false, server: false },\r\n    currentItemBackgroundColor: { browser: true, export: false, server: false },\r\n    currentItemEndArrowhead: { browser: true, export: false, server: false },\r\n    currentItemFillStyle: { browser: true, export: false, server: false },\r\n    currentItemFontFamily: { browser: true, export: false, server: false },\r\n    currentItemFontSize: { browser: true, export: false, server: false },\r\n    currentItemLinearStrokeSharpness: {\r\n        browser: true,\r\n        export: false,\r\n        server: false,\r\n    },\r\n    currentItemOpacity: { browser: true, export: false, server: false },\r\n    currentItemRoughness: { browser: true, export: false, server: false },\r\n    currentItemStartArrowhead: { browser: true, export: false, server: false },\r\n    currentItemStrokeColor: { browser: true, export: false, server: false },\r\n    currentItemStrokeSharpness: { browser: true, export: false, server: false },\r\n    currentItemStrokeStyle: { browser: true, export: false, server: false },\r\n    currentItemStrokeWidth: { browser: true, export: false, server: false },\r\n    currentItemTextAlign: { browser: true, export: false, server: false },\r\n    cursorButton: { browser: true, export: false, server: false },\r\n    draggingElement: { browser: false, export: false, server: false },\r\n    editingElement: { browser: false, export: false, server: false },\r\n    editingGroupId: { browser: true, export: false, server: false },\r\n    editingLinearElement: { browser: false, export: false, server: false },\r\n    elementLocked: { browser: true, export: false, server: false },\r\n    elementType: { browser: true, export: false, server: false },\r\n    errorMessage: { browser: false, export: false, server: false },\r\n    exportBackground: { browser: true, export: false, server: false },\r\n    exportEmbedScene: { browser: true, export: false, server: false },\r\n    exportScale: { browser: true, export: false, server: false },\r\n    exportWithDarkMode: { browser: true, export: false, server: false },\r\n    fileHandle: { browser: false, export: false, server: false },\r\n    gridSize: { browser: true, export: true, server: true },\r\n    height: { browser: false, export: false, server: false },\r\n    isBindingEnabled: { browser: false, export: false, server: false },\r\n    isLibraryOpen: { browser: false, export: false, server: false },\r\n    isLoading: { browser: false, export: false, server: false },\r\n    isResizing: { browser: false, export: false, server: false },\r\n    isRotating: { browser: false, export: false, server: false },\r\n    lastPointerDownWith: { browser: true, export: false, server: false },\r\n    multiElement: { browser: false, export: false, server: false },\r\n    name: { browser: true, export: false, server: false },\r\n    offsetLeft: { browser: false, export: false, server: false },\r\n    offsetTop: { browser: false, export: false, server: false },\r\n    openMenu: { browser: true, export: false, server: false },\r\n    openPopup: { browser: false, export: false, server: false },\r\n    pasteDialog: { browser: false, export: false, server: false },\r\n    previousSelectedElementIds: { browser: true, export: false, server: false },\r\n    resizingElement: { browser: false, export: false, server: false },\r\n    scrolledOutside: { browser: true, export: false, server: false },\r\n    scrollX: { browser: true, export: false, server: false },\r\n    scrollY: { browser: true, export: false, server: false },\r\n    selectedElementIds: { browser: true, export: false, server: false },\r\n    selectedGroupIds: { browser: true, export: false, server: false },\r\n    selectionElement: { browser: false, export: false, server: false },\r\n    shouldCacheIgnoreZoom: { browser: true, export: false, server: false },\r\n    showHelpDialog: { browser: false, export: false, server: false },\r\n    showStats: { browser: true, export: false, server: false },\r\n    startBoundElement: { browser: false, export: false, server: false },\r\n    suggestedBindings: { browser: false, export: false, server: false },\r\n    toastMessage: { browser: false, export: false, server: false },\r\n    viewBackgroundColor: { browser: true, export: true, server: true },\r\n    width: { browser: false, export: false, server: false },\r\n    zenModeEnabled: { browser: true, export: false, server: false },\r\n    zoom: { browser: true, export: false, server: false },\r\n    viewModeEnabled: { browser: false, export: false, server: false },\r\n    pendingImageElement: { browser: false, export: false, server: false },\r\n});\r\nconst _clearAppStateForStorage = (appState, exportType) => {\r\n    const stateForExport = {};\r\n    for (const key of Object.keys(appState)) {\r\n        const propConfig = APP_STATE_STORAGE_CONF[key];\r\n        if (propConfig?.[exportType]) {\r\n            const nextValue = appState[key];\r\n            // https://github.com/microsoft/TypeScript/issues/31445\r\n            stateForExport[key] = nextValue;\r\n        }\r\n    }\r\n    return stateForExport;\r\n};\r\nexport const clearAppStateForLocalStorage = (appState) => {\r\n    return _clearAppStateForStorage(appState, \"browser\");\r\n};\r\nexport const cleanAppStateForExport = (appState) => {\r\n    return _clearAppStateForStorage(appState, \"export\");\r\n};\r\nexport const clearAppStateForDatabase = (appState) => {\r\n    return _clearAppStateForStorage(appState, \"server\");\r\n};\r\n","import { useCallback, useState } from \"react\";\r\nexport const useCallbackRefState = () => {\r\n    const [refValue, setRefValue] = useState(null);\r\n    const refCallback = useCallback((value) => setRefValue(value), []);\r\n    return [refValue, refCallback];\r\n};\r\n","export const isGenericElement = (element) => {\r\n    return (element != null &&\r\n        (element.type === \"selection\" ||\r\n            element.type === \"rectangle\" ||\r\n            element.type === \"diamond\" ||\r\n            element.type === \"ellipse\"));\r\n};\r\nexport const isInitializedImageElement = (element) => {\r\n    return !!element && element.type === \"image\" && !!element.fileId;\r\n};\r\nexport const isImageElement = (element) => {\r\n    return !!element && element.type === \"image\";\r\n};\r\nexport const isTextElement = (element) => {\r\n    return element != null && element.type === \"text\";\r\n};\r\nexport const isFreeDrawElement = (element) => {\r\n    return element != null && isFreeDrawElementType(element.type);\r\n};\r\nexport const isFreeDrawElementType = (elementType) => {\r\n    return elementType === \"freedraw\";\r\n};\r\nexport const isLinearElement = (element) => {\r\n    return element != null && isLinearElementType(element.type);\r\n};\r\nexport const isLinearElementType = (elementType) => {\r\n    return (elementType === \"arrow\" || elementType === \"line\" // || elementType === \"freedraw\"\r\n    );\r\n};\r\nexport const isBindingElement = (element) => {\r\n    return element != null && isBindingElementType(element.type);\r\n};\r\nexport const isBindingElementType = (elementType) => {\r\n    return elementType === \"arrow\";\r\n};\r\nexport const isBindableElement = (element) => {\r\n    return (element != null &&\r\n        (element.type === \"rectangle\" ||\r\n            element.type === \"diamond\" ||\r\n            element.type === \"ellipse\" ||\r\n            element.type === \"text\"));\r\n};\r\nexport const isExcalidrawElement = (element) => {\r\n    return (element?.type === \"text\" ||\r\n        element?.type === \"diamond\" ||\r\n        element?.type === \"rectangle\" ||\r\n        element?.type === \"ellipse\" ||\r\n        element?.type === \"arrow\" ||\r\n        element?.type === \"freedraw\" ||\r\n        element?.type === \"line\");\r\n};\r\n","import { LINE_CONFIRM_THRESHOLD } from \"./constants\";\r\nexport const rotate = (x1, y1, x2, y2, angle) => \r\n// =()cos()sin+\r\n// =()sin+()cos+.\r\n// https://math.stackexchange.com/questions/2204520/how-do-i-rotate-a-line-segment-in-a-specific-point-on-the-line\r\n[\r\n    (x1 - x2) * Math.cos(angle) - (y1 - y2) * Math.sin(angle) + x2,\r\n    (x1 - x2) * Math.sin(angle) + (y1 - y2) * Math.cos(angle) + y2,\r\n];\r\nexport const rotatePoint = (point, center, angle) => rotate(point[0], point[1], center[0], center[1], angle);\r\nexport const adjustXYWithRotation = (sides, x, y, angle, deltaX1, deltaY1, deltaX2, deltaY2) => {\r\n    const cos = Math.cos(angle);\r\n    const sin = Math.sin(angle);\r\n    if (sides.e && sides.w) {\r\n        x += deltaX1 + deltaX2;\r\n    }\r\n    else if (sides.e) {\r\n        x += deltaX1 * (1 + cos);\r\n        y += deltaX1 * sin;\r\n        x += deltaX2 * (1 - cos);\r\n        y += deltaX2 * -sin;\r\n    }\r\n    else if (sides.w) {\r\n        x += deltaX1 * (1 - cos);\r\n        y += deltaX1 * -sin;\r\n        x += deltaX2 * (1 + cos);\r\n        y += deltaX2 * sin;\r\n    }\r\n    if (sides.n && sides.s) {\r\n        y += deltaY1 + deltaY2;\r\n    }\r\n    else if (sides.n) {\r\n        x += deltaY1 * sin;\r\n        y += deltaY1 * (1 - cos);\r\n        x += deltaY2 * -sin;\r\n        y += deltaY2 * (1 + cos);\r\n    }\r\n    else if (sides.s) {\r\n        x += deltaY1 * -sin;\r\n        y += deltaY1 * (1 + cos);\r\n        x += deltaY2 * sin;\r\n        y += deltaY2 * (1 - cos);\r\n    }\r\n    return [x, y];\r\n};\r\nexport const getPointOnAPath = (point, path) => {\r\n    const [px, py] = point;\r\n    const [start, ...other] = path;\r\n    let [lastX, lastY] = start;\r\n    let kLine = 0;\r\n    let idx = 0;\r\n    // if any item in the array is true, it means that a point is\r\n    // on some segment of a line based path\r\n    const retVal = other.some(([x2, y2], i) => {\r\n        // we always take a line when dealing with line segments\r\n        const x1 = lastX;\r\n        const y1 = lastY;\r\n        lastX = x2;\r\n        lastY = y2;\r\n        // if a point is not within the domain of the line segment\r\n        // it is not on the line segment\r\n        if (px < x1 || px > x2) {\r\n            return false;\r\n        }\r\n        // check if all points lie on the same line\r\n        // y1 = kx1 + b, y2 = kx2 + b\r\n        // y2 - y1 = k(x2 - x2) -> k = (y2 - y1) / (x2 - x1)\r\n        // coefficient for the line (p0, p1)\r\n        const kL = (y2 - y1) / (x2 - x1);\r\n        // coefficient for the line segment (p0, point)\r\n        const kP1 = (py - y1) / (px - x1);\r\n        // coefficient for the line segment (point, p1)\r\n        const kP2 = (py - y2) / (px - x2);\r\n        // because we are basing both lines from the same starting point\r\n        // the only option for collinearity is having same coefficients\r\n        // using it for floating point comparisons\r\n        const epsilon = 0.3;\r\n        // if coefficient is more than an arbitrary epsilon,\r\n        // these lines are nor collinear\r\n        if (Math.abs(kP1 - kL) > epsilon && Math.abs(kP2 - kL) > epsilon) {\r\n            return false;\r\n        }\r\n        // store the coefficient because we are goint to need it\r\n        kLine = kL;\r\n        idx = i;\r\n        return true;\r\n    });\r\n    // Return a coordinate that is always on the line segment\r\n    if (retVal === true) {\r\n        return { x: point[0], y: kLine * point[0], segment: idx };\r\n    }\r\n    return null;\r\n};\r\nexport const distance2d = (x1, y1, x2, y2) => {\r\n    const xd = x2 - x1;\r\n    const yd = y2 - y1;\r\n    return Math.hypot(xd, yd);\r\n};\r\nexport const centerPoint = (a, b) => {\r\n    return [(a[0] + b[0]) / 2, (a[1] + b[1]) / 2];\r\n};\r\n// Checks if the first and last point are close enough\r\n// to be considered a loop\r\nexport const isPathALoop = (points, \r\n/** supply if you want the loop detection to account for current zoom */\r\nzoomValue = 1) => {\r\n    if (points.length >= 3) {\r\n        const [first, last] = [points[0], points[points.length - 1]];\r\n        const distance = distance2d(first[0], first[1], last[0], last[1]);\r\n        // Adjusting LINE_CONFIRM_THRESHOLD to current zoom so that when zoomed in\r\n        // really close we make the threshold smaller, and vice versa.\r\n        return distance <= LINE_CONFIRM_THRESHOLD / zoomValue;\r\n    }\r\n    return false;\r\n};\r\n// Draw a line from the point to the right till infiinty\r\n// Check how many lines of the polygon does this infinite line intersects with\r\n// If the number of intersections is odd, point is in the polygon\r\nexport const isPointInPolygon = (points, x, y) => {\r\n    const vertices = points.length;\r\n    // There must be at least 3 vertices in polygon\r\n    if (vertices < 3) {\r\n        return false;\r\n    }\r\n    const extreme = [Number.MAX_SAFE_INTEGER, y];\r\n    const p = [x, y];\r\n    let count = 0;\r\n    for (let i = 0; i < vertices; i++) {\r\n        const current = points[i];\r\n        const next = points[(i + 1) % vertices];\r\n        if (doSegmentsIntersect(current, next, p, extreme)) {\r\n            if (orderedColinearOrientation(current, p, next) === 0) {\r\n                return isPointWithinBounds(current, p, next);\r\n            }\r\n            count++;\r\n        }\r\n    }\r\n    // true if count is off\r\n    return count % 2 === 1;\r\n};\r\n// Returns whether `q` lies inside the segment/rectangle defined by `p` and `r`.\r\n// This is an approximation to \"does `q` lie on a segment `pr`\" check.\r\nconst isPointWithinBounds = (p, q, r) => {\r\n    return (q[0] <= Math.max(p[0], r[0]) &&\r\n        q[0] >= Math.min(p[0], r[0]) &&\r\n        q[1] <= Math.max(p[1], r[1]) &&\r\n        q[1] >= Math.min(p[1], r[1]));\r\n};\r\n// For the ordered points p, q, r, return\r\n// 0 if p, q, r are colinear\r\n// 1 if Clockwise\r\n// 2 if counterclickwise\r\nconst orderedColinearOrientation = (p, q, r) => {\r\n    const val = (q[1] - p[1]) * (r[0] - q[0]) - (q[0] - p[0]) * (r[1] - q[1]);\r\n    if (val === 0) {\r\n        return 0;\r\n    }\r\n    return val > 0 ? 1 : 2;\r\n};\r\n// Check is p1q1 intersects with p2q2\r\nconst doSegmentsIntersect = (p1, q1, p2, q2) => {\r\n    const o1 = orderedColinearOrientation(p1, q1, p2);\r\n    const o2 = orderedColinearOrientation(p1, q1, q2);\r\n    const o3 = orderedColinearOrientation(p2, q2, p1);\r\n    const o4 = orderedColinearOrientation(p2, q2, q1);\r\n    if (o1 !== o2 && o3 !== o4) {\r\n        return true;\r\n    }\r\n    // p1, q1 and p2 are colinear and p2 lies on segment p1q1\r\n    if (o1 === 0 && isPointWithinBounds(p1, p2, q1)) {\r\n        return true;\r\n    }\r\n    // p1, q1 and p2 are colinear and q2 lies on segment p1q1\r\n    if (o2 === 0 && isPointWithinBounds(p1, q2, q1)) {\r\n        return true;\r\n    }\r\n    // p2, q2 and p1 are colinear and p1 lies on segment p2q2\r\n    if (o3 === 0 && isPointWithinBounds(p2, p1, q2)) {\r\n        return true;\r\n    }\r\n    // p2, q2 and q1 are colinear and q1 lies on segment p2q2\r\n    if (o4 === 0 && isPointWithinBounds(p2, q1, q2)) {\r\n        return true;\r\n    }\r\n    return false;\r\n};\r\n// TODO: Rounding this point causes some shake when free drawing\r\nexport const getGridPoint = (x, y, gridSize) => {\r\n    if (gridSize) {\r\n        return [\r\n            Math.round(x / gridSize) * gridSize,\r\n            Math.round(y / gridSize) * gridSize,\r\n        ];\r\n    }\r\n    return [x, y];\r\n};\r\n","export const getSizeFromPoints = (points) => {\r\n    const xs = points.map((point) => point[0]);\r\n    const ys = points.map((point) => point[1]);\r\n    return {\r\n        width: Math.max(...xs) - Math.min(...xs),\r\n        height: Math.max(...ys) - Math.min(...ys),\r\n    };\r\n};\r\nexport const rescalePoints = (dimension, nextDimensionSize, prevPoints) => {\r\n    const prevDimValues = prevPoints.map((point) => point[dimension]);\r\n    const prevMaxDimension = Math.max(...prevDimValues);\r\n    const prevMinDimension = Math.min(...prevDimValues);\r\n    const prevDimensionSize = prevMaxDimension - prevMinDimension;\r\n    const dimensionScaleFactor = prevDimensionSize === 0 ? 1 : nextDimensionSize / prevDimensionSize;\r\n    let nextMinDimension = Infinity;\r\n    const scaledPoints = prevPoints.map((prevPoint) => prevPoint.map((value, currentDimension) => {\r\n        if (currentDimension !== dimension) {\r\n            return value;\r\n        }\r\n        const scaledValue = value * dimensionScaleFactor;\r\n        nextMinDimension = Math.min(scaledValue, nextMinDimension);\r\n        return scaledValue;\r\n    }));\r\n    if (scaledPoints.length === 2) {\r\n        // we don't tranlate two-point lines\r\n        return scaledPoints;\r\n    }\r\n    const translation = prevMinDimension - nextMinDimension;\r\n    const nextPoints = scaledPoints.map((scaledPoint) => scaledPoint.map((value, currentDimension) => {\r\n        return currentDimension === dimension ? value + translation : value;\r\n    }));\r\n    return nextPoints;\r\n};\r\n","import { distance2d, rotate } from \"../math\";\r\nimport rough from \"roughjs/bin/rough\";\r\nimport { getShapeForElement, generateRoughOptions, } from \"../renderer/renderElement\";\r\nimport { isFreeDrawElement, isLinearElement } from \"./typeChecks\";\r\nimport { rescalePoints } from \"../points\";\r\n// If the element is created from right to left, the width is going to be negative\r\n// This set of functions retrieves the absolute position of the 4 points.\r\nexport const getElementAbsoluteCoords = (element) => {\r\n    if (isFreeDrawElement(element)) {\r\n        return getFreeDrawElementAbsoluteCoords(element);\r\n    }\r\n    else if (isLinearElement(element)) {\r\n        return getLinearElementAbsoluteCoords(element);\r\n    }\r\n    return [\r\n        element.x,\r\n        element.y,\r\n        element.x + element.width,\r\n        element.y + element.height,\r\n    ];\r\n};\r\nexport const pointRelativeTo = (element, absoluteCoords) => {\r\n    return [absoluteCoords[0] - element.x, absoluteCoords[1] - element.y];\r\n};\r\nexport const getDiamondPoints = (element) => {\r\n    // Here we add +1 to avoid these numbers to be 0\r\n    // otherwise rough.js will throw an error complaining about it\r\n    const topX = Math.floor(element.width / 2) + 1;\r\n    const topY = 0;\r\n    const rightX = element.width;\r\n    const rightY = Math.floor(element.height / 2) + 1;\r\n    const bottomX = topX;\r\n    const bottomY = element.height;\r\n    const leftX = 0;\r\n    const leftY = rightY;\r\n    return [topX, topY, rightX, rightY, bottomX, bottomY, leftX, leftY];\r\n};\r\nexport const getCurvePathOps = (shape) => {\r\n    for (const set of shape.sets) {\r\n        if (set.type === \"path\") {\r\n            return set.ops;\r\n        }\r\n    }\r\n    return shape.sets[0].ops;\r\n};\r\nconst getMinMaxXYFromCurvePathOps = (ops, transformXY) => {\r\n    let currentP = [0, 0];\r\n    const { minX, minY, maxX, maxY } = ops.reduce((limits, { op, data }) => {\r\n        // There are only four operation types:\r\n        // move, bcurveTo, lineTo, and curveTo\r\n        if (op === \"move\") {\r\n            // change starting point\r\n            currentP = data;\r\n            // move operation does not draw anything; so, it always\r\n            // returns false\r\n        }\r\n        else if (op === \"bcurveTo\") {\r\n            // create points from bezier curve\r\n            // bezier curve stores data as a flattened array of three positions\r\n            // [x1, y1, x2, y2, x3, y3]\r\n            const p1 = [data[0], data[1]];\r\n            const p2 = [data[2], data[3]];\r\n            const p3 = [data[4], data[5]];\r\n            const p0 = currentP;\r\n            currentP = p3;\r\n            const equation = (t, idx) => Math.pow(1 - t, 3) * p3[idx] +\r\n                3 * t * Math.pow(1 - t, 2) * p2[idx] +\r\n                3 * Math.pow(t, 2) * (1 - t) * p1[idx] +\r\n                p0[idx] * Math.pow(t, 3);\r\n            let t = 0;\r\n            while (t <= 1.0) {\r\n                let x = equation(t, 0);\r\n                let y = equation(t, 1);\r\n                if (transformXY) {\r\n                    [x, y] = transformXY(x, y);\r\n                }\r\n                limits.minY = Math.min(limits.minY, y);\r\n                limits.minX = Math.min(limits.minX, x);\r\n                limits.maxX = Math.max(limits.maxX, x);\r\n                limits.maxY = Math.max(limits.maxY, y);\r\n                t += 0.1;\r\n            }\r\n        }\r\n        else if (op === \"lineTo\") {\r\n            // TODO: Implement this\r\n        }\r\n        else if (op === \"qcurveTo\") {\r\n            // TODO: Implement this\r\n        }\r\n        return limits;\r\n    }, { minX: Infinity, minY: Infinity, maxX: -Infinity, maxY: -Infinity });\r\n    return [minX, minY, maxX, maxY];\r\n};\r\nconst getBoundsFromPoints = (points) => {\r\n    let minX = Infinity;\r\n    let minY = Infinity;\r\n    let maxX = -Infinity;\r\n    let maxY = -Infinity;\r\n    for (const [x, y] of points) {\r\n        minX = Math.min(minX, x);\r\n        minY = Math.min(minY, y);\r\n        maxX = Math.max(maxX, x);\r\n        maxY = Math.max(maxY, y);\r\n    }\r\n    return [minX, minY, maxX, maxY];\r\n};\r\nconst getFreeDrawElementAbsoluteCoords = (element) => {\r\n    const [minX, minY, maxX, maxY] = getBoundsFromPoints(element.points);\r\n    return [\r\n        minX + element.x,\r\n        minY + element.y,\r\n        maxX + element.x,\r\n        maxY + element.y,\r\n    ];\r\n};\r\nconst getLinearElementAbsoluteCoords = (element) => {\r\n    let coords;\r\n    if (element.points.length < 2 || !getShapeForElement(element)) {\r\n        // XXX this is just a poor estimate and not very useful\r\n        const { minX, minY, maxX, maxY } = element.points.reduce((limits, [x, y]) => {\r\n            limits.minY = Math.min(limits.minY, y);\r\n            limits.minX = Math.min(limits.minX, x);\r\n            limits.maxX = Math.max(limits.maxX, x);\r\n            limits.maxY = Math.max(limits.maxY, y);\r\n            return limits;\r\n        }, { minX: Infinity, minY: Infinity, maxX: -Infinity, maxY: -Infinity });\r\n        coords = [\r\n            minX + element.x,\r\n            minY + element.y,\r\n            maxX + element.x,\r\n            maxY + element.y,\r\n        ];\r\n    }\r\n    else {\r\n        const shape = getShapeForElement(element);\r\n        // first element is always the curve\r\n        const ops = getCurvePathOps(shape[0]);\r\n        const [minX, minY, maxX, maxY] = getMinMaxXYFromCurvePathOps(ops);\r\n        coords = [\r\n            minX + element.x,\r\n            minY + element.y,\r\n            maxX + element.x,\r\n            maxY + element.y,\r\n        ];\r\n    }\r\n    return coords;\r\n};\r\nexport const getArrowheadPoints = (element, shape, position, arrowhead) => {\r\n    const ops = getCurvePathOps(shape[0]);\r\n    if (ops.length < 1) {\r\n        return null;\r\n    }\r\n    // The index of the bCurve operation to examine.\r\n    const index = position === \"start\" ? 1 : ops.length - 1;\r\n    const data = ops[index].data;\r\n    const p3 = [data[4], data[5]];\r\n    const p2 = [data[2], data[3]];\r\n    const p1 = [data[0], data[1]];\r\n    // We need to find p0 of the bezier curve.\r\n    // It is typically the last point of the previous\r\n    // curve; it can also be the position of moveTo operation.\r\n    const prevOp = ops[index - 1];\r\n    let p0 = [0, 0];\r\n    if (prevOp.op === \"move\") {\r\n        p0 = prevOp.data;\r\n    }\r\n    else if (prevOp.op === \"bcurveTo\") {\r\n        p0 = [prevOp.data[4], prevOp.data[5]];\r\n    }\r\n    // B(t) = p0 * (1-t)^3 + 3p1 * t * (1-t)^2 + 3p2 * t^2 * (1-t) + p3 * t^3\r\n    const equation = (t, idx) => Math.pow(1 - t, 3) * p3[idx] +\r\n        3 * t * Math.pow(1 - t, 2) * p2[idx] +\r\n        3 * Math.pow(t, 2) * (1 - t) * p1[idx] +\r\n        p0[idx] * Math.pow(t, 3);\r\n    // Ee know the last point of the arrow (or the first, if start arrowhead).\r\n    const [x2, y2] = position === \"start\" ? p0 : p3;\r\n    // By using cubic bezier equation (B(t)) and the given parameters,\r\n    // we calculate a point that is closer to the last point.\r\n    // The value 0.3 is chosen arbitrarily and it works best for all\r\n    // the tested cases.\r\n    const [x1, y1] = [equation(0.3, 0), equation(0.3, 1)];\r\n    // Find the normalized direction vector based on the\r\n    // previously calculated points.\r\n    const distance = Math.hypot(x2 - x1, y2 - y1);\r\n    const nx = (x2 - x1) / distance;\r\n    const ny = (y2 - y1) / distance;\r\n    const size = {\r\n        arrow: 30,\r\n        bar: 15,\r\n        dot: 15,\r\n        triangle: 15,\r\n    }[arrowhead]; // pixels (will differ for each arrowhead)\r\n    let length = 0;\r\n    if (arrowhead === \"arrow\") {\r\n        // Length for -> arrows is based on the length of the last section\r\n        const [cx, cy] = element.points[element.points.length - 1];\r\n        const [px, py] = element.points.length > 1\r\n            ? element.points[element.points.length - 2]\r\n            : [0, 0];\r\n        length = Math.hypot(cx - px, cy - py);\r\n    }\r\n    else {\r\n        // Length for other arrowhead types is based on the total length of the line\r\n        for (let i = 0; i < element.points.length; i++) {\r\n            const [px, py] = element.points[i - 1] || [0, 0];\r\n            const [cx, cy] = element.points[i];\r\n            length += Math.hypot(cx - px, cy - py);\r\n        }\r\n    }\r\n    // Scale down the arrowhead until we hit a certain size so that it doesn't look weird.\r\n    // This value is selected by minimizing a minimum size with the last segment of the arrowhead\r\n    const minSize = Math.min(size, length / 2);\r\n    const xs = x2 - nx * minSize;\r\n    const ys = y2 - ny * minSize;\r\n    if (arrowhead === \"dot\") {\r\n        const r = Math.hypot(ys - y2, xs - x2) + element.strokeWidth;\r\n        return [x2, y2, r];\r\n    }\r\n    const angle = {\r\n        arrow: 20,\r\n        bar: 90,\r\n        triangle: 25,\r\n    }[arrowhead]; // degrees\r\n    // Return points\r\n    const [x3, y3] = rotate(xs, ys, x2, y2, (-angle * Math.PI) / 180);\r\n    const [x4, y4] = rotate(xs, ys, x2, y2, (angle * Math.PI) / 180);\r\n    return [x2, y2, x3, y3, x4, y4];\r\n};\r\nconst getLinearElementRotatedBounds = (element, cx, cy) => {\r\n    if (element.points.length < 2 || !getShapeForElement(element)) {\r\n        // XXX this is just a poor estimate and not very useful\r\n        const { minX, minY, maxX, maxY } = element.points.reduce((limits, [x, y]) => {\r\n            [x, y] = rotate(element.x + x, element.y + y, cx, cy, element.angle);\r\n            limits.minY = Math.min(limits.minY, y);\r\n            limits.minX = Math.min(limits.minX, x);\r\n            limits.maxX = Math.max(limits.maxX, x);\r\n            limits.maxY = Math.max(limits.maxY, y);\r\n            return limits;\r\n        }, { minX: Infinity, minY: Infinity, maxX: -Infinity, maxY: -Infinity });\r\n        return [minX, minY, maxX, maxY];\r\n    }\r\n    const shape = getShapeForElement(element);\r\n    // first element is always the curve\r\n    const ops = getCurvePathOps(shape[0]);\r\n    const transformXY = (x, y) => rotate(element.x + x, element.y + y, cx, cy, element.angle);\r\n    return getMinMaxXYFromCurvePathOps(ops, transformXY);\r\n};\r\n// We could cache this stuff\r\nexport const getElementBounds = (element) => {\r\n    let bounds;\r\n    const [x1, y1, x2, y2] = getElementAbsoluteCoords(element);\r\n    const cx = (x1 + x2) / 2;\r\n    const cy = (y1 + y2) / 2;\r\n    if (isFreeDrawElement(element)) {\r\n        const [minX, minY, maxX, maxY] = getBoundsFromPoints(element.points.map(([x, y]) => rotate(x, y, cx - element.x, cy - element.y, element.angle)));\r\n        return [\r\n            minX + element.x,\r\n            minY + element.y,\r\n            maxX + element.x,\r\n            maxY + element.y,\r\n        ];\r\n    }\r\n    else if (isLinearElement(element)) {\r\n        bounds = getLinearElementRotatedBounds(element, cx, cy);\r\n    }\r\n    else if (element.type === \"diamond\") {\r\n        const [x11, y11] = rotate(cx, y1, cx, cy, element.angle);\r\n        const [x12, y12] = rotate(cx, y2, cx, cy, element.angle);\r\n        const [x22, y22] = rotate(x1, cy, cx, cy, element.angle);\r\n        const [x21, y21] = rotate(x2, cy, cx, cy, element.angle);\r\n        const minX = Math.min(x11, x12, x22, x21);\r\n        const minY = Math.min(y11, y12, y22, y21);\r\n        const maxX = Math.max(x11, x12, x22, x21);\r\n        const maxY = Math.max(y11, y12, y22, y21);\r\n        bounds = [minX, minY, maxX, maxY];\r\n    }\r\n    else if (element.type === \"ellipse\") {\r\n        const w = (x2 - x1) / 2;\r\n        const h = (y2 - y1) / 2;\r\n        const cos = Math.cos(element.angle);\r\n        const sin = Math.sin(element.angle);\r\n        const ww = Math.hypot(w * cos, h * sin);\r\n        const hh = Math.hypot(h * cos, w * sin);\r\n        bounds = [cx - ww, cy - hh, cx + ww, cy + hh];\r\n    }\r\n    else {\r\n        const [x11, y11] = rotate(x1, y1, cx, cy, element.angle);\r\n        const [x12, y12] = rotate(x1, y2, cx, cy, element.angle);\r\n        const [x22, y22] = rotate(x2, y2, cx, cy, element.angle);\r\n        const [x21, y21] = rotate(x2, y1, cx, cy, element.angle);\r\n        const minX = Math.min(x11, x12, x22, x21);\r\n        const minY = Math.min(y11, y12, y22, y21);\r\n        const maxX = Math.max(x11, x12, x22, x21);\r\n        const maxY = Math.max(y11, y12, y22, y21);\r\n        bounds = [minX, minY, maxX, maxY];\r\n    }\r\n    return bounds;\r\n};\r\nexport const getCommonBounds = (elements) => {\r\n    if (!elements.length) {\r\n        return [0, 0, 0, 0];\r\n    }\r\n    let minX = Infinity;\r\n    let maxX = -Infinity;\r\n    let minY = Infinity;\r\n    let maxY = -Infinity;\r\n    elements.forEach((element) => {\r\n        const [x1, y1, x2, y2] = getElementBounds(element);\r\n        minX = Math.min(minX, x1);\r\n        minY = Math.min(minY, y1);\r\n        maxX = Math.max(maxX, x2);\r\n        maxY = Math.max(maxY, y2);\r\n    });\r\n    return [minX, minY, maxX, maxY];\r\n};\r\nexport const getResizedElementAbsoluteCoords = (element, nextWidth, nextHeight) => {\r\n    if (!(isLinearElement(element) || isFreeDrawElement(element))) {\r\n        return [\r\n            element.x,\r\n            element.y,\r\n            element.x + nextWidth,\r\n            element.y + nextHeight,\r\n        ];\r\n    }\r\n    const points = rescalePoints(0, nextWidth, rescalePoints(1, nextHeight, element.points));\r\n    let bounds;\r\n    if (isFreeDrawElement(element)) {\r\n        // Free Draw\r\n        bounds = getBoundsFromPoints(points);\r\n    }\r\n    else {\r\n        // Line\r\n        const gen = rough.generator();\r\n        const curve = element.strokeSharpness === \"sharp\"\r\n            ? gen.linearPath(points, generateRoughOptions(element))\r\n            : gen.curve(points, generateRoughOptions(element));\r\n        const ops = getCurvePathOps(curve);\r\n        bounds = getMinMaxXYFromCurvePathOps(ops);\r\n    }\r\n    const [minX, minY, maxX, maxY] = bounds;\r\n    return [\r\n        minX + element.x,\r\n        minY + element.y,\r\n        maxX + element.x,\r\n        maxY + element.y,\r\n    ];\r\n};\r\nexport const getElementPointsCoords = (element, points, sharpness) => {\r\n    // This might be computationally heavey\r\n    const gen = rough.generator();\r\n    const curve = sharpness === \"sharp\"\r\n        ? gen.linearPath(points, generateRoughOptions(element))\r\n        : gen.curve(points, generateRoughOptions(element));\r\n    const ops = getCurvePathOps(curve);\r\n    const [minX, minY, maxX, maxY] = getMinMaxXYFromCurvePathOps(ops);\r\n    return [\r\n        minX + element.x,\r\n        minY + element.y,\r\n        maxX + element.x,\r\n        maxY + element.y,\r\n    ];\r\n};\r\nexport const getClosestElementBounds = (elements, from) => {\r\n    if (!elements.length) {\r\n        return [0, 0, 0, 0];\r\n    }\r\n    let minDistance = Infinity;\r\n    let closestElement = elements[0];\r\n    elements.forEach((element) => {\r\n        const [x1, y1, x2, y2] = getElementBounds(element);\r\n        const distance = distance2d((x1 + x2) / 2, (y1 + y2) / 2, from.x, from.y);\r\n        if (distance < minDistance) {\r\n            minDistance = distance;\r\n            closestElement = element;\r\n        }\r\n    });\r\n    return getElementBounds(closestElement);\r\n};\r\n","import { isTextElement, isLinearElement, isFreeDrawElement, isInitializedImageElement, } from \"../element/typeChecks\";\r\nimport { getDiamondPoints, getElementAbsoluteCoords, getArrowheadPoints, } from \"../element/bounds\";\r\nimport { distance, getFontString, getFontFamilyString, isRTL } from \"../utils\";\r\nimport { isPathALoop } from \"../math\";\r\nimport rough from \"roughjs/bin/rough\";\r\nimport { getDefaultAppState } from \"../appState\";\r\nimport { MAX_DECIMALS_FOR_SVG_EXPORT, MIME_TYPES, SVG_NS } from \"../constants\";\r\nimport { getStroke } from \"perfect-freehand\";\r\nconst defaultAppState = getDefaultAppState();\r\nconst isPendingImageElement = (element, sceneState) => isInitializedImageElement(element) &&\r\n    !sceneState.imageCache.has(element.fileId);\r\nconst getDashArrayDashed = (strokeWidth) => [8, 8 + strokeWidth];\r\nconst getDashArrayDotted = (strokeWidth) => [1.5, 6 + strokeWidth];\r\nconst getCanvasPadding = (element) => element.type === \"freedraw\" ? element.strokeWidth * 12 : 20;\r\nconst generateElementCanvas = (element, zoom, sceneState) => {\r\n    const canvas = document.createElement(\"canvas\");\r\n    const context = canvas.getContext(\"2d\");\r\n    const padding = getCanvasPadding(element);\r\n    let canvasOffsetX = 0;\r\n    let canvasOffsetY = 0;\r\n    if (isLinearElement(element) || isFreeDrawElement(element)) {\r\n        let [x1, y1, x2, y2] = getElementAbsoluteCoords(element);\r\n        x1 = Math.floor(x1);\r\n        x2 = Math.ceil(x2);\r\n        y1 = Math.floor(y1);\r\n        y2 = Math.ceil(y2);\r\n        canvas.width =\r\n            distance(x1, x2) * window.devicePixelRatio * zoom.value +\r\n                padding * zoom.value * 2;\r\n        canvas.height =\r\n            distance(y1, y2) * window.devicePixelRatio * zoom.value +\r\n                padding * zoom.value * 2;\r\n        canvasOffsetX =\r\n            element.x > x1\r\n                ? Math.floor(distance(element.x, x1)) *\r\n                    window.devicePixelRatio *\r\n                    zoom.value\r\n                : 0;\r\n        canvasOffsetY =\r\n            element.y > y1\r\n                ? Math.floor(distance(element.y, y1)) *\r\n                    window.devicePixelRatio *\r\n                    zoom.value\r\n                : 0;\r\n        context.translate(canvasOffsetX, canvasOffsetY);\r\n    }\r\n    else {\r\n        canvas.width =\r\n            element.width * window.devicePixelRatio * zoom.value +\r\n                padding * zoom.value * 2;\r\n        canvas.height =\r\n            element.height * window.devicePixelRatio * zoom.value +\r\n                padding * zoom.value * 2;\r\n    }\r\n    context.save();\r\n    context.translate(padding * zoom.value, padding * zoom.value);\r\n    context.scale(window.devicePixelRatio * zoom.value, window.devicePixelRatio * zoom.value);\r\n    const rc = rough.canvas(canvas);\r\n    if (sceneState.theme === \"dark\" &&\r\n        isInitializedImageElement(element) &&\r\n        !isPendingImageElement(element, sceneState) &&\r\n        sceneState.imageCache.get(element.fileId)?.mimeType !== MIME_TYPES.svg) {\r\n        // using a stronger invert (100% vs our regular 93%) and saturate\r\n        // as a temp hack to make images in dark theme look closer to original\r\n        // color scheme (it's still not quite there and the clors look slightly\r\n        // desaturing/black is not as black, but...)\r\n        context.filter = \"invert(100%) hue-rotate(180deg) saturate(1.25)\";\r\n    }\r\n    drawElementOnCanvas(element, rc, context, sceneState);\r\n    context.restore();\r\n    return {\r\n        element,\r\n        canvas,\r\n        theme: sceneState.theme,\r\n        canvasZoom: zoom.value,\r\n        canvasOffsetX,\r\n        canvasOffsetY,\r\n    };\r\n};\r\nconst IMAGE_PLACEHOLDER_IMG = document.createElement(\"img\");\r\nIMAGE_PLACEHOLDER_IMG.src = `data:${MIME_TYPES.svg},${encodeURIComponent(`<svg aria-hidden=\"true\" focusable=\"false\" data-prefix=\"fas\" data-icon=\"image\" class=\"svg-inline--fa fa-image fa-w-16\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\"><path fill=\"#888\" d=\"M464 448H48c-26.51 0-48-21.49-48-48V112c0-26.51 21.49-48 48-48h416c26.51 0 48 21.49 48 48v288c0 26.51-21.49 48-48 48zM112 120c-30.928 0-56 25.072-56 56s25.072 56 56 56 56-25.072 56-56-25.072-56-56-56zM64 384h384V272l-87.515-87.515c-4.686-4.686-12.284-4.686-16.971 0L208 320l-55.515-55.515c-4.686-4.686-12.284-4.686-16.971 0L64 336v48z\"></path></svg>`)}`;\r\nconst IMAGE_ERROR_PLACEHOLDER_IMG = document.createElement(\"img\");\r\nIMAGE_ERROR_PLACEHOLDER_IMG.src = `data:${MIME_TYPES.svg},${encodeURIComponent(`<svg viewBox=\"0 0 668 668\" xmlns=\"http://www.w3.org/2000/svg\" xml:space=\"preserve\" style=\"fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2\"><path d=\"M464 448H48c-26.51 0-48-21.49-48-48V112c0-26.51 21.49-48 48-48h416c26.51 0 48 21.49 48 48v288c0 26.51-21.49 48-48 48ZM112 120c-30.928 0-56 25.072-56 56s25.072 56 56 56 56-25.072 56-56-25.072-56-56-56ZM64 384h384V272l-87.515-87.515c-4.686-4.686-12.284-4.686-16.971 0L208 320l-55.515-55.515c-4.686-4.686-12.284-4.686-16.971 0L64 336v48Z\" style=\"fill:#888;fill-rule:nonzero\" transform=\"matrix(.81709 0 0 .81709 124.825 145.825)\"/><path d=\"M256 8C119.034 8 8 119.033 8 256c0 136.967 111.034 248 248 248s248-111.034 248-248S392.967 8 256 8Zm130.108 117.892c65.448 65.448 70 165.481 20.677 235.637L150.47 105.216c70.204-49.356 170.226-44.735 235.638 20.676ZM125.892 386.108c-65.448-65.448-70-165.481-20.677-235.637L361.53 406.784c-70.203 49.356-170.226 44.736-235.638-20.676Z\" style=\"fill:#888;fill-rule:nonzero\" transform=\"matrix(.30366 0 0 .30366 506.822 60.065)\"/></svg>`)}`;\r\nconst drawImagePlaceholder = (element, context, zoomValue) => {\r\n    context.fillStyle = \"#E7E7E7\";\r\n    context.fillRect(0, 0, element.width, element.height);\r\n    const imageMinWidthOrHeight = Math.min(element.width, element.height);\r\n    const size = Math.min(imageMinWidthOrHeight, Math.min(imageMinWidthOrHeight * 0.4, 100));\r\n    context.drawImage(element.status === \"error\"\r\n        ? IMAGE_ERROR_PLACEHOLDER_IMG\r\n        : IMAGE_PLACEHOLDER_IMG, element.width / 2 - size / 2, element.height / 2 - size / 2, size, size);\r\n};\r\nconst drawElementOnCanvas = (element, rc, context, sceneState) => {\r\n    context.globalAlpha = element.opacity / 100;\r\n    switch (element.type) {\r\n        case \"rectangle\":\r\n        case \"diamond\":\r\n        case \"ellipse\": {\r\n            context.lineJoin = \"round\";\r\n            context.lineCap = \"round\";\r\n            rc.draw(getShapeForElement(element));\r\n            break;\r\n        }\r\n        case \"arrow\":\r\n        case \"line\": {\r\n            context.lineJoin = \"round\";\r\n            context.lineCap = \"round\";\r\n            getShapeForElement(element).forEach((shape) => {\r\n                rc.draw(shape);\r\n            });\r\n            break;\r\n        }\r\n        case \"freedraw\": {\r\n            // Draw directly to canvas\r\n            context.save();\r\n            context.fillStyle = element.strokeColor;\r\n            const path = getFreeDrawPath2D(element);\r\n            context.fillStyle = element.strokeColor;\r\n            context.fill(path);\r\n            context.restore();\r\n            break;\r\n        }\r\n        case \"image\": {\r\n            const img = isInitializedImageElement(element)\r\n                ? sceneState.imageCache.get(element.fileId)?.image\r\n                : undefined;\r\n            if (img != null && !(img instanceof Promise)) {\r\n                context.drawImage(img, 0 /* hardcoded for the selection box*/, 0, element.width, element.height);\r\n            }\r\n            else {\r\n                drawImagePlaceholder(element, context, sceneState.zoom.value);\r\n            }\r\n            break;\r\n        }\r\n        default: {\r\n            if (isTextElement(element)) {\r\n                const rtl = isRTL(element.text);\r\n                const shouldTemporarilyAttach = rtl && !context.canvas.isConnected;\r\n                if (shouldTemporarilyAttach) {\r\n                    // to correctly render RTL text mixed with LTR, we have to append it\r\n                    // to the DOM\r\n                    document.body.appendChild(context.canvas);\r\n                }\r\n                context.canvas.setAttribute(\"dir\", rtl ? \"rtl\" : \"ltr\");\r\n                context.save();\r\n                context.font = getFontString(element);\r\n                context.fillStyle = element.strokeColor;\r\n                context.textAlign = element.textAlign;\r\n                // Canvas does not support multiline text by default\r\n                const lines = element.text.replace(/\\r\\n?/g, \"\\n\").split(\"\\n\");\r\n                const lineHeight = element.height / lines.length;\r\n                const verticalOffset = element.height - element.baseline;\r\n                const horizontalOffset = element.textAlign === \"center\"\r\n                    ? element.width / 2\r\n                    : element.textAlign === \"right\"\r\n                        ? element.width\r\n                        : 0;\r\n                for (let index = 0; index < lines.length; index++) {\r\n                    context.fillText(lines[index], horizontalOffset, (index + 1) * lineHeight - verticalOffset);\r\n                }\r\n                context.restore();\r\n                if (shouldTemporarilyAttach) {\r\n                    context.canvas.remove();\r\n                }\r\n            }\r\n            else {\r\n                throw new Error(`Unimplemented type ${element.type}`);\r\n            }\r\n        }\r\n    }\r\n    context.globalAlpha = 1;\r\n};\r\nconst elementWithCanvasCache = new WeakMap();\r\nconst shapeCache = new WeakMap();\r\nexport const getShapeForElement = (element) => shapeCache.get(element);\r\nexport const invalidateShapeForElement = (element) => shapeCache.delete(element);\r\nexport const generateRoughOptions = (element, continuousPath = false) => {\r\n    const options = {\r\n        seed: element.seed,\r\n        strokeLineDash: element.strokeStyle === \"dashed\"\r\n            ? getDashArrayDashed(element.strokeWidth)\r\n            : element.strokeStyle === \"dotted\"\r\n                ? getDashArrayDotted(element.strokeWidth)\r\n                : undefined,\r\n        // for non-solid strokes, disable multiStroke because it tends to make\r\n        // dashes/dots overlay each other\r\n        disableMultiStroke: element.strokeStyle !== \"solid\",\r\n        // for non-solid strokes, increase the width a bit to make it visually\r\n        // similar to solid strokes, because we're also disabling multiStroke\r\n        strokeWidth: element.strokeStyle !== \"solid\"\r\n            ? element.strokeWidth + 0.5\r\n            : element.strokeWidth,\r\n        // when increasing strokeWidth, we must explicitly set fillWeight and\r\n        // hachureGap because if not specified, roughjs uses strokeWidth to\r\n        // calculate them (and we don't want the fills to be modified)\r\n        fillWeight: element.strokeWidth / 2,\r\n        hachureGap: element.strokeWidth * 4,\r\n        roughness: element.roughness,\r\n        stroke: element.strokeColor,\r\n        preserveVertices: continuousPath,\r\n        // disable decimals to fix Skia rendering issues #4046\r\n        fixedDecimalPlaceDigits: 0,\r\n    };\r\n    switch (element.type) {\r\n        case \"rectangle\":\r\n        case \"diamond\":\r\n        case \"ellipse\": {\r\n            options.fillStyle = element.fillStyle;\r\n            options.fill =\r\n                element.backgroundColor === \"transparent\"\r\n                    ? undefined\r\n                    : element.backgroundColor;\r\n            if (element.type === \"ellipse\") {\r\n                options.curveFitting = 1;\r\n            }\r\n            return options;\r\n        }\r\n        case \"line\": {\r\n            if (isPathALoop(element.points)) {\r\n                options.fillStyle = element.fillStyle;\r\n                options.fill =\r\n                    element.backgroundColor === \"transparent\"\r\n                        ? undefined\r\n                        : element.backgroundColor;\r\n            }\r\n            return options;\r\n        }\r\n        case \"freedraw\":\r\n        case \"arrow\":\r\n            return options;\r\n        default: {\r\n            throw new Error(`Unimplemented type ${element.type}`);\r\n        }\r\n    }\r\n};\r\n/**\r\n * Generates the element's shape and puts it into the cache.\r\n * @param element\r\n * @param generator\r\n */\r\nconst generateElementShape = (element, generator) => {\r\n    let shape = shapeCache.get(element) || null;\r\n    if (!shape) {\r\n        elementWithCanvasCache.delete(element);\r\n        switch (element.type) {\r\n            case \"rectangle\":\r\n                if (element.strokeSharpness === \"round\") {\r\n                    const w = element.width;\r\n                    const h = element.height;\r\n                    const r = Math.min(w, h) * 0.25;\r\n                    shape = generator.path(`M ${r} 0 L ${w - r} 0 Q ${w} 0, ${w} ${r} L ${w} ${h - r} Q ${w} ${h}, ${w - r} ${h} L ${r} ${h} Q 0 ${h}, 0 ${h - r} L 0 ${r} Q 0 0, ${r} 0`, generateRoughOptions(element, true));\r\n                }\r\n                else {\r\n                    shape = generator.rectangle(0, 0, element.width, element.height, generateRoughOptions(element));\r\n                }\r\n                break;\r\n            case \"diamond\": {\r\n                const [topX, topY, rightX, rightY, bottomX, bottomY, leftX, leftY] = getDiamondPoints(element);\r\n                if (element.strokeSharpness === \"round\") {\r\n                    shape = generator.path(\r\n                      `M ${topX + (rightX - topX) * 0.25} ${\r\n                        topY + (rightY - topY) * 0.25\r\n                      } L ${rightX - (rightX - topX) * 0.25} ${\r\n                        rightY - (rightY - topY) * 0.25\r\n                      } \r\n                      C ${rightX} ${rightY}, ${rightX} ${rightY}, ${\r\n                        rightX - (rightX - bottomX) * 0.25\r\n                      } ${rightY + (bottomY - rightY) * 0.25} \r\n                      L ${bottomX + (rightX - bottomX) * 0.25} ${\r\n                        bottomY - (bottomY - rightY) * 0.25\r\n                      }  \r\n                      C ${bottomX} ${bottomY}, ${bottomX} ${bottomY}, ${\r\n                        bottomX - (bottomX - leftX) * 0.25\r\n                      } ${bottomY - (bottomY - leftY) * 0.25} \r\n                      L ${leftX + (bottomX - leftX) * 0.25} ${\r\n                        leftY + (bottomY - leftY) * 0.25\r\n                      } \r\n                      C ${leftX} ${leftY}, ${leftX} ${leftY}, ${\r\n                        leftX + (topX - leftX) * 0.25\r\n                      } ${leftY - (leftY - topY) * 0.25} \r\n                      L ${topX - (topX - leftX) * 0.25} ${topY + (leftY - topY) * 0.25} \r\n                      C ${topX} ${topY}, ${topX} ${topY}, ${\r\n                        topX + (rightX - topX) * 0.25\r\n                      } ${topY + (rightY - topY) * 0.25}`,\r\n                      generateRoughOptions(element, true),\r\n                    );\r\n                  } else {\r\n                    shape = generator.polygon(\r\n                      [\r\n                        [topX, topY],\r\n                        [rightX, rightY],\r\n                        [bottomX, bottomY],\r\n                        [leftX, leftY],\r\n                      ],\r\n                      generateRoughOptions(element),\r\n                    );\r\n                  }\r\n                break;\r\n            }\r\n            case \"ellipse\":\r\n                shape = generator.ellipse(element.width / 2, element.height / 2, element.width, element.height, generateRoughOptions(element));\r\n                break;\r\n            case \"line\":\r\n            case \"arrow\": {\r\n                const options = generateRoughOptions(element);\r\n                // points array can be empty in the beginning, so it is important to add\r\n                // initial position to it\r\n                const points = element.points.length ? element.points : [[0, 0]];\r\n                // curve is always the first element\r\n                // this simplifies finding the curve for an element\r\n                if (element.strokeSharpness === \"sharp\") {\r\n                    if (options.fill) {\r\n                        shape = [generator.polygon(points, options)];\r\n                    }\r\n                    else {\r\n                        shape = [\r\n                            generator.linearPath(points, options),\r\n                        ];\r\n                    }\r\n                }\r\n                else {\r\n                    shape = [generator.curve(points, options)];\r\n                }\r\n                // add lines only in arrow\r\n                if (element.type === \"arrow\") {\r\n                    const { startArrowhead = null, endArrowhead = \"arrow\" } = element;\r\n                    const getArrowheadShapes = (element, shape, position, arrowhead) => {\r\n                        const arrowheadPoints = getArrowheadPoints(element, shape, position, arrowhead);\r\n                        if (arrowheadPoints === null) {\r\n                            return [];\r\n                        }\r\n                        // Other arrowheads here...\r\n                        if (arrowhead === \"dot\") {\r\n                            const [x, y, r] = arrowheadPoints;\r\n                            return [\r\n                                generator.circle(x, y, r, {\r\n                                    ...options,\r\n                                    fill: element.strokeColor,\r\n                                    fillStyle: \"solid\",\r\n                                    stroke: \"none\",\r\n                                }),\r\n                            ];\r\n                        }\r\n                        if (arrowhead === \"triangle\") {\r\n                            const [x, y, x2, y2, x3, y3] = arrowheadPoints;\r\n                            // always use solid stroke for triangle arrowhead\r\n                            delete options.strokeLineDash;\r\n                            return [\r\n                                generator.polygon([\r\n                                    [x, y],\r\n                                    [x2, y2],\r\n                                    [x3, y3],\r\n                                    [x, y],\r\n                                ], {\r\n                                    ...options,\r\n                                    fill: element.strokeColor,\r\n                                    fillStyle: \"solid\",\r\n                                }),\r\n                            ];\r\n                        }\r\n                        // Arrow arrowheads\r\n                        const [x2, y2, x3, y3, x4, y4] = arrowheadPoints;\r\n                        if (element.strokeStyle === \"dotted\") {\r\n                            // for dotted arrows caps, reduce gap to make it more legible\r\n                            const dash = getDashArrayDotted(element.strokeWidth - 1);\r\n                            options.strokeLineDash = [dash[0], dash[1] - 1];\r\n                        }\r\n                        else {\r\n                            // for solid/dashed, keep solid arrow cap\r\n                            delete options.strokeLineDash;\r\n                        }\r\n                        return [\r\n                            generator.line(x3, y3, x2, y2, options),\r\n                            generator.line(x4, y4, x2, y2, options),\r\n                        ];\r\n                    };\r\n                    if (startArrowhead !== null) {\r\n                        const shapes = getArrowheadShapes(element, shape, \"start\", startArrowhead);\r\n                        shape.push(...shapes);\r\n                    }\r\n                    if (endArrowhead !== null) {\r\n                        if (endArrowhead === undefined) {\r\n                            // Hey, we have an old arrow here!\r\n                        }\r\n                        const shapes = getArrowheadShapes(element, shape, \"end\", endArrowhead);\r\n                        shape.push(...shapes);\r\n                    }\r\n                }\r\n                break;\r\n            }\r\n            case \"freedraw\": {\r\n                generateFreeDrawShape(element);\r\n                shape = [];\r\n                break;\r\n            }\r\n            case \"text\":\r\n            case \"image\": {\r\n                // just to ensure we don't regenerate element.canvas on rerenders\r\n                shape = [];\r\n                break;\r\n            }\r\n        }\r\n        shapeCache.set(element, shape);\r\n    }\r\n};\r\nconst generateElementWithCanvas = (element, sceneState) => {\r\n    const zoom = sceneState ? sceneState.zoom : defaultAppState.zoom;\r\n    const prevElementWithCanvas = elementWithCanvasCache.get(element);\r\n    const shouldRegenerateBecauseZoom = prevElementWithCanvas &&\r\n        prevElementWithCanvas.canvasZoom !== zoom.value &&\r\n        !sceneState?.shouldCacheIgnoreZoom;\r\n    if (!prevElementWithCanvas ||\r\n        shouldRegenerateBecauseZoom ||\r\n        prevElementWithCanvas.theme !== sceneState.theme) {\r\n        const elementWithCanvas = generateElementCanvas(element, zoom, sceneState);\r\n        elementWithCanvasCache.set(element, elementWithCanvas);\r\n        return elementWithCanvas;\r\n    }\r\n    return prevElementWithCanvas;\r\n};\r\nconst drawElementFromCanvas = (elementWithCanvas, rc, context, sceneState) => {\r\n    const element = elementWithCanvas.element;\r\n    const padding = getCanvasPadding(element);\r\n    let [x1, y1, x2, y2] = getElementAbsoluteCoords(element);\r\n    // Free draw elements will otherwise \"shuffle\" as the min x and y change\r\n    if (isFreeDrawElement(element)) {\r\n        x1 = Math.floor(x1);\r\n        x2 = Math.ceil(x2);\r\n        y1 = Math.floor(y1);\r\n        y2 = Math.ceil(y2);\r\n    }\r\n    const cx = ((x1 + x2) / 2 + sceneState.scrollX) * window.devicePixelRatio;\r\n    const cy = ((y1 + y2) / 2 + sceneState.scrollY) * window.devicePixelRatio;\r\n    const _isPendingImageElement = isPendingImageElement(element, sceneState);\r\n    const scaleXFactor = \"scale\" in elementWithCanvas.element && !_isPendingImageElement\r\n        ? elementWithCanvas.element.scale[0]\r\n        : 1;\r\n    const scaleYFactor = \"scale\" in elementWithCanvas.element && !_isPendingImageElement\r\n        ? elementWithCanvas.element.scale[1]\r\n        : 1;\r\n    context.save();\r\n    context.scale((1 / window.devicePixelRatio) * scaleXFactor, (1 / window.devicePixelRatio) * scaleYFactor);\r\n    context.translate(cx * scaleXFactor, cy * scaleYFactor);\r\n    context.rotate(element.angle * scaleXFactor * scaleYFactor);\r\n    context.drawImage(elementWithCanvas.canvas, (-(x2 - x1) / 2) * window.devicePixelRatio -\r\n        (padding * elementWithCanvas.canvasZoom) / elementWithCanvas.canvasZoom, (-(y2 - y1) / 2) * window.devicePixelRatio -\r\n        (padding * elementWithCanvas.canvasZoom) / elementWithCanvas.canvasZoom, elementWithCanvas.canvas.width / elementWithCanvas.canvasZoom, elementWithCanvas.canvas.height / elementWithCanvas.canvasZoom);\r\n    context.restore();\r\n    // Clear the nested element we appended to the DOM\r\n};\r\nexport const renderElement = (element, rc, context, renderOptimizations, sceneState) => {\r\n    const generator = rc.generator;\r\n    switch (element.type) {\r\n        case \"selection\": {\r\n            context.save();\r\n            context.translate(element.x + sceneState.scrollX, element.y + sceneState.scrollY);\r\n            context.fillStyle = \"rgba(0, 0, 255, 0.10)\";\r\n            context.fillRect(0, 0, element.width, element.height);\r\n            context.restore();\r\n            break;\r\n        }\r\n        case \"freedraw\": {\r\n            generateElementShape(element, generator);\r\n            if (renderOptimizations) {\r\n                const elementWithCanvas = generateElementWithCanvas(element, sceneState);\r\n                drawElementFromCanvas(elementWithCanvas, rc, context, sceneState);\r\n            }\r\n            else {\r\n                const [x1, y1, x2, y2] = getElementAbsoluteCoords(element);\r\n                const cx = (x1 + x2) / 2 + sceneState.scrollX;\r\n                const cy = (y1 + y2) / 2 + sceneState.scrollY;\r\n                const shiftX = (x2 - x1) / 2 - (element.x - x1);\r\n                const shiftY = (y2 - y1) / 2 - (element.y - y1);\r\n                context.save();\r\n                context.translate(cx, cy);\r\n                context.rotate(element.angle);\r\n                context.translate(-shiftX, -shiftY);\r\n                drawElementOnCanvas(element, rc, context, sceneState);\r\n                context.restore();\r\n            }\r\n            break;\r\n        }\r\n        case \"rectangle\":\r\n        case \"diamond\":\r\n        case \"ellipse\":\r\n        case \"line\":\r\n        case \"arrow\":\r\n        case \"image\":\r\n        case \"text\": {\r\n            generateElementShape(element, generator);\r\n            if (renderOptimizations) {\r\n                const elementWithCanvas = generateElementWithCanvas(element, sceneState);\r\n                drawElementFromCanvas(elementWithCanvas, rc, context, sceneState);\r\n            }\r\n            else {\r\n                const [x1, y1, x2, y2] = getElementAbsoluteCoords(element);\r\n                const cx = (x1 + x2) / 2 + sceneState.scrollX;\r\n                const cy = (y1 + y2) / 2 + sceneState.scrollY;\r\n                const shiftX = (x2 - x1) / 2 - (element.x - x1);\r\n                const shiftY = (y2 - y1) / 2 - (element.y - y1);\r\n                context.save();\r\n                context.translate(cx, cy);\r\n                context.rotate(element.angle);\r\n                context.translate(-shiftX, -shiftY);\r\n                drawElementOnCanvas(element, rc, context, sceneState);\r\n                context.restore();\r\n            }\r\n            break;\r\n        }\r\n        default: {\r\n            // @ts-ignore\r\n            throw new Error(`Unimplemented type ${element.type}`);\r\n        }\r\n    }\r\n};\r\nconst roughSVGDrawWithPrecision = (rsvg, drawable, precision) => {\r\n    if (typeof precision === \"undefined\") {\r\n        return rsvg.draw(drawable);\r\n    }\r\n    const pshape = {\r\n        sets: drawable.sets,\r\n        shape: drawable.shape,\r\n        options: { ...drawable.options, fixedDecimalPlaceDigits: precision },\r\n    };\r\n    return rsvg.draw(pshape);\r\n};\r\nexport const renderElementToSvg = (element, rsvg, svgRoot, files, offsetX, offsetY) => {\r\n    const [x1, y1, x2, y2] = getElementAbsoluteCoords(element);\r\n    const cx = (x2 - x1) / 2 - (element.x - x1);\r\n    const cy = (y2 - y1) / 2 - (element.y - y1);\r\n    const degree = (180 * element.angle) / Math.PI;\r\n    const generator = rsvg.generator;\r\n    switch (element.type) {\r\n        case \"selection\": {\r\n            // Since this is used only during editing experience, which is canvas based,\r\n            // this should not happen\r\n            throw new Error(\"Selection rendering is not supported for SVG\");\r\n        }\r\n        case \"rectangle\":\r\n        case \"diamond\":\r\n        case \"ellipse\": {\r\n            generateElementShape(element, generator);\r\n            const node = roughSVGDrawWithPrecision(rsvg, getShapeForElement(element), MAX_DECIMALS_FOR_SVG_EXPORT);\r\n            const opacity = element.opacity / 100;\r\n            if (opacity !== 1) {\r\n                node.setAttribute(\"stroke-opacity\", `${opacity}`);\r\n                node.setAttribute(\"fill-opacity\", `${opacity}`);\r\n            }\r\n            node.setAttribute(\"stroke-linecap\", \"round\");\r\n            node.setAttribute(\"transform\", `translate(${offsetX || 0} ${offsetY || 0}) rotate(${degree} ${cx} ${cy})`);\r\n            svgRoot.appendChild(node);\r\n            break;\r\n        }\r\n        case \"line\":\r\n        case \"arrow\": {\r\n            generateElementShape(element, generator);\r\n            const group = svgRoot.ownerDocument.createElementNS(SVG_NS, \"g\");\r\n            const opacity = element.opacity / 100;\r\n            group.setAttribute(\"stroke-linecap\", \"round\");\r\n            getShapeForElement(element).forEach((shape) => {\r\n                const node = roughSVGDrawWithPrecision(rsvg, shape, MAX_DECIMALS_FOR_SVG_EXPORT);\r\n                if (opacity !== 1) {\r\n                    node.setAttribute(\"stroke-opacity\", `${opacity}`);\r\n                    node.setAttribute(\"fill-opacity\", `${opacity}`);\r\n                }\r\n                node.setAttribute(\"transform\", `translate(${offsetX || 0} ${offsetY || 0}) rotate(${degree} ${cx} ${cy})`);\r\n                if (element.type === \"line\" &&\r\n                    isPathALoop(element.points) &&\r\n                    element.backgroundColor !== \"transparent\") {\r\n                    node.setAttribute(\"fill-rule\", \"evenodd\");\r\n                }\r\n                group.appendChild(node);\r\n            });\r\n            svgRoot.appendChild(group);\r\n            break;\r\n        }\r\n        case \"freedraw\": {\r\n            generateFreeDrawShape(element);\r\n            const opacity = element.opacity / 100;\r\n            const node = svgRoot.ownerDocument.createElementNS(SVG_NS, \"g\");\r\n            if (opacity !== 1) {\r\n                node.setAttribute(\"stroke-opacity\", `${opacity}`);\r\n                node.setAttribute(\"fill-opacity\", `${opacity}`);\r\n            }\r\n            node.setAttribute(\"transform\", `translate(${offsetX || 0} ${offsetY || 0}) rotate(${degree} ${cx} ${cy})`);\r\n            const path = svgRoot.ownerDocument.createElementNS(SVG_NS, \"path\");\r\n            node.setAttribute(\"stroke\", \"none\");\r\n            node.setAttribute(\"fill\", element.strokeColor);\r\n            path.setAttribute(\"d\", getFreeDrawSvgPath(element));\r\n            node.appendChild(path);\r\n            svgRoot.appendChild(node);\r\n            break;\r\n        }\r\n        case \"image\": {\r\n            const fileData = isInitializedImageElement(element) && files[element.fileId];\r\n            if (fileData) {\r\n                const symbolId = `image-${fileData.id}`;\r\n                let symbol = svgRoot.querySelector(`#${symbolId}`);\r\n                if (!symbol) {\r\n                    symbol = svgRoot.ownerDocument.createElementNS(SVG_NS, \"symbol\");\r\n                    symbol.id = symbolId;\r\n                    const image = svgRoot.ownerDocument.createElementNS(SVG_NS, \"image\");\r\n                    image.setAttribute(\"width\", \"100%\");\r\n                    image.setAttribute(\"height\", \"100%\");\r\n                    image.setAttribute(\"href\", fileData.dataURL);\r\n                    symbol.appendChild(image);\r\n                    svgRoot.prepend(symbol);\r\n                }\r\n                const use = svgRoot.ownerDocument.createElementNS(SVG_NS, \"use\");\r\n                use.setAttribute(\"href\", `#${symbolId}`);\r\n                use.setAttribute(\"width\", `${Math.round(element.width)}`);\r\n                use.setAttribute(\"height\", `${Math.round(element.height)}`);\r\n                use.setAttribute(\"transform\", `translate(${offsetX || 0} ${offsetY || 0}) rotate(${degree} ${cx} ${cy})`);\r\n                svgRoot.appendChild(use);\r\n            }\r\n            break;\r\n        }\r\n        default: {\r\n            if (isTextElement(element)) {\r\n                const opacity = element.opacity / 100;\r\n                const node = svgRoot.ownerDocument.createElementNS(SVG_NS, \"g\");\r\n                if (opacity !== 1) {\r\n                    node.setAttribute(\"stroke-opacity\", `${opacity}`);\r\n                    node.setAttribute(\"fill-opacity\", `${opacity}`);\r\n                }\r\n                node.setAttribute(\"transform\", `translate(${offsetX || 0} ${offsetY || 0}) rotate(${degree} ${cx} ${cy})`);\r\n                const lines = element.text.replace(/\\r\\n?/g, \"\\n\").split(\"\\n\");\r\n                const lineHeight = element.height / lines.length;\r\n                const verticalOffset = element.height - element.baseline;\r\n                const horizontalOffset = element.textAlign === \"center\"\r\n                    ? element.width / 2\r\n                    : element.textAlign === \"right\"\r\n                        ? element.width\r\n                        : 0;\r\n                const direction = isRTL(element.text) ? \"rtl\" : \"ltr\";\r\n                const textAnchor = element.textAlign === \"center\"\r\n                    ? \"middle\"\r\n                    : element.textAlign === \"right\" || direction === \"rtl\"\r\n                        ? \"end\"\r\n                        : \"start\";\r\n                for (let i = 0; i < lines.length; i++) {\r\n                    const text = svgRoot.ownerDocument.createElementNS(SVG_NS, \"text\");\r\n                    text.textContent = lines[i];\r\n                    text.setAttribute(\"x\", `${horizontalOffset}`);\r\n                    text.setAttribute(\"y\", `${(i + 1) * lineHeight - verticalOffset}`);\r\n                    text.setAttribute(\"font-family\", getFontFamilyString(element));\r\n                    text.setAttribute(\"font-size\", `${element.fontSize}px`);\r\n                    text.setAttribute(\"fill\", element.strokeColor);\r\n                    text.setAttribute(\"text-anchor\", textAnchor);\r\n                    text.setAttribute(\"style\", \"white-space: pre;\");\r\n                    text.setAttribute(\"direction\", direction);\r\n                    node.appendChild(text);\r\n                }\r\n                svgRoot.appendChild(node);\r\n            }\r\n            else {\r\n                // @ts-ignore\r\n                throw new Error(`Unimplemented type ${element.type}`);\r\n            }\r\n        }\r\n    }\r\n};\r\nexport const pathsCache = new WeakMap([]);\r\nexport function generateFreeDrawShape(element) {\r\n    const svgPathData = getFreeDrawSvgPath(element);\r\n    const path = new Path2D(svgPathData);\r\n    pathsCache.set(element, path);\r\n    return path;\r\n}\r\nexport function getFreeDrawPath2D(element) {\r\n    return pathsCache.get(element);\r\n}\r\nexport function getFreeDrawSvgPath(element) {\r\n    // If input points are empty (should they ever be?) return a dot\r\n    const inputPoints = element.simulatePressure\r\n        ? element.points\r\n        : element.points.length\r\n            ? element.points.map(([x, y], i) => [x, y, element.pressures[i]])\r\n            : [[0, 0, 0.5]];\r\n    // Consider changing the options for simulated pressure vs real pressure\r\n    const options = {\r\n        simulatePressure: element.simulatePressure,\r\n        size: element.strokeWidth * 4.25,\r\n        thinning: 0.6,\r\n        smoothing: 0.5,\r\n        streamline: 0.5,\r\n        easing: (t) => Math.sin((t * Math.PI) / 2),\r\n        last: !!element.lastCommittedPoint, // LastCommittedPoint is added on pointerup\r\n    };\r\n    return getSvgPathFromStroke(getStroke(inputPoints, options));\r\n}\r\nfunction med(A, B) {\r\n    return [(A[0] + B[0]) / 2, (A[1] + B[1]) / 2];\r\n}\r\n// Trim SVG path data so number are each two decimal points. This\r\n// improves SVG exports, and prevents rendering errors on points\r\n// with long decimals.\r\nconst TO_FIXED_PRECISION = /(\\s?[A-Z]?,?-?[0-9]*\\.[0-9]{0,2})(([0-9]|e|-)*)/g;\r\nfunction getSvgPathFromStroke(points) {\r\n    if (!points.length) {\r\n        return \"\";\r\n    }\r\n    const max = points.length - 1;\r\n    return points\r\n        .reduce((acc, point, i, arr) => {\r\n        if (i === max) {\r\n            acc.push(point, med(point, arr[0]), \"L\", arr[0], \"Z\");\r\n        }\r\n        else {\r\n            acc.push(point, med(point, arr[i + 1]));\r\n        }\r\n        return acc;\r\n    }, [\"M\", points[0], \"Q\"])\r\n        .join(\" \")\r\n        .replace(TO_FIXED_PRECISION, \"$1\");\r\n}\r\n","import { getNonDeletedElements, isNonDeletedElement } from \"../element\";\r\nconst isIdKey = (elementKey) => {\r\n    if (typeof elementKey === \"string\") {\r\n        return true;\r\n    }\r\n    return false;\r\n};\r\nclass Scene {\r\n    constructor() {\r\n        // ---------------------------------------------------------------------------\r\n        // static methods/props\r\n        // ---------------------------------------------------------------------------\r\n        // ---------------------------------------------------------------------------\r\n        // instance methods/props\r\n        // ---------------------------------------------------------------------------\r\n        this.callbacks = new Set();\r\n        this.nonDeletedElements = [];\r\n        this.elements = [];\r\n        this.elementsMap = new Map();\r\n    }\r\n    static mapElementToScene(elementKey, scene) {\r\n        if (isIdKey(elementKey)) {\r\n            this.sceneMapById.set(elementKey, scene);\r\n        }\r\n        else {\r\n            this.sceneMapByElement.set(elementKey, scene);\r\n        }\r\n    }\r\n    static getScene(elementKey) {\r\n        if (isIdKey(elementKey)) {\r\n            return this.sceneMapById.get(elementKey) || null;\r\n        }\r\n        return this.sceneMapByElement.get(elementKey) || null;\r\n    }\r\n    // TODO: getAllElementsIncludingDeleted\r\n    getElementsIncludingDeleted() {\r\n        return this.elements;\r\n    }\r\n    // TODO: getAllNonDeletedElements\r\n    getElements() {\r\n        return this.nonDeletedElements;\r\n    }\r\n    getElement(id) {\r\n        return this.elementsMap.get(id) || null;\r\n    }\r\n    getNonDeletedElement(id) {\r\n        const element = this.getElement(id);\r\n        if (element && isNonDeletedElement(element)) {\r\n            return element;\r\n        }\r\n        return null;\r\n    }\r\n    // TODO: Rename methods here, this is confusing\r\n    getNonDeletedElements(ids) {\r\n        const result = [];\r\n        ids.forEach((id) => {\r\n            const element = this.getNonDeletedElement(id);\r\n            if (element != null) {\r\n                result.push(element);\r\n            }\r\n        });\r\n        return result;\r\n    }\r\n    replaceAllElements(nextElements) {\r\n        this.elements = nextElements;\r\n        this.elementsMap.clear();\r\n        nextElements.forEach((element) => {\r\n            this.elementsMap.set(element.id, element);\r\n            Scene.mapElementToScene(element, this);\r\n        });\r\n        this.nonDeletedElements = getNonDeletedElements(this.elements);\r\n        this.informMutation();\r\n    }\r\n    informMutation() {\r\n        for (const callback of Array.from(this.callbacks)) {\r\n            callback();\r\n        }\r\n    }\r\n    addCallback(cb) {\r\n        if (this.callbacks.has(cb)) {\r\n            throw new Error();\r\n        }\r\n        this.callbacks.add(cb);\r\n        return () => {\r\n            if (!this.callbacks.has(cb)) {\r\n                throw new Error();\r\n            }\r\n            this.callbacks.delete(cb);\r\n        };\r\n    }\r\n    destroy() {\r\n        Scene.sceneMapById.forEach((scene, elementKey) => {\r\n            if (scene === this) {\r\n                Scene.sceneMapById.delete(elementKey);\r\n            }\r\n        });\r\n        // done not for memory leaks, but to guard against possible late fires\r\n        // (I guess?)\r\n        this.callbacks.clear();\r\n    }\r\n}\r\nScene.sceneMapByElement = new WeakMap();\r\nScene.sceneMapById = new Map();\r\nexport default Scene;\r\n","import { Random } from \"roughjs/bin/math\";\r\nimport { nanoid } from \"nanoid\";\r\nlet random = new Random(Date.now());\r\nlet testIdBase = 0;\r\nexport const randomInteger = () => Math.floor(random.next() * 2 ** 31);\r\nexport const reseed = (seed) => {\r\n    random = new Random(seed);\r\n    testIdBase = 0;\r\n};\r\nexport const randomId = () => process.env.NODE_ENV === \"test\" ? `id${testIdBase++}` : nanoid();\r\n","import { invalidateShapeForElement } from \"../renderer/renderElement\";\r\nimport Scene from \"../scene/Scene\";\r\nimport { getSizeFromPoints } from \"../points\";\r\nimport { randomInteger } from \"../random\";\r\n// This function tracks updates of text elements for the purposes for collaboration.\r\n// The version is used to compare updates when more than one user is working in\r\n// the same drawing. Note: this will trigger the component to update. Make sure you\r\n// are calling it either from a React event handler or within unstable_batchedUpdates().\r\nexport const mutateElement = (element, updates, informMutation = true) => {\r\n    let didChange = false;\r\n    // casting to any because can't use `in` operator\r\n    // (see https://github.com/microsoft/TypeScript/issues/21732)\r\n    const { points, fileId } = updates;\r\n    if (typeof points !== \"undefined\") {\r\n        updates = { ...getSizeFromPoints(points), ...updates };\r\n    }\r\n    for (const key in updates) {\r\n        const value = updates[key];\r\n        if (typeof value !== \"undefined\") {\r\n            if (element[key] === value &&\r\n                // if object, always update because its attrs could have changed\r\n                // (except for specific keys we handle below)\r\n                (typeof value !== \"object\" ||\r\n                    value === null ||\r\n                    key === \"groupIds\" ||\r\n                    key === \"scale\")) {\r\n                continue;\r\n            }\r\n            if (key === \"scale\") {\r\n                const prevScale = element[key];\r\n                const nextScale = value;\r\n                if (prevScale[0] === nextScale[0] && prevScale[1] === nextScale[1]) {\r\n                    continue;\r\n                }\r\n            }\r\n            else if (key === \"points\") {\r\n                const prevPoints = element[key];\r\n                const nextPoints = value;\r\n                if (prevPoints.length === nextPoints.length) {\r\n                    let didChangePoints = false;\r\n                    let index = prevPoints.length;\r\n                    while (--index) {\r\n                        const prevPoint = prevPoints[index];\r\n                        const nextPoint = nextPoints[index];\r\n                        if (prevPoint[0] !== nextPoint[0] ||\r\n                            prevPoint[1] !== nextPoint[1]) {\r\n                            didChangePoints = true;\r\n                            break;\r\n                        }\r\n                    }\r\n                    if (!didChangePoints) {\r\n                        continue;\r\n                    }\r\n                }\r\n            }\r\n            element[key] = value;\r\n            didChange = true;\r\n        }\r\n    }\r\n    if (!didChange) {\r\n        return element;\r\n    }\r\n    if (typeof updates.height !== \"undefined\" ||\r\n        typeof updates.width !== \"undefined\" ||\r\n        typeof fileId != \"undefined\" ||\r\n        typeof points !== \"undefined\") {\r\n        invalidateShapeForElement(element);\r\n    }\r\n    element.version++;\r\n    element.versionNonce = randomInteger();\r\n    if (informMutation) {\r\n        Scene.getScene(element)?.informMutation();\r\n    }\r\n    return element;\r\n};\r\nexport const newElementWith = (element, updates) => {\r\n    let didChange = false;\r\n    for (const key in updates) {\r\n        const value = updates[key];\r\n        if (typeof value !== \"undefined\") {\r\n            if (element[key] === value &&\r\n                // if object, always update because its attrs could have changed\r\n                (typeof value !== \"object\" || value === null)) {\r\n                continue;\r\n            }\r\n            didChange = true;\r\n        }\r\n    }\r\n    if (!didChange) {\r\n        return element;\r\n    }\r\n    return {\r\n        ...element,\r\n        ...updates,\r\n        version: element.version + 1,\r\n        versionNonce: randomInteger(),\r\n    };\r\n};\r\n/**\r\n * Mutates element and updates `version` & `versionNonce`.\r\n *\r\n * NOTE: does not trigger re-render.\r\n */\r\nexport const bumpVersion = (element, version) => {\r\n    element.version = (version ?? element.version) + 1;\r\n    element.versionNonce = randomInteger();\r\n    return element;\r\n};\r\n","import { mutateElement } from \"./mutateElement\";\r\nimport { isFreeDrawElement, isLinearElement } from \"./typeChecks\";\r\nimport { SHIFT_LOCKING_ANGLE } from \"../constants\";\r\nexport const isInvisiblySmallElement = (element) => {\r\n    if (isLinearElement(element) || isFreeDrawElement(element)) {\r\n        return element.points.length < 2;\r\n    }\r\n    return element.width === 0 && element.height === 0;\r\n};\r\n/**\r\n * Makes a perfect shape or diagonal/horizontal/vertical line\r\n */\r\nexport const getPerfectElementSize = (elementType, width, height) => {\r\n    const absWidth = Math.abs(width);\r\n    const absHeight = Math.abs(height);\r\n    if (elementType === \"line\" ||\r\n        elementType === \"arrow\" ||\r\n        elementType === \"freedraw\") {\r\n        const lockedAngle = Math.round(Math.atan(absHeight / absWidth) / SHIFT_LOCKING_ANGLE) *\r\n            SHIFT_LOCKING_ANGLE;\r\n        if (lockedAngle === 0) {\r\n            height = 0;\r\n        }\r\n        else if (lockedAngle === Math.PI / 2) {\r\n            width = 0;\r\n        }\r\n        else {\r\n            height =\r\n                Math.round(absWidth * Math.tan(lockedAngle)) * Math.sign(height) ||\r\n                    height;\r\n        }\r\n    }\r\n    else if (elementType !== \"selection\") {\r\n        height = absWidth * Math.sign(height);\r\n    }\r\n    return { width, height };\r\n};\r\nexport const resizePerfectLineForNWHandler = (element, x, y) => {\r\n    const anchorX = element.x + element.width;\r\n    const anchorY = element.y + element.height;\r\n    const distanceToAnchorX = x - anchorX;\r\n    const distanceToAnchorY = y - anchorY;\r\n    if (Math.abs(distanceToAnchorX) < Math.abs(distanceToAnchorY) / 2) {\r\n        mutateElement(element, {\r\n            x: anchorX,\r\n            width: 0,\r\n            y,\r\n            height: -distanceToAnchorY,\r\n        });\r\n    }\r\n    else if (Math.abs(distanceToAnchorY) < Math.abs(element.width) / 2) {\r\n        mutateElement(element, {\r\n            y: anchorY,\r\n            height: 0,\r\n        });\r\n    }\r\n    else {\r\n        const nextHeight = Math.sign(distanceToAnchorY) *\r\n            Math.sign(distanceToAnchorX) *\r\n            element.width;\r\n        mutateElement(element, {\r\n            x,\r\n            y: anchorY - nextHeight,\r\n            width: -distanceToAnchorX,\r\n            height: nextHeight,\r\n        });\r\n    }\r\n};\r\nexport const getNormalizedDimensions = (element) => {\r\n    const ret = {\r\n        width: element.width,\r\n        height: element.height,\r\n        x: element.x,\r\n        y: element.y,\r\n    };\r\n    if (element.width < 0) {\r\n        const nextWidth = Math.abs(element.width);\r\n        ret.width = nextWidth;\r\n        ret.x = element.x - nextWidth;\r\n    }\r\n    if (element.height < 0) {\r\n        const nextHeight = Math.abs(element.height);\r\n        ret.height = nextHeight;\r\n        ret.y = element.y - nextHeight;\r\n    }\r\n    return ret;\r\n};\r\n","import { getSelectedElements } from \"./scene\";\r\nexport const selectGroup = (groupId, appState, elements) => {\r\n    const elementsInGroup = elements.filter((element) => element.groupIds.includes(groupId));\r\n    if (elementsInGroup.length < 2) {\r\n        if (appState.selectedGroupIds[groupId] ||\r\n            appState.editingGroupId === groupId) {\r\n            return {\r\n                ...appState,\r\n                selectedGroupIds: { ...appState.selectedGroupIds, [groupId]: false },\r\n                editingGroupId: null,\r\n            };\r\n        }\r\n        return appState;\r\n    }\r\n    return {\r\n        ...appState,\r\n        selectedGroupIds: { ...appState.selectedGroupIds, [groupId]: true },\r\n        selectedElementIds: {\r\n            ...appState.selectedElementIds,\r\n            ...Object.fromEntries(elementsInGroup.map((element) => [element.id, true])),\r\n        },\r\n    };\r\n};\r\n/**\r\n * If the element's group is selected, don't render an individual\r\n * selection border around it.\r\n */\r\nexport const isSelectedViaGroup = (appState, element) => getSelectedGroupForElement(appState, element) != null;\r\nexport const getSelectedGroupForElement = (appState, element) => element.groupIds\r\n    .filter((groupId) => groupId !== appState.editingGroupId)\r\n    .find((groupId) => appState.selectedGroupIds[groupId]);\r\nexport const getSelectedGroupIds = (appState) => Object.entries(appState.selectedGroupIds)\r\n    .filter(([groupId, isSelected]) => isSelected)\r\n    .map(([groupId, isSelected]) => groupId);\r\n/**\r\n * When you select an element, you often want to actually select the whole group it's in, unless\r\n * you're currently editing that group.\r\n */\r\nexport const selectGroupsForSelectedElements = (appState, elements) => {\r\n    let nextAppState = { ...appState, selectedGroupIds: {} };\r\n    const selectedElements = getSelectedElements(elements, appState);\r\n    if (!selectedElements.length) {\r\n        return { ...nextAppState, editingGroupId: null };\r\n    }\r\n    for (const selectedElement of selectedElements) {\r\n        let groupIds = selectedElement.groupIds;\r\n        if (appState.editingGroupId) {\r\n            // handle the case where a group is nested within a group\r\n            const indexOfEditingGroup = groupIds.indexOf(appState.editingGroupId);\r\n            if (indexOfEditingGroup > -1) {\r\n                groupIds = groupIds.slice(0, indexOfEditingGroup);\r\n            }\r\n        }\r\n        if (groupIds.length > 0) {\r\n            const groupId = groupIds[groupIds.length - 1];\r\n            nextAppState = selectGroup(groupId, nextAppState, elements);\r\n        }\r\n    }\r\n    return nextAppState;\r\n};\r\nexport const editGroupForSelectedElement = (appState, element) => {\r\n    return {\r\n        ...appState,\r\n        editingGroupId: element.groupIds.length ? element.groupIds[0] : null,\r\n        selectedGroupIds: {},\r\n        selectedElementIds: {\r\n            [element.id]: true,\r\n        },\r\n    };\r\n};\r\nexport const isElementInGroup = (element, groupId) => element.groupIds.includes(groupId);\r\nexport const getElementsInGroup = (elements, groupId) => elements.filter((element) => isElementInGroup(element, groupId));\r\nexport const getSelectedGroupIdForElement = (element, selectedGroupIds) => element.groupIds.find((groupId) => selectedGroupIds[groupId]);\r\nexport const getNewGroupIdsForDuplication = (groupIds, editingGroupId, mapper) => {\r\n    const copy = [...groupIds];\r\n    const positionOfEditingGroupId = editingGroupId\r\n        ? groupIds.indexOf(editingGroupId)\r\n        : -1;\r\n    const endIndex = positionOfEditingGroupId > -1 ? positionOfEditingGroupId : groupIds.length;\r\n    for (let index = 0; index < endIndex; index++) {\r\n        copy[index] = mapper(copy[index]);\r\n    }\r\n    return copy;\r\n};\r\nexport const addToGroup = (prevGroupIds, newGroupId, editingGroupId) => {\r\n    // insert before the editingGroupId, or push to the end.\r\n    const groupIds = [...prevGroupIds];\r\n    const positionOfEditingGroupId = editingGroupId\r\n        ? groupIds.indexOf(editingGroupId)\r\n        : -1;\r\n    const positionToInsert = positionOfEditingGroupId > -1 ? positionOfEditingGroupId : groupIds.length;\r\n    groupIds.splice(positionToInsert, 0, newGroupId);\r\n    return groupIds;\r\n};\r\nexport const removeFromSelectedGroups = (groupIds, selectedGroupIds) => groupIds.filter((groupId) => !selectedGroupIds[groupId]);\r\n","import { measureText, getFontString } from \"../utils\";\r\nimport { randomInteger, randomId } from \"../random\";\r\nimport { newElementWith } from \"./mutateElement\";\r\nimport { getNewGroupIdsForDuplication } from \"../groups\";\r\nimport { getElementAbsoluteCoords } from \".\";\r\nimport { adjustXYWithRotation } from \"../math\";\r\nimport { getResizedElementAbsoluteCoords } from \"./bounds\";\r\nconst _newElementBase = (type, { x, y, strokeColor, backgroundColor, fillStyle, strokeWidth, strokeStyle, roughness, opacity, width = 0, height = 0, angle = 0, groupIds = [], strokeSharpness, boundElementIds = null, ...rest }) => ({\r\n    id: rest.id || randomId(),\r\n    type,\r\n    x,\r\n    y,\r\n    width,\r\n    height,\r\n    angle,\r\n    strokeColor,\r\n    backgroundColor,\r\n    fillStyle,\r\n    strokeWidth,\r\n    strokeStyle,\r\n    roughness,\r\n    opacity,\r\n    groupIds,\r\n    strokeSharpness,\r\n    seed: rest.seed ?? randomInteger(),\r\n    version: rest.version || 1,\r\n    versionNonce: rest.versionNonce ?? 0,\r\n    isDeleted: false,\r\n    boundElementIds,\r\n});\r\nexport const newElement = (opts) => _newElementBase(opts.type, opts);\r\n/** computes element x/y offset based on textAlign/verticalAlign */\r\nconst getTextElementPositionOffsets = (opts, metrics) => {\r\n    return {\r\n        x: opts.textAlign === \"center\"\r\n            ? metrics.width / 2\r\n            : opts.textAlign === \"right\"\r\n                ? metrics.width\r\n                : 0,\r\n        y: opts.verticalAlign === \"middle\" ? metrics.height / 2 : 0,\r\n    };\r\n};\r\nexport const newTextElement = (opts) => {\r\n    const metrics = measureText(opts.text, getFontString(opts));\r\n    const offsets = getTextElementPositionOffsets(opts, metrics);\r\n    const textElement = newElementWith({\r\n        ..._newElementBase(\"text\", opts),\r\n        text: opts.text,\r\n        fontSize: opts.fontSize,\r\n        fontFamily: opts.fontFamily,\r\n        textAlign: opts.textAlign,\r\n        verticalAlign: opts.verticalAlign,\r\n        x: opts.x - offsets.x,\r\n        y: opts.y - offsets.y,\r\n        width: metrics.width,\r\n        height: metrics.height,\r\n        baseline: metrics.baseline,\r\n    }, {});\r\n    return textElement;\r\n};\r\nconst getAdjustedDimensions = (element, nextText) => {\r\n    const { width: nextWidth, height: nextHeight, baseline: nextBaseline, } = measureText(nextText, getFontString(element));\r\n    const { textAlign, verticalAlign } = element;\r\n    let x;\r\n    let y;\r\n    if (textAlign === \"center\" && verticalAlign === \"middle\") {\r\n        const prevMetrics = measureText(element.text, getFontString(element));\r\n        const offsets = getTextElementPositionOffsets(element, {\r\n            width: nextWidth - prevMetrics.width,\r\n            height: nextHeight - prevMetrics.height,\r\n        });\r\n        x = element.x - offsets.x;\r\n        y = element.y - offsets.y;\r\n    }\r\n    else {\r\n        const [x1, y1, x2, y2] = getElementAbsoluteCoords(element);\r\n        const [nextX1, nextY1, nextX2, nextY2] = getResizedElementAbsoluteCoords(element, nextWidth, nextHeight);\r\n        const deltaX1 = (x1 - nextX1) / 2;\r\n        const deltaY1 = (y1 - nextY1) / 2;\r\n        const deltaX2 = (x2 - nextX2) / 2;\r\n        const deltaY2 = (y2 - nextY2) / 2;\r\n        [x, y] = adjustXYWithRotation({\r\n            s: true,\r\n            e: textAlign === \"center\" || textAlign === \"left\",\r\n            w: textAlign === \"center\" || textAlign === \"right\",\r\n        }, element.x, element.y, element.angle, deltaX1, deltaY1, deltaX2, deltaY2);\r\n    }\r\n    return {\r\n        width: nextWidth,\r\n        height: nextHeight,\r\n        x: Number.isFinite(x) ? x : element.x,\r\n        y: Number.isFinite(y) ? y : element.y,\r\n        baseline: nextBaseline,\r\n    };\r\n};\r\nexport const updateTextElement = (element, { text, isDeleted }) => {\r\n    return newElementWith(element, {\r\n        text,\r\n        isDeleted: isDeleted ?? element.isDeleted,\r\n        ...getAdjustedDimensions(element, text),\r\n    });\r\n};\r\nexport const newFreeDrawElement = (opts) => {\r\n    return {\r\n        ..._newElementBase(opts.type, opts),\r\n        points: opts.points || [],\r\n        pressures: [],\r\n        simulatePressure: opts.simulatePressure,\r\n        lastCommittedPoint: null,\r\n    };\r\n};\r\nexport const newLinearElement = (opts) => {\r\n    return {\r\n        ..._newElementBase(opts.type, opts),\r\n        points: opts.points || [],\r\n        lastCommittedPoint: null,\r\n        startBinding: null,\r\n        endBinding: null,\r\n        startArrowhead: opts.startArrowhead,\r\n        endArrowhead: opts.endArrowhead,\r\n    };\r\n};\r\nexport const newImageElement = (opts) => {\r\n    return {\r\n        ..._newElementBase(\"image\", opts),\r\n        // in the future we'll support changing stroke color for some SVG elements,\r\n        // and `transparent` will likely mean \"use original colors of the image\"\r\n        strokeColor: \"transparent\",\r\n        status: \"pending\",\r\n        fileId: null,\r\n        scale: [1, 1],\r\n    };\r\n};\r\n// Simplified deep clone for the purpose of cloning ExcalidrawElement only\r\n// (doesn't clone Date, RegExp, Map, Set, Typed arrays etc.)\r\n//\r\n// Adapted from https://github.com/lukeed/klona\r\nexport const deepCopyElement = (val, depth = 0) => {\r\n    if (val == null || typeof val !== \"object\") {\r\n        return val;\r\n    }\r\n    if (Object.prototype.toString.call(val) === \"[object Object]\") {\r\n        const tmp = typeof val.constructor === \"function\"\r\n            ? Object.create(Object.getPrototypeOf(val))\r\n            : {};\r\n        for (const key in val) {\r\n            if (val.hasOwnProperty(key)) {\r\n                // don't copy top-level shape property, which we want to regenerate\r\n                if (depth === 0 && (key === \"shape\" || key === \"canvas\")) {\r\n                    continue;\r\n                }\r\n                tmp[key] = deepCopyElement(val[key], depth + 1);\r\n            }\r\n        }\r\n        return tmp;\r\n    }\r\n    if (Array.isArray(val)) {\r\n        let k = val.length;\r\n        const arr = new Array(k);\r\n        while (k--) {\r\n            arr[k] = deepCopyElement(val[k], depth + 1);\r\n        }\r\n        return arr;\r\n    }\r\n    return val;\r\n};\r\n/**\r\n * Duplicate an element, often used in the alt-drag operation.\r\n * Note that this method has gotten a bit complicated since the\r\n * introduction of gruoping/ungrouping elements.\r\n * @param editingGroupId The current group being edited. The new\r\n *                       element will inherit this group and its\r\n *                       parents.\r\n * @param groupIdMapForOperation A Map that maps old group IDs to\r\n *                               duplicated ones. If you are duplicating\r\n *                               multiple elements at once, share this map\r\n *                               amongst all of them\r\n * @param element Element to duplicate\r\n * @param overrides Any element properties to override\r\n */\r\nexport const duplicateElement = (editingGroupId, groupIdMapForOperation, element, overrides) => {\r\n    let copy = deepCopyElement(element);\r\n    if (process.env.NODE_ENV === \"test\") {\r\n        copy.id = `${copy.id}_copy`;\r\n        // `window.h` may not be defined in some unit tests\r\n        if (window.h?.app\r\n            ?.getSceneElementsIncludingDeleted()\r\n            .find((el) => el.id === copy.id)) {\r\n            copy.id += \"_copy\";\r\n        }\r\n    }\r\n    else {\r\n        copy.id = randomId();\r\n    }\r\n    copy.seed = randomInteger();\r\n    copy.groupIds = getNewGroupIdsForDuplication(copy.groupIds, editingGroupId, (groupId) => {\r\n        if (!groupIdMapForOperation.has(groupId)) {\r\n            groupIdMapForOperation.set(groupId, randomId());\r\n        }\r\n        return groupIdMapForOperation.get(groupId);\r\n    });\r\n    if (overrides) {\r\n        copy = Object.assign(copy, overrides);\r\n    }\r\n    return copy;\r\n};\r\n","import { getElementAbsoluteCoords } from \"./bounds\";\r\nimport { rotate } from \"../math\";\r\nconst transformHandleSizes = {\r\n    mouse: 8,\r\n    pen: 16,\r\n    touch: 28,\r\n};\r\nconst ROTATION_RESIZE_HANDLE_GAP = 16;\r\nexport const OMIT_SIDES_FOR_MULTIPLE_ELEMENTS = {\r\n    e: true,\r\n    s: true,\r\n    n: true,\r\n    w: true,\r\n};\r\nconst OMIT_SIDES_FOR_TEXT_ELEMENT = {\r\n    e: true,\r\n    s: true,\r\n    n: true,\r\n    w: true,\r\n};\r\nconst OMIT_SIDES_FOR_LINE_SLASH = {\r\n    e: true,\r\n    s: true,\r\n    n: true,\r\n    w: true,\r\n    nw: true,\r\n    se: true,\r\n};\r\nconst OMIT_SIDES_FOR_LINE_BACKSLASH = {\r\n    e: true,\r\n    s: true,\r\n    n: true,\r\n    w: true,\r\n    ne: true,\r\n    sw: true,\r\n};\r\nconst generateTransformHandle = (x, y, width, height, cx, cy, angle) => {\r\n    const [xx, yy] = rotate(x + width / 2, y + height / 2, cx, cy, angle);\r\n    return [xx - width / 2, yy - height / 2, width, height];\r\n};\r\nexport const getTransformHandlesFromCoords = ([x1, y1, x2, y2], angle, zoom, pointerType, omitSides = {}) => {\r\n    const size = transformHandleSizes[pointerType];\r\n    const handleWidth = size / zoom.value;\r\n    const handleHeight = size / zoom.value;\r\n    const handleMarginX = size / zoom.value;\r\n    const handleMarginY = size / zoom.value;\r\n    const width = x2 - x1;\r\n    const height = y2 - y1;\r\n    const cx = (x1 + x2) / 2;\r\n    const cy = (y1 + y2) / 2;\r\n    const dashedLineMargin = 4 / zoom.value;\r\n    const centeringOffset = (size - 8) / (2 * zoom.value);\r\n    const transformHandles = {\r\n        nw: omitSides.nw\r\n            ? undefined\r\n            : generateTransformHandle(x1 - dashedLineMargin - handleMarginX + centeringOffset, y1 - dashedLineMargin - handleMarginY + centeringOffset, handleWidth, handleHeight, cx, cy, angle),\r\n        ne: omitSides.ne\r\n            ? undefined\r\n            : generateTransformHandle(x2 + dashedLineMargin - centeringOffset, y1 - dashedLineMargin - handleMarginY + centeringOffset, handleWidth, handleHeight, cx, cy, angle),\r\n        sw: omitSides.sw\r\n            ? undefined\r\n            : generateTransformHandle(x1 - dashedLineMargin - handleMarginX + centeringOffset, y2 + dashedLineMargin - centeringOffset, handleWidth, handleHeight, cx, cy, angle),\r\n        se: omitSides.se\r\n            ? undefined\r\n            : generateTransformHandle(x2 + dashedLineMargin - centeringOffset, y2 + dashedLineMargin - centeringOffset, handleWidth, handleHeight, cx, cy, angle),\r\n        rotation: omitSides.rotation\r\n            ? undefined\r\n            : generateTransformHandle(x1 + width / 2 - handleWidth / 2, y1 -\r\n                dashedLineMargin -\r\n                handleMarginY +\r\n                centeringOffset -\r\n                ROTATION_RESIZE_HANDLE_GAP / zoom.value, handleWidth, handleHeight, cx, cy, angle),\r\n    };\r\n    // We only want to show height handles (all cardinal directions)  above a certain size\r\n    // Note: we render using \"mouse\" size so we should also use \"mouse\" size for this check\r\n    const minimumSizeForEightHandles = (5 * transformHandleSizes.mouse) / zoom.value;\r\n    if (Math.abs(width) > minimumSizeForEightHandles) {\r\n        if (!omitSides.n) {\r\n            transformHandles.n = generateTransformHandle(x1 + width / 2 - handleWidth / 2, y1 - dashedLineMargin - handleMarginY + centeringOffset, handleWidth, handleHeight, cx, cy, angle);\r\n        }\r\n        if (!omitSides.s) {\r\n            transformHandles.s = generateTransformHandle(x1 + width / 2 - handleWidth / 2, y2 + dashedLineMargin - centeringOffset, handleWidth, handleHeight, cx, cy, angle);\r\n        }\r\n    }\r\n    if (Math.abs(height) > minimumSizeForEightHandles) {\r\n        if (!omitSides.w) {\r\n            transformHandles.w = generateTransformHandle(x1 - dashedLineMargin - handleMarginX + centeringOffset, y1 + height / 2 - handleHeight / 2, handleWidth, handleHeight, cx, cy, angle);\r\n        }\r\n        if (!omitSides.e) {\r\n            transformHandles.e = generateTransformHandle(x2 + dashedLineMargin - centeringOffset, y1 + height / 2 - handleHeight / 2, handleWidth, handleHeight, cx, cy, angle);\r\n        }\r\n    }\r\n    return transformHandles;\r\n};\r\nexport const getTransformHandles = (element, zoom, pointerType = \"mouse\") => {\r\n    let omitSides = {};\r\n    if (element.type === \"arrow\" ||\r\n        element.type === \"line\" ||\r\n        element.type === \"freedraw\") {\r\n        if (element.points.length === 2) {\r\n            // only check the last point because starting point is always (0,0)\r\n            const [, p1] = element.points;\r\n            if (p1[0] === 0 || p1[1] === 0) {\r\n                omitSides = OMIT_SIDES_FOR_LINE_BACKSLASH;\r\n            }\r\n            else if (p1[0] > 0 && p1[1] < 0) {\r\n                omitSides = OMIT_SIDES_FOR_LINE_SLASH;\r\n            }\r\n            else if (p1[0] > 0 && p1[1] > 0) {\r\n                omitSides = OMIT_SIDES_FOR_LINE_BACKSLASH;\r\n            }\r\n            else if (p1[0] < 0 && p1[1] > 0) {\r\n                omitSides = OMIT_SIDES_FOR_LINE_SLASH;\r\n            }\r\n            else if (p1[0] < 0 && p1[1] < 0) {\r\n                omitSides = OMIT_SIDES_FOR_LINE_BACKSLASH;\r\n            }\r\n        }\r\n    }\r\n    else if (element.type === \"text\") {\r\n        omitSides = OMIT_SIDES_FOR_TEXT_ELEMENT;\r\n    }\r\n    return getTransformHandlesFromCoords(getElementAbsoluteCoords(element), element.angle, zoom, pointerType, omitSides);\r\n};\r\n","/**\r\n * This is a 2D Projective Geometric Algebra implementation.\r\n *\r\n * For wider context on geometric algebra visit see https://bivector.net.\r\n *\r\n * For this specific algebra see cheatsheet https://bivector.net/2DPGA.pdf.\r\n *\r\n * Converted from generator written by enki, with a ton of added on top.\r\n *\r\n * This library uses 8-vectors to represent points, directions and lines\r\n * in 2D space.\r\n *\r\n * An array `[a, b, c, d, e, f, g, h]` represents a n(8)vector:\r\n *   a + b*e0 + c*e1 + d*e2 + e*e01 + f*e20 + g*e12 + h*e012\r\n *\r\n * See GAPoint, GALine, GADirection and GATransform modules for common\r\n * operations.\r\n */\r\nexport const point = (x, y) => [0, 0, 0, 0, y, x, 1, 0];\r\nexport const origin = () => [0, 0, 0, 0, 0, 0, 1, 0];\r\nexport const direction = (x, y) => {\r\n    const norm = Math.hypot(x, y); // same as `inorm(direction(x, y))`\r\n    return [0, 0, 0, 0, y / norm, x / norm, 0, 0];\r\n};\r\nexport const offset = (x, y) => [\r\n    0,\r\n    0,\r\n    0,\r\n    0,\r\n    y,\r\n    x,\r\n    0,\r\n    0,\r\n];\r\n// These are labels for what each number in an nvector represents\r\nconst NVECTOR_BASE = [\"1\", \"e0\", \"e1\", \"e2\", \"e01\", \"e20\", \"e12\", \"e012\"];\r\n// Used to represent points, lines and transformations\r\nexport const nvector = (value = 0, index = 0) => {\r\n    const result = [0, 0, 0, 0, 0, 0, 0, 0];\r\n    if (index < 0 || index > 7) {\r\n        throw new Error(`Expected \\`index\\` betwen 0 and 7, got \\`${index}\\``);\r\n    }\r\n    if (value !== 0) {\r\n        result[index] = value;\r\n    }\r\n    return result;\r\n};\r\nconst STRING_EPSILON = 0.000001;\r\nexport const toString = (nvector) => {\r\n    const result = nvector\r\n        .map((value, index) => Math.abs(value) > STRING_EPSILON\r\n        ? value.toFixed(7).replace(/(\\.|0+)$/, \"\") +\r\n            (index > 0 ? NVECTOR_BASE[index] : \"\")\r\n        : null)\r\n        .filter((representation) => representation != null)\r\n        .join(\" + \");\r\n    return result === \"\" ? \"0\" : result;\r\n};\r\n// Reverse the order of the basis blades.\r\nexport const reverse = (nvector) => [\r\n    nvector[0],\r\n    nvector[1],\r\n    nvector[2],\r\n    nvector[3],\r\n    -nvector[4],\r\n    -nvector[5],\r\n    -nvector[6],\r\n    -nvector[7],\r\n];\r\n// Poincare duality operator.\r\nexport const dual = (nvector) => [\r\n    nvector[7],\r\n    nvector[6],\r\n    nvector[5],\r\n    nvector[4],\r\n    nvector[3],\r\n    nvector[2],\r\n    nvector[1],\r\n    nvector[0],\r\n];\r\n// Clifford Conjugation\r\nexport const conjugate = (nvector) => [\r\n    nvector[0],\r\n    -nvector[1],\r\n    -nvector[2],\r\n    -nvector[3],\r\n    -nvector[4],\r\n    -nvector[5],\r\n    -nvector[6],\r\n    nvector[7],\r\n];\r\n// Main involution\r\nexport const involute = (nvector) => [\r\n    nvector[0],\r\n    -nvector[1],\r\n    -nvector[2],\r\n    -nvector[3],\r\n    nvector[4],\r\n    nvector[5],\r\n    nvector[6],\r\n    -nvector[7],\r\n];\r\n// Multivector addition\r\nexport const add = (a, b) => {\r\n    if (isNumber(b)) {\r\n        return [a[0] + b, a[1], a[2], a[3], a[4], a[5], a[6], a[7]];\r\n    }\r\n    return [\r\n        a[0] + b[0],\r\n        a[1] + b[1],\r\n        a[2] + b[2],\r\n        a[3] + b[3],\r\n        a[4] + b[4],\r\n        a[5] + b[5],\r\n        a[6] + b[6],\r\n        a[7] + b[7],\r\n    ];\r\n};\r\n// Multivector subtraction\r\nexport const sub = (a, b) => {\r\n    if (isNumber(b)) {\r\n        return [a[0] - b, a[1], a[2], a[3], a[4], a[5], a[6], a[7]];\r\n    }\r\n    return [\r\n        a[0] - b[0],\r\n        a[1] - b[1],\r\n        a[2] - b[2],\r\n        a[3] - b[3],\r\n        a[4] - b[4],\r\n        a[5] - b[5],\r\n        a[6] - b[6],\r\n        a[7] - b[7],\r\n    ];\r\n};\r\n// The geometric product.\r\nexport const mul = (a, b) => {\r\n    if (isNumber(b)) {\r\n        return [\r\n            a[0] * b,\r\n            a[1] * b,\r\n            a[2] * b,\r\n            a[3] * b,\r\n            a[4] * b,\r\n            a[5] * b,\r\n            a[6] * b,\r\n            a[7] * b,\r\n        ];\r\n    }\r\n    return [\r\n        mulScalar(a, b),\r\n        b[1] * a[0] +\r\n            b[0] * a[1] -\r\n            b[4] * a[2] +\r\n            b[5] * a[3] +\r\n            b[2] * a[4] -\r\n            b[3] * a[5] -\r\n            b[7] * a[6] -\r\n            b[6] * a[7],\r\n        b[2] * a[0] + b[0] * a[2] - b[6] * a[3] + b[3] * a[6],\r\n        b[3] * a[0] + b[6] * a[2] + b[0] * a[3] - b[2] * a[6],\r\n        b[4] * a[0] +\r\n            b[2] * a[1] -\r\n            b[1] * a[2] +\r\n            b[7] * a[3] +\r\n            b[0] * a[4] +\r\n            b[6] * a[5] -\r\n            b[5] * a[6] +\r\n            b[3] * a[7],\r\n        b[5] * a[0] -\r\n            b[3] * a[1] +\r\n            b[7] * a[2] +\r\n            b[1] * a[3] -\r\n            b[6] * a[4] +\r\n            b[0] * a[5] +\r\n            b[4] * a[6] +\r\n            b[2] * a[7],\r\n        b[6] * a[0] + b[3] * a[2] - b[2] * a[3] + b[0] * a[6],\r\n        b[7] * a[0] +\r\n            b[6] * a[1] +\r\n            b[5] * a[2] +\r\n            b[4] * a[3] +\r\n            b[3] * a[4] +\r\n            b[2] * a[5] +\r\n            b[1] * a[6] +\r\n            b[0] * a[7],\r\n    ];\r\n};\r\nexport const mulScalar = (a, b) => b[0] * a[0] + b[2] * a[2] + b[3] * a[3] - b[6] * a[6];\r\n// The outer/exterior/wedge product.\r\nexport const meet = (a, b) => [\r\n    b[0] * a[0],\r\n    b[1] * a[0] + b[0] * a[1],\r\n    b[2] * a[0] + b[0] * a[2],\r\n    b[3] * a[0] + b[0] * a[3],\r\n    b[4] * a[0] + b[2] * a[1] - b[1] * a[2] + b[0] * a[4],\r\n    b[5] * a[0] - b[3] * a[1] + b[1] * a[3] + b[0] * a[5],\r\n    b[6] * a[0] + b[3] * a[2] - b[2] * a[3] + b[0] * a[6],\r\n    b[7] * a[0] +\r\n        b[6] * a[1] +\r\n        b[5] * a[2] +\r\n        b[4] * a[3] +\r\n        b[3] * a[4] +\r\n        b[2] * a[5] +\r\n        b[1] * a[6],\r\n];\r\n// The regressive product.\r\nexport const join = (a, b) => [\r\n    joinScalar(a, b),\r\n    a[1] * b[7] + a[4] * b[5] - a[5] * b[4] + a[7] * b[1],\r\n    a[2] * b[7] - a[4] * b[6] + a[6] * b[4] + a[7] * b[2],\r\n    a[3] * b[7] + a[5] * b[6] - a[6] * b[5] + a[7] * b[3],\r\n    a[4] * b[7] + a[7] * b[4],\r\n    a[5] * b[7] + a[7] * b[5],\r\n    a[6] * b[7] + a[7] * b[6],\r\n    a[7] * b[7],\r\n];\r\nexport const joinScalar = (a, b) => a[0] * b[7] +\r\n    a[1] * b[6] +\r\n    a[2] * b[5] +\r\n    a[3] * b[4] +\r\n    a[4] * b[3] +\r\n    a[5] * b[2] +\r\n    a[6] * b[1] +\r\n    a[7] * b[0];\r\n// The inner product.\r\nexport const dot = (a, b) => [\r\n    b[0] * a[0] + b[2] * a[2] + b[3] * a[3] - b[6] * a[6],\r\n    b[1] * a[0] +\r\n        b[0] * a[1] -\r\n        b[4] * a[2] +\r\n        b[5] * a[3] +\r\n        b[2] * a[4] -\r\n        b[3] * a[5] -\r\n        b[7] * a[6] -\r\n        b[6] * a[7],\r\n    b[2] * a[0] + b[0] * a[2] - b[6] * a[3] + b[3] * a[6],\r\n    b[3] * a[0] + b[6] * a[2] + b[0] * a[3] - b[2] * a[6],\r\n    b[4] * a[0] + b[7] * a[3] + b[0] * a[4] + b[3] * a[7],\r\n    b[5] * a[0] + b[7] * a[2] + b[0] * a[5] + b[2] * a[7],\r\n    b[6] * a[0] + b[0] * a[6],\r\n    b[7] * a[0] + b[0] * a[7],\r\n];\r\nexport const norm = (a) => Math.sqrt(Math.abs(a[0] * a[0] - a[2] * a[2] - a[3] * a[3] + a[6] * a[6]));\r\nexport const inorm = (a) => Math.sqrt(Math.abs(a[7] * a[7] - a[5] * a[5] - a[4] * a[4] + a[1] * a[1]));\r\nexport const normalized = (a) => {\r\n    const n = norm(a);\r\n    if (n === 0 || n === 1) {\r\n        return a;\r\n    }\r\n    const sign = a[6] < 0 ? -1 : 1;\r\n    return mul(a, sign / n);\r\n};\r\nexport const inormalized = (a) => {\r\n    const n = inorm(a);\r\n    if (n === 0 || n === 1) {\r\n        return a;\r\n    }\r\n    return mul(a, 1 / n);\r\n};\r\nconst isNumber = (a) => typeof a === \"number\";\r\nexport const E0 = nvector(1, 1);\r\nexport const E1 = nvector(1, 2);\r\nexport const E2 = nvector(1, 3);\r\nexport const E01 = nvector(1, 4);\r\nexport const E20 = nvector(1, 5);\r\nexport const E12 = nvector(1, 6);\r\nexport const E012 = nvector(1, 7);\r\nexport const I = E012;\r\n","import * as GA from \"./ga\";\r\n/**\r\n * A line is stored as an array `[0, c, a, b, 0, 0, 0, 0]` representing:\r\n *   c * e0 + a * e1 + b*e2\r\n *\r\n * This maps to a standard formula `a * x + b * y + c`.\r\n *\r\n * `(-b, a)` correponds to a 2D vector parallel to the line. The lines\r\n * have a natural orientation, corresponding to that vector.\r\n *\r\n * The magnitude (\"norm\") of the line is `sqrt(a ^ 2 + b ^ 2)`.\r\n * `c / norm(line)` is the oriented distance from line to origin.\r\n */\r\n// Returns line with direction (x, y) through origin\r\nexport const vector = (x, y) => GA.normalized([0, 0, -y, x, 0, 0, 0, 0]);\r\n// For equation ax + by + c = 0.\r\nexport const equation = (a, b, c) => GA.normalized([0, c, a, b, 0, 0, 0, 0]);\r\nexport const through = (from, to) => GA.normalized(GA.join(to, from));\r\nexport const orthogonal = (line, point) => GA.dot(line, point);\r\n// Returns a line perpendicular to the line through `against` and `intersection`\r\n// going through `intersection`.\r\nexport const orthogonalThrough = (against, intersection) => orthogonal(through(against, intersection), intersection);\r\nexport const parallel = (line, distance) => {\r\n    const result = line.slice();\r\n    result[1] -= distance;\r\n    return result;\r\n};\r\nexport const parallelThrough = (line, point) => orthogonal(orthogonal(point, line), point);\r\nexport const distance = (line1, line2) => GA.inorm(GA.meet(line1, line2));\r\nexport const angle = (line1, line2) => Math.acos(GA.dot(line1, line2)[0]);\r\n// The orientation of the line\r\nexport const sign = (line) => Math.sign(line[1]);\r\n","import * as GA from \"./ga\";\r\nimport * as GALine from \"./galines\";\r\nimport { join } from \"./ga\";\r\nexport const from = ([x, y]) => [\r\n    0,\r\n    0,\r\n    0,\r\n    0,\r\n    y,\r\n    x,\r\n    1,\r\n    0,\r\n];\r\nexport const toTuple = (point) => [point[5], point[4]];\r\nexport const abs = (point) => [\r\n    0,\r\n    0,\r\n    0,\r\n    0,\r\n    Math.abs(point[4]),\r\n    Math.abs(point[5]),\r\n    1,\r\n    0,\r\n];\r\nexport const intersect = (line1, line2) => GA.normalized(GA.meet(line1, line2));\r\n// Projects `point` onto the `line`.\r\n// The returned point is the closest point on the `line` to the `point`.\r\nexport const project = (point, line) => intersect(GALine.orthogonal(line, point), line);\r\nexport const distance = (point1, point2) => GA.norm(join(point1, point2));\r\nexport const distanceToLine = (point, line) => GA.joinScalar(point, line);\r\n","import * as GA from \"./ga\";\r\n/**\r\n * A direction is stored as an array `[0, 0, 0, 0, y, x, 0, 0]` representing\r\n * vector `(x, y)`.\r\n */\r\nexport const from = (point) => [\r\n    0,\r\n    0,\r\n    0,\r\n    0,\r\n    point[4],\r\n    point[5],\r\n    0,\r\n    0,\r\n];\r\nexport const fromTo = (from, to) => GA.inormalized([0, 0, 0, 0, to[4] - from[4], to[5] - from[5], 0, 0]);\r\nexport const orthogonal = (direction) => GA.inormalized([0, 0, 0, 0, -direction[5], direction[4], 0, 0]);\r\nexport const orthogonalToLine = (line) => GA.mul(line, GA.I);\r\n","import * as GA from \"./ga\";\r\nimport * as GADirection from \"./gadirections\";\r\n/**\r\n * TODO: docs\r\n */\r\nexport const rotation = (pivot, angle) => GA.add(GA.mul(pivot, Math.sin(angle / 2)), Math.cos(angle / 2));\r\nexport const translation = (direction) => [\r\n    1,\r\n    0,\r\n    0,\r\n    0,\r\n    -(0.5 * direction[5]),\r\n    0.5 * direction[4],\r\n    0,\r\n    0,\r\n];\r\nexport const translationOrthogonal = (direction, distance) => {\r\n    const scale = 0.5 * distance;\r\n    return [1, 0, 0, 0, scale * direction[4], scale * direction[5], 0, 0];\r\n};\r\nexport const translationAlong = (line, distance) => GA.add(GA.mul(GADirection.orthogonalToLine(line), 0.5 * distance), 1);\r\nexport const compose = (motor1, motor2) => GA.mul(motor2, motor1);\r\nexport const apply = (motor, nvector) => GA.normalized(GA.mul(GA.mul(motor, nvector), GA.reverse(motor)));\r\n","import * as GA from \"../ga\";\r\nimport * as GAPoint from \"../gapoints\";\r\nimport * as GADirection from \"../gadirections\";\r\nimport * as GALine from \"../galines\";\r\nimport * as GATransform from \"../gatransforms\";\r\nimport { distance2d, rotatePoint, isPathALoop, isPointInPolygon, rotate, } from \"../math\";\r\nimport { pointsOnBezierCurves } from \"points-on-curve\";\r\nimport { getElementAbsoluteCoords, getCurvePathOps } from \"./bounds\";\r\nimport { getShapeForElement } from \"../renderer/renderElement\";\r\nimport { isImageElement } from \"./typeChecks\";\r\nconst isElementDraggableFromInside = (element) => {\r\n    if (element.type === \"arrow\") {\r\n        return false;\r\n    }\r\n    if (element.type === \"freedraw\") {\r\n        return true;\r\n    }\r\n    const isDraggableFromInside = element.backgroundColor !== \"transparent\";\r\n    if (element.type === \"line\") {\r\n        return isDraggableFromInside && isPathALoop(element.points);\r\n    }\r\n    return isDraggableFromInside || isImageElement(element);\r\n};\r\nexport const hitTest = (element, appState, x, y) => {\r\n    // How many pixels off the shape boundary we still consider a hit\r\n    const threshold = 10 / appState.zoom.value;\r\n    const point = [x, y];\r\n    if (isElementSelected(appState, element)) {\r\n        return isPointHittingElementBoundingBox(element, point, threshold);\r\n    }\r\n    return isHittingElementNotConsideringBoundingBox(element, appState, point);\r\n};\r\nexport const isHittingElementBoundingBoxWithoutHittingElement = (element, appState, x, y) => {\r\n    const threshold = 10 / appState.zoom.value;\r\n    return (!isHittingElementNotConsideringBoundingBox(element, appState, [x, y]) &&\r\n        isPointHittingElementBoundingBox(element, [x, y], threshold));\r\n};\r\nconst isHittingElementNotConsideringBoundingBox = (element, appState, point) => {\r\n    const threshold = 10 / appState.zoom.value;\r\n    const check = element.type === \"text\"\r\n        ? isStrictlyInside\r\n        : isElementDraggableFromInside(element)\r\n            ? isInsideCheck\r\n            : isNearCheck;\r\n    return hitTestPointAgainstElement({ element, point, threshold, check });\r\n};\r\nconst isElementSelected = (appState, element) => appState.selectedElementIds[element.id];\r\nconst isPointHittingElementBoundingBox = (element, [x, y], threshold) => {\r\n    const [x1, y1, x2, y2] = getElementAbsoluteCoords(element);\r\n    const elementCenterX = (x1 + x2) / 2;\r\n    const elementCenterY = (y1 + y2) / 2;\r\n    // reverse rotate to take element's angle into account.\r\n    const [rotatedX, rotatedY] = rotate(x, y, elementCenterX, elementCenterY, -element.angle);\r\n    return (rotatedX > x1 - threshold &&\r\n        rotatedX < x2 + threshold &&\r\n        rotatedY > y1 - threshold &&\r\n        rotatedY < y2 + threshold);\r\n};\r\nexport const bindingBorderTest = (element, { x, y }) => {\r\n    const threshold = maxBindingGap(element, element.width, element.height);\r\n    const check = isOutsideCheck;\r\n    const point = [x, y];\r\n    return hitTestPointAgainstElement({ element, point, threshold, check });\r\n};\r\nexport const maxBindingGap = (element, elementWidth, elementHeight) => {\r\n    // Aligns diamonds with rectangles\r\n    const shapeRatio = element.type === \"diamond\" ? 1 / Math.sqrt(2) : 1;\r\n    const smallerDimension = shapeRatio * Math.min(elementWidth, elementHeight);\r\n    // We make the bindable boundary bigger for bigger elements\r\n    return Math.max(16, Math.min(0.25 * smallerDimension, 32));\r\n};\r\nconst hitTestPointAgainstElement = (args) => {\r\n    switch (args.element.type) {\r\n        case \"rectangle\":\r\n        case \"image\":\r\n        case \"text\":\r\n        case \"diamond\":\r\n        case \"ellipse\":\r\n            const distance = distanceToBindableElement(args.element, args.point);\r\n            return args.check(distance, args.threshold);\r\n        case \"freedraw\": {\r\n            if (!args.check(distanceToRectangle(args.element, args.point), args.threshold)) {\r\n                return false;\r\n            }\r\n            return hitTestFreeDrawElement(args.element, args.point, args.threshold);\r\n        }\r\n        case \"arrow\":\r\n        case \"line\":\r\n            return hitTestLinear(args);\r\n        case \"selection\":\r\n            console.warn(\"This should not happen, we need to investigate why it does.\");\r\n            return false;\r\n    }\r\n};\r\nexport const distanceToBindableElement = (element, point) => {\r\n    switch (element.type) {\r\n        case \"rectangle\":\r\n        case \"image\":\r\n        case \"text\":\r\n            return distanceToRectangle(element, point);\r\n        case \"diamond\":\r\n            return distanceToDiamond(element, point);\r\n        case \"ellipse\":\r\n            return distanceToEllipse(element, point);\r\n    }\r\n};\r\nconst isStrictlyInside = (distance, threshold) => {\r\n    return distance < 0;\r\n};\r\nconst isInsideCheck = (distance, threshold) => {\r\n    return distance < threshold;\r\n};\r\nconst isNearCheck = (distance, threshold) => {\r\n    return Math.abs(distance) < threshold;\r\n};\r\nconst isOutsideCheck = (distance, threshold) => {\r\n    return 0 <= distance && distance < threshold;\r\n};\r\nconst distanceToRectangle = (element, point) => {\r\n    const [, pointRel, hwidth, hheight] = pointRelativeToElement(element, point);\r\n    return Math.max(GAPoint.distanceToLine(pointRel, GALine.equation(0, 1, -hheight)), GAPoint.distanceToLine(pointRel, GALine.equation(1, 0, -hwidth)));\r\n};\r\nconst distanceToDiamond = (element, point) => {\r\n    const [, pointRel, hwidth, hheight] = pointRelativeToElement(element, point);\r\n    const side = GALine.equation(hheight, hwidth, -hheight * hwidth);\r\n    return GAPoint.distanceToLine(pointRel, side);\r\n};\r\nconst distanceToEllipse = (element, point) => {\r\n    const [pointRel, tangent] = ellipseParamsForTest(element, point);\r\n    return -GALine.sign(tangent) * GAPoint.distanceToLine(pointRel, tangent);\r\n};\r\nconst ellipseParamsForTest = (element, point) => {\r\n    const [, pointRel, hwidth, hheight] = pointRelativeToElement(element, point);\r\n    const [px, py] = GAPoint.toTuple(pointRel);\r\n    // We're working in positive quadrant, so start with `t = 45deg`, `tx=cos(t)`\r\n    let tx = 0.707;\r\n    let ty = 0.707;\r\n    const a = hwidth;\r\n    const b = hheight;\r\n    // This is a numerical method to find the params tx, ty at which\r\n    // the ellipse has the closest point to the given point\r\n    [0, 1, 2, 3].forEach((_) => {\r\n        const xx = a * tx;\r\n        const yy = b * ty;\r\n        const ex = ((a * a - b * b) * tx ** 3) / a;\r\n        const ey = ((b * b - a * a) * ty ** 3) / b;\r\n        const rx = xx - ex;\r\n        const ry = yy - ey;\r\n        const qx = px - ex;\r\n        const qy = py - ey;\r\n        const r = Math.hypot(ry, rx);\r\n        const q = Math.hypot(qy, qx);\r\n        tx = Math.min(1, Math.max(0, ((qx * r) / q + ex) / a));\r\n        ty = Math.min(1, Math.max(0, ((qy * r) / q + ey) / b));\r\n        const t = Math.hypot(ty, tx);\r\n        tx /= t;\r\n        ty /= t;\r\n    });\r\n    const closestPoint = GA.point(a * tx, b * ty);\r\n    const tangent = GALine.orthogonalThrough(pointRel, closestPoint);\r\n    return [pointRel, tangent];\r\n};\r\nconst hitTestFreeDrawElement = (element, point, threshold) => {\r\n    // Check point-distance-to-line-segment for every segment in the\r\n    // element's points (its input points, not its outline points).\r\n    // This is... okay? It's plenty fast, but the GA library may\r\n    // have a faster option.\r\n    let x;\r\n    let y;\r\n    if (element.angle === 0) {\r\n        x = point[0] - element.x;\r\n        y = point[1] - element.y;\r\n    }\r\n    else {\r\n        // Counter-rotate the point around center before testing\r\n        const [minX, minY, maxX, maxY] = getElementAbsoluteCoords(element);\r\n        const rotatedPoint = rotatePoint(point, [minX + (maxX - minX) / 2, minY + (maxY - minY) / 2], -element.angle);\r\n        x = rotatedPoint[0] - element.x;\r\n        y = rotatedPoint[1] - element.y;\r\n    }\r\n    let [A, B] = element.points;\r\n    let P;\r\n    // For freedraw dots\r\n    if (distance2d(A[0], A[1], x, y) < threshold ||\r\n        distance2d(B[0], B[1], x, y) < threshold) {\r\n        return true;\r\n    }\r\n    // For freedraw lines\r\n    for (let i = 0; i < element.points.length; i++) {\r\n        const delta = [B[0] - A[0], B[1] - A[1]];\r\n        const length = Math.hypot(delta[1], delta[0]);\r\n        const U = [delta[0] / length, delta[1] / length];\r\n        const C = [x - A[0], y - A[1]];\r\n        const d = (C[0] * U[0] + C[1] * U[1]) / Math.hypot(U[1], U[0]);\r\n        P = [A[0] + U[0] * d, A[1] + U[1] * d];\r\n        const da = distance2d(P[0], P[1], A[0], A[1]);\r\n        const db = distance2d(P[0], P[1], B[0], B[1]);\r\n        P = db < da && da > length ? B : da < db && db > length ? A : P;\r\n        if (Math.hypot(y - P[1], x - P[0]) < threshold) {\r\n            return true;\r\n        }\r\n        A = B;\r\n        B = element.points[i + 1];\r\n    }\r\n    return false;\r\n};\r\nconst hitTestLinear = (args) => {\r\n    const { element, threshold } = args;\r\n    if (!getShapeForElement(element)) {\r\n        return false;\r\n    }\r\n    const [point, pointAbs, hwidth, hheight] = pointRelativeToElement(args.element, args.point);\r\n    const side1 = GALine.equation(0, 1, -hheight);\r\n    const side2 = GALine.equation(1, 0, -hwidth);\r\n    if (!isInsideCheck(GAPoint.distanceToLine(pointAbs, side1), threshold) ||\r\n        !isInsideCheck(GAPoint.distanceToLine(pointAbs, side2), threshold)) {\r\n        return false;\r\n    }\r\n    const [relX, relY] = GAPoint.toTuple(point);\r\n    const shape = getShapeForElement(element);\r\n    if (args.check === isInsideCheck) {\r\n        const hit = shape.some((subshape) => hitTestCurveInside(subshape, relX, relY, element.strokeSharpness));\r\n        if (hit) {\r\n            return true;\r\n        }\r\n    }\r\n    // hit test all \"subshapes\" of the linear element\r\n    return shape.some((subshape) => hitTestRoughShape(subshape, relX, relY, threshold));\r\n};\r\n// Returns:\r\n//   1. the point relative to the elements (x, y) position\r\n//   2. the point relative to the element's center with positive (x, y)\r\n//   3. half element width\r\n//   4. half element height\r\n//\r\n// Note that for linear elements the (x, y) position is not at the\r\n// top right corner of their boundary.\r\n//\r\n// Rectangles, diamonds and ellipses are symmetrical over axes,\r\n// and other elements have a rectangular boundary,\r\n// so we only need to perform hit tests for the positive quadrant.\r\nconst pointRelativeToElement = (element, pointTuple) => {\r\n    const point = GAPoint.from(pointTuple);\r\n    const elementCoords = getElementAbsoluteCoords(element);\r\n    const center = coordsCenter(elementCoords);\r\n    // GA has angle orientation opposite to `rotate`\r\n    const rotate = GATransform.rotation(center, element.angle);\r\n    const pointRotated = GATransform.apply(rotate, point);\r\n    const pointRelToCenter = GA.sub(pointRotated, GADirection.from(center));\r\n    const pointRelToCenterAbs = GAPoint.abs(pointRelToCenter);\r\n    const elementPos = GA.offset(element.x, element.y);\r\n    const pointRelToPos = GA.sub(pointRotated, elementPos);\r\n    const [ax, ay, bx, by] = elementCoords;\r\n    const halfWidth = (bx - ax) / 2;\r\n    const halfHeight = (by - ay) / 2;\r\n    return [pointRelToPos, pointRelToCenterAbs, halfWidth, halfHeight];\r\n};\r\n// Returns point in absolute coordinates\r\nexport const pointInAbsoluteCoords = (element, \r\n// Point relative to the element position\r\npoint) => {\r\n    const [x, y] = point;\r\n    const [x1, y1, x2, y2] = getElementAbsoluteCoords(element);\r\n    const cx = (x2 - x1) / 2;\r\n    const cy = (y2 - y1) / 2;\r\n    const [rotatedX, rotatedY] = rotate(x, y, cx, cy, element.angle);\r\n    return [element.x + rotatedX, element.y + rotatedY];\r\n};\r\nconst relativizationToElementCenter = (element) => {\r\n    const elementCoords = getElementAbsoluteCoords(element);\r\n    const center = coordsCenter(elementCoords);\r\n    // GA has angle orientation opposite to `rotate`\r\n    const rotate = GATransform.rotation(center, element.angle);\r\n    const translate = GA.reverse(GATransform.translation(GADirection.from(center)));\r\n    return GATransform.compose(rotate, translate);\r\n};\r\nconst coordsCenter = ([ax, ay, bx, by]) => {\r\n    return GA.point((ax + bx) / 2, (ay + by) / 2);\r\n};\r\n// The focus distance is the oriented ratio between the size of\r\n// the `element` and the \"focus image\" of the element on which\r\n// all focus points lie, so it's a number between -1 and 1.\r\n// The line going through `a` and `b` is a tangent to the \"focus image\"\r\n// of the element.\r\nexport const determineFocusDistance = (element, \r\n// Point on the line, in absolute coordinates\r\na, \r\n// Another point on the line, in absolute coordinates (closer to element)\r\nb) => {\r\n    const relateToCenter = relativizationToElementCenter(element);\r\n    const aRel = GATransform.apply(relateToCenter, GAPoint.from(a));\r\n    const bRel = GATransform.apply(relateToCenter, GAPoint.from(b));\r\n    const line = GALine.through(aRel, bRel);\r\n    const q = element.height / element.width;\r\n    const hwidth = element.width / 2;\r\n    const hheight = element.height / 2;\r\n    const n = line[2];\r\n    const m = line[3];\r\n    const c = line[1];\r\n    const mabs = Math.abs(m);\r\n    const nabs = Math.abs(n);\r\n    switch (element.type) {\r\n        case \"rectangle\":\r\n        case \"image\":\r\n        case \"text\":\r\n            return c / (hwidth * (nabs + q * mabs));\r\n        case \"diamond\":\r\n            return mabs < nabs ? c / (nabs * hwidth) : c / (mabs * hheight);\r\n        case \"ellipse\":\r\n            return c / (hwidth * Math.sqrt(n ** 2 + q ** 2 * m ** 2));\r\n    }\r\n};\r\nexport const determineFocusPoint = (element, \r\n// The oriented, relative distance from the center of `element` of the\r\n// returned focusPoint\r\nfocus, adjecentPoint) => {\r\n    if (focus === 0) {\r\n        const elementCoords = getElementAbsoluteCoords(element);\r\n        const center = coordsCenter(elementCoords);\r\n        return GAPoint.toTuple(center);\r\n    }\r\n    const relateToCenter = relativizationToElementCenter(element);\r\n    const adjecentPointRel = GATransform.apply(relateToCenter, GAPoint.from(adjecentPoint));\r\n    const reverseRelateToCenter = GA.reverse(relateToCenter);\r\n    let point;\r\n    switch (element.type) {\r\n        case \"rectangle\":\r\n        case \"image\":\r\n        case \"text\":\r\n        case \"diamond\":\r\n            point = findFocusPointForRectangulars(element, focus, adjecentPointRel);\r\n            break;\r\n        case \"ellipse\":\r\n            point = findFocusPointForEllipse(element, focus, adjecentPointRel);\r\n            break;\r\n    }\r\n    return GAPoint.toTuple(GATransform.apply(reverseRelateToCenter, point));\r\n};\r\n// Returns 2 or 0 intersection points between line going through `a` and `b`\r\n// and the `element`, in ascending order of distance from `a`.\r\nexport const intersectElementWithLine = (element, \r\n// Point on the line, in absolute coordinates\r\na, \r\n// Another point on the line, in absolute coordinates\r\nb, \r\n// If given, the element is inflated by this value\r\ngap = 0) => {\r\n    const relateToCenter = relativizationToElementCenter(element);\r\n    const aRel = GATransform.apply(relateToCenter, GAPoint.from(a));\r\n    const bRel = GATransform.apply(relateToCenter, GAPoint.from(b));\r\n    const line = GALine.through(aRel, bRel);\r\n    const reverseRelateToCenter = GA.reverse(relateToCenter);\r\n    const intersections = getSortedElementLineIntersections(element, line, aRel, gap);\r\n    return intersections.map((point) => GAPoint.toTuple(GATransform.apply(reverseRelateToCenter, point)));\r\n};\r\nconst getSortedElementLineIntersections = (element, \r\n// Relative to element center\r\nline, \r\n// Relative to element center\r\nnearPoint, gap = 0) => {\r\n    let intersections;\r\n    switch (element.type) {\r\n        case \"rectangle\":\r\n        case \"image\":\r\n        case \"text\":\r\n        case \"diamond\":\r\n            const corners = getCorners(element);\r\n            intersections = corners\r\n                .flatMap((point, i) => {\r\n                const edge = [point, corners[(i + 1) % 4]];\r\n                return intersectSegment(line, offsetSegment(edge, gap));\r\n            })\r\n                .concat(corners.flatMap((point) => getCircleIntersections(point, gap, line)));\r\n            break;\r\n        case \"ellipse\":\r\n            intersections = getEllipseIntersections(element, gap, line);\r\n            break;\r\n    }\r\n    if (intersections.length < 2) {\r\n        // Ignore the \"edge\" case of only intersecting with a single corner\r\n        return [];\r\n    }\r\n    const sortedIntersections = intersections.sort((i1, i2) => GAPoint.distance(i1, nearPoint) - GAPoint.distance(i2, nearPoint));\r\n    return [\r\n        sortedIntersections[0],\r\n        sortedIntersections[sortedIntersections.length - 1],\r\n    ];\r\n};\r\nconst getCorners = (element, scale = 1) => {\r\n    const hx = (scale * element.width) / 2;\r\n    const hy = (scale * element.height) / 2;\r\n    switch (element.type) {\r\n        case \"rectangle\":\r\n        case \"image\":\r\n        case \"text\":\r\n            return [\r\n                GA.point(hx, hy),\r\n                GA.point(hx, -hy),\r\n                GA.point(-hx, -hy),\r\n                GA.point(-hx, hy),\r\n            ];\r\n        case \"diamond\":\r\n            return [\r\n                GA.point(0, hy),\r\n                GA.point(hx, 0),\r\n                GA.point(0, -hy),\r\n                GA.point(-hx, 0),\r\n            ];\r\n    }\r\n};\r\n// Returns intersection of `line` with `segment`, with `segment` moved by\r\n// `gap` in its polar direction.\r\n// If intersection conincides with second segment point returns empty array.\r\nconst intersectSegment = (line, segment) => {\r\n    const [a, b] = segment;\r\n    const aDist = GAPoint.distanceToLine(a, line);\r\n    const bDist = GAPoint.distanceToLine(b, line);\r\n    if (aDist * bDist >= 0) {\r\n        // The intersection is outside segment `(a, b)`\r\n        return [];\r\n    }\r\n    return [GAPoint.intersect(line, GALine.through(a, b))];\r\n};\r\nconst offsetSegment = (segment, distance) => {\r\n    const [a, b] = segment;\r\n    const offset = GATransform.translationOrthogonal(GADirection.fromTo(a, b), distance);\r\n    return [GATransform.apply(offset, a), GATransform.apply(offset, b)];\r\n};\r\nconst getEllipseIntersections = (element, gap, line) => {\r\n    const a = element.width / 2 + gap;\r\n    const b = element.height / 2 + gap;\r\n    const m = line[2];\r\n    const n = line[3];\r\n    const c = line[1];\r\n    const squares = a * a * m * m + b * b * n * n;\r\n    const discr = squares - c * c;\r\n    if (squares === 0 || discr <= 0) {\r\n        return [];\r\n    }\r\n    const discrRoot = Math.sqrt(discr);\r\n    const xn = -a * a * m * c;\r\n    const yn = -b * b * n * c;\r\n    return [\r\n        GA.point((xn + a * b * n * discrRoot) / squares, (yn - a * b * m * discrRoot) / squares),\r\n        GA.point((xn - a * b * n * discrRoot) / squares, (yn + a * b * m * discrRoot) / squares),\r\n    ];\r\n};\r\nexport const getCircleIntersections = (center, radius, line) => {\r\n    if (radius === 0) {\r\n        return GAPoint.distanceToLine(line, center) === 0 ? [center] : [];\r\n    }\r\n    const m = line[2];\r\n    const n = line[3];\r\n    const c = line[1];\r\n    const [a, b] = GAPoint.toTuple(center);\r\n    const r = radius;\r\n    const squares = m * m + n * n;\r\n    const discr = r * r * squares - (m * a + n * b + c) ** 2;\r\n    if (squares === 0 || discr <= 0) {\r\n        return [];\r\n    }\r\n    const discrRoot = Math.sqrt(discr);\r\n    const xn = a * n * n - b * m * n - m * c;\r\n    const yn = b * m * m - a * m * n - n * c;\r\n    return [\r\n        GA.point((xn + n * discrRoot) / squares, (yn - m * discrRoot) / squares),\r\n        GA.point((xn - n * discrRoot) / squares, (yn + m * discrRoot) / squares),\r\n    ];\r\n};\r\n// The focus point is the tangent point of the \"focus image\" of the\r\n// `element`, where the tangent goes through `point`.\r\nexport const findFocusPointForEllipse = (ellipse, \r\n// Between -1 and 1 (not 0) the relative size of the \"focus image\" of\r\n// the element on which the focus point lies\r\nrelativeDistance, \r\n// The point for which we're trying to find the focus point, relative\r\n// to the ellipse center.\r\npoint) => {\r\n    const relativeDistanceAbs = Math.abs(relativeDistance);\r\n    const a = (ellipse.width * relativeDistanceAbs) / 2;\r\n    const b = (ellipse.height * relativeDistanceAbs) / 2;\r\n    const orientation = Math.sign(relativeDistance);\r\n    const [px, pyo] = GAPoint.toTuple(point);\r\n    // The calculation below can't handle py = 0\r\n    const py = pyo === 0 ? 0.0001 : pyo;\r\n    const squares = px ** 2 * b ** 2 + py ** 2 * a ** 2;\r\n    // Tangent mx + ny + 1 = 0\r\n    const m = (-px * b ** 2 +\r\n        orientation * py * Math.sqrt(Math.max(0, squares - a ** 2 * b ** 2))) /\r\n        squares;\r\n    const n = (-m * px - 1) / py;\r\n    const x = -(a ** 2 * m) / (n ** 2 * b ** 2 + m ** 2 * a ** 2);\r\n    return GA.point(x, (-m * x - 1) / n);\r\n};\r\nexport const findFocusPointForRectangulars = (element, \r\n// Between -1 and 1 for how far away should the focus point be relative\r\n// to the size of the element. Sign determines orientation.\r\nrelativeDistance, \r\n// The point for which we're trying to find the focus point, relative\r\n// to the element center.\r\npoint) => {\r\n    const relativeDistanceAbs = Math.abs(relativeDistance);\r\n    const orientation = Math.sign(relativeDistance);\r\n    const corners = getCorners(element, relativeDistanceAbs);\r\n    let maxDistance = 0;\r\n    let tangentPoint = null;\r\n    corners.forEach((corner) => {\r\n        const distance = orientation * GALine.through(point, corner)[1];\r\n        if (distance > maxDistance) {\r\n            maxDistance = distance;\r\n            tangentPoint = corner;\r\n        }\r\n    });\r\n    return tangentPoint;\r\n};\r\nconst pointInBezierEquation = (p0, p1, p2, p3, [mx, my], lineThreshold) => {\r\n    // B(t) = p0 * (1-t)^3 + 3p1 * t * (1-t)^2 + 3p2 * t^2 * (1-t) + p3 * t^3\r\n    const equation = (t, idx) => Math.pow(1 - t, 3) * p3[idx] +\r\n        3 * t * Math.pow(1 - t, 2) * p2[idx] +\r\n        3 * Math.pow(t, 2) * (1 - t) * p1[idx] +\r\n        p0[idx] * Math.pow(t, 3);\r\n    // go through t in increments of 0.01\r\n    let t = 0;\r\n    while (t <= 1.0) {\r\n        const tx = equation(t, 0);\r\n        const ty = equation(t, 1);\r\n        const diff = Math.sqrt(Math.pow(tx - mx, 2) + Math.pow(ty - my, 2));\r\n        if (diff < lineThreshold) {\r\n            return true;\r\n        }\r\n        t += 0.01;\r\n    }\r\n    return false;\r\n};\r\nconst hitTestCurveInside = (drawable, x, y, sharpness) => {\r\n    const ops = getCurvePathOps(drawable);\r\n    const points = [];\r\n    let odd = false; // select one line out of double lines\r\n    for (const operation of ops) {\r\n        if (operation.op === \"move\") {\r\n            odd = !odd;\r\n            if (odd) {\r\n                points.push([operation.data[0], operation.data[1]]);\r\n            }\r\n        }\r\n        else if (operation.op === \"bcurveTo\") {\r\n            if (odd) {\r\n                points.push([operation.data[0], operation.data[1]]);\r\n                points.push([operation.data[2], operation.data[3]]);\r\n                points.push([operation.data[4], operation.data[5]]);\r\n            }\r\n        }\r\n    }\r\n    if (points.length >= 4) {\r\n        if (sharpness === \"sharp\") {\r\n            return isPointInPolygon(points, x, y);\r\n        }\r\n        const polygonPoints = pointsOnBezierCurves(points, 10, 5);\r\n        return isPointInPolygon(polygonPoints, x, y);\r\n    }\r\n    return false;\r\n};\r\nconst hitTestRoughShape = (drawable, x, y, lineThreshold) => {\r\n    // read operations from first opSet\r\n    const ops = getCurvePathOps(drawable);\r\n    // set start position as (0,0) just in case\r\n    // move operation does not exist (unlikely but it is worth safekeeping it)\r\n    let currentP = [0, 0];\r\n    return ops.some(({ op, data }, idx) => {\r\n        // There are only four operation types:\r\n        // move, bcurveTo, lineTo, and curveTo\r\n        if (op === \"move\") {\r\n            // change starting point\r\n            currentP = data;\r\n            // move operation does not draw anything; so, it always\r\n            // returns false\r\n        }\r\n        else if (op === \"bcurveTo\") {\r\n            // create points from bezier curve\r\n            // bezier curve stores data as a flattened array of three positions\r\n            // [x1, y1, x2, y2, x3, y3]\r\n            const p1 = [data[0], data[1]];\r\n            const p2 = [data[2], data[3]];\r\n            const p3 = [data[4], data[5]];\r\n            const p0 = currentP;\r\n            currentP = p3;\r\n            // check if points are on the curve\r\n            // cubic bezier curves require four parameters\r\n            // the first parameter is the last stored position (p0)\r\n            const retVal = pointInBezierEquation(p0, p1, p2, p3, [x, y], lineThreshold);\r\n            // set end point of bezier curve as the new starting point for\r\n            // upcoming operations as each operation is based on the last drawn\r\n            // position of the previous operation\r\n            return retVal;\r\n        }\r\n        else if (op === \"lineTo\") {\r\n            // TODO: Implement this\r\n        }\r\n        else if (op === \"qcurveTo\") {\r\n            // TODO: Implement this\r\n        }\r\n        return false;\r\n    });\r\n};\r\n","import { OMIT_SIDES_FOR_MULTIPLE_ELEMENTS, getTransformHandlesFromCoords, getTransformHandles, } from \"./transformHandles\";\r\nconst isInsideTransformHandle = (transformHandle, x, y) => x >= transformHandle[0] &&\r\n    x <= transformHandle[0] + transformHandle[2] &&\r\n    y >= transformHandle[1] &&\r\n    y <= transformHandle[1] + transformHandle[3];\r\nexport const resizeTest = (element, appState, x, y, zoom, pointerType) => {\r\n    if (!appState.selectedElementIds[element.id]) {\r\n        return false;\r\n    }\r\n    const { rotation: rotationTransformHandle, ...transformHandles } = getTransformHandles(element, zoom, pointerType);\r\n    if (rotationTransformHandle &&\r\n        isInsideTransformHandle(rotationTransformHandle, x, y)) {\r\n        return \"rotation\";\r\n    }\r\n    const filter = Object.keys(transformHandles).filter((key) => {\r\n        const transformHandle = transformHandles[key];\r\n        if (!transformHandle) {\r\n            return false;\r\n        }\r\n        return isInsideTransformHandle(transformHandle, x, y);\r\n    });\r\n    if (filter.length > 0) {\r\n        return filter[0];\r\n    }\r\n    return false;\r\n};\r\nexport const getElementWithTransformHandleType = (elements, appState, scenePointerX, scenePointerY, zoom, pointerType) => {\r\n    return elements.reduce((result, element) => {\r\n        if (result) {\r\n            return result;\r\n        }\r\n        const transformHandleType = resizeTest(element, appState, scenePointerX, scenePointerY, zoom, pointerType);\r\n        return transformHandleType ? { element, transformHandleType } : null;\r\n    }, null);\r\n};\r\nexport const getTransformHandleTypeFromCoords = ([x1, y1, x2, y2], scenePointerX, scenePointerY, zoom, pointerType) => {\r\n    const transformHandles = getTransformHandlesFromCoords([x1, y1, x2, y2], 0, zoom, pointerType, OMIT_SIDES_FOR_MULTIPLE_ELEMENTS);\r\n    const found = Object.keys(transformHandles).find((key) => {\r\n        const transformHandle = transformHandles[key];\r\n        return (transformHandle &&\r\n            isInsideTransformHandle(transformHandle, scenePointerX, scenePointerY));\r\n    });\r\n    return (found || false);\r\n};\r\nconst RESIZE_CURSORS = [\"ns\", \"nesw\", \"ew\", \"nwse\"];\r\nconst rotateResizeCursor = (cursor, angle) => {\r\n    const index = RESIZE_CURSORS.indexOf(cursor);\r\n    if (index >= 0) {\r\n        const a = Math.round(angle / (Math.PI / 4));\r\n        cursor = RESIZE_CURSORS[(index + a) % RESIZE_CURSORS.length];\r\n    }\r\n    return cursor;\r\n};\r\n/*\r\n * Returns bi-directional cursor for the element being resized\r\n */\r\nexport const getCursorForResizingElement = (resizingElement) => {\r\n    const { element, transformHandleType } = resizingElement;\r\n    const shouldSwapCursors = element && Math.sign(element.height) * Math.sign(element.width) === -1;\r\n    let cursor = null;\r\n    switch (transformHandleType) {\r\n        case \"n\":\r\n        case \"s\":\r\n            cursor = \"ns\";\r\n            break;\r\n        case \"w\":\r\n        case \"e\":\r\n            cursor = \"ew\";\r\n            break;\r\n        case \"nw\":\r\n        case \"se\":\r\n            if (shouldSwapCursors) {\r\n                cursor = \"nesw\";\r\n            }\r\n            else {\r\n                cursor = \"nwse\";\r\n            }\r\n            break;\r\n        case \"ne\":\r\n        case \"sw\":\r\n            if (shouldSwapCursors) {\r\n                cursor = \"nwse\";\r\n            }\r\n            else {\r\n                cursor = \"nesw\";\r\n            }\r\n            break;\r\n        case \"rotation\":\r\n            return \"grab\";\r\n    }\r\n    if (cursor && element) {\r\n        cursor = rotateResizeCursor(cursor, element.angle);\r\n    }\r\n    return cursor ? `${cursor}-resize` : \"\";\r\n};\r\n","import { distance2d, rotate, isPathALoop, getGridPoint } from \"../math\";\r\nimport { getElementAbsoluteCoords } from \".\";\r\nimport { getElementPointsCoords } from \"./bounds\";\r\nimport { mutateElement } from \"./mutateElement\";\r\nimport Scene from \"../scene/Scene\";\r\nimport { bindOrUnbindLinearElement, getHoveredElementForBinding, isBindingEnabled, } from \"./binding\";\r\nimport { tupleToCoors } from \"../utils\";\r\nimport { isBindingElement } from \"./typeChecks\";\r\nexport class LinearElementEditor {\r\n    constructor(element, scene) {\r\n        this.elementId = element.id;\r\n        Scene.mapElementToScene(this.elementId, scene);\r\n        LinearElementEditor.normalizePoints(element);\r\n        this.activePointIndex = null;\r\n        this.lastUncommittedPoint = null;\r\n        this.isDragging = false;\r\n        this.pointerOffset = { x: 0, y: 0 };\r\n        this.startBindingElement = \"keep\";\r\n        this.endBindingElement = \"keep\";\r\n    }\r\n    /**\r\n     * @param id the `elementId` from the instance of this class (so that we can\r\n     *  statically guarantee this method returns an ExcalidrawLinearElement)\r\n     */\r\n    static getElement(id) {\r\n        const element = Scene.getScene(id)?.getNonDeletedElement(id);\r\n        if (element) {\r\n            return element;\r\n        }\r\n        return null;\r\n    }\r\n    /** @returns whether point was dragged */\r\n    static handlePointDragging(appState, setState, scenePointerX, scenePointerY, maybeSuggestBinding) {\r\n        if (!appState.editingLinearElement) {\r\n            return false;\r\n        }\r\n        const { editingLinearElement } = appState;\r\n        const { activePointIndex, elementId, isDragging } = editingLinearElement;\r\n        const element = LinearElementEditor.getElement(elementId);\r\n        if (!element) {\r\n            return false;\r\n        }\r\n        if (activePointIndex != null && activePointIndex > -1) {\r\n            if (isDragging === false) {\r\n                setState({\r\n                    editingLinearElement: {\r\n                        ...editingLinearElement,\r\n                        isDragging: true,\r\n                    },\r\n                });\r\n            }\r\n            const newPoint = LinearElementEditor.createPointAt(element, scenePointerX - editingLinearElement.pointerOffset.x, scenePointerY - editingLinearElement.pointerOffset.y, appState.gridSize);\r\n            LinearElementEditor.movePoint(element, activePointIndex, newPoint);\r\n            if (isBindingElement(element)) {\r\n                maybeSuggestBinding(element, activePointIndex === 0 ? \"start\" : \"end\");\r\n            }\r\n            return true;\r\n        }\r\n        return false;\r\n    }\r\n    static handlePointerUp(event, editingLinearElement, appState) {\r\n        const { elementId, activePointIndex, isDragging } = editingLinearElement;\r\n        const element = LinearElementEditor.getElement(elementId);\r\n        if (!element) {\r\n            return editingLinearElement;\r\n        }\r\n        let binding = {};\r\n        if (isDragging &&\r\n            (activePointIndex === 0 || activePointIndex === element.points.length - 1)) {\r\n            if (isPathALoop(element.points, appState.zoom.value)) {\r\n                LinearElementEditor.movePoint(element, activePointIndex, activePointIndex === 0\r\n                    ? element.points[element.points.length - 1]\r\n                    : element.points[0]);\r\n            }\r\n            const bindingElement = isBindingEnabled(appState)\r\n                ? getHoveredElementForBinding(tupleToCoors(LinearElementEditor.getPointAtIndexGlobalCoordinates(element, activePointIndex)), Scene.getScene(element))\r\n                : null;\r\n            binding = {\r\n                [activePointIndex === 0 ? \"startBindingElement\" : \"endBindingElement\"]: bindingElement,\r\n            };\r\n        }\r\n        return {\r\n            ...editingLinearElement,\r\n            ...binding,\r\n            isDragging: false,\r\n            pointerOffset: { x: 0, y: 0 },\r\n        };\r\n    }\r\n    static handlePointerDown(event, appState, setState, history, scenePointer) {\r\n        const ret = {\r\n            didAddPoint: false,\r\n            hitElement: null,\r\n        };\r\n        if (!appState.editingLinearElement) {\r\n            return ret;\r\n        }\r\n        const { elementId } = appState.editingLinearElement;\r\n        const element = LinearElementEditor.getElement(elementId);\r\n        if (!element) {\r\n            return ret;\r\n        }\r\n        if (event.altKey) {\r\n            if (appState.editingLinearElement.lastUncommittedPoint == null) {\r\n                mutateElement(element, {\r\n                    points: [\r\n                        ...element.points,\r\n                        LinearElementEditor.createPointAt(element, scenePointer.x, scenePointer.y, appState.gridSize),\r\n                    ],\r\n                });\r\n            }\r\n            history.resumeRecording();\r\n            setState({\r\n                editingLinearElement: {\r\n                    ...appState.editingLinearElement,\r\n                    activePointIndex: element.points.length - 1,\r\n                    lastUncommittedPoint: null,\r\n                    endBindingElement: getHoveredElementForBinding(scenePointer, Scene.getScene(element)),\r\n                },\r\n            });\r\n            ret.didAddPoint = true;\r\n            return ret;\r\n        }\r\n        const clickedPointIndex = LinearElementEditor.getPointIndexUnderCursor(element, appState.zoom, scenePointer.x, scenePointer.y);\r\n        // if we clicked on a point, set the element as hitElement otherwise\r\n        // it would get deselected if the point is outside the hitbox area\r\n        if (clickedPointIndex > -1) {\r\n            ret.hitElement = element;\r\n        }\r\n        else {\r\n            // You might be wandering why we are storing the binding elements on\r\n            // LinearElementEditor and passing them in, insted of calculating them\r\n            // from the end points of the `linearElement` - this is to allow disabling\r\n            // binding (which needs to happen at the point the user finishes moving\r\n            // the point).\r\n            const { startBindingElement, endBindingElement } = appState.editingLinearElement;\r\n            if (isBindingEnabled(appState) && isBindingElement(element)) {\r\n                bindOrUnbindLinearElement(element, startBindingElement, endBindingElement);\r\n            }\r\n        }\r\n        const [x1, y1, x2, y2] = getElementAbsoluteCoords(element);\r\n        const cx = (x1 + x2) / 2;\r\n        const cy = (y1 + y2) / 2;\r\n        const targetPoint = clickedPointIndex > -1 &&\r\n            rotate(element.x + element.points[clickedPointIndex][0], element.y + element.points[clickedPointIndex][1], cx, cy, element.angle);\r\n        setState({\r\n            editingLinearElement: {\r\n                ...appState.editingLinearElement,\r\n                activePointIndex: clickedPointIndex > -1 ? clickedPointIndex : null,\r\n                pointerOffset: targetPoint\r\n                    ? {\r\n                        x: scenePointer.x - targetPoint[0],\r\n                        y: scenePointer.y - targetPoint[1],\r\n                    }\r\n                    : { x: 0, y: 0 },\r\n            },\r\n        });\r\n        return ret;\r\n    }\r\n    static handlePointerMove(event, scenePointerX, scenePointerY, editingLinearElement, gridSize) {\r\n        const { elementId, lastUncommittedPoint } = editingLinearElement;\r\n        const element = LinearElementEditor.getElement(elementId);\r\n        if (!element) {\r\n            return editingLinearElement;\r\n        }\r\n        const { points } = element;\r\n        const lastPoint = points[points.length - 1];\r\n        if (!event.altKey) {\r\n            if (lastPoint === lastUncommittedPoint) {\r\n                LinearElementEditor.movePoint(element, points.length - 1, \"delete\");\r\n            }\r\n            return { ...editingLinearElement, lastUncommittedPoint: null };\r\n        }\r\n        const newPoint = LinearElementEditor.createPointAt(element, scenePointerX - editingLinearElement.pointerOffset.x, scenePointerY - editingLinearElement.pointerOffset.y, gridSize);\r\n        if (lastPoint === lastUncommittedPoint) {\r\n            LinearElementEditor.movePoint(element, element.points.length - 1, newPoint);\r\n        }\r\n        else {\r\n            LinearElementEditor.movePoint(element, \"new\", newPoint);\r\n        }\r\n        return {\r\n            ...editingLinearElement,\r\n            lastUncommittedPoint: element.points[element.points.length - 1],\r\n        };\r\n    }\r\n    static getPointsGlobalCoordinates(element) {\r\n        const [x1, y1, x2, y2] = getElementAbsoluteCoords(element);\r\n        const cx = (x1 + x2) / 2;\r\n        const cy = (y1 + y2) / 2;\r\n        return element.points.map((point) => {\r\n            let { x, y } = element;\r\n            [x, y] = rotate(x + point[0], y + point[1], cx, cy, element.angle);\r\n            return [x, y];\r\n        });\r\n    }\r\n    static getPointAtIndexGlobalCoordinates(element, indexMaybeFromEnd) {\r\n        const index = indexMaybeFromEnd < 0\r\n            ? element.points.length + indexMaybeFromEnd\r\n            : indexMaybeFromEnd;\r\n        const [x1, y1, x2, y2] = getElementAbsoluteCoords(element);\r\n        const cx = (x1 + x2) / 2;\r\n        const cy = (y1 + y2) / 2;\r\n        const point = element.points[index];\r\n        const { x, y } = element;\r\n        return rotate(x + point[0], y + point[1], cx, cy, element.angle);\r\n    }\r\n    static pointFromAbsoluteCoords(element, absoluteCoords) {\r\n        const [x1, y1, x2, y2] = getElementAbsoluteCoords(element);\r\n        const cx = (x1 + x2) / 2;\r\n        const cy = (y1 + y2) / 2;\r\n        const [x, y] = rotate(absoluteCoords[0], absoluteCoords[1], cx, cy, -element.angle);\r\n        return [x - element.x, y - element.y];\r\n    }\r\n    static getPointIndexUnderCursor(element, zoom, x, y) {\r\n        const pointHandles = this.getPointsGlobalCoordinates(element);\r\n        let idx = pointHandles.length;\r\n        // loop from right to left because points on the right are rendered over\r\n        // points on the left, thus should take precedence when clicking, if they\r\n        // overlap\r\n        while (--idx > -1) {\r\n            const point = pointHandles[idx];\r\n            if (distance2d(x, y, point[0], point[1]) * zoom.value <\r\n                // +1px to account for outline stroke\r\n                this.POINT_HANDLE_SIZE / 2 + 1) {\r\n                return idx;\r\n            }\r\n        }\r\n        return -1;\r\n    }\r\n    static createPointAt(element, scenePointerX, scenePointerY, gridSize) {\r\n        const pointerOnGrid = getGridPoint(scenePointerX, scenePointerY, gridSize);\r\n        const [x1, y1, x2, y2] = getElementAbsoluteCoords(element);\r\n        const cx = (x1 + x2) / 2;\r\n        const cy = (y1 + y2) / 2;\r\n        const [rotatedX, rotatedY] = rotate(pointerOnGrid[0], pointerOnGrid[1], cx, cy, -element.angle);\r\n        return [rotatedX - element.x, rotatedY - element.y];\r\n    }\r\n    /**\r\n     * Normalizes line points so that the start point is at [0,0]. This is\r\n     * expected in various parts of the codebase. Also returns new x/y to account\r\n     * for the potential normalization.\r\n     */\r\n    static getNormalizedPoints(element) {\r\n        const { points } = element;\r\n        const offsetX = points[0][0];\r\n        const offsetY = points[0][1];\r\n        return {\r\n            points: points.map((point, _idx) => {\r\n                return [point[0] - offsetX, point[1] - offsetY];\r\n            }),\r\n            x: element.x + offsetX,\r\n            y: element.y + offsetY,\r\n        };\r\n    }\r\n    // element-mutating methods\r\n    // ---------------------------------------------------------------------------\r\n    static normalizePoints(element) {\r\n        mutateElement(element, LinearElementEditor.getNormalizedPoints(element));\r\n    }\r\n    static movePointByOffset(element, pointIndex, offset) {\r\n        const [x, y] = element.points[pointIndex];\r\n        LinearElementEditor.movePoint(element, pointIndex, [\r\n            x + offset.x,\r\n            y + offset.y,\r\n        ]);\r\n    }\r\n    static movePoint(element, pointIndex, targetPosition, otherUpdates) {\r\n        const { points } = element;\r\n        // in case we're moving start point, instead of modifying its position\r\n        // which would break the invariant of it being at [0,0], we move\r\n        // all the other points in the opposite direction by delta to\r\n        // offset it. We do the same with actual element.x/y position, so\r\n        // this hacks are completely transparent to the user.\r\n        let offsetX = 0;\r\n        let offsetY = 0;\r\n        let nextPoints;\r\n        if (targetPosition === \"delete\") {\r\n            // remove point\r\n            if (pointIndex === \"new\") {\r\n                throw new Error(\"invalid args in movePoint\");\r\n            }\r\n            nextPoints = points.slice();\r\n            nextPoints.splice(pointIndex, 1);\r\n            if (pointIndex === 0) {\r\n                // if deleting first point, make the next to be [0,0] and recalculate\r\n                // positions of the rest with respect to it\r\n                offsetX = nextPoints[0][0];\r\n                offsetY = nextPoints[0][1];\r\n                nextPoints = nextPoints.map((point, idx) => {\r\n                    if (idx === 0) {\r\n                        return [0, 0];\r\n                    }\r\n                    return [point[0] - offsetX, point[1] - offsetY];\r\n                });\r\n            }\r\n        }\r\n        else if (pointIndex === \"new\") {\r\n            nextPoints = [...points, targetPosition];\r\n        }\r\n        else {\r\n            const deltaX = targetPosition[0] - points[pointIndex][0];\r\n            const deltaY = targetPosition[1] - points[pointIndex][1];\r\n            nextPoints = points.map((point, idx) => {\r\n                if (idx === pointIndex) {\r\n                    if (idx === 0) {\r\n                        offsetX = deltaX;\r\n                        offsetY = deltaY;\r\n                        return point;\r\n                    }\r\n                    offsetX = 0;\r\n                    offsetY = 0;\r\n                    return [point[0] + deltaX, point[1] + deltaY];\r\n                }\r\n                return offsetX || offsetY\r\n                    ? [point[0] - offsetX, point[1] - offsetY]\r\n                    : point;\r\n            });\r\n        }\r\n        const nextCoords = getElementPointsCoords(element, nextPoints, element.strokeSharpness || \"round\");\r\n        const prevCoords = getElementPointsCoords(element, points, element.strokeSharpness || \"round\");\r\n        const nextCenterX = (nextCoords[0] + nextCoords[2]) / 2;\r\n        const nextCenterY = (nextCoords[1] + nextCoords[3]) / 2;\r\n        const prevCenterX = (prevCoords[0] + prevCoords[2]) / 2;\r\n        const prevCenterY = (prevCoords[1] + prevCoords[3]) / 2;\r\n        const dX = prevCenterX - nextCenterX;\r\n        const dY = prevCenterY - nextCenterY;\r\n        const rotated = rotate(offsetX, offsetY, dX, dY, element.angle);\r\n        mutateElement(element, {\r\n            ...otherUpdates,\r\n            points: nextPoints,\r\n            x: element.x + rotated[0],\r\n            y: element.y + rotated[1],\r\n        });\r\n    }\r\n}\r\n// ---------------------------------------------------------------------------\r\n// static methods\r\n// ---------------------------------------------------------------------------\r\nLinearElementEditor.POINT_HANDLE_SIZE = 20;\r\n","import { getElementAtPosition } from \"../scene\";\r\nimport { isBindableElement, isBindingElement } from \"./typeChecks\";\r\nimport { bindingBorderTest, distanceToBindableElement, maxBindingGap, determineFocusDistance, intersectElementWithLine, determineFocusPoint, } from \"./collision\";\r\nimport { mutateElement } from \"./mutateElement\";\r\nimport Scene from \"../scene/Scene\";\r\nimport { LinearElementEditor } from \"./linearElementEditor\";\r\nimport { tupleToCoors } from \"../utils\";\r\nimport { KEYS } from \"../keys\";\r\nexport const shouldEnableBindingForPointerEvent = (event) => {\r\n    return !event[KEYS.CTRL_OR_CMD];\r\n};\r\nexport const isBindingEnabled = (appState) => {\r\n    return appState.isBindingEnabled;\r\n};\r\nexport const bindOrUnbindLinearElement = (linearElement, startBindingElement, endBindingElement) => {\r\n    const boundToElementIds = new Set();\r\n    const unboundFromElementIds = new Set();\r\n    bindOrUnbindLinearElementEdge(linearElement, startBindingElement, endBindingElement, \"start\", boundToElementIds, unboundFromElementIds);\r\n    bindOrUnbindLinearElementEdge(linearElement, endBindingElement, startBindingElement, \"end\", boundToElementIds, unboundFromElementIds);\r\n    const onlyUnbound = Array.from(unboundFromElementIds).filter((id) => !boundToElementIds.has(id));\r\n    Scene.getScene(linearElement)\r\n        .getNonDeletedElements(onlyUnbound)\r\n        .forEach((element) => {\r\n        mutateElement(element, {\r\n            boundElementIds: element.boundElementIds?.filter((id) => id !== linearElement.id),\r\n        });\r\n    });\r\n};\r\nconst bindOrUnbindLinearElementEdge = (linearElement, bindableElement, otherEdgeBindableElement, startOrEnd, \r\n// Is mutated\r\nboundToElementIds, \r\n// Is mutated\r\nunboundFromElementIds) => {\r\n    if (bindableElement !== \"keep\") {\r\n        if (bindableElement != null) {\r\n            // Don't bind if we're trying to bind or are already bound to the same\r\n            // element on the other edge already (\"start\" edge takes precedence).\r\n            if (otherEdgeBindableElement == null ||\r\n                (otherEdgeBindableElement === \"keep\"\r\n                    ? !isLinearElementSimpleAndAlreadyBoundOnOppositeEdge(linearElement, bindableElement, startOrEnd)\r\n                    : startOrEnd === \"start\" ||\r\n                        otherEdgeBindableElement.id !== bindableElement.id)) {\r\n                bindLinearElement(linearElement, bindableElement, startOrEnd);\r\n                boundToElementIds.add(bindableElement.id);\r\n            }\r\n        }\r\n        else {\r\n            const unbound = unbindLinearElement(linearElement, startOrEnd);\r\n            if (unbound != null) {\r\n                unboundFromElementIds.add(unbound);\r\n            }\r\n        }\r\n    }\r\n};\r\nexport const bindOrUnbindSelectedElements = (elements) => {\r\n    elements.forEach((element) => {\r\n        if (isBindingElement(element)) {\r\n            bindOrUnbindLinearElement(element, getElligibleElementForBindingElement(element, \"start\"), getElligibleElementForBindingElement(element, \"end\"));\r\n        }\r\n        else if (isBindableElement(element)) {\r\n            maybeBindBindableElement(element);\r\n        }\r\n    });\r\n};\r\nconst maybeBindBindableElement = (bindableElement) => {\r\n    getElligibleElementsForBindableElementAndWhere(bindableElement).forEach(([linearElement, where]) => bindOrUnbindLinearElement(linearElement, where === \"end\" ? \"keep\" : bindableElement, where === \"start\" ? \"keep\" : bindableElement));\r\n};\r\nexport const maybeBindLinearElement = (linearElement, appState, scene, pointerCoords) => {\r\n    if (appState.startBoundElement != null) {\r\n        bindLinearElement(linearElement, appState.startBoundElement, \"start\");\r\n    }\r\n    const hoveredElement = getHoveredElementForBinding(pointerCoords, scene);\r\n    if (hoveredElement != null &&\r\n        !isLinearElementSimpleAndAlreadyBoundOnOppositeEdge(linearElement, hoveredElement, \"end\")) {\r\n        bindLinearElement(linearElement, hoveredElement, \"end\");\r\n    }\r\n};\r\nconst bindLinearElement = (linearElement, hoveredElement, startOrEnd) => {\r\n    mutateElement(linearElement, {\r\n        [startOrEnd === \"start\" ? \"startBinding\" : \"endBinding\"]: {\r\n            elementId: hoveredElement.id,\r\n            ...calculateFocusAndGap(linearElement, hoveredElement, startOrEnd),\r\n        },\r\n    });\r\n    mutateElement(hoveredElement, {\r\n        boundElementIds: Array.from(new Set([...(hoveredElement.boundElementIds ?? []), linearElement.id])),\r\n    });\r\n};\r\n// Don't bind both ends of a simple segment\r\nconst isLinearElementSimpleAndAlreadyBoundOnOppositeEdge = (linearElement, bindableElement, startOrEnd) => {\r\n    const otherBinding = linearElement[startOrEnd === \"start\" ? \"endBinding\" : \"startBinding\"];\r\n    return isLinearElementSimpleAndAlreadyBound(linearElement, otherBinding?.elementId, bindableElement);\r\n};\r\nexport const isLinearElementSimpleAndAlreadyBound = (linearElement, alreadyBoundToId, bindableElement) => {\r\n    return (alreadyBoundToId === bindableElement.id && linearElement.points.length < 3);\r\n};\r\nexport const unbindLinearElements = (elements) => {\r\n    elements.forEach((element) => {\r\n        if (isBindingElement(element)) {\r\n            bindOrUnbindLinearElement(element, null, null);\r\n        }\r\n    });\r\n};\r\nconst unbindLinearElement = (linearElement, startOrEnd) => {\r\n    const field = startOrEnd === \"start\" ? \"startBinding\" : \"endBinding\";\r\n    const binding = linearElement[field];\r\n    if (binding == null) {\r\n        return null;\r\n    }\r\n    mutateElement(linearElement, { [field]: null });\r\n    return binding.elementId;\r\n};\r\nexport const getHoveredElementForBinding = (pointerCoords, scene) => {\r\n    const hoveredElement = getElementAtPosition(scene.getElements(), (element) => isBindableElement(element) && bindingBorderTest(element, pointerCoords));\r\n    return hoveredElement;\r\n};\r\nconst calculateFocusAndGap = (linearElement, hoveredElement, startOrEnd) => {\r\n    const direction = startOrEnd === \"start\" ? -1 : 1;\r\n    const edgePointIndex = direction === -1 ? 0 : linearElement.points.length - 1;\r\n    const adjacentPointIndex = edgePointIndex - direction;\r\n    const edgePoint = LinearElementEditor.getPointAtIndexGlobalCoordinates(linearElement, edgePointIndex);\r\n    const adjacentPoint = LinearElementEditor.getPointAtIndexGlobalCoordinates(linearElement, adjacentPointIndex);\r\n    return {\r\n        focus: determineFocusDistance(hoveredElement, adjacentPoint, edgePoint),\r\n        gap: Math.max(1, distanceToBindableElement(hoveredElement, edgePoint)),\r\n    };\r\n};\r\n// Supports translating, rotating and scaling `changedElement` with bound\r\n// linear elements.\r\n// Because scaling involves moving the focus points as well, it is\r\n// done before the `changedElement` is updated, and the `newSize` is passed\r\n// in explicitly.\r\nexport const updateBoundElements = (changedElement, options) => {\r\n    const boundElementIds = changedElement.boundElementIds ?? [];\r\n    if (boundElementIds.length === 0) {\r\n        return;\r\n    }\r\n    const { newSize, simultaneouslyUpdated } = options ?? {};\r\n    const simultaneouslyUpdatedElementIds = getSimultaneouslyUpdatedElementIds(simultaneouslyUpdated);\r\n    Scene.getScene(changedElement).getNonDeletedElements(boundElementIds).forEach((linearElement) => {\r\n        const bindableElement = changedElement;\r\n        // In case the boundElementIds are stale\r\n        if (!doesNeedUpdate(linearElement, bindableElement)) {\r\n            return;\r\n        }\r\n        const startBinding = maybeCalculateNewGapWhenScaling(bindableElement, linearElement.startBinding, newSize);\r\n        const endBinding = maybeCalculateNewGapWhenScaling(bindableElement, linearElement.endBinding, newSize);\r\n        // `linearElement` is being moved/scaled already, just update the binding\r\n        if (simultaneouslyUpdatedElementIds.has(linearElement.id)) {\r\n            mutateElement(linearElement, { startBinding, endBinding });\r\n            return;\r\n        }\r\n        updateBoundPoint(linearElement, \"start\", startBinding, changedElement);\r\n        updateBoundPoint(linearElement, \"end\", endBinding, changedElement);\r\n    });\r\n};\r\nconst doesNeedUpdate = (boundElement, changedElement) => {\r\n    return (boundElement.startBinding?.elementId === changedElement.id ||\r\n        boundElement.endBinding?.elementId === changedElement.id);\r\n};\r\nconst getSimultaneouslyUpdatedElementIds = (simultaneouslyUpdated) => {\r\n    return new Set((simultaneouslyUpdated || []).map((element) => element.id));\r\n};\r\nconst updateBoundPoint = (linearElement, startOrEnd, binding, changedElement) => {\r\n    if (binding == null ||\r\n        // We only need to update the other end if this is a 2 point line element\r\n        (binding.elementId !== changedElement.id && linearElement.points.length > 2)) {\r\n        return;\r\n    }\r\n    const bindingElement = Scene.getScene(linearElement).getElement(binding.elementId);\r\n    if (bindingElement == null) {\r\n        // We're not cleaning up after deleted elements atm., so handle this case\r\n        return;\r\n    }\r\n    const direction = startOrEnd === \"start\" ? -1 : 1;\r\n    const edgePointIndex = direction === -1 ? 0 : linearElement.points.length - 1;\r\n    const adjacentPointIndex = edgePointIndex - direction;\r\n    const adjacentPoint = LinearElementEditor.getPointAtIndexGlobalCoordinates(linearElement, adjacentPointIndex);\r\n    const focusPointAbsolute = determineFocusPoint(bindingElement, binding.focus, adjacentPoint);\r\n    let newEdgePoint;\r\n    // The linear element was not originally pointing inside the bound shape,\r\n    // we can point directly at the focus point\r\n    if (binding.gap === 0) {\r\n        newEdgePoint = focusPointAbsolute;\r\n    }\r\n    else {\r\n        const intersections = intersectElementWithLine(bindingElement, adjacentPoint, focusPointAbsolute, binding.gap);\r\n        if (intersections.length === 0) {\r\n            // This should never happen, since focusPoint should always be\r\n            // inside the element, but just in case, bail out\r\n            newEdgePoint = focusPointAbsolute;\r\n        }\r\n        else {\r\n            // Guaranteed to intersect because focusPoint is always inside the shape\r\n            newEdgePoint = intersections[0];\r\n        }\r\n    }\r\n    LinearElementEditor.movePoint(linearElement, edgePointIndex, LinearElementEditor.pointFromAbsoluteCoords(linearElement, newEdgePoint), { [startOrEnd === \"start\" ? \"startBinding\" : \"endBinding\"]: binding });\r\n};\r\nconst maybeCalculateNewGapWhenScaling = (changedElement, currentBinding, newSize) => {\r\n    if (currentBinding == null || newSize == null) {\r\n        return currentBinding;\r\n    }\r\n    const { gap, focus, elementId } = currentBinding;\r\n    const { width: newWidth, height: newHeight } = newSize;\r\n    const { width, height } = changedElement;\r\n    const newGap = Math.max(1, Math.min(maxBindingGap(changedElement, newWidth, newHeight), gap * (newWidth < newHeight ? newWidth / width : newHeight / height)));\r\n    return { elementId, gap: newGap, focus };\r\n};\r\nexport const getEligibleElementsForBinding = (elements) => {\r\n    const includedElementIds = new Set(elements.map(({ id }) => id));\r\n    return elements.flatMap((element) => isBindingElement(element)\r\n        ? getElligibleElementsForBindingElement(element).filter((element) => !includedElementIds.has(element.id))\r\n        : isBindableElement(element)\r\n            ? getElligibleElementsForBindableElementAndWhere(element).filter((binding) => !includedElementIds.has(binding[0].id))\r\n            : []);\r\n};\r\nconst getElligibleElementsForBindingElement = (linearElement) => {\r\n    return [\r\n        getElligibleElementForBindingElement(linearElement, \"start\"),\r\n        getElligibleElementForBindingElement(linearElement, \"end\"),\r\n    ].filter((element) => element != null);\r\n};\r\nconst getElligibleElementForBindingElement = (linearElement, startOrEnd) => {\r\n    return getHoveredElementForBinding(getLinearElementEdgeCoors(linearElement, startOrEnd), Scene.getScene(linearElement));\r\n};\r\nconst getLinearElementEdgeCoors = (linearElement, startOrEnd) => {\r\n    const index = startOrEnd === \"start\" ? 0 : -1;\r\n    return tupleToCoors(LinearElementEditor.getPointAtIndexGlobalCoordinates(linearElement, index));\r\n};\r\nconst getElligibleElementsForBindableElementAndWhere = (bindableElement) => {\r\n    return Scene.getScene(bindableElement)\r\n        .getElements()\r\n        .map((element) => {\r\n        if (!isBindingElement(element)) {\r\n            return null;\r\n        }\r\n        const canBindStart = isLinearElementEligibleForNewBindingByBindable(element, \"start\", bindableElement);\r\n        const canBindEnd = isLinearElementEligibleForNewBindingByBindable(element, \"end\", bindableElement);\r\n        if (!canBindStart && !canBindEnd) {\r\n            return null;\r\n        }\r\n        return [\r\n            element,\r\n            canBindStart && canBindEnd ? \"both\" : canBindStart ? \"start\" : \"end\",\r\n            bindableElement,\r\n        ];\r\n    })\r\n        .filter((maybeElement) => maybeElement != null);\r\n};\r\nconst isLinearElementEligibleForNewBindingByBindable = (linearElement, startOrEnd, bindableElement) => {\r\n    const existingBinding = linearElement[startOrEnd === \"start\" ? \"startBinding\" : \"endBinding\"];\r\n    return (existingBinding == null &&\r\n        !isLinearElementSimpleAndAlreadyBoundOnOppositeEdge(linearElement, bindableElement, startOrEnd) &&\r\n        bindingBorderTest(bindableElement, getLinearElementEdgeCoors(linearElement, startOrEnd)));\r\n};\r\n// We need to:\r\n// 1: Update elements not selected to point to duplicated elements\r\n// 2: Update duplicated elements to point to other duplicated elements\r\nexport const fixBindingsAfterDuplication = (sceneElements, oldElements, oldIdToDuplicatedId, \r\n// There are three copying mechanisms: Copy-paste, duplication and alt-drag.\r\n// Only when alt-dragging the new \"duplicates\" act as the \"old\", while\r\n// the \"old\" elements act as the \"new copy\" - essentially working reverse\r\n// to the other two.\r\nduplicatesServeAsOld) => {\r\n    // First collect all the binding/bindable elements, so we only update\r\n    // each once, regardless of whether they were duplicated or not.\r\n    const allBoundElementIds = new Set();\r\n    const allBindableElementIds = new Set();\r\n    const shouldReverseRoles = duplicatesServeAsOld === \"duplicatesServeAsOld\";\r\n    oldElements.forEach((oldElement) => {\r\n        const { boundElementIds } = oldElement;\r\n        if (boundElementIds != null && boundElementIds.length > 0) {\r\n            boundElementIds.forEach((boundElementId) => {\r\n                if (shouldReverseRoles && !oldIdToDuplicatedId.has(boundElementId)) {\r\n                    allBoundElementIds.add(boundElementId);\r\n                }\r\n            });\r\n            allBindableElementIds.add(oldIdToDuplicatedId.get(oldElement.id));\r\n        }\r\n        if (isBindingElement(oldElement)) {\r\n            if (oldElement.startBinding != null) {\r\n                const { elementId } = oldElement.startBinding;\r\n                if (shouldReverseRoles && !oldIdToDuplicatedId.has(elementId)) {\r\n                    allBindableElementIds.add(elementId);\r\n                }\r\n            }\r\n            if (oldElement.endBinding != null) {\r\n                const { elementId } = oldElement.endBinding;\r\n                if (shouldReverseRoles && !oldIdToDuplicatedId.has(elementId)) {\r\n                    allBindableElementIds.add(elementId);\r\n                }\r\n            }\r\n            if (oldElement.startBinding != null || oldElement.endBinding != null) {\r\n                allBoundElementIds.add(oldIdToDuplicatedId.get(oldElement.id));\r\n            }\r\n        }\r\n    });\r\n    // Update the linear elements\r\n    sceneElements.filter(({ id }) => allBoundElementIds.has(id)).forEach((element) => {\r\n        const { startBinding, endBinding } = element;\r\n        mutateElement(element, {\r\n            startBinding: newBindingAfterDuplication(startBinding, oldIdToDuplicatedId),\r\n            endBinding: newBindingAfterDuplication(endBinding, oldIdToDuplicatedId),\r\n        });\r\n    });\r\n    // Update the bindable shapes\r\n    sceneElements\r\n        .filter(({ id }) => allBindableElementIds.has(id))\r\n        .forEach((bindableElement) => {\r\n        const { boundElementIds } = bindableElement;\r\n        if (boundElementIds != null && boundElementIds.length > 0) {\r\n            mutateElement(bindableElement, {\r\n                boundElementIds: boundElementIds.map((boundElementId) => oldIdToDuplicatedId.get(boundElementId) ?? boundElementId),\r\n            });\r\n        }\r\n    });\r\n};\r\nconst newBindingAfterDuplication = (binding, oldIdToDuplicatedId) => {\r\n    if (binding == null) {\r\n        return null;\r\n    }\r\n    const { elementId, focus, gap } = binding;\r\n    return {\r\n        focus,\r\n        gap,\r\n        elementId: oldIdToDuplicatedId.get(elementId) ?? elementId,\r\n    };\r\n};\r\nexport const fixBindingsAfterDeletion = (sceneElements, deletedElements) => {\r\n    const deletedElementIds = new Set(deletedElements.map((element) => element.id));\r\n    // Non deleted and need an update\r\n    const boundElementIds = new Set();\r\n    deletedElements.forEach((deletedElement) => {\r\n        if (isBindableElement(deletedElement)) {\r\n            deletedElement.boundElementIds?.forEach((id) => {\r\n                if (!deletedElementIds.has(id)) {\r\n                    boundElementIds.add(id);\r\n                }\r\n            });\r\n        }\r\n    });\r\n    sceneElements.filter(({ id }) => boundElementIds.has(id)).forEach((element) => {\r\n        const { startBinding, endBinding } = element;\r\n        mutateElement(element, {\r\n            startBinding: newBindingAfterDeletion(startBinding, deletedElementIds),\r\n            endBinding: newBindingAfterDeletion(endBinding, deletedElementIds),\r\n        });\r\n    });\r\n};\r\nconst newBindingAfterDeletion = (binding, deletedElementIds) => {\r\n    if (binding == null || deletedElementIds.has(binding.elementId)) {\r\n        return null;\r\n    }\r\n    return binding;\r\n};\r\n","import { SHIFT_LOCKING_ANGLE } from \"../constants\";\r\nimport { rescalePoints } from \"../points\";\r\nimport { rotate, adjustXYWithRotation, centerPoint, rotatePoint, } from \"../math\";\r\nimport { getElementAbsoluteCoords, getCommonBounds, getResizedElementAbsoluteCoords, } from \"./bounds\";\r\nimport { isFreeDrawElement, isLinearElement, isTextElement, } from \"./typeChecks\";\r\nimport { mutateElement } from \"./mutateElement\";\r\nimport { getPerfectElementSize } from \"./sizeHelpers\";\r\nimport { measureText, getFontString } from \"../utils\";\r\nimport { updateBoundElements } from \"./binding\";\r\nexport const normalizeAngle = (angle) => {\r\n    if (angle >= 2 * Math.PI) {\r\n        return angle - 2 * Math.PI;\r\n    }\r\n    return angle;\r\n};\r\n// Returns true when transform (resizing/rotation) happened\r\nexport const transformElements = (pointerDownState, transformHandleType, selectedElements, resizeArrowDirection, shouldRotateWithDiscreteAngle, shouldResizeFromCenter, shouldMaintainAspectRatio, pointerX, pointerY, centerX, centerY) => {\r\n    if (selectedElements.length === 1) {\r\n        const [element] = selectedElements;\r\n        if (transformHandleType === \"rotation\") {\r\n            rotateSingleElement(element, pointerX, pointerY, shouldRotateWithDiscreteAngle);\r\n            updateBoundElements(element);\r\n        }\r\n        else if (isLinearElement(element) &&\r\n            element.points.length === 2 &&\r\n            (transformHandleType === \"nw\" ||\r\n                transformHandleType === \"ne\" ||\r\n                transformHandleType === \"sw\" ||\r\n                transformHandleType === \"se\")) {\r\n            reshapeSingleTwoPointElement(element, resizeArrowDirection, shouldRotateWithDiscreteAngle, pointerX, pointerY);\r\n        }\r\n        else if (isTextElement(element) &&\r\n            (transformHandleType === \"nw\" ||\r\n                transformHandleType === \"ne\" ||\r\n                transformHandleType === \"sw\" ||\r\n                transformHandleType === \"se\")) {\r\n            resizeSingleTextElement(element, transformHandleType, shouldResizeFromCenter, pointerX, pointerY);\r\n            updateBoundElements(element);\r\n        }\r\n        else if (transformHandleType) {\r\n            resizeSingleElement(pointerDownState.originalElements.get(element.id), shouldMaintainAspectRatio, element, transformHandleType, shouldResizeFromCenter, pointerX, pointerY);\r\n        }\r\n        return true;\r\n    }\r\n    else if (selectedElements.length > 1) {\r\n        if (transformHandleType === \"rotation\") {\r\n            rotateMultipleElements(pointerDownState, selectedElements, pointerX, pointerY, shouldRotateWithDiscreteAngle, centerX, centerY);\r\n            return true;\r\n        }\r\n        else if (transformHandleType === \"nw\" ||\r\n            transformHandleType === \"ne\" ||\r\n            transformHandleType === \"sw\" ||\r\n            transformHandleType === \"se\") {\r\n            resizeMultipleElements(selectedElements, transformHandleType, pointerX, pointerY);\r\n            return true;\r\n        }\r\n    }\r\n    return false;\r\n};\r\nconst rotateSingleElement = (element, pointerX, pointerY, shouldRotateWithDiscreteAngle) => {\r\n    const [x1, y1, x2, y2] = getElementAbsoluteCoords(element);\r\n    const cx = (x1 + x2) / 2;\r\n    const cy = (y1 + y2) / 2;\r\n    let angle = (5 * Math.PI) / 2 + Math.atan2(pointerY - cy, pointerX - cx);\r\n    if (shouldRotateWithDiscreteAngle) {\r\n        angle += SHIFT_LOCKING_ANGLE / 2;\r\n        angle -= angle % SHIFT_LOCKING_ANGLE;\r\n    }\r\n    angle = normalizeAngle(angle);\r\n    mutateElement(element, { angle });\r\n};\r\n// used in DEV only\r\nconst validateTwoPointElementNormalized = (element) => {\r\n    if (element.points.length !== 2 ||\r\n        element.points[0][0] !== 0 ||\r\n        element.points[0][1] !== 0 ||\r\n        Math.abs(element.points[1][0]) !== element.width ||\r\n        Math.abs(element.points[1][1]) !== element.height) {\r\n        throw new Error(\"Two-point element is not normalized\");\r\n    }\r\n};\r\nconst getPerfectElementSizeWithRotation = (elementType, width, height, angle) => {\r\n    const size = getPerfectElementSize(elementType, ...rotate(width, height, 0, 0, angle));\r\n    return rotate(size.width, size.height, 0, 0, -angle);\r\n};\r\nexport const reshapeSingleTwoPointElement = (element, resizeArrowDirection, shouldRotateWithDiscreteAngle, pointerX, pointerY) => {\r\n    if (process.env.NODE_ENV !== \"production\") {\r\n        validateTwoPointElementNormalized(element);\r\n    }\r\n    const [x1, y1, x2, y2] = getElementAbsoluteCoords(element);\r\n    const cx = (x1 + x2) / 2;\r\n    const cy = (y1 + y2) / 2;\r\n    // rotation pointer with reverse angle\r\n    const [rotatedX, rotatedY] = rotate(pointerX, pointerY, cx, cy, -element.angle);\r\n    let [width, height] = resizeArrowDirection === \"end\"\r\n        ? [rotatedX - element.x, rotatedY - element.y]\r\n        : [\r\n            element.x + element.points[1][0] - rotatedX,\r\n            element.y + element.points[1][1] - rotatedY,\r\n        ];\r\n    if (shouldRotateWithDiscreteAngle) {\r\n        [width, height] = getPerfectElementSizeWithRotation(element.type, width, height, element.angle);\r\n    }\r\n    const [nextElementX, nextElementY] = adjustXYWithRotation(resizeArrowDirection === \"end\"\r\n        ? { s: true, e: true }\r\n        : { n: true, w: true }, element.x, element.y, element.angle, 0, 0, (element.points[1][0] - width) / 2, (element.points[1][1] - height) / 2);\r\n    mutateElement(element, {\r\n        x: nextElementX,\r\n        y: nextElementY,\r\n        points: [\r\n            [0, 0],\r\n            [width, height],\r\n        ],\r\n    });\r\n};\r\nconst rescalePointsInElement = (element, width, height) => isLinearElement(element) || isFreeDrawElement(element)\r\n    ? {\r\n        points: rescalePoints(0, width, rescalePoints(1, height, element.points)),\r\n    }\r\n    : {};\r\nconst MIN_FONT_SIZE = 1;\r\nconst measureFontSizeFromWH = (element, nextWidth, nextHeight) => {\r\n    // We only use width to scale font on resize\r\n    const nextFontSize = element.fontSize * (nextWidth / element.width);\r\n    if (nextFontSize < MIN_FONT_SIZE) {\r\n        return null;\r\n    }\r\n    const metrics = measureText(element.text, getFontString({ fontSize: nextFontSize, fontFamily: element.fontFamily }));\r\n    return {\r\n        size: nextFontSize,\r\n        baseline: metrics.baseline + (nextHeight - metrics.height),\r\n    };\r\n};\r\nconst getSidesForTransformHandle = (transformHandleType, shouldResizeFromCenter) => {\r\n    return {\r\n        n: /^(n|ne|nw)$/.test(transformHandleType) ||\r\n            (shouldResizeFromCenter && /^(s|se|sw)$/.test(transformHandleType)),\r\n        s: /^(s|se|sw)$/.test(transformHandleType) ||\r\n            (shouldResizeFromCenter && /^(n|ne|nw)$/.test(transformHandleType)),\r\n        w: /^(w|nw|sw)$/.test(transformHandleType) ||\r\n            (shouldResizeFromCenter && /^(e|ne|se)$/.test(transformHandleType)),\r\n        e: /^(e|ne|se)$/.test(transformHandleType) ||\r\n            (shouldResizeFromCenter && /^(w|nw|sw)$/.test(transformHandleType)),\r\n    };\r\n};\r\nconst resizeSingleTextElement = (element, transformHandleType, shouldResizeFromCenter, pointerX, pointerY) => {\r\n    const [x1, y1, x2, y2] = getElementAbsoluteCoords(element);\r\n    const cx = (x1 + x2) / 2;\r\n    const cy = (y1 + y2) / 2;\r\n    // rotation pointer with reverse angle\r\n    const [rotatedX, rotatedY] = rotate(pointerX, pointerY, cx, cy, -element.angle);\r\n    let scale;\r\n    switch (transformHandleType) {\r\n        case \"se\":\r\n            scale = Math.max((rotatedX - x1) / (x2 - x1), (rotatedY - y1) / (y2 - y1));\r\n            break;\r\n        case \"nw\":\r\n            scale = Math.max((x2 - rotatedX) / (x2 - x1), (y2 - rotatedY) / (y2 - y1));\r\n            break;\r\n        case \"ne\":\r\n            scale = Math.max((rotatedX - x1) / (x2 - x1), (y2 - rotatedY) / (y2 - y1));\r\n            break;\r\n        case \"sw\":\r\n            scale = Math.max((x2 - rotatedX) / (x2 - x1), (rotatedY - y1) / (y2 - y1));\r\n            break;\r\n    }\r\n    if (scale > 0) {\r\n        const nextWidth = element.width * scale;\r\n        const nextHeight = element.height * scale;\r\n        const nextFont = measureFontSizeFromWH(element, nextWidth, nextHeight);\r\n        if (nextFont === null) {\r\n            return;\r\n        }\r\n        const [nextX1, nextY1, nextX2, nextY2] = getResizedElementAbsoluteCoords(element, nextWidth, nextHeight);\r\n        const deltaX1 = (x1 - nextX1) / 2;\r\n        const deltaY1 = (y1 - nextY1) / 2;\r\n        const deltaX2 = (x2 - nextX2) / 2;\r\n        const deltaY2 = (y2 - nextY2) / 2;\r\n        const [nextElementX, nextElementY] = adjustXYWithRotation(getSidesForTransformHandle(transformHandleType, shouldResizeFromCenter), element.x, element.y, element.angle, deltaX1, deltaY1, deltaX2, deltaY2);\r\n        mutateElement(element, {\r\n            fontSize: nextFont.size,\r\n            width: nextWidth,\r\n            height: nextHeight,\r\n            baseline: nextFont.baseline,\r\n            x: nextElementX,\r\n            y: nextElementY,\r\n        });\r\n    }\r\n};\r\nexport const resizeSingleElement = (stateAtResizeStart, shouldMaintainAspectRatio, element, transformHandleDirection, shouldResizeFromCenter, pointerX, pointerY) => {\r\n    // Gets bounds corners\r\n    const [x1, y1, x2, y2] = getResizedElementAbsoluteCoords(stateAtResizeStart, stateAtResizeStart.width, stateAtResizeStart.height);\r\n    const startTopLeft = [x1, y1];\r\n    const startBottomRight = [x2, y2];\r\n    const startCenter = centerPoint(startTopLeft, startBottomRight);\r\n    // Calculate new dimensions based on cursor position\r\n    const rotatedPointer = rotatePoint([pointerX, pointerY], startCenter, -stateAtResizeStart.angle);\r\n    // Get bounds corners rendered on screen\r\n    const [esx1, esy1, esx2, esy2] = getResizedElementAbsoluteCoords(element, element.width, element.height);\r\n    const boundsCurrentWidth = esx2 - esx1;\r\n    const boundsCurrentHeight = esy2 - esy1;\r\n    // It's important we set the initial scale value based on the width and height at resize start,\r\n    // otherwise previous dimensions affected by modifiers will be taken into account.\r\n    const atStartBoundsWidth = startBottomRight[0] - startTopLeft[0];\r\n    const atStartBoundsHeight = startBottomRight[1] - startTopLeft[1];\r\n    let scaleX = atStartBoundsWidth / boundsCurrentWidth;\r\n    let scaleY = atStartBoundsHeight / boundsCurrentHeight;\r\n    if (transformHandleDirection.includes(\"e\")) {\r\n        scaleX = (rotatedPointer[0] - startTopLeft[0]) / boundsCurrentWidth;\r\n    }\r\n    if (transformHandleDirection.includes(\"s\")) {\r\n        scaleY = (rotatedPointer[1] - startTopLeft[1]) / boundsCurrentHeight;\r\n    }\r\n    if (transformHandleDirection.includes(\"w\")) {\r\n        scaleX = (startBottomRight[0] - rotatedPointer[0]) / boundsCurrentWidth;\r\n    }\r\n    if (transformHandleDirection.includes(\"n\")) {\r\n        scaleY = (startBottomRight[1] - rotatedPointer[1]) / boundsCurrentHeight;\r\n    }\r\n    // Linear elements dimensions differ from bounds dimensions\r\n    const eleInitialWidth = stateAtResizeStart.width;\r\n    const eleInitialHeight = stateAtResizeStart.height;\r\n    // We have to use dimensions of element on screen, otherwise the scaling of the\r\n    // dimensions won't match the cursor for linear elements.\r\n    let eleNewWidth = element.width * scaleX;\r\n    let eleNewHeight = element.height * scaleY;\r\n    // adjust dimensions for resizing from center\r\n    if (shouldResizeFromCenter) {\r\n        eleNewWidth = 2 * eleNewWidth - eleInitialWidth;\r\n        eleNewHeight = 2 * eleNewHeight - eleInitialHeight;\r\n    }\r\n    // adjust dimensions to keep sides ratio\r\n    if (shouldMaintainAspectRatio) {\r\n        const widthRatio = Math.abs(eleNewWidth) / eleInitialWidth;\r\n        const heightRatio = Math.abs(eleNewHeight) / eleInitialHeight;\r\n        if (transformHandleDirection.length === 1) {\r\n            eleNewHeight *= widthRatio;\r\n            eleNewWidth *= heightRatio;\r\n        }\r\n        if (transformHandleDirection.length === 2) {\r\n            const ratio = Math.max(widthRatio, heightRatio);\r\n            eleNewWidth = eleInitialWidth * ratio * Math.sign(eleNewWidth);\r\n            eleNewHeight = eleInitialHeight * ratio * Math.sign(eleNewHeight);\r\n        }\r\n    }\r\n    const [newBoundsX1, newBoundsY1, newBoundsX2, newBoundsY2] = getResizedElementAbsoluteCoords(stateAtResizeStart, eleNewWidth, eleNewHeight);\r\n    const newBoundsWidth = newBoundsX2 - newBoundsX1;\r\n    const newBoundsHeight = newBoundsY2 - newBoundsY1;\r\n    // Calculate new topLeft based on fixed corner during resize\r\n    let newTopLeft = [...startTopLeft];\r\n    if ([\"n\", \"w\", \"nw\"].includes(transformHandleDirection)) {\r\n        newTopLeft = [\r\n            startBottomRight[0] - Math.abs(newBoundsWidth),\r\n            startBottomRight[1] - Math.abs(newBoundsHeight),\r\n        ];\r\n    }\r\n    if (transformHandleDirection === \"ne\") {\r\n        const bottomLeft = [startTopLeft[0], startBottomRight[1]];\r\n        newTopLeft = [bottomLeft[0], bottomLeft[1] - Math.abs(newBoundsHeight)];\r\n    }\r\n    if (transformHandleDirection === \"sw\") {\r\n        const topRight = [startBottomRight[0], startTopLeft[1]];\r\n        newTopLeft = [topRight[0] - Math.abs(newBoundsWidth), topRight[1]];\r\n    }\r\n    // Keeps opposite handle fixed during resize\r\n    if (shouldMaintainAspectRatio) {\r\n        if ([\"s\", \"n\"].includes(transformHandleDirection)) {\r\n            newTopLeft[0] = startCenter[0] - newBoundsWidth / 2;\r\n        }\r\n        if ([\"e\", \"w\"].includes(transformHandleDirection)) {\r\n            newTopLeft[1] = startCenter[1] - newBoundsHeight / 2;\r\n        }\r\n    }\r\n    // Flip horizontally\r\n    if (eleNewWidth < 0) {\r\n        if (transformHandleDirection.includes(\"e\")) {\r\n            newTopLeft[0] -= Math.abs(newBoundsWidth);\r\n        }\r\n        if (transformHandleDirection.includes(\"w\")) {\r\n            newTopLeft[0] += Math.abs(newBoundsWidth);\r\n        }\r\n    }\r\n    // Flip vertically\r\n    if (eleNewHeight < 0) {\r\n        if (transformHandleDirection.includes(\"s\")) {\r\n            newTopLeft[1] -= Math.abs(newBoundsHeight);\r\n        }\r\n        if (transformHandleDirection.includes(\"n\")) {\r\n            newTopLeft[1] += Math.abs(newBoundsHeight);\r\n        }\r\n    }\r\n    if (shouldResizeFromCenter) {\r\n        newTopLeft[0] = startCenter[0] - Math.abs(newBoundsWidth) / 2;\r\n        newTopLeft[1] = startCenter[1] - Math.abs(newBoundsHeight) / 2;\r\n    }\r\n    // adjust topLeft to new rotation point\r\n    const angle = stateAtResizeStart.angle;\r\n    const rotatedTopLeft = rotatePoint(newTopLeft, startCenter, angle);\r\n    const newCenter = [\r\n        newTopLeft[0] + Math.abs(newBoundsWidth) / 2,\r\n        newTopLeft[1] + Math.abs(newBoundsHeight) / 2,\r\n    ];\r\n    const rotatedNewCenter = rotatePoint(newCenter, startCenter, angle);\r\n    newTopLeft = rotatePoint(rotatedTopLeft, rotatedNewCenter, -angle);\r\n    // Readjust points for linear elements\r\n    const rescaledPoints = rescalePointsInElement(stateAtResizeStart, eleNewWidth, eleNewHeight);\r\n    // For linear elements (x,y) are the coordinates of the first drawn point not the top-left corner\r\n    // So we need to readjust (x,y) to be where the first point should be\r\n    const newOrigin = [...newTopLeft];\r\n    newOrigin[0] += stateAtResizeStart.x - newBoundsX1;\r\n    newOrigin[1] += stateAtResizeStart.y - newBoundsY1;\r\n    const resizedElement = {\r\n        width: Math.abs(eleNewWidth),\r\n        height: Math.abs(eleNewHeight),\r\n        x: newOrigin[0],\r\n        y: newOrigin[1],\r\n        ...rescaledPoints,\r\n    };\r\n    if (\"scale\" in element && \"scale\" in stateAtResizeStart) {\r\n        mutateElement(element, {\r\n            scale: [\r\n                // defaulting because scaleX/Y can be 0/-0\r\n                (Math.sign(scaleX) || stateAtResizeStart.scale[0]) *\r\n                    stateAtResizeStart.scale[0],\r\n                (Math.sign(scaleY) || stateAtResizeStart.scale[1]) *\r\n                    stateAtResizeStart.scale[1],\r\n            ],\r\n        });\r\n    }\r\n    if (resizedElement.width !== 0 &&\r\n        resizedElement.height !== 0 &&\r\n        Number.isFinite(resizedElement.x) &&\r\n        Number.isFinite(resizedElement.y)) {\r\n        updateBoundElements(element, {\r\n            newSize: { width: resizedElement.width, height: resizedElement.height },\r\n        });\r\n        mutateElement(element, resizedElement);\r\n    }\r\n};\r\nconst resizeMultipleElements = (elements, transformHandleType, pointerX, pointerY) => {\r\n    const [x1, y1, x2, y2] = getCommonBounds(elements);\r\n    let scale;\r\n    let getNextXY;\r\n    switch (transformHandleType) {\r\n        case \"se\":\r\n            scale = Math.max((pointerX - x1) / (x2 - x1), (pointerY - y1) / (y2 - y1));\r\n            getNextXY = (element, [origX1, origY1], [finalX1, finalY1]) => {\r\n                const x = element.x + (origX1 - x1) * (scale - 1) + origX1 - finalX1;\r\n                const y = element.y + (origY1 - y1) * (scale - 1) + origY1 - finalY1;\r\n                return { x, y };\r\n            };\r\n            break;\r\n        case \"nw\":\r\n            scale = Math.max((x2 - pointerX) / (x2 - x1), (y2 - pointerY) / (y2 - y1));\r\n            getNextXY = (element, [, , origX2, origY2], [, , finalX2, finalY2]) => {\r\n                const x = element.x - (x2 - origX2) * (scale - 1) + origX2 - finalX2;\r\n                const y = element.y - (y2 - origY2) * (scale - 1) + origY2 - finalY2;\r\n                return { x, y };\r\n            };\r\n            break;\r\n        case \"ne\":\r\n            scale = Math.max((pointerX - x1) / (x2 - x1), (y2 - pointerY) / (y2 - y1));\r\n            getNextXY = (element, [origX1, , , origY2], [finalX1, , , finalY2]) => {\r\n                const x = element.x + (origX1 - x1) * (scale - 1) + origX1 - finalX1;\r\n                const y = element.y - (y2 - origY2) * (scale - 1) + origY2 - finalY2;\r\n                return { x, y };\r\n            };\r\n            break;\r\n        case \"sw\":\r\n            scale = Math.max((x2 - pointerX) / (x2 - x1), (pointerY - y1) / (y2 - y1));\r\n            getNextXY = (element, [, origY1, origX2], [, finalY1, finalX2]) => {\r\n                const x = element.x - (x2 - origX2) * (scale - 1) + origX2 - finalX2;\r\n                const y = element.y + (origY1 - y1) * (scale - 1) + origY1 - finalY1;\r\n                return { x, y };\r\n            };\r\n            break;\r\n    }\r\n    if (scale > 0) {\r\n        const updates = elements.reduce((prev, element) => {\r\n            if (!prev) {\r\n                return prev;\r\n            }\r\n            const width = element.width * scale;\r\n            const height = element.height * scale;\r\n            let font = {};\r\n            if (element.type === \"text\") {\r\n                const nextFont = measureFontSizeFromWH(element, width, height);\r\n                if (nextFont === null) {\r\n                    return null;\r\n                }\r\n                font = { fontSize: nextFont.size, baseline: nextFont.baseline };\r\n            }\r\n            const origCoords = getElementAbsoluteCoords(element);\r\n            const rescaledPoints = rescalePointsInElement(element, width, height);\r\n            updateBoundElements(element, {\r\n                newSize: { width, height },\r\n                simultaneouslyUpdated: elements,\r\n            });\r\n            const finalCoords = getResizedElementAbsoluteCoords({\r\n                ...element,\r\n                ...rescaledPoints,\r\n            }, width, height);\r\n            const { x, y } = getNextXY(element, origCoords, finalCoords);\r\n            return [...prev, { width, height, x, y, ...rescaledPoints, ...font }];\r\n        }, []);\r\n        if (updates) {\r\n            elements.forEach((element, index) => {\r\n                mutateElement(element, updates[index]);\r\n            });\r\n        }\r\n    }\r\n};\r\nconst rotateMultipleElements = (pointerDownState, elements, pointerX, pointerY, shouldRotateWithDiscreteAngle, centerX, centerY) => {\r\n    let centerAngle = (5 * Math.PI) / 2 + Math.atan2(pointerY - centerY, pointerX - centerX);\r\n    if (shouldRotateWithDiscreteAngle) {\r\n        centerAngle += SHIFT_LOCKING_ANGLE / 2;\r\n        centerAngle -= centerAngle % SHIFT_LOCKING_ANGLE;\r\n    }\r\n    elements.forEach((element, index) => {\r\n        const [x1, y1, x2, y2] = getElementAbsoluteCoords(element);\r\n        const cx = (x1 + x2) / 2;\r\n        const cy = (y1 + y2) / 2;\r\n        const origAngle = pointerDownState.originalElements.get(element.id)?.angle ?? element.angle;\r\n        const [rotatedCX, rotatedCY] = rotate(cx, cy, centerX, centerY, centerAngle + origAngle - element.angle);\r\n        mutateElement(element, {\r\n            x: element.x + (rotatedCX - cx),\r\n            y: element.y + (rotatedCY - cy),\r\n            angle: normalizeAngle(centerAngle + origAngle),\r\n        });\r\n    });\r\n};\r\nexport const getResizeOffsetXY = (transformHandleType, selectedElements, x, y) => {\r\n    const [x1, y1, x2, y2] = selectedElements.length === 1\r\n        ? getElementAbsoluteCoords(selectedElements[0])\r\n        : getCommonBounds(selectedElements);\r\n    const cx = (x1 + x2) / 2;\r\n    const cy = (y1 + y2) / 2;\r\n    const angle = selectedElements.length === 1 ? selectedElements[0].angle : 0;\r\n    [x, y] = rotate(x, y, cx, cy, -angle);\r\n    switch (transformHandleType) {\r\n        case \"n\":\r\n            return rotate(x - (x1 + x2) / 2, y - y1, 0, 0, angle);\r\n        case \"s\":\r\n            return rotate(x - (x1 + x2) / 2, y - y2, 0, 0, angle);\r\n        case \"w\":\r\n            return rotate(x - x1, y - (y1 + y2) / 2, 0, 0, angle);\r\n        case \"e\":\r\n            return rotate(x - x2, y - (y1 + y2) / 2, 0, 0, angle);\r\n        case \"nw\":\r\n            return rotate(x - x1, y - y1, 0, 0, angle);\r\n        case \"ne\":\r\n            return rotate(x - x2, y - y1, 0, 0, angle);\r\n        case \"sw\":\r\n            return rotate(x - x1, y - y2, 0, 0, angle);\r\n        case \"se\":\r\n            return rotate(x - x2, y - y2, 0, 0, angle);\r\n        default:\r\n            return [0, 0];\r\n    }\r\n};\r\nexport const getResizeArrowDirection = (transformHandleType, element) => {\r\n    const [, [px, py]] = element.points;\r\n    const isResizeEnd = (transformHandleType === \"nw\" && (px < 0 || py < 0)) ||\r\n        (transformHandleType === \"ne\" && px >= 0) ||\r\n        (transformHandleType === \"sw\" && px <= 0) ||\r\n        (transformHandleType === \"se\" && (px > 0 || py > 0));\r\n    return isResizeEnd ? \"end\" : \"origin\";\r\n};\r\n","import { updateBoundElements } from \"./binding\";\r\nimport { getCommonBounds } from \"./bounds\";\r\nimport { mutateElement } from \"./mutateElement\";\r\nimport { getPerfectElementSize } from \"./sizeHelpers\";\r\nexport const dragSelectedElements = (pointerDownState, selectedElements, pointerX, pointerY, scene, lockDirection = false, distanceX = 0, distanceY = 0) => {\r\n    const [x1, y1] = getCommonBounds(selectedElements);\r\n    const offset = { x: pointerX - x1, y: pointerY - y1 };\r\n    selectedElements.forEach((element) => {\r\n        let x;\r\n        let y;\r\n        if (lockDirection) {\r\n            const lockX = lockDirection && distanceX < distanceY;\r\n            const lockY = lockDirection && distanceX > distanceY;\r\n            const original = pointerDownState.originalElements.get(element.id);\r\n            x = lockX && original ? original.x : element.x + offset.x;\r\n            y = lockY && original ? original.y : element.y + offset.y;\r\n        }\r\n        else {\r\n            x = element.x + offset.x;\r\n            y = element.y + offset.y;\r\n        }\r\n        mutateElement(element, {\r\n            x,\r\n            y,\r\n        });\r\n        updateBoundElements(element, {\r\n            simultaneouslyUpdated: selectedElements,\r\n        });\r\n    });\r\n};\r\nexport const getDragOffsetXY = (selectedElements, x, y) => {\r\n    const [x1, y1] = getCommonBounds(selectedElements);\r\n    return [x - x1, y - y1];\r\n};\r\nexport const dragNewElement = (draggingElement, elementType, originX, originY, x, y, width, height, shouldMaintainAspectRatio, shouldResizeFromCenter, \r\n/** whether to keep given aspect ratio when `isResizeWithSidesSameLength` is\r\n    true */\r\nwidthAspectRatio) => {\r\n    if (shouldMaintainAspectRatio) {\r\n        if (widthAspectRatio) {\r\n            height = width / widthAspectRatio;\r\n        }\r\n        else {\r\n            ({ width, height } = getPerfectElementSize(elementType, width, y < originY ? -height : height));\r\n            if (height < 0) {\r\n                height = -height;\r\n            }\r\n        }\r\n    }\r\n    let newX = x < originX ? originX - width : originX;\r\n    let newY = y < originY ? originY - height : originY;\r\n    if (shouldResizeFromCenter) {\r\n        width += width;\r\n        height += height;\r\n        newX = originX - width / 2;\r\n        newY = originY - height / 2;\r\n    }\r\n    if (width !== 0 && height !== 0) {\r\n        mutateElement(draggingElement, {\r\n            x: newX,\r\n            y: newY,\r\n            width,\r\n            height,\r\n        });\r\n    }\r\n};\r\n","import { CODES, KEYS } from \"../keys\";\r\nimport { isWritableElement, getFontString } from \"../utils\";\r\nimport Scene from \"../scene/Scene\";\r\nimport { isTextElement } from \"./typeChecks\";\r\nimport { CLASSES } from \"../constants\";\r\nconst normalizeText = (text) => {\r\n    return (text\r\n        // replace tabs with spaces so they render and measure correctly\r\n        .replace(/\\t/g, \"        \")\r\n        // normalize newlines\r\n        .replace(/\\r?\\n|\\r/g, \"\\n\"));\r\n};\r\nconst getTransform = (width, height, angle, appState, maxWidth) => {\r\n    const { zoom, offsetTop, offsetLeft } = appState;\r\n    const degree = (180 * angle) / Math.PI;\r\n    // offsets must be multiplied by 2 to account for the division by 2 of\r\n    // the whole expression afterwards\r\n    let translateX = ((width - offsetLeft * 2) * (zoom.value - 1)) / 2;\r\n    const translateY = ((height - offsetTop * 2) * (zoom.value - 1)) / 2;\r\n    if (width > maxWidth && zoom.value !== 1) {\r\n        translateX = (maxWidth / 2) * (zoom.value - 1);\r\n    }\r\n    return `translate(${translateX}px, ${translateY}px) scale(${zoom.value}) rotate(${degree}deg)`;\r\n};\r\nexport const textWysiwyg = ({ id, appState, onChange, onSubmit, getViewportCoords, element, canvas, excalidrawContainer, }) => {\r\n    const updateWysiwygStyle = () => {\r\n        const updatedElement = Scene.getScene(element)?.getElement(id);\r\n        if (updatedElement && isTextElement(updatedElement)) {\r\n            const [viewportX, viewportY] = getViewportCoords(updatedElement.x, updatedElement.y);\r\n            const { textAlign, angle } = updatedElement;\r\n            editable.value = updatedElement.text;\r\n            const lines = updatedElement.text.replace(/\\r\\n?/g, \"\\n\").split(\"\\n\");\r\n            const lineHeight = updatedElement.height / lines.length;\r\n            const maxWidth = (appState.offsetLeft + appState.width - viewportX - 8) /\r\n                appState.zoom.value -\r\n                // margin-right of parent if any\r\n                Number(getComputedStyle(excalidrawContainer?.parentNode).marginRight.slice(0, -2));\r\n            Object.assign(editable.style, {\r\n                font: getFontString(updatedElement),\r\n                // must be defined *after* font \\_()_/\r\n                lineHeight: `${lineHeight}px`,\r\n                width: `${updatedElement.width}px`,\r\n                height: `${updatedElement.height}px`,\r\n                left: `${viewportX}px`,\r\n                top: `${viewportY}px`,\r\n                transform: getTransform(updatedElement.width, updatedElement.height, angle, appState, maxWidth),\r\n                textAlign,\r\n                color: updatedElement.strokeColor,\r\n                opacity: updatedElement.opacity / 100,\r\n                filter: \"var(--theme-filter)\",\r\n                maxWidth: `${maxWidth}px`,\r\n            });\r\n        }\r\n    };\r\n    const editable = document.createElement(\"textarea\");\r\n    editable.dir = \"auto\";\r\n    editable.tabIndex = 0;\r\n    editable.className = \"canvas_text\";\r\n    editable.dataset.type = \"wysiwyg\";\r\n    // prevent line wrapping on Safari\r\n    editable.wrap = \"off\";\r\n    Object.assign(editable.style, {\r\n        position: \"absolute\",\r\n        display: \"inline-block\",\r\n        minHeight: \"1em\",\r\n        backfaceVisibility: \"hidden\",\r\n        margin: 0,\r\n        padding: 0,\r\n        border: 0,\r\n        outline: 0,\r\n        resize: \"none\",\r\n        background: \"transparent\",\r\n        overflow: \"hidden\",\r\n        font: \"Virgil\",\r\n        // prevent line wrapping (`whitespace: nowrap` doesn't work on FF)\r\n        whiteSpace: \"pre\",\r\n        // must be specified because in dark mode canvas creates a stacking context\r\n        zIndex: \"var(--zIndex-wysiwyg)\",\r\n    });\r\n    updateWysiwygStyle();\r\n    if (onChange) {\r\n        editable.oninput = () => {\r\n           \r\n            onChange(normalizeText(editable.value));\r\n        };\r\n    }\r\n    editable.onkeydown = (event) => {\r\n        event.stopPropagation();\r\n        if (event.key === KEYS.ESCAPE) {\r\n            event.preventDefault();\r\n            submittedViaKeyboard = true;\r\n            handleSubmit();\r\n        }\r\n        else if (event.key === KEYS.ENTER && event[KEYS.CTRL_OR_CMD]) {\r\n            event.preventDefault();\r\n            if (event.isComposing || event.keyCode === 229) {\r\n                return;\r\n            }\r\n            submittedViaKeyboard = true;\r\n            handleSubmit();\r\n        }\r\n        else if (event.key === KEYS.TAB ||\r\n            (event[KEYS.CTRL_OR_CMD] &&\r\n                (event.code === CODES.BRACKET_LEFT ||\r\n                    event.code === CODES.BRACKET_RIGHT))) {\r\n            event.preventDefault();\r\n            if (event.shiftKey || event.code === CODES.BRACKET_LEFT) {\r\n                outdent();\r\n            }\r\n            else {\r\n                indent();\r\n            }\r\n            \r\n            // We must send an input event to resize the element\r\n            editable.dispatchEvent(new Event(\"input\"));\r\n        }\r\n        console.log(\"here on 89\");\r\n        editable.dispatchEvent(new Event(\"input\"));\r\n    };\r\n    const TAB_SIZE = 4;\r\n    const TAB = \" \".repeat(TAB_SIZE);\r\n    const RE_LEADING_TAB = new RegExp(`^ {1,${TAB_SIZE}}`);\r\n    const indent = () => {\r\n        const { selectionStart, selectionEnd } = editable;\r\n        const linesStartIndices = getSelectedLinesStartIndices();\r\n        let value = editable.value;\r\n        linesStartIndices.forEach((startIndex) => {\r\n            const startValue = value.slice(0, startIndex);\r\n            const endValue = value.slice(startIndex);\r\n            value = `${startValue}${TAB}${endValue}`;\r\n        });\r\n        editable.value = value;\r\n        editable.selectionStart = selectionStart + TAB_SIZE;\r\n        editable.selectionEnd = selectionEnd + TAB_SIZE * linesStartIndices.length;\r\n    };\r\n    const outdent = () => {\r\n        const { selectionStart, selectionEnd } = editable;\r\n        const linesStartIndices = getSelectedLinesStartIndices();\r\n        const removedTabs = [];\r\n        let value = editable.value;\r\n        linesStartIndices.forEach((startIndex) => {\r\n            const tabMatch = value\r\n                .slice(startIndex, startIndex + TAB_SIZE)\r\n                .match(RE_LEADING_TAB);\r\n            if (tabMatch) {\r\n                const startValue = value.slice(0, startIndex);\r\n                const endValue = value.slice(startIndex + tabMatch[0].length);\r\n                // Delete a tab from the line\r\n                value = `${startValue}${endValue}`;\r\n                removedTabs.push(startIndex);\r\n            }\r\n        });\r\n        editable.value = value;\r\n        if (removedTabs.length) {\r\n            if (selectionStart > removedTabs[removedTabs.length - 1]) {\r\n                editable.selectionStart = Math.max(selectionStart - TAB_SIZE, removedTabs[removedTabs.length - 1]);\r\n            }\r\n            else {\r\n                // If the cursor is before the first tab removed, ex:\r\n                // Line| #1\r\n                //     Line #2\r\n                // Lin|e #3\r\n                // we should reset the selectionStart to his initial value.\r\n                editable.selectionStart = selectionStart;\r\n            }\r\n            editable.selectionEnd = Math.max(editable.selectionStart, selectionEnd - TAB_SIZE * removedTabs.length);\r\n        }\r\n    };\r\n    /**\r\n     * @returns indeces of start positions of selected lines, in reverse order\r\n     */\r\n    const getSelectedLinesStartIndices = () => {\r\n        let { selectionStart, selectionEnd, value } = editable;\r\n        // chars before selectionStart on the same line\r\n        const startOffset = value.slice(0, selectionStart).match(/[^\\n]*$/)[0]\r\n            .length;\r\n        // put caret at the start of the line\r\n        selectionStart = selectionStart - startOffset;\r\n        const selected = value.slice(selectionStart, selectionEnd);\r\n        return selected\r\n            .split(\"\\n\")\r\n            .reduce((startIndices, line, idx, lines) => startIndices.concat(idx\r\n            ? // curr line index is prev line's start + prev line's length + \\n\r\n                startIndices[idx - 1] + lines[idx - 1].length + 1\r\n            : // first selected line\r\n                selectionStart), [])\r\n            .reverse();\r\n    };\r\n    const stopEvent = (event) => {\r\n        event.preventDefault();\r\n        event.stopPropagation();\r\n    };\r\n    // using a state variable instead of passing it to the handleSubmit callback\r\n    // so that we don't need to create separate a callback for event handlers\r\n    let submittedViaKeyboard = false;\r\n    const handleSubmit = () => {\r\n        // cleanup must be run before onSubmit otherwise when app blurs the wysiwyg\r\n        // it'd get stuck in an infinite loop of bluronSubmit after we re-focus the\r\n        // wysiwyg on update\r\n        cleanup();\r\n        onSubmit({\r\n            text: normalizeText(editable.value),\r\n            viaKeyboard: submittedViaKeyboard,\r\n        });\r\n    };\r\n    const cleanup = () => {\r\n        if (isDestroyed) {\r\n            return;\r\n        }\r\n        isDestroyed = true;\r\n        // remove events to ensure they don't late-fire\r\n        editable.onblur = null;\r\n        editable.oninput = null;\r\n        editable.onkeydown = null;\r\n        if (observer) {\r\n            observer.disconnect();\r\n        }\r\n        window.removeEventListener(\"resize\", updateWysiwygStyle);\r\n        window.removeEventListener(\"wheel\", stopEvent, true);\r\n        window.removeEventListener(\"pointerdown\", onPointerDown);\r\n        window.removeEventListener(\"pointerup\", bindBlurEvent);\r\n        window.removeEventListener(\"blur\", handleSubmit);\r\n        unbindUpdate();\r\n        editable.remove();\r\n    };\r\n    const bindBlurEvent = () => {\r\n        window.removeEventListener(\"pointerup\", bindBlurEvent);\r\n        // Deferred so that the pointerdown that initiates the wysiwyg doesn't\r\n        // trigger the blur on ensuing pointerup.\r\n        // Also to handle cases such as picking a color which would trigger a blur\r\n        // in that same tick.\r\n        setTimeout(() => {\r\n            editable.onblur = handleSubmit;\r\n            // case: clicking on the same property  no change  no update  no focus\r\n            editable.focus();\r\n        });\r\n    };\r\n    // prevent blur when changing properties from the menu\r\n    const onPointerDown = (event) => {\r\n        if ((event.target instanceof HTMLElement ||\r\n            event.target instanceof SVGElement) &&\r\n            event.target.closest(`.${CLASSES.SHAPE_ACTIONS_MENU}`) &&\r\n            !isWritableElement(event.target)) {\r\n            editable.onblur = null;\r\n            window.addEventListener(\"pointerup\", bindBlurEvent);\r\n            // handle edge-case where pointerup doesn't fire e.g. due to user\r\n            // alt-tabbing away\r\n            window.addEventListener(\"blur\", handleSubmit);\r\n        }\r\n    };\r\n    // handle updates of textElement properties of editing element\r\n    const unbindUpdate = Scene.getScene(element).addCallback(() => {\r\n        updateWysiwygStyle();\r\n        editable.focus();\r\n    });\r\n    // ---------------------------------------------------------------------------\r\n    let isDestroyed = false;\r\n    // select on init (focusing is done separately inside the bindBlurEvent()\r\n    // because we need it to happen *after* the blur event from `pointerdown`)\r\n    editable.select();\r\n    bindBlurEvent();\r\n    // reposition wysiwyg in case of canvas is resized. Using ResizeObserver\r\n    // is preferred so we catch changes from host, where window may not resize.\r\n    let observer = null;\r\n    if (canvas && \"ResizeObserver\" in window) {\r\n        observer = new window.ResizeObserver(() => {\r\n            updateWysiwygStyle();\r\n        });\r\n        observer.observe(canvas);\r\n    }\r\n    else {\r\n        window.addEventListener(\"resize\", updateWysiwygStyle);\r\n    }\r\n    window.addEventListener(\"pointerdown\", onPointerDown);\r\n    window.addEventListener(\"wheel\", stopEvent, {\r\n        passive: false,\r\n        capture: true,\r\n    });\r\n    excalidrawContainer\r\n        ?.querySelector(\".excalidraw-textEditorContainer\")\r\n        .appendChild(editable);\r\n};\r\n","import { measureText, getFontString } from \"../utils\";\r\nimport { mutateElement } from \"./mutateElement\";\r\nexport const redrawTextBoundingBox = (element) => {\r\n    const metrics = measureText(element.text, getFontString(element));\r\n    mutateElement(element, {\r\n        width: metrics.width,\r\n        height: metrics.height,\r\n        baseline: metrics.baseline,\r\n    });\r\n};\r\n","import { getSelectedElements } from \"../scene\";\r\nexport const showSelectedShapeActions = (appState, elements) => Boolean(!appState.viewModeEnabled &&\r\n    (appState.editingElement ||\r\n        getSelectedElements(elements, appState).length ||\r\n        appState.elementType !== \"selection\"));\r\n","import { isInvisiblySmallElement } from \"./sizeHelpers\";\r\nimport { isLinearElementType } from \"./typeChecks\";\r\nexport { newElement, newTextElement, updateTextElement, newLinearElement, newImageElement, duplicateElement, } from \"./newElement\";\r\nexport { getElementAbsoluteCoords, getElementBounds, getCommonBounds, getDiamondPoints, getArrowheadPoints, getClosestElementBounds, } from \"./bounds\";\r\nexport { OMIT_SIDES_FOR_MULTIPLE_ELEMENTS, getTransformHandlesFromCoords, getTransformHandles, } from \"./transformHandles\";\r\nexport { hitTest, isHittingElementBoundingBoxWithoutHittingElement, } from \"./collision\";\r\nexport { resizeTest, getCursorForResizingElement, getElementWithTransformHandleType, getTransformHandleTypeFromCoords, } from \"./resizeTest\";\r\nexport { transformElements, getResizeOffsetXY, getResizeArrowDirection, } from \"./resizeElements\";\r\nexport { dragSelectedElements, getDragOffsetXY, dragNewElement, } from \"./dragElements\";\r\nexport { isTextElement, isExcalidrawElement } from \"./typeChecks\";\r\nexport { textWysiwyg } from \"./textWysiwyg\";\r\nexport { redrawTextBoundingBox } from \"./textElement\";\r\nexport { getPerfectElementSize, isInvisiblySmallElement, resizePerfectLineForNWHandler, getNormalizedDimensions, } from \"./sizeHelpers\";\r\nexport { showSelectedShapeActions } from \"./showSelectedShapeActions\";\r\nexport const getElementMap = (elements) => elements.reduce((acc, element) => {\r\n    acc[element.id] = element;\r\n    return acc;\r\n}, {});\r\nexport const getSceneVersion = (elements) => elements.reduce((acc, el) => acc + el.version, 0);\r\nexport const getVisibleElements = (elements) => elements.filter((el) => !el.isDeleted && !isInvisiblySmallElement(el));\r\nexport const getNonDeletedElements = (elements) => elements.filter((element) => !element.isDeleted);\r\nexport const isNonDeletedElement = (element) => !element.isDeleted;\r\nconst _clearElements = (elements) => getNonDeletedElements(elements).map((element) => isLinearElementType(element.type)\r\n    ? { ...element, lastCommittedPoint: null }\r\n    : element);\r\nexport const clearElementsForDatabase = (elements) => _clearElements(elements);\r\nexport const clearElementsForExport = (elements) => _clearElements(elements);\r\nexport const clearElementsForLocalStorage = (elements) => _clearElements(elements);\r\n","import { getCommonBounds } from \"../element\";\r\nimport { getGlobalCSSVariable } from \"../utils\";\r\nimport { getLanguage } from \"../i18n\";\r\nexport const SCROLLBAR_MARGIN = 4;\r\nexport const SCROLLBAR_WIDTH = 6;\r\nexport const SCROLLBAR_COLOR = \"rgba(0,0,0,0.3)\";\r\nexport const getScrollBars = (elements, viewportWidth, viewportHeight, { scrollX, scrollY, zoom, }) => {\r\n    if (elements.length === 0) {\r\n        return {\r\n            horizontal: null,\r\n            vertical: null,\r\n        };\r\n    }\r\n    // This is the bounding box of all the elements\r\n    const [elementsMinX, elementsMinY, elementsMaxX, elementsMaxY] = getCommonBounds(elements);\r\n    // Apply zoom\r\n    const viewportWidthWithZoom = viewportWidth / zoom.value;\r\n    const viewportHeightWithZoom = viewportHeight / zoom.value;\r\n    const viewportWidthDiff = viewportWidth - viewportWidthWithZoom;\r\n    const viewportHeightDiff = viewportHeight - viewportHeightWithZoom;\r\n    const safeArea = {\r\n        top: parseInt(getGlobalCSSVariable(\"sat\")),\r\n        bottom: parseInt(getGlobalCSSVariable(\"sab\")),\r\n        left: parseInt(getGlobalCSSVariable(\"sal\")),\r\n        right: parseInt(getGlobalCSSVariable(\"sar\")),\r\n    };\r\n    const isRTL = getLanguage().rtl;\r\n    // The viewport is the rectangle currently visible for the user\r\n    const viewportMinX = -scrollX + viewportWidthDiff / 2 + safeArea.left;\r\n    const viewportMinY = -scrollY + viewportHeightDiff / 2 + safeArea.top;\r\n    const viewportMaxX = viewportMinX + viewportWidthWithZoom - safeArea.right;\r\n    const viewportMaxY = viewportMinY + viewportHeightWithZoom - safeArea.bottom;\r\n    // The scene is the bounding box of both the elements and viewport\r\n    const sceneMinX = Math.min(elementsMinX, viewportMinX);\r\n    const sceneMinY = Math.min(elementsMinY, viewportMinY);\r\n    const sceneMaxX = Math.max(elementsMaxX, viewportMaxX);\r\n    const sceneMaxY = Math.max(elementsMaxY, viewportMaxY);\r\n    // The scrollbar represents where the viewport is in relationship to the scene\r\n    return {\r\n        horizontal: viewportMinX === sceneMinX && viewportMaxX === sceneMaxX\r\n            ? null\r\n            : {\r\n                x: Math.max(safeArea.left, SCROLLBAR_MARGIN) +\r\n                    ((viewportMinX - sceneMinX) / (sceneMaxX - sceneMinX)) *\r\n                        viewportWidth,\r\n                y: viewportHeight -\r\n                    SCROLLBAR_WIDTH -\r\n                    Math.max(SCROLLBAR_MARGIN, safeArea.bottom),\r\n                width: ((viewportMaxX - viewportMinX) / (sceneMaxX - sceneMinX)) *\r\n                    viewportWidth -\r\n                    Math.max(SCROLLBAR_MARGIN * 2, safeArea.left + safeArea.right),\r\n                height: SCROLLBAR_WIDTH,\r\n            },\r\n        vertical: viewportMinY === sceneMinY && viewportMaxY === sceneMaxY\r\n            ? null\r\n            : {\r\n                x: isRTL\r\n                    ? Math.max(safeArea.left, SCROLLBAR_MARGIN)\r\n                    : viewportWidth -\r\n                        SCROLLBAR_WIDTH -\r\n                        Math.max(safeArea.right, SCROLLBAR_MARGIN),\r\n                y: ((viewportMinY - sceneMinY) / (sceneMaxY - sceneMinY)) *\r\n                    viewportHeight +\r\n                    Math.max(safeArea.top, SCROLLBAR_MARGIN),\r\n                width: SCROLLBAR_WIDTH,\r\n                height: ((viewportMaxY - viewportMinY) / (sceneMaxY - sceneMinY)) *\r\n                    viewportHeight -\r\n                    Math.max(SCROLLBAR_MARGIN * 2, safeArea.top + safeArea.bottom),\r\n            },\r\n    };\r\n};\r\nexport const isOverScrollBars = (scrollBars, x, y) => {\r\n    const [isOverHorizontal, isOverVertical] = [\r\n        scrollBars.horizontal,\r\n        scrollBars.vertical,\r\n    ].map((scrollBar) => {\r\n        return (scrollBar != null &&\r\n            scrollBar.x <= x &&\r\n            x <= scrollBar.x + scrollBar.width &&\r\n            scrollBar.y <= y &&\r\n            y <= scrollBar.y + scrollBar.height);\r\n    });\r\n    const isOverEither = isOverHorizontal || isOverVertical;\r\n    return { isOverEither, isOverHorizontal, isOverVertical };\r\n};\r\n","import { getElementAbsoluteCoords, getElementBounds } from \"../element\";\r\nexport const getElementsWithinSelection = (elements, selection) => {\r\n    const [selectionX1, selectionY1, selectionX2, selectionY2] = getElementAbsoluteCoords(selection);\r\n    return elements.filter((element) => {\r\n        const [elementX1, elementY1, elementX2, elementY2] = getElementBounds(element);\r\n        return (element.type !== \"selection\" &&\r\n            selectionX1 <= elementX1 &&\r\n            selectionY1 <= elementY1 &&\r\n            selectionX2 >= elementX2 &&\r\n            selectionY2 >= elementY2);\r\n    });\r\n};\r\nexport const isSomeElementSelected = (elements, appState) => elements.some((element) => appState.selectedElementIds[element.id]);\r\n/**\r\n * Returns common attribute (picked by `getAttribute` callback) of selected\r\n *  elements. If elements don't share the same value, returns `null`.\r\n */\r\nexport const getCommonAttributeOfSelectedElements = (elements, appState, getAttribute) => {\r\n    const attributes = Array.from(new Set(getSelectedElements(elements, appState).map((element) => getAttribute(element))));\r\n    return attributes.length === 1 ? attributes[0] : null;\r\n};\r\nexport const getSelectedElements = (elements, appState) => elements.filter((element) => appState.selectedElementIds[element.id]);\r\nexport const getTargetElements = (elements, appState) => appState.editingElement\r\n    ? [appState.editingElement]\r\n    : getSelectedElements(elements, appState);\r\n","import { getCommonBounds, getClosestElementBounds, getVisibleElements, } from \"../element\";\r\nimport { sceneCoordsToViewportCoords, viewportCoordsToSceneCoords, } from \"../utils\";\r\nconst isOutsideViewPort = (appState, canvas, cords) => {\r\n    const [x1, y1, x2, y2] = cords;\r\n    const { x: viewportX1, y: viewportY1 } = sceneCoordsToViewportCoords({ sceneX: x1, sceneY: y1 }, appState);\r\n    const { x: viewportX2, y: viewportY2 } = sceneCoordsToViewportCoords({ sceneX: x2, sceneY: y2 }, appState);\r\n    return (viewportX2 - viewportX1 > appState.width ||\r\n        viewportY2 - viewportY1 > appState.height);\r\n};\r\nexport const centerScrollOn = ({ scenePoint, viewportDimensions, zoom, }) => {\r\n    return {\r\n        scrollX: (viewportDimensions.width / 2) * (1 / zoom.value) -\r\n            scenePoint.x -\r\n            zoom.translation.x * (1 / zoom.value),\r\n        scrollY: (viewportDimensions.height / 2) * (1 / zoom.value) -\r\n            scenePoint.y -\r\n            zoom.translation.y * (1 / zoom.value),\r\n    };\r\n};\r\nexport const calculateScrollCenter = (elements, appState, canvas) => {\r\n    elements = getVisibleElements(elements);\r\n    if (!elements.length) {\r\n        return {\r\n            scrollX: 0,\r\n            scrollY: 0,\r\n        };\r\n    }\r\n    let [x1, y1, x2, y2] = getCommonBounds(elements);\r\n    if (isOutsideViewPort(appState, canvas, [x1, y1, x2, y2])) {\r\n        [x1, y1, x2, y2] = getClosestElementBounds(elements, viewportCoordsToSceneCoords({ clientX: appState.scrollX, clientY: appState.scrollY }, appState));\r\n    }\r\n    const centerX = (x1 + x2) / 2;\r\n    const centerY = (y1 + y2) / 2;\r\n    return centerScrollOn({\r\n        scenePoint: { x: centerX, y: centerY },\r\n        viewportDimensions: { width: appState.width, height: appState.height },\r\n        zoom: appState.zoom,\r\n    });\r\n};\r\n","import { getElementAbsoluteCoords } from \"../element\";\r\nexport const hasBackground = (type) => type === \"rectangle\" ||\r\n    type === \"ellipse\" ||\r\n    type === \"diamond\" ||\r\n    type === \"line\";\r\nexport const hasStrokeColor = (type) => type !== \"image\";\r\nexport const hasStrokeWidth = (type) => type === \"rectangle\" ||\r\n    type === \"ellipse\" ||\r\n    type === \"diamond\" ||\r\n    type === \"freedraw\" ||\r\n    type === \"arrow\" ||\r\n    type === \"line\";\r\nexport const hasStrokeStyle = (type) => type === \"rectangle\" ||\r\n    type === \"ellipse\" ||\r\n    type === \"diamond\" ||\r\n    type === \"arrow\" ||\r\n    type === \"line\";\r\nexport const canChangeSharpness = (type) => type === \"rectangle\" || type === \"arrow\" || type === \"line\" || type === \"diamond\";\r\nexport const hasText = (type) => type === \"text\";\r\nexport const canHaveArrowheads = (type) => type === \"arrow\";\r\nexport const getElementAtPosition = (elements, isAtPositionFn) => {\r\n    let hitElement = null;\r\n    // We need to to hit testing from front (end of the array) to back (beginning of the array)\r\n    // because array is ordered from lower z-index to highest and we want element z-index\r\n    // with higher z-index\r\n    for (let index = elements.length - 1; index >= 0; --index) {\r\n        const element = elements[index];\r\n        if (element.isDeleted) {\r\n            continue;\r\n        }\r\n        if (isAtPositionFn(element)) {\r\n            hitElement = element;\r\n            break;\r\n        }\r\n    }\r\n    return hitElement;\r\n};\r\nexport const getElementsAtPosition = (elements, isAtPositionFn) => {\r\n    // The parameter elements comes ordered from lower z-index to higher.\r\n    // We want to preserve that order on the returned array.\r\n    return elements.filter((element) => !element.isDeleted && isAtPositionFn(element));\r\n};\r\nexport const getElementContainingPosition = (elements, x, y) => {\r\n    let hitElement = null;\r\n    // We need to to hit testing from front (end of the array) to back (beginning of the array)\r\n    for (let index = elements.length - 1; index >= 0; --index) {\r\n        if (elements[index].isDeleted) {\r\n            continue;\r\n        }\r\n        const [x1, y1, x2, y2] = getElementAbsoluteCoords(elements[index]);\r\n        if (x1 < x && x < x2 && y1 < y && y < y2) {\r\n            hitElement = elements[index];\r\n            break;\r\n        }\r\n    }\r\n    return hitElement;\r\n};\r\n","export const getNewZoom = (newZoomValue, prevZoom, canvasOffset, zoomOnViewportPoint = { x: 0, y: 0 }) => {\r\n    return {\r\n        value: newZoomValue,\r\n        translation: {\r\n            x: zoomOnViewportPoint.x -\r\n                canvasOffset.left -\r\n                (zoomOnViewportPoint.x - canvasOffset.left - prevZoom.translation.x) *\r\n                    (newZoomValue / prevZoom.value),\r\n            y: zoomOnViewportPoint.y -\r\n                canvasOffset.top -\r\n                (zoomOnViewportPoint.y - canvasOffset.top - prevZoom.translation.y) *\r\n                    (newZoomValue / prevZoom.value),\r\n        },\r\n    };\r\n};\r\nexport const getNormalizedZoom = (zoom) => {\r\n    const normalizedZoom = parseFloat(zoom.toFixed(2));\r\n    const clampedZoom = Math.max(0.1, Math.min(normalizedZoom, 10));\r\n    return clampedZoom;\r\n};\r\n","export class CanvasError extends Error {\r\n    constructor(message = \"Couldn't export canvas.\", name = \"CANVAS_ERROR\") {\r\n        super();\r\n        this.name = name;\r\n        this.message = message;\r\n    }\r\n}\r\nexport class AbortError extends DOMException {\r\n    constructor(message = \"Request Aborted\") {\r\n        super(message, \"AbortError\");\r\n    }\r\n}\r\n","import React from \"react\";\r\nimport \"./Spinner.scss\";\r\nconst Spinner = ({ size = \"1em\", circleWidth = 8, }) => {\r\n    return (<div className=\"Spinner\">\r\n      <svg viewBox=\"0 0 100 100\" style={{ width: size, height: size }}>\r\n        <circle cx=\"50\" cy=\"50\" r={50 - circleWidth / 2} strokeWidth={circleWidth} fill=\"none\" strokeMiterlimit=\"10\"/>\r\n      </svg>\r\n    </div>);\r\n};\r\nexport default Spinner;\r\n","import \"./ToolIcon.scss\";\r\nimport React, { useEffect, useRef, useState } from \"react\";\r\nimport clsx from \"clsx\";\r\nimport { useExcalidrawContainer } from \"./App\";\r\nimport { AbortError } from \"../errors\";\r\nimport Spinner from \"./Spinner\";\r\nexport const ToolButton = React.forwardRef((props, ref) => {\r\n    const { id: excalId } = useExcalidrawContainer();\r\n    const innerRef = React.useRef(null);\r\n    React.useImperativeHandle(ref, () => innerRef.current);\r\n    const sizeCn = `ToolIcon_size_${props.size}`;\r\n    const [isLoading, setIsLoading] = useState(false);\r\n    const isMountedRef = useRef(true);\r\n    const onClick = async (event) => {\r\n        const ret = \"onClick\" in props && props.onClick?.(event);\r\n        if (ret && \"then\" in ret) {\r\n            try {\r\n                setIsLoading(true);\r\n                await ret;\r\n            }\r\n            catch (error) {\r\n                if (!(error instanceof AbortError)) {\r\n                    throw error;\r\n                }\r\n            }\r\n            finally {\r\n                if (isMountedRef.current) {\r\n                    setIsLoading(false);\r\n                }\r\n            }\r\n        }\r\n    };\r\n    useEffect(() => () => {\r\n        isMountedRef.current = false;\r\n    }, []);\r\n    const lastPointerTypeRef = useRef(null);\r\n    if (props.type === \"button\" || props.type === \"icon\") {\r\n        return (<button className={clsx(\"ToolIcon_type_button\", sizeCn, props.className, props.visible && !props.hidden\r\n                ? \"ToolIcon_type_button--show\"\r\n                : \"ToolIcon_type_button--hide\", {\r\n                ToolIcon: !props.hidden,\r\n                \"ToolIcon--selected\": props.selected,\r\n                \"ToolIcon--plain\": props.type === \"icon\",\r\n            })} data-testid={props[\"data-testid\"]} hidden={props.hidden} title={props.title} aria-label={props[\"aria-label\"]} type=\"button\" onClick={onClick} ref={innerRef} disabled={isLoading}>\r\n        {(props.icon || props.label) && (<div className=\"ToolIcon__icon\" aria-hidden=\"true\">\r\n            {props.icon || props.label}\r\n            {props.keyBindingLabel && (<span className=\"ToolIcon__keybinding\">\r\n                {props.keyBindingLabel}\r\n              </span>)}\r\n          </div>)}\r\n        {props.showAriaLabel && (<div className=\"ToolIcon__label\">\r\n            {props[\"aria-label\"]} {isLoading && <Spinner />}\r\n          </div>)}\r\n        {props.children}\r\n      </button>);\r\n    }\r\n    return (<label className={clsx(`ToolIcon ${props.title}`, props.className)} title={props.title} onPointerDown={(event) => {\r\n            lastPointerTypeRef.current = event.pointerType || null;\r\n        }} onPointerUp={() => {\r\n            requestAnimationFrame(() => {\r\n                lastPointerTypeRef.current = null;\r\n            });\r\n        }}>\r\n      <input className={`ToolIcon_type_radio ${sizeCn} ${props[\"aria-label\"]}`} type=\"radio\" name={props.name} aria-label={props[\"aria-label\"]} aria-keyshortcuts={props[\"aria-keyshortcuts\"]} data-testid={props[\"data-testid\"]} id={`${excalId}-${props.id}`} onChange={() => {\r\n            props.onChange?.({ pointerType: lastPointerTypeRef.current });\r\n        }} checked={props.checked} ref={innerRef}/>\r\n      <div className = {`ToolIcon__icon ${props[\"aria-label\"]}`}>\r\n        {props.icon}\r\n        {props.keyBindingLabel && (<span className=\"ToolIcon__keybinding\">{props.keyBindingLabel}</span>)}\r\n      </div>\r\n    </label>);\r\n});\r\nToolButton.defaultProps = {\r\n    visible: true,\r\n    className: \"\",\r\n    size: \"medium\",\r\n};\r\n","//\r\n// All icons are imported from https://fontawesome.com/icons?d=gallery\r\n// Icons are under the license https://fontawesome.com/license\r\n//\r\n// Note: when adding new icons, review https://developer.mozilla.org/en-US/docs/Mozilla/Developer_guide/RTL_Guidelines\r\n// to determine whether or not the icons should be mirrored in right-to-left languages.\r\nimport React from \"react\";\r\nimport oc from \"open-color\";\r\nimport clsx from \"clsx\";\r\nimport { THEME } from \"../constants\";\r\nconst activeElementColor = (theme) => theme === THEME.LIGHT ? oc.orange[4] : oc.orange[9];\r\nconst iconFillColor = (theme) => theme === THEME.LIGHT ? oc.black : oc.gray[4];\r\nconst handlerColor = (theme) => theme === THEME.LIGHT ? oc.white : \"#1e1e1e\";\r\nexport const createIcon = (d, opts = 512) => {\r\n    const { width = 512, height = width, mirror, style, } = typeof opts === \"number\" ? { width: opts } : opts;\r\n    return (<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" viewBox={`0 0 ${width} ${height}`} className={clsx({ \"rtl-mirror\": mirror })} style={style}>\r\n      {typeof d === \"string\" ? <path fill=\"currentColor\" d={d}/> : d}\r\n    </svg>);\r\n};\r\nexport const checkIcon = createIcon(<polyline fill=\"none\" stroke=\"currentColor\" points=\"20 6 9 17 4 12\"/>, {\r\n    width: 24,\r\n    height: 24,\r\n});\r\nexport const link = createIcon(\"M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96 0-59.27-59.26-59.27-155.7 0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757 0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037 0 0 1-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482 0 0 1 20.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96 0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454 0 0 0 20.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037 0 0 0-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639 0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z\", { mirror: true });\r\nexport const save = createIcon(\"M433.941 129.941l-83.882-83.882A48 48 0 0 0 316.118 32H48C21.49 32 0 53.49 0 80v352c0 26.51 21.49 48 48 48h352c26.51 0 48-21.49 48-48V163.882a48 48 0 0 0-14.059-33.941zM224 416c-35.346 0-64-28.654-64-64 0-35.346 28.654-64 64-64s64 28.654 64 64c0 35.346-28.654 64-64 64zm96-304.52V212c0 6.627-5.373 12-12 12H76c-6.627 0-12-5.373-12-12V108c0-6.627 5.373-12 12-12h228.52c3.183 0 6.235 1.264 8.485 3.515l3.48 3.48A11.996 11.996 0 0 1 320 111.48z\", { width: 448, height: 512 });\r\nexport const saveAs = createIcon(\"M252 54L203 8a28 27 0 00-20-8H28C12 0 0 12 0 27v195c0 15 12 26 28 26h204c15 0 28-11 28-26V73a28 27 0 00-8-19zM130 213c-21 0-37-16-37-36 0-19 16-35 37-35 20 0 37 16 37 35 0 20-17 36-37 36zm56-169v56c0 4-4 6-7 6H44c-4 0-7-2-7-6V42c0-4 3-7 7-7h133l4 2 3 2a7 7 0 012 5z M296 201l87 95-188 205-78 9c-10 1-19-8-18-20l9-84zm141-14l-41-44a31 31 0 00-46 0l-38 41 87 95 38-42c13-14 13-36 0-50z\", { width: 448, height: 512 });\r\nexport const load = createIcon(\"M572.694 292.093L500.27 416.248A63.997 63.997 0 0 1 444.989 448H45.025c-18.523 0-30.064-20.093-20.731-36.093l72.424-124.155A64 64 0 0 1 152 256h399.964c18.523 0 30.064 20.093 20.73 36.093zM152 224h328v-48c0-26.51-21.49-48-48-48H272l-64-64H48C21.49 64 0 85.49 0 112v278.046l69.077-118.418C86.214 242.25 117.989 224 152 224z\", { width: 576, height: 512, mirror: true });\r\nexport const clipboard = createIcon(\"M384 112v352c0 26.51-21.49 48-48 48H48c-26.51 0-48-21.49-48-48V112c0-26.51 21.49-48 48-48h80c0-35.29 28.71-64 64-64s64 28.71 64 64h80c26.51 0 48 21.49 48 48zM192 40c-13.255 0-24 10.745-24 24s10.745 24 24 24 24-10.745 24-24-10.745-24-24-24m96 114v-20a6 6 0 0 0-6-6H102a6 6 0 0 0-6 6v20a6 6 0 0 0 6 6h180a6 6 0 0 0 6-6z\", { width: 384, height: 512 });\r\nexport const trash = createIcon(\"M32 464a48 48 0 0 0 48 48h288a48 48 0 0 0 48-48V128H32zm272-256a16 16 0 0 1 32 0v224a16 16 0 0 1-32 0zm-96 0a16 16 0 0 1 32 0v224a16 16 0 0 1-32 0zm-96 0a16 16 0 0 1 32 0v224a16 16 0 0 1-32 0zM432 32H312l-9.4-18.7A24 24 0 0 0 281.1 0H166.8a23.72 23.72 0 0 0-21.4 13.3L136 32H16A16 16 0 0 0 0 48v32a16 16 0 0 0 16 16h416a16 16 0 0 0 16-16V48a16 16 0 0 0-16-16z\", { width: 448, height: 512 });\r\nexport const palette = createIcon(\"M204.3 5C104.9 24.4 24.8 104.3 5.2 203.4c-37 187 131.7 326.4 258.8 306.7 41.2-6.4 61.4-54.6 42.5-91.7-23.1-45.4 9.9-98.4 60.9-98.4h79.7c35.8 0 64.8-29.6 64.9-65.3C511.5 97.1 368.1-26.9 204.3 5zM96 320c-17.7 0-32-14.3-32-32s14.3-32 32-32 32 14.3 32 32-14.3 32-32 32zm32-128c-17.7 0-32-14.3-32-32s14.3-32 32-32 32 14.3 32 32-14.3 32-32 32zm128-64c-17.7 0-32-14.3-32-32s14.3-32 32-32 32 14.3 32 32-14.3 32-32 32zm128 64c-17.7 0-32-14.3-32-32s14.3-32 32-32 32 14.3 32 32-14.3 32-32 32z\");\r\nexport const exportFile = createIcon(\"M384 121.9c0-6.3-2.5-12.4-7-16.9L279.1 7c-4.5-4.5-10.6-7-17-7H256v128h128zM571 308l-95.7-96.4c-10.1-10.1-27.4-3-27.4 11.3V288h-64v64h64v65.2c0 14.3 17.3 21.4 27.4 11.3L571 332c6.6-6.6 6.6-17.4 0-24zm-379 28v-32c0-8.8 7.2-16 16-16h176V160H248c-13.2 0-24-10.8-24-24V0H24C10.7 0 0 10.7 0 24v464c0 13.3 10.7 24 24 24h336c13.3 0 24-10.7 24-24V352H208c-8.8 0-16-7.2-16-16z\", { width: 576, height: 512, mirror: true });\r\nexport const exportImage = createIcon(<>\r\n    <path d=\"M571 308l-95.7-96.4c-10.1-10.1-27.4-3-27.4 11.3V288h-64v64h64v65.2c0 14.3 17.3 21.4 27.4 11.3L571 332c6.6-6.6 6.6-17.4 0-24zm-187 44v-64 64z\"/>\r\n    <path d=\"M384 121.941V128H256V0h6.059c6.362 0 12.471 2.53 16.97 7.029l97.941 97.941a24.01 24.01 0 017.03 16.971zM248 160c-13.2 0-24-10.8-24-24V0H24C10.745 0 0 10.745 0 24v464c0 13.255 10.745 24 24 24h336c13.255 0 24-10.745 24-24V160H248zm-135.455 16c26.51 0 48 21.49 48 48s-21.49 48-48 48-48-21.49-48-48 21.491-48 48-48zm208 240h-256l.485-48.485L104.545 328c4.686-4.686 11.799-4.201 16.485.485L160.545 368 264.06 264.485c4.686-4.686 12.284-4.686 16.971 0L320.545 304v112z\"/>\r\n  </>, { width: 576, height: 512, mirror: true });\r\nexport const exportToFileIcon = createIcon(\"M216 0h80c13.3 0 24 10.7 24 24v168h87.7c17.8 0 26.7 21.5 14.1 34.1L269.7 378.3c-7.5 7.5-19.8 7.5-27.3 0L90.1 226.1c-12.6-12.6-3.7-34.1 14.1-34.1H192V24c0-13.3 10.7-24 24-24zm296 376v112c0 13.3-10.7 24-24 24H24c-13.3 0-24-10.7-24-24V376c0-13.3 10.7-24 24-24h146.7l49 49c20.1 20.1 52.5 20.1 72.6 0l49-49H488c13.3 0 24 10.7 24 24zm-124 88c0-11-9-20-20-20s-20 9-20 20 9 20 20 20 20-9 20-20zm64 0c0-11-9-20-20-20s-20 9-20 20 9 20 20 20 20-9 20-20z\", { width: 512, height: 512 });\r\nexport const zoomIn = createIcon(\"M416 208H272V64c0-17.67-14.33-32-32-32h-32c-17.67 0-32 14.33-32 32v144H32c-17.67 0-32 14.33-32 32v32c0 17.67 14.33 32 32 32h144v144c0 17.67 14.33 32 32 32h32c17.67 0 32-14.33 32-32V304h144c17.67 0 32-14.33 32-32v-32c0-17.67-14.33-32-32-32z\", { width: 448, height: 512 });\r\nexport const zoomOut = createIcon(\"M416 208H32c-17.67 0-32 14.33-32 32v32c0 17.67 14.33 32 32 32h384c17.67 0 32-14.33 32-32v-32c0-17.67-14.33-32-32-32z\", { width: 448, height: 512 });\r\nexport const done = createIcon(\"M173.898 439.404l-166.4-166.4c-9.997-9.997-9.997-26.206 0-36.204l36.203-36.204c9.997-9.998 26.207-9.998 36.204 0L192 312.69 432.095 72.596c9.997-9.997 26.207-9.997 36.204 0l36.203 36.204c9.997 9.997 9.997 26.206 0 36.204l-294.4 294.401c-9.998 9.997-26.207 9.997-36.204-.001z\");\r\nexport const menu = createIcon(\"M16 132h416c8.837 0 16-7.163 16-16V76c0-8.837-7.163-16-16-16H16C7.163 60 0 67.163 0 76v40c0 8.837 7.163 16 16 16zm0 160h416c8.837 0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H16c-8.837 0-16 7.163-16 16v40c0 8.837 7.163 16 16 16zm0 160h416c8.837 0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H16c-8.837 0-16 7.163-16 16v40c0 8.837 7.163 16 16 16z\");\r\nexport const undo = createIcon(\"M255.545 8c-66.269.119-126.438 26.233-170.86 68.685L48.971 40.971C33.851 25.851 8 36.559 8 57.941V192c0 13.255 10.745 24 24 24h134.059c21.382 0 32.09-25.851 16.971-40.971l-41.75-41.75c30.864-28.899 70.801-44.907 113.23-45.273 92.398-.798 170.283 73.977 169.484 169.442C423.236 348.009 349.816 424 256 424c-41.127 0-79.997-14.678-110.63-41.556-4.743-4.161-11.906-3.908-16.368.553L89.34 422.659c-4.872 4.872-4.631 12.815.482 17.433C133.798 479.813 192.074 504 256 504c136.966 0 247.999-111.033 248-247.998C504.001 119.193 392.354 7.755 255.545 8z\", { mirror: true });\r\nexport const redo = createIcon(\"M256.455 8c66.269.119 126.437 26.233 170.859 68.685l35.715-35.715C478.149 25.851 504 36.559 504 57.941V192c0 13.255-10.745 24-24 24H345.941c-21.382 0-32.09-25.851-16.971-40.971l41.75-41.75c-30.864-28.899-70.801-44.907-113.23-45.273-92.398-.798-170.283 73.977-169.484 169.442C88.764 348.009 162.184 424 256 424c41.127 0 79.997-14.678 110.629-41.556 4.743-4.161 11.906-3.908 16.368.553l39.662 39.662c4.872 4.872 4.631 12.815-.482 17.433C378.202 479.813 319.926 504 256 504 119.034 504 8.001 392.967 8 256.002 7.999 119.193 119.646 7.755 256.455 8z\", { mirror: true });\r\nexport const questionCircle = createIcon(\"M504 256c0 136.997-111.043 248-248 248S8 392.997 8 256C8 119.083 119.043 8 256 8s248 111.083 248 248zM262.655 90c-54.497 0-89.255 22.957-116.549 63.758-3.536 5.286-2.353 12.415 2.715 16.258l34.699 26.31c5.205 3.947 12.621 3.008 16.665-2.122 17.864-22.658 30.113-35.797 57.303-35.797 20.429 0 45.698 13.148 45.698 32.958 0 14.976-12.363 22.667-32.534 33.976C247.128 238.528 216 254.941 216 296v4c0 6.627 5.373 12 12 12h56c6.627 0 12-5.373 12-12v-1.333c0-28.462 83.186-29.647 83.186-106.667 0-58.002-60.165-102-116.531-102zM256 338c-25.365 0-46 20.635-46 46 0 25.364 20.635 46 46 46s46-20.636 46-46c0-25.365-20.635-46-46-46z\", { mirror: true });\r\nexport const share = createIcon(\"M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81 1.66 0 3-1.34 3-3s-1.34-3-3-3-3 1.34-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9c-1.66 0-3 1.34-3 3s1.34 3 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.16c-.05.21-.08.43-.08.65 0 1.61 1.31 2.92 2.92 2.92 1.61 0 2.92-1.31 2.92-2.92s-1.31-2.92-2.92-2.92z\", { width: 24, height: 24 });\r\nexport const shareIOS = createIcon(\"M16 5l-1.42 1.42-1.59-1.59V16h-1.98V4.83L9.42 6.42 8 5l4-4 4 4zm4 5v11c0 1.1-.9 2-2 2H6c-1.11 0-2-.9-2-2V10c0-1.11.89-2 2-2h3v2H6v11h12V10h-3V8h3c1.1 0 2 .89 2 2z\", { width: 24, height: 24 });\r\nexport const shareWindows = createIcon(<>\r\n    <path stroke=\"currentColor\" fill=\"currentColor\" d=\"M40 5.6v6.1l-4.1.7c-8.9 1.4-16.5 6.9-20.6 15C13 32 10.9 43 12.4 43c.4 0 2.4-1.3 4.4-3 5-3.9 12.1-7 18.2-7.7l5-.6v12.8l11.2-11.3L62.5 22 51.2 10.8 40-.5v6.1zm10.2 22.6L44 34.5v-6.8l-6.9.6c-3.9.3-9.8 1.7-13.2 3.1-3.5 1.4-6.5 2.4-6.7 2.2-.9-1 3-7.5 6.4-10.8C28 18.6 34.4 16 40.1 16c3.7 0 3.9-.1 3.9-3.2V9.5l6.2 6.3 6.3 6.2-6.3 6.2z\"/>\r\n    <path stroke=\"currentColor\" fill=\"currentColor\" d=\"M0 36v20h48v-6.2c0-6 0-6.1-2-4.3-1.1 1-2 2.9-2 4.2V52H4V34c0-17.3-.1-18-2-18s-2 .7-2 20z\"/>\r\n  </>, { width: 64, height: 64 });\r\n// Icon imported form Storybook\r\n// Storybook is licensed under MIT https://github.com/storybookjs/storybook/blob/next/LICENSE\r\nexport const resetZoom = createIcon(<path stroke=\"currentColor\" strokeWidth=\"40\" fill=\"currentColor\" d=\"M148 560a318 318 0 0 0 522 110 316 316 0 0 0 0-450 316 316 0 0 0-450 0c-11 11-21 22-30 34v4h47c25 0 46 21 46 46s-21 45-46 45H90c-13 0-25-6-33-14-9-9-14-20-14-33V156c0-25 20-45 45-45s45 20 45 45v32l1 1a401 401 0 0 1 623 509l212 212a42 42 0 0 1-59 59L698 757A401 401 0 0 1 65 570a42 42 0 0 1 83-10z\"/>, { width: 1024 });\r\nexport const BringForwardIcon = React.memo(({ theme }) => createIcon(<>\r\n      <path d=\"M22 9.556C22 8.696 21.303 8 20.444 8H16v8H8v4.444C8 21.304 8.697 22 9.556 22h10.888c.86 0 1.556-.697 1.556-1.556V9.556z\" fill={iconFillColor(theme)} stroke={iconFillColor(theme)} strokeWidth=\"2\"/>\r\n      <path d=\"M16 3.556C16 2.696 15.303 2 14.444 2H3.556C2.696 2 2 2.697 2 3.556v10.888C2 15.304 2.697 16 3.556 16h10.888c.86 0 1.556-.697 1.556-1.556V3.556z\" fill={activeElementColor(theme)} stroke={activeElementColor(theme)} strokeWidth=\"2\"/>\r\n    </>, { width: 24, mirror: true }));\r\nexport const SendBackwardIcon = React.memo(({ theme }) => createIcon(<>\r\n      <path d=\"M16 3.556C16 2.696 15.303 2 14.444 2H3.556C2.696 2 2 2.697 2 3.556v10.888C2 15.304 2.697 16 3.556 16h10.888c.86 0 1.556-.697 1.556-1.556V3.556z\" fill={activeElementColor(theme)} stroke={activeElementColor(theme)} strokeWidth=\"2\"/>\r\n      <path d=\"M22 9.556C22 8.696 21.303 8 20.444 8H9.556C8.696 8 8 8.697 8 9.556v10.888C8 21.304 8.697 22 9.556 22h10.888c.86 0 1.556-.697 1.556-1.556V9.556z\" fill={iconFillColor(theme)} stroke={iconFillColor(theme)} strokeWidth=\"2\"/>\r\n    </>, { width: 24, mirror: true }));\r\nexport const BringToFrontIcon = React.memo(({ theme }) => createIcon(<>\r\n      <path d=\"M13 21a1 1 0 001 1h7a1 1 0 001-1v-7a1 1 0 00-1-1h-3v5h-5v3zM11 3a1 1 0 00-1-1H3a1 1 0 00-1 1v7a1 1 0 001 1h3V6h5V3z\" fill={iconFillColor(theme)} stroke={iconFillColor(theme)} strokeWidth=\"2\"/>\r\n      <path d=\"M18 7.333C18 6.597 17.403 6 16.667 6H7.333C6.597 6 6 6.597 6 7.333v9.334C6 17.403 6.597 18 7.333 18h9.334c.736 0 1.333-.597 1.333-1.333V7.333z\" fill={activeElementColor(theme)} stroke={activeElementColor(theme)} strokeWidth=\"2\"/>\r\n    </>, { width: 24, mirror: true }));\r\nexport const SendToBackIcon = React.memo(({ theme }) => createIcon(<>\r\n      <path d=\"M18 7.333C18 6.597 17.403 6 16.667 6H7.333C6.597 6 6 6.597 6 7.333v9.334C6 17.403 6.597 18 7.333 18h9.334c.736 0 1.333-.597 1.333-1.333V7.333z\" fill={activeElementColor(theme)} stroke={activeElementColor(theme)} strokeWidth=\"2\"/>\r\n      <path d=\"M11 3a1 1 0 00-1-1H3a1 1 0 00-1 1v7a1 1 0 001 1h8V3zM22 14a1 1 0 00-1-1h-7a1 1 0 00-1 1v7a1 1 0 001 1h8v-8z\" fill={iconFillColor(theme)} stroke={iconFillColor(theme)} strokeWidth=\"2\"/>\r\n    </>, { width: 24, mirror: true }));\r\n//\r\n// Align action icons created from scratch to match those of z-index actions\r\n// Note: vertical align icons are flipped so the larger item is always the\r\n// first one the user sees. Horizontal align icons should not be flipped since\r\n// that would make them lie about their function.\r\n//\r\nexport const AlignTopIcon = React.memo(({ theme }) => createIcon(<>\r\n      <path d=\"M 2,5 H 22\" fill={iconFillColor(theme)} stroke={iconFillColor(theme)} strokeWidth=\"2\" strokeLinecap=\"round\"/>\r\n      <path d=\"M 6,7 C 5.446,7 5,7.446 5,8 v 9.999992 c 0,0.554 0.446,1 1,1 h 3.0000001 c 0.554,0 0.9999999,-0.446 0.9999999,-1 V 8 C 10,7.446 9.5540001,7 9.0000001,7 Z m 9,0 c -0.554,0 -1,0.446 -1,1 v 5.999992 c 0,0.554 0.446,1 1,1 h 3 c 0.554,0 1,-0.446 1,-1 V 8 C 19,7.446 18.554,7 18,7 Z\" fill={activeElementColor(theme)} stroke={activeElementColor(theme)} strokeWidth=\"2\"/>\r\n    </>, { width: 24, mirror: true }));\r\nexport const AlignBottomIcon = React.memo(({ theme }) => createIcon(<>\r\n      <path d=\"M 2,19 H 22\" fill={iconFillColor(theme)} stroke={iconFillColor(theme)} strokeWidth=\"2\" strokeLinecap=\"round\"/>\r\n      <path d=\"m 6,16.999992 c -0.554,0 -1,-0.446 -1,-1 V 6 C 5,5.446 5.446,5 6,5 H 9.0000001 C 9.5540001,5 10,5.446 10,6 v 9.999992 c 0,0.554 -0.4459999,1 -0.9999999,1 z m 9,0 c -0.554,0 -1,-0.446 -1,-1 V 10 c 0,-0.554 0.446,-1 1,-1 h 3 c 0.554,0 1,0.446 1,1 v 5.999992 c 0,0.554 -0.446,1 -1,1 z\" fill={activeElementColor(theme)} stroke={activeElementColor(theme)} strokeWidth=\"2\"/>\r\n    </>, { width: 24, mirror: true }));\r\nexport const AlignLeftIcon = React.memo(({ theme }) => createIcon(<>\r\n      <path d=\"M 5,2 V 22\" fill={iconFillColor(theme)} stroke={iconFillColor(theme)} strokeWidth=\"2\" strokeLinecap=\"round\"/>\r\n      <path d=\"m 7.000004,5.999996 c 0,-0.554 0.446,-1 1,-1 h 9.999992 c 0.554,0 1,0.446 1,1 v 3.0000001 c 0,0.554 -0.446,0.9999999 -1,0.9999999 H 8.000004 c -0.554,0 -1,-0.4459999 -1,-0.9999999 z m 0,9 c 0,-0.554 0.446,-1 1,-1 h 5.999992 c 0.554,0 1,0.446 1,1 v 3 c 0,0.554 -0.446,1 -1,1 H 8.000004 c -0.554,0 -1,-0.446 -1,-1 z\" fill={activeElementColor(theme)} stroke={activeElementColor(theme)} strokeWidth=\"2\"/>\r\n    </>, { width: 24 }));\r\nexport const AlignRightIcon = React.memo(({ theme }) => createIcon(<>\r\n      <path d=\"M 19,2 V 22\" fill={iconFillColor(theme)} stroke={iconFillColor(theme)} strokeWidth=\"2\" strokeLinecap=\"round\"/>\r\n      <path d=\"m 16.999996,5.999996 c 0,-0.554 -0.446,-1 -1,-1 H 6.000004 c -0.554,0 -1,0.446 -1,1 v 3.0000001 c 0,0.554 0.446,0.9999999 1,0.9999999 h 9.999992 c 0.554,0 1,-0.4459999 1,-0.9999999 z m 0,9 c 0,-0.554 -0.446,-1 -1,-1 h -5.999992 c -0.554,0 -1,0.446 -1,1 v 3 c 0,0.554 0.446,1 1,1 h 5.999992 c 0.554,0 1,-0.446 1,-1 z\" fill={activeElementColor(theme)} stroke={activeElementColor(theme)} strokeWidth=\"2\"/>\r\n    </>, { width: 24 }));\r\nexport const DistributeHorizontallyIcon = React.memo(({ theme }) => createIcon(<>\r\n        <path d=\"M19 5V19M5 5V19\" stroke={iconFillColor(theme)} strokeWidth=\"2\" strokeLinecap=\"round\"/>\r\n        <path d=\"M15 9C15.554 9 16 9.446 16 10V14C16 14.554 15.554 15 15 15H9C8.446 15 8 14.554 8 14V10C8 9.446 8.446 9 9 9H15Z\" fill={activeElementColor(theme)} stroke={activeElementColor(theme)} strokeWidth=\"2\"/>\r\n      </>, { width: 24 }));\r\nexport const DistributeVerticallyIcon = React.memo(({ theme }) => createIcon(<>\r\n        <path d=\"M5 5L19 5M5 19H19\" fill={iconFillColor(theme)} stroke={iconFillColor(theme)} strokeWidth=\"2\" strokeLinecap=\"round\"/>\r\n        <path d=\"M15 9C15.554 9 16 9.446 16 10V14C16 14.554 15.554 15 15 15H9C8.446 15 8 14.554 8 14V10C8 9.446 8.446 9 9 9H15Z\" fill={activeElementColor(theme)} stroke={activeElementColor(theme)} strokeWidth=\"2\"/>\r\n      </>, { width: 24 }));\r\nexport const CenterVerticallyIcon = React.memo(({ theme }) => createIcon(<>\r\n      <path d=\"m 5.000004,16.999996 c 0,0.554 0.446,1 1,1 h 3 c 0.554,0 1,-0.446 1,-1 v -10 c 0,-0.554 -0.446,-1 -1,-1 h -3 c -0.554,0 -1,0.446 -1,1 z m 9,-2 c 0,0.554 0.446,1 1,1 h 3 c 0.554,0 1,-0.446 1,-1 v -6 c 0,-0.554 -0.446,-1 -1,-1 h -3 c -0.554,0 -1,0.446 -1,1 z\" fill={activeElementColor(theme)} stroke={activeElementColor(theme)} strokeWidth=\"2\"/>\r\n      <path d=\"M 2,12 H 22\" fill={iconFillColor(theme)} stroke={iconFillColor(theme)} strokeWidth=\"2\" strokeDasharray=\"1, 2.8\" strokeLinecap=\"round\"/>\r\n    </>, { width: 24, mirror: true }));\r\nexport const CenterHorizontallyIcon = React.memo(({ theme }) => createIcon(<>\r\n        <path d=\"M 7 5 C 6.446 5 6 5.446 6 6 L 6 9 C 6 9.554 6.446 10 7 10 L 17 10 C 17.554 10 18 9.554 18 9 L 18 6 C 18 5.446 17.554 5 17 5 L 7 5 z M 9 14 C 8.446 14 8 14.446 8 15 L 8 18 C 8 18.554 8.446 19 9 19 L 15 19 C 15.554 19 16 18.554 16 18 L 16 15 C 16 14.446 15.554 14 15 14 L 9 14 z \" fill={activeElementColor(theme)} stroke={activeElementColor(theme)} strokeWidth=\"2\"/>\r\n        <path d=\"M 12,2 V 22\" fill={iconFillColor(theme)} stroke={iconFillColor(theme)} strokeWidth=\"2\" strokeDasharray=\"1, 2.8\" strokeLinecap=\"round\"/>\r\n      </>, { width: 24 }));\r\nexport const users = createIcon(\"M192 256c61.9 0 112-50.1 112-112S253.9 32 192 32 80 82.1 80 144s50.1 112 112 112zm76.8 32h-8.3c-20.8 10-43.9 16-68.5 16s-47.6-6-68.5-16h-8.3C51.6 288 0 339.6 0 403.2V432c0 26.5 21.5 48 48 48h288c26.5 0 48-21.5 48-48v-28.8c0-63.6-51.6-115.2-115.2-115.2zM480 256c53 0 96-43 96-96s-43-96-96-96-96 43-96 96 43 96 96 96zm48 32h-3.8c-13.9 4.8-28.6 8-44.2 8s-30.3-3.2-44.2-8H432c-20.4 0-39.2 5.9-55.7 15.4 24.4 26.3 39.7 61.2 39.7 99.8v38.4c0 2.2-.5 4.3-.6 6.4H592c26.5 0 48-21.5 48-48 0-61.9-50.1-112-112-112z\", { width: 640, height: 512, mirror: true });\r\n// not mirrored because it's inspired by a playback control, which is always RTL\r\nexport const start = createIcon(\"M256 8C119 8 8 119 8 256s111 248 248 248 248-111 248-248S393 8 256 8zm115.7 272l-176 101c-15.8 8.8-35.7-2.5-35.7-21V152c0-18.4 19.8-29.8 35.7-21l176 107c16.4 9.2 16.4 32.9 0 42z\");\r\nexport const stop = createIcon(\"M256 8C119 8 8 119 8 256s111 248 248 248 248-111 248-248S393 8 256 8zm96 328c0 8.8-7.2 16-16 16H176c-8.8 0-16-7.2-16-16V176c0-8.8 7.2-16 16-16h160c8.8 0 16 7.2 16 16v160z\");\r\nexport const close = createIcon(\"M242.72 256l100.07-100.07c12.28-12.28 12.28-32.19 0-44.48l-22.24-22.24c-12.28-12.28-32.19-12.28-44.48 0L176 189.28 75.93 89.21c-12.28-12.28-32.19-12.28-44.48 0L9.21 111.45c-12.28 12.28-12.28 32.19 0 44.48L109.28 256 9.21 356.07c-12.28 12.28-12.28 32.19 0 44.48l22.24 22.24c12.28 12.28 32.2 12.28 44.48 0L176 322.72l100.07 100.07c12.28 12.28 32.2 12.28 44.48 0l22.24-22.24c12.28-12.28 12.28-32.19 0-44.48L242.72 256z\", { width: 352, height: 512 });\r\nexport const back = createIcon(\"M34.52 239.03L228.87 44.69c9.37-9.37 24.57-9.37 33.94 0l22.67 22.67c9.36 9.36 9.37 24.52.04 33.9L131.49 256l154.02 154.75c9.34 9.38 9.32 24.54-.04 33.9l-22.67 22.67c-9.37 9.37-24.57 9.37-33.94 0L34.52 272.97c-9.37-9.37-9.37-24.57 0-33.94z\", { width: 320, height: 512, style: { marginLeft: \"-0.2rem\" }, mirror: true });\r\nexport const clone = createIcon(\"M464 0c26.51 0 48 21.49 48 48v288c0 26.51-21.49 48-48 48H176c-26.51 0-48-21.49-48-48V48c0-26.51 21.49-48 48-48h288M176 416c-44.112 0-80-35.888-80-80V128H48c-26.51 0-48 21.49-48 48v288c0 26.51 21.49 48 48 48h288c26.51 0 48-21.49 48-48v-48H176z\", { mirror: true });\r\n// modified https://feathericons.com/?query=shield\r\nexport const shield = createIcon(\"M11.553 22.894a.998.998 0 00.894 0s3.037-1.516 5.465-4.097C19.616 16.987 21 14.663 21 12V5a1 1 0 00-.649-.936l-8-3a.998.998 0 00-.702 0l-8 3A1 1 0 003 5v7c0 2.663 1.384 4.987 3.088 6.797 2.428 2.581 5.465 4.097 5.465 4.097zm-1.303-8.481l6.644-6.644a.856.856 0 111.212 1.212l-7.25 7.25a.856.856 0 01-1.212 0l-3.75-3.75a.856.856 0 111.212-1.212l3.144 3.144z\", { width: 24 });\r\nexport const file = createIcon(\"M369.9 97.9L286 14C277 5 264.8-.1 252.1-.1H48C21.5 0 0 21.5 0 48v416c0 26.5 21.5 48 48 48h288c26.5 0 48-21.5 48-48V131.9c0-12.7-5.1-25-14.1-34zM332.1 128H256V51.9l76.1 76.1zM48 464V48h160v104c0 13.3 10.7 24 24 24h104v288H48zm32-48h224V288l-23.5-23.5c-4.7-4.7-12.3-4.7-17 0L176 352l-39.5-39.5c-4.7-4.7-12.3-4.7-17 0L80 352v64zm48-240c-26.5 0-48 21.5-48 48s21.5 48 48 48 48-21.5 48-48-21.5-48-48-48z\", { width: 384, height: 512 });\r\nexport const GroupIcon = React.memo(({ theme }) => createIcon(<>\r\n      <path d=\"M25 26H111V111H25\" fill={iconFillColor(theme)}/>\r\n      <path d=\"M25 111C25 80.2068 25 49.4135 25 26M25 26C48.6174 26 72.2348 26 111 26H25ZM25 26C53.3671 26 81.7343 26 111 26H25ZM111 26C111 52.303 111 78.606 111 111V26ZM111 26C111 51.2947 111 76.5893 111 111V26ZM111 111C87.0792 111 63.1585 111 25 111H111ZM111 111C87.4646 111 63.9293 111 25 111H111ZM25 111C25 81.1514 25 51.3028 25 26V111Z\" stroke={iconFillColor(theme)} strokeWidth=\"2\"/>\r\n      <path d=\"M100 100H160V160H100\" fill={iconFillColor(theme)}/>\r\n      <path d=\"M100 160C100 144.106 100 128.211 100 100M100 100C117.706 100 135.412 100 160 100H100ZM100 100C114.214 100 128.428 100 160 100H100ZM160 100C160 120.184 160 140.369 160 160V100ZM160 100C160 113.219 160 126.437 160 160V100ZM160 160C145.534 160 131.068 160 100 160H160ZM160 160C143.467 160 126.934 160 100 160H160ZM100 160C100 143.661 100 127.321 100 100V160Z\" stroke={iconFillColor(theme)} strokeWidth=\"2\"/>\r\n      <g fill={handlerColor(theme)} stroke={iconFillColor(theme)} strokeWidth=\"6\">\r\n        <rect x=\"2.5\" y=\"2.5\" width=\"30\" height=\"30\"/>\r\n        <rect x=\"2.5\" y=\"149.5\" width=\"30\" height=\"30\"/>\r\n        <rect x=\"147.5\" y=\"149.5\" width=\"30\" height=\"30\"/>\r\n        <rect x=\"147.5\" y=\"2.5\" width=\"30\" height=\"30\"/>\r\n      </g>\r\n    </>, { width: 182, height: 182, mirror: true }));\r\nexport const UngroupIcon = React.memo(({ theme }) => createIcon(<>\r\n      <path d=\"M25 26H111V111H25\" fill={iconFillColor(theme)}/>\r\n      <path d=\"M25 111C25 80.2068 25 49.4135 25 26M25 26C48.6174 26 72.2348 26 111 26H25ZM25 26C53.3671 26 81.7343 26 111 26H25ZM111 26C111 52.303 111 78.606 111 111V26ZM111 26C111 51.2947 111 76.5893 111 111V26ZM111 111C87.0792 111 63.1585 111 25 111H111ZM111 111C87.4646 111 63.9293 111 25 111H111ZM25 111C25 81.1514 25 51.3028 25 26V111Z\" stroke={iconFillColor(theme)} strokeWidth=\"2\"/>\r\n      <path d=\"M100 100H160V160H100\" fill={iconFillColor(theme)}/>\r\n      <path d=\"M100 160C100 144.106 100 128.211 100 100M100 100C117.706 100 135.412 100 160 100H100ZM100 100C114.214 100 128.428 100 160 100H100ZM160 100C160 120.184 160 140.369 160 160V100ZM160 100C160 113.219 160 126.437 160 160V100ZM160 160C145.534 160 131.068 160 100 160H160ZM160 160C143.467 160 126.934 160 100 160H160ZM100 160C100 143.661 100 127.321 100 100V160Z\" stroke={iconFillColor(theme)} strokeWidth=\"2\"/>\r\n      <g fill={handlerColor(theme)} stroke={iconFillColor(theme)} strokeWidth=\"6\">\r\n        <rect x=\"2.5\" y=\"2.5\" width=\"30\" height=\"30\"/>\r\n        <rect x=\"78.5\" y=\"149.5\" width=\"30\" height=\"30\"/>\r\n        <rect x=\"147.5\" y=\"149.5\" width=\"30\" height=\"30\"/>\r\n        <rect x=\"147.5\" y=\"78.5\" width=\"30\" height=\"30\"/>\r\n        <rect x=\"105.5\" y=\"2.5\" width=\"30\" height=\"30\"/>\r\n        <rect x=\"2.5\" y=\"102.5\" width=\"30\" height=\"30\"/>\r\n      </g>\r\n    </>, { width: 182, height: 182, mirror: true }));\r\nexport const FillHachureIcon = React.memo(({ theme }) => createIcon(<path fillRule=\"evenodd\" clipRule=\"evenodd\" d=\"M20.101 16H28.0934L36 8.95989V4H33.5779L20.101 16ZM30.5704 4L17.0935 16H9.10101L22.5779 4H30.5704ZM19.5704 4L6.09349 16H4V10.7475L11.5779 4H19.5704ZM8.57036 4H4V8.06952L8.57036 4ZM36 11.6378L31.101 16H36V11.6378ZM2 2V18H38V2H2Z\" fill={iconFillColor(theme)}/>, { width: 40, height: 20 }));\r\nexport const FillCrossHatchIcon = React.memo(({ theme }) => createIcon(<g fill={iconFillColor(theme)} fillRule=\"evenodd\" clipRule=\"evenodd\">\r\n      <path d=\"M20.101 16H28.0934L36 8.95989V4H33.5779L20.101 16ZM30.5704 4L17.0935 16H9.10101L22.5779 4H30.5704ZM19.5704 4L6.09349 16H4V10.7475L11.5779 4H19.5704ZM8.57036 4H4V8.06952L8.57036 4ZM36 11.6378L31.101 16H36V11.6378ZM2 2V18H38V2H2Z\"/>\r\n      <path d=\"M14.0001 18L3.00006 4.00002L4.5727 2.76438L15.5727 16.7644L14.0001 18ZM25.0001 18L14.0001 4.00002L15.5727 2.76438L26.5727 16.7644L25.0001 18ZM36.0001 18L25.0001 4.00002L26.5727 2.76438L37.5727 16.7644L36.0001 18Z\"/>\r\n    </g>, { width: 40, height: 20 }));\r\nexport const FillSolidIcon = React.memo(({ theme }) => createIcon(<path d=\"M2 2H38V18H2V2Z\" fill={iconFillColor(theme)}/>, {\r\n    width: 40,\r\n    height: 20,\r\n}));\r\nexport const StrokeWidthIcon = React.memo(({ theme, strokeWidth }) => createIcon(<path d=\"M6 10H32\" stroke={iconFillColor(theme)} strokeWidth={strokeWidth} strokeLinecap=\"round\" fill=\"none\"/>, { width: 40, height: 20 }));\r\nexport const StrokeStyleSolidIcon = React.memo(({ theme }) => createIcon(<path d=\"M6 10H34\" stroke={iconFillColor(theme)} strokeWidth={2} fill=\"none\" strokeLinecap=\"round\"/>, {\r\n    width: 40,\r\n    height: 20,\r\n}));\r\nexport const StrokeStyleDashedIcon = React.memo(({ theme }) => createIcon(<path d=\"M6 10H34\" stroke={iconFillColor(theme)} strokeWidth={2.5} strokeDasharray={\"10, 8\"} fill=\"none\" strokeLinecap=\"round\"/>, { width: 40, height: 20 }));\r\nexport const StrokeStyleDottedIcon = React.memo(({ theme }) => createIcon(<path d=\"M6 10H36\" stroke={iconFillColor(theme)} strokeWidth={2.5} strokeDasharray={\"2, 4.5\"} fill=\"none\" strokeLinecap=\"round\"/>, { width: 40, height: 20 }));\r\nexport const SloppinessArchitectIcon = React.memo(({ theme }) => createIcon(<path d=\"M3.00098 16.1691C6.28774 13.9744 19.6399 2.8905 22.7215 3.00082C25.8041 3.11113 19.1158 15.5488 21.4962 16.8309C23.8757 18.1131 34.4155 11.7148 37.0001 10.6919\" stroke={iconFillColor(theme)} strokeWidth={2} strokeLinecap=\"round\" fill=\"none\"/>, { width: 40, height: 20, mirror: true }));\r\nexport const SloppinessArtistIcon = React.memo(({ theme }) => createIcon(<path d=\"M3 17C6.68158 14.8752 16.1296 9.09849 22.0648 6.54922C28 3.99995 22.2896 13.3209 25 14C27.7104 14.6791 36.3757 9.6471 36.3757 9.6471M6.40706 15C13 11.1918 20.0468 1.51045 23.0234 3.0052C26 4.49995 20.457 12.8659 22.7285 16.4329C25 20 36.3757 13 36.3757 13\" stroke={iconFillColor(theme)} strokeWidth={2} strokeLinecap=\"round\" fill=\"none\"/>, { width: 40, height: 20, mirror: true }));\r\nexport const SloppinessCartoonistIcon = React.memo(({ theme }) => createIcon(<path d=\"M3 15.6468C6.93692 13.5378 22.5544 2.81528 26.6206 3.00242C30.6877 3.18956 25.6708 15.3346 27.4009 16.7705C29.1309 18.2055 35.4001 12.4762 37 11.6177M3.97143 10.4917C6.61158 9.24563 16.3706 2.61886 19.8104 3.01724C23.2522 3.41472 22.0773 12.2013 24.6181 12.8783C27.1598 13.5536 33.3179 8.04068 35.0571 7.07244\" stroke={iconFillColor(theme)} strokeWidth={2} strokeLinecap=\"round\" fill=\"none\"/>, { width: 40, height: 20, mirror: true }));\r\nexport const EdgeSharpIcon = React.memo(({ theme }) => createIcon(<path d=\"M10 17L10 5L35 5\" stroke={iconFillColor(theme)} strokeWidth={2} strokeLinecap=\"round\" fill=\"none\"/>, { width: 40, height: 20, mirror: true }));\r\nexport const EdgeRoundIcon = React.memo(({ theme }) => createIcon(<path d=\"M10 17V15C10 8 13 5 21 5L33.5 5\" stroke={iconFillColor(theme)} strokeWidth={2} strokeLinecap=\"round\" fill=\"none\"/>, { width: 40, height: 20, mirror: true }));\r\nexport const ArrowheadNoneIcon = React.memo(({ theme }) => createIcon(<path d=\"M6 10H34\" stroke={iconFillColor(theme)} strokeWidth={2} fill=\"none\"/>, {\r\n    width: 40,\r\n    height: 20,\r\n}));\r\nexport const ArrowheadArrowIcon = React.memo(({ theme, flip = false }) => createIcon(<g transform={flip ? \"translate(40, 0) scale(-1, 1)\" : \"\"} stroke={iconFillColor(theme)} strokeWidth={2} fill=\"none\">\r\n        <path d=\"M34 10H6M34 10L27 5M34 10L27 15\"/>\r\n        <path d=\"M27.5 5L34.5 10L27.5 15\"/>\r\n      </g>, { width: 40, height: 20 }));\r\nexport const ArrowheadDotIcon = React.memo(({ theme, flip = false }) => createIcon(<g stroke={iconFillColor(theme)} fill={iconFillColor(theme)} transform={flip ? \"translate(40, 0) scale(-1, 1)\" : \"\"}>\r\n        <path d=\"M32 10L6 10\" strokeWidth={2}/>\r\n        <circle r=\"4\" transform=\"matrix(-1 0 0 1 30 10)\"/>\r\n      </g>, { width: 40, height: 20 }));\r\nexport const ArrowheadBarIcon = React.memo(({ theme, flip = false }) => createIcon(<g transform={flip ? \"translate(40, 0) scale(-1, 1)\" : \"\"}>\r\n        <path d=\"M34 10H5.99996M34 10L34 5M34 10L34 15\" stroke={iconFillColor(theme)} strokeWidth={2} fill=\"none\"/>\r\n      </g>, { width: 40, height: 20 }));\r\nexport const ArrowheadTriangleIcon = React.memo(({ theme, flip = false }) => createIcon(<g stroke={iconFillColor(theme)} fill={iconFillColor(theme)} transform={flip ? \"translate(40, 0) scale(-1, 1)\" : \"\"}>\r\n        <path d=\"M32 10L6 10\" strokeWidth={2}/>\r\n        <path d=\"M27.5 5.5L34.5 10L27.5 14.5L27.5 5.5\"/>\r\n      </g>, { width: 40, height: 20 }));\r\nexport const FontSizeSmallIcon = React.memo(({ theme }) => createIcon(<path fill={iconFillColor(theme)} d=\"M 0 69.092 L 0 55.03 A 124.24 124.24 0 0 0 4.706 57.02 Q 6.826 57.863 8.708 58.5 A 53.466 53.466 0 0 0 12.231 59.571 Q 17.236 60.889 21.387 60.889 A 20.909 20.909 0 0 0 24.265 60.704 Q 25.719 60.502 26.903 60.077 A 8.649 8.649 0 0 0 29.028 58.985 Q 31.689 57.08 31.689 53.321 Q 31.689 51.221 30.518 49.585 A 10.126 10.126 0 0 0 29.282 48.177 Q 28.352 47.287 27.075 46.436 A 23.719 23.719 0 0 0 25.752 45.627 Q 23.774 44.492 20.176 42.735 A 254.44 254.44 0 0 0 17.822 41.602 Q 11.503 38.631 8.236 35.888 A 19.742 19.742 0 0 1 8.008 35.694 A 22.18 22.18 0 0 1 2.783 29.102 Q 0.83 25.342 0.83 20.313 A 22.471 22.471 0 0 1 1.733 13.778 A 17.283 17.283 0 0 1 7.251 5.42 A 21.486 21.486 0 0 1 15.177 1.272 Q 18.361 0.338 22.166 0.09 A 43.573 43.573 0 0 1 25 0 A 42.399 42.399 0 0 1 34.349 1.01 A 39.075 39.075 0 0 1 35.62 1.319 A 67.407 67.407 0 0 1 42.108 3.382 A 83.357 83.357 0 0 1 46.191 5.03 L 41.309 16.797 Q 35.596 14.453 31.86 13.526 A 30.762 30.762 0 0 0 25.417 12.612 A 28.337 28.337 0 0 0 24.512 12.598 A 14.846 14.846 0 0 0 22.022 12.793 Q 19.498 13.224 17.92 14.6 Q 15.625 16.602 15.625 19.824 Q 15.625 21.826 16.553 23.316 Q 17.48 24.805 19.507 26.197 A 18.343 18.343 0 0 0 20.659 26.912 Q 22.596 28.035 26.516 29.953 A 299.99 299.99 0 0 0 29.102 31.201 Q 37.91 35.412 41.841 39.642 A 16.553 16.553 0 0 1 42.822 40.796 A 17.675 17.675 0 0 1 46.301 49.233 A 23.517 23.517 0 0 1 46.533 52.588 A 21.581 21.581 0 0 1 45.471 59.515 A 17.733 17.733 0 0 1 39.575 67.823 Q 33.745 72.486 24.094 73.243 A 49.683 49.683 0 0 1 20.215 73.389 A 51.712 51.712 0 0 1 9.448 72.315 A 40.672 40.672 0 0 1 0 69.092 Z\"/>, { width: 47, height: 77 }));\r\nexport const FontSizeMediumIcon = React.memo(({ theme }) => createIcon(<path fill={iconFillColor(theme)} d=\"M 44.092 71.387 L 30.225 71.387 L 13.037 15.381 L 12.598 15.381 A 1505.093 1505.093 0 0 1 12.959 22.313 Q 13.426 31.715 13.508 36.4 A 102.991 102.991 0 0 1 13.525 38.184 L 13.525 71.387 L 0 71.387 L 0 0 L 20.605 0 L 37.5 54.59 L 37.793 54.59 L 55.713 0 L 76.318 0 L 76.318 71.387 L 62.207 71.387 L 62.207 37.598 Q 62.207 35.205 62.28 32.08 A 160.703 160.703 0 0 1 62.326 30.544 Q 62.452 26.754 62.866 17.168 A 5390.536 5390.536 0 0 1 62.939 15.479 L 62.5 15.479 L 44.092 71.387 Z\"/>, { width: 77, height: 75 }));\r\nexport const FontSizeLargeIcon = React.memo(({ theme }) => createIcon(<path fill={iconFillColor(theme)} d=\"M 44.092 71.387 L 0 71.387 L 0 0 L 15.137 0 L 15.137 58.887 L 44.092 58.887 L 44.092 71.387 Z\"/>, { width: 45, height: 75 }));\r\nexport const FontSizeExtraLargeIcon = React.memo(({ theme }) => createIcon(<path fill={iconFillColor(theme)} d=\"M 42.578 35.4 L 66.699 71.387 L 49.414 71.387 L 32.813 44.385 L 16.211 71.387 L 0 71.387 L 23.682 34.57 L 1.514 0 L 18.213 0 L 33.594 25.684 L 48.682 0 L 64.99 0 L 42.578 35.4 Z M 119.775 71.387 L 75.684 71.387 L 75.684 0 L 90.82 0 L 90.82 58.887 L 119.775 58.887 L 119.775 71.387 Z\"/>, { width: 120, height: 75 }));\r\nexport const FontFamilyHandDrawnIcon = React.memo(({ theme }) => createIcon(<path fill={iconFillColor(theme)} d=\"M290.74 93.24l128.02 128.02-277.99 277.99-114.14 12.6C11.35 513.54-1.56 500.62.14 485.34l12.7-114.22 277.9-277.88zm207.2-19.06l-60.11-60.11c-18.75-18.75-49.16-18.75-67.91 0l-56.55 56.55 128.02 128.02 56.55-56.55c18.75-18.76 18.75-49.16 0-67.91z\"/>, { width: 448, height: 512 }));\r\nexport const FontFamilyNormalIcon = React.memo(({ theme }) => createIcon(<>\r\n      <path fill={iconFillColor(theme)} d=\"M 63.818 71.68 L 54.492 71.68 L 45.898 49.561 L 17.578 49.561 L 9.082 71.68 L 0 71.68 L 27.881 0 L 35.986 0 L 63.818 71.68 Z M 20.605 41.602 L 43.213 41.602 L 35.205 19.971 L 31.787 9.277 Q 30.322 15.137 28.711 19.971 L 20.605 41.602 Z\"/>\r\n      <path fill={iconFillColor(theme)} d=\"M 68.994 71.68 L 52.686 71.68 L 47.51 54.688 L 21.484 54.688 L 16.309 71.68 L 0 71.68 L 25.195 0 L 43.701 0 L 68.994 71.68 Z M 25.293 41.992 L 43.896 41.992 A 27590.463 27590.463 0 0 1 42.2 36.532 Q 36.965 19.676 35.937 16.273 A 120.932 120.932 0 0 1 35.815 15.869 A 131.65 131.65 0 0 1 35.396 14.435 Q 34.951 12.879 34.675 11.741 A 34.866 34.866 0 0 1 34.521 11.084 A 141.762 141.762 0 0 1 33.706 14.075 Q 31.482 21.957 25.293 41.992 Z\"/>\r\n    </>, { width: 70, height: 78 }));\r\nexport const FontFamilyCodeIcon = React.memo(({ theme }) => createIcon(<>\r\n      <path fill={iconFillColor(theme)} d=\"M278.9 511.5l-61-17.7c-6.4-1.8-10-8.5-8.2-14.9L346.2 8.7c1.8-6.4 8.5-10 14.9-8.2l61 17.7c6.4 1.8 10 8.5 8.2 14.9L293.8 503.3c-1.9 6.4-8.5 10.1-14.9 8.2zm-114-112.2l43.5-46.4c4.6-4.9 4.3-12.7-.8-17.2L117 256l90.6-79.7c5.1-4.5 5.5-12.3.8-17.2l-43.5-46.4c-4.5-4.8-12.1-5.1-17-.5L3.8 247.2c-5.1 4.7-5.1 12.8 0 17.5l144.1 135.1c4.9 4.6 12.5 4.4 17-.5zm327.2.6l144.1-135.1c5.1-4.7 5.1-12.8 0-17.5L492.1 112.1c-4.8-4.5-12.4-4.3-17 .5L431.6 159c-4.6 4.9-4.3 12.7.8 17.2L523 256l-90.6 79.7c-5.1 4.5-5.5 12.3-.8 17.2l43.5 46.4c4.5 4.9 12.1 5.1 17 .6z\"/>\r\n    </>, { width: 640, height: 512 }));\r\nexport const TextAlignLeftIcon = React.memo(({ theme }) => createIcon(<path d=\"M12.83 352h262.34A12.82 12.82 0 00288 339.17v-38.34A12.82 12.82 0 00275.17 288H12.83A12.82 12.82 0 000 300.83v38.34A12.82 12.82 0 0012.83 352zm0-256h262.34A12.82 12.82 0 00288 83.17V44.83A12.82 12.82 0 00275.17 32H12.83A12.82 12.82 0 000 44.83v38.34A12.82 12.82 0 0012.83 96zM432 160H16a16 16 0 00-16 16v32a16 16 0 0016 16h416a16 16 0 0016-16v-32a16 16 0 00-16-16zm0 256H16a16 16 0 00-16 16v32a16 16 0 0016 16h416a16 16 0 0016-16v-32a16 16 0 00-16-16z\" fill={iconFillColor(theme)} strokeLinecap=\"round\"/>, { width: 448, height: 512 }));\r\nexport const TextAlignCenterIcon = React.memo(({ theme }) => createIcon(<path d=\"M432 160H16a16 16 0 00-16 16v32a16 16 0 0016 16h416a16 16 0 0016-16v-32a16 16 0 00-16-16zm0 256H16a16 16 0 00-16 16v32a16 16 0 0016 16h416a16 16 0 0016-16v-32a16 16 0 00-16-16zM108.1 96h231.81A12.09 12.09 0 00352 83.9V44.09A12.09 12.09 0 00339.91 32H108.1A12.09 12.09 0 0096 44.09V83.9A12.1 12.1 0 00108.1 96zm231.81 256A12.09 12.09 0 00352 339.9v-39.81A12.09 12.09 0 00339.91 288H108.1A12.09 12.09 0 0096 300.09v39.81a12.1 12.1 0 0012.1 12.1z\" fill={iconFillColor(theme)}/>, { width: 448, height: 512 }));\r\nexport const TextAlignRightIcon = React.memo(({ theme }) => createIcon(<path d=\"M16 224h416a16 16 0 0016-16v-32a16 16 0 00-16-16H16a16 16 0 00-16 16v32a16 16 0 0016 16zm416 192H16a16 16 0 00-16 16v32a16 16 0 0016 16h416a16 16 0 0016-16v-32a16 16 0 00-16-16zm3.17-384H172.83A12.82 12.82 0 00160 44.83v38.34A12.82 12.82 0 00172.83 96h262.34A12.82 12.82 0 00448 83.17V44.83A12.82 12.82 0 00435.17 32zm0 256H172.83A12.82 12.82 0 00160 300.83v38.34A12.82 12.82 0 00172.83 352h262.34A12.82 12.82 0 00448 339.17v-38.34A12.82 12.82 0 00435.17 288z\" fill={iconFillColor(theme)} strokeLinecap=\"round\"/>, { width: 448, height: 512 }));\r\n","export let actions = [];\r\nexport const register = (action) => {\r\n    actions = actions.concat(action);\r\n    return action;\r\n};\r\n","import { isSomeElementSelected } from \"../scene\";\r\nimport { KEYS } from \"../keys\";\r\nimport { ToolButton } from \"../components/ToolButton\";\r\nimport { trash } from \"../components/icons\";\r\nimport { t } from \"../i18n\";\r\nimport { register } from \"./register\";\r\nimport { getNonDeletedElements } from \"../element\";\r\nimport { newElementWith } from \"../element/mutateElement\";\r\nimport { getElementsInGroup } from \"../groups\";\r\nimport { LinearElementEditor } from \"../element/linearElementEditor\";\r\nimport { fixBindingsAfterDeletion } from \"../element/binding\";\r\nconst deleteSelectedElements = (elements, appState) => {\r\n    return {\r\n        elements: elements.map((el) => {\r\n            if (appState.selectedElementIds[el.id]) {\r\n                return newElementWith(el, { isDeleted: true });\r\n            }\r\n            return el;\r\n        }),\r\n        appState: {\r\n            ...appState,\r\n            selectedElementIds: {},\r\n        },\r\n    };\r\n};\r\nconst handleGroupEditingState = (appState, elements) => {\r\n    if (appState.editingGroupId) {\r\n        const siblingElements = getElementsInGroup(getNonDeletedElements(elements), appState.editingGroupId);\r\n        if (siblingElements.length) {\r\n            return {\r\n                ...appState,\r\n                selectedElementIds: { [siblingElements[0].id]: true },\r\n            };\r\n        }\r\n    }\r\n    return appState;\r\n};\r\nexport const actionDeleteSelected = register({\r\n    name: \"deleteSelectedElements\",\r\n    perform: (elements, appState) => {\r\n        if (appState.editingLinearElement) {\r\n            const { elementId, activePointIndex, startBindingElement, endBindingElement, } = appState.editingLinearElement;\r\n            const element = LinearElementEditor.getElement(elementId);\r\n            if (!element) {\r\n                return false;\r\n            }\r\n            if (\r\n            // case: no point selected  delete whole element\r\n            activePointIndex == null ||\r\n                activePointIndex === -1 ||\r\n                // case: deleting last remaining point\r\n                element.points.length < 2) {\r\n                const nextElements = elements.filter((el) => el.id !== element.id);\r\n                const nextAppState = handleGroupEditingState(appState, nextElements);\r\n                return {\r\n                    elements: nextElements,\r\n                    appState: {\r\n                        ...nextAppState,\r\n                        editingLinearElement: null,\r\n                    },\r\n                    commitToHistory: false,\r\n                };\r\n            }\r\n            // We cannot do this inside `movePoint` because it is also called\r\n            // when deleting the uncommitted point (which hasn't caused any binding)\r\n            const binding = {\r\n                startBindingElement: activePointIndex === 0 ? null : startBindingElement,\r\n                endBindingElement: activePointIndex === element.points.length - 1\r\n                    ? null\r\n                    : endBindingElement,\r\n            };\r\n            LinearElementEditor.movePoint(element, activePointIndex, \"delete\");\r\n            return {\r\n                elements,\r\n                appState: {\r\n                    ...appState,\r\n                    editingLinearElement: {\r\n                        ...appState.editingLinearElement,\r\n                        ...binding,\r\n                        activePointIndex: activePointIndex > 0 ? activePointIndex - 1 : 0,\r\n                    },\r\n                },\r\n                commitToHistory: true,\r\n            };\r\n        }\r\n        let { elements: nextElements, appState: nextAppState } = deleteSelectedElements(elements, appState);\r\n        fixBindingsAfterDeletion(nextElements, elements.filter(({ id }) => appState.selectedElementIds[id]));\r\n        nextAppState = handleGroupEditingState(nextAppState, nextElements);\r\n        return {\r\n            elements: nextElements,\r\n            appState: {\r\n                ...nextAppState,\r\n                elementType: \"selection\",\r\n                multiElement: null,\r\n            },\r\n            commitToHistory: isSomeElementSelected(getNonDeletedElements(elements), appState),\r\n        };\r\n    },\r\n    contextItemLabel: \"labels.delete\",\r\n    keyTest: (event) => event.key === KEYS.BACKSPACE || event.key === KEYS.DELETE,\r\n    PanelComponent: ({ elements, appState, updateData }) => (<ToolButton type=\"button\" icon={trash} title={t(\"labels.delete\")} aria-label={t(\"labels.delete\")} onClick={() => updateData(null)} visible={isSomeElementSelected(getNonDeletedElements(elements), appState)}/>),\r\n});\r\n","import { bumpVersion } from \"./element/mutateElement\";\r\nimport { getElementsInGroup } from \"./groups\";\r\nimport { findIndex, findLastIndex } from \"./utils\";\r\n/**\r\n * Returns indices of elements to move based on selected elements.\r\n * Includes contiguous deleted elements that are between two selected elements,\r\n *  e.g.: [0 (selected), 1 (deleted), 2 (deleted), 3 (selected)]\r\n */\r\nconst getIndicesToMove = (elements, appState) => {\r\n    let selectedIndices = [];\r\n    let deletedIndices = [];\r\n    let includeDeletedIndex = null;\r\n    let index = -1;\r\n    while (++index < elements.length) {\r\n        if (appState.selectedElementIds[elements[index].id]) {\r\n            if (deletedIndices.length) {\r\n                selectedIndices = selectedIndices.concat(deletedIndices);\r\n                deletedIndices = [];\r\n            }\r\n            selectedIndices.push(index);\r\n            includeDeletedIndex = index + 1;\r\n        }\r\n        else if (elements[index].isDeleted && includeDeletedIndex === index) {\r\n            includeDeletedIndex = index + 1;\r\n            deletedIndices.push(index);\r\n        }\r\n        else {\r\n            deletedIndices = [];\r\n        }\r\n    }\r\n    return selectedIndices;\r\n};\r\nconst toContiguousGroups = (array) => {\r\n    let cursor = 0;\r\n    return array.reduce((acc, value, index) => {\r\n        if (index > 0 && array[index - 1] !== value - 1) {\r\n            cursor = ++cursor;\r\n        }\r\n        (acc[cursor] || (acc[cursor] = [])).push(value);\r\n        return acc;\r\n    }, []);\r\n};\r\n/**\r\n * Returns next candidate index that's available to be moved to. Currently that\r\n *  is a non-deleted element, and not inside a group (unless we're editing it).\r\n */\r\nconst getTargetIndex = (appState, elements, boundaryIndex, direction) => {\r\n    const sourceElement = elements[boundaryIndex];\r\n    const indexFilter = (element) => {\r\n        if (element.isDeleted) {\r\n            return false;\r\n        }\r\n        // if we're editing group, find closest sibling irrespective of whether\r\n        // there's a different-group element between them (for legacy reasons)\r\n        if (appState.editingGroupId) {\r\n            return element.groupIds.includes(appState.editingGroupId);\r\n        }\r\n        return true;\r\n    };\r\n    const candidateIndex = direction === \"left\"\r\n        ? findLastIndex(elements, indexFilter, Math.max(0, boundaryIndex - 1))\r\n        : findIndex(elements, indexFilter, boundaryIndex + 1);\r\n    const nextElement = elements[candidateIndex];\r\n    if (!nextElement) {\r\n        return -1;\r\n    }\r\n    if (appState.editingGroupId) {\r\n        if (\r\n        // candidate element is a sibling in current editing group  return\r\n        sourceElement?.groupIds.join(\"\") === nextElement?.groupIds.join(\"\")) {\r\n            return candidateIndex;\r\n        }\r\n        else if (!nextElement?.groupIds.includes(appState.editingGroupId)) {\r\n            // candidate element is outside current editing group  prevent\r\n            return -1;\r\n        }\r\n    }\r\n    if (!nextElement.groupIds.length) {\r\n        return candidateIndex;\r\n    }\r\n    const siblingGroupId = appState.editingGroupId\r\n        ? nextElement.groupIds[nextElement.groupIds.indexOf(appState.editingGroupId) - 1]\r\n        : nextElement.groupIds[nextElement.groupIds.length - 1];\r\n    const elementsInSiblingGroup = getElementsInGroup(elements, siblingGroupId);\r\n    if (elementsInSiblingGroup.length) {\r\n        // assumes getElementsInGroup() returned elements are sorted\r\n        // by zIndex (ascending)\r\n        return direction === \"left\"\r\n            ? elements.indexOf(elementsInSiblingGroup[0])\r\n            : elements.indexOf(elementsInSiblingGroup[elementsInSiblingGroup.length - 1]);\r\n    }\r\n    return candidateIndex;\r\n};\r\nconst getTargetElementsMap = (elements, indices) => {\r\n    return indices.reduce((acc, index) => {\r\n        const element = elements[index];\r\n        acc[element.id] = element;\r\n        return acc;\r\n    }, {});\r\n};\r\nconst shiftElements = (appState, elements, direction) => {\r\n    const indicesToMove = getIndicesToMove(elements, appState);\r\n    const targetElementsMap = getTargetElementsMap(elements, indicesToMove);\r\n    let groupedIndices = toContiguousGroups(indicesToMove);\r\n    if (direction === \"right\") {\r\n        groupedIndices = groupedIndices.reverse();\r\n    }\r\n    groupedIndices.forEach((indices, i) => {\r\n        const leadingIndex = indices[0];\r\n        const trailingIndex = indices[indices.length - 1];\r\n        const boundaryIndex = direction === \"left\" ? leadingIndex : trailingIndex;\r\n        const targetIndex = getTargetIndex(appState, elements, boundaryIndex, direction);\r\n        if (targetIndex === -1 || boundaryIndex === targetIndex) {\r\n            return;\r\n        }\r\n        const leadingElements = direction === \"left\"\r\n            ? elements.slice(0, targetIndex)\r\n            : elements.slice(0, leadingIndex);\r\n        const targetElements = elements.slice(leadingIndex, trailingIndex + 1);\r\n        const displacedElements = direction === \"left\"\r\n            ? elements.slice(targetIndex, leadingIndex)\r\n            : elements.slice(trailingIndex + 1, targetIndex + 1);\r\n        const trailingElements = direction === \"left\"\r\n            ? elements.slice(trailingIndex + 1)\r\n            : elements.slice(targetIndex + 1);\r\n        elements =\r\n            direction === \"left\"\r\n                ? [\r\n                    ...leadingElements,\r\n                    ...targetElements,\r\n                    ...displacedElements,\r\n                    ...trailingElements,\r\n                ]\r\n                : [\r\n                    ...leadingElements,\r\n                    ...displacedElements,\r\n                    ...targetElements,\r\n                    ...trailingElements,\r\n                ];\r\n    });\r\n    return elements.map((element) => {\r\n        if (targetElementsMap[element.id]) {\r\n            return bumpVersion(element);\r\n        }\r\n        return element;\r\n    });\r\n};\r\nconst shiftElementsToEnd = (elements, appState, direction) => {\r\n    const indicesToMove = getIndicesToMove(elements, appState);\r\n    const targetElementsMap = getTargetElementsMap(elements, indicesToMove);\r\n    const displacedElements = [];\r\n    let leadingIndex;\r\n    let trailingIndex;\r\n    if (direction === \"left\") {\r\n        if (appState.editingGroupId) {\r\n            const groupElements = getElementsInGroup(elements, appState.editingGroupId);\r\n            if (!groupElements.length) {\r\n                return elements;\r\n            }\r\n            leadingIndex = elements.indexOf(groupElements[0]);\r\n        }\r\n        else {\r\n            leadingIndex = 0;\r\n        }\r\n        trailingIndex = indicesToMove[indicesToMove.length - 1];\r\n    }\r\n    else {\r\n        if (appState.editingGroupId) {\r\n            const groupElements = getElementsInGroup(elements, appState.editingGroupId);\r\n            if (!groupElements.length) {\r\n                return elements;\r\n            }\r\n            trailingIndex = elements.indexOf(groupElements[groupElements.length - 1]);\r\n        }\r\n        else {\r\n            trailingIndex = elements.length - 1;\r\n        }\r\n        leadingIndex = indicesToMove[0];\r\n    }\r\n    for (let index = leadingIndex; index < trailingIndex + 1; index++) {\r\n        if (!indicesToMove.includes(index)) {\r\n            displacedElements.push(elements[index]);\r\n        }\r\n    }\r\n    const targetElements = Object.values(targetElementsMap).map((element) => {\r\n        return bumpVersion(element);\r\n    });\r\n    const leadingElements = elements.slice(0, leadingIndex);\r\n    const trailingElements = elements.slice(trailingIndex + 1);\r\n    return direction === \"left\"\r\n        ? [\r\n            ...leadingElements,\r\n            ...targetElements,\r\n            ...displacedElements,\r\n            ...trailingElements,\r\n        ]\r\n        : [\r\n            ...leadingElements,\r\n            ...displacedElements,\r\n            ...targetElements,\r\n            ...trailingElements,\r\n        ];\r\n};\r\n// public API\r\n// -----------------------------------------------------------------------------\r\nexport const moveOneLeft = (elements, appState) => {\r\n    return shiftElements(appState, elements, \"left\");\r\n};\r\nexport const moveOneRight = (elements, appState) => {\r\n    return shiftElements(appState, elements, \"right\");\r\n};\r\nexport const moveAllLeft = (elements, appState) => {\r\n    return shiftElementsToEnd(elements, appState, \"left\");\r\n};\r\nexport const moveAllRight = (elements, appState) => {\r\n    return shiftElementsToEnd(elements, appState, \"right\");\r\n};\r\n","import React from \"react\";\r\nimport { moveOneLeft, moveOneRight, moveAllLeft, moveAllRight, } from \"../zindex\";\r\nimport { KEYS, isDarwin, CODES } from \"../keys\";\r\nimport { t } from \"../i18n\";\r\nimport { getShortcutKey } from \"../utils\";\r\nimport { register } from \"./register\";\r\nimport { SendBackwardIcon, BringToFrontIcon, SendToBackIcon, BringForwardIcon, } from \"../components/icons\";\r\nexport const actionSendBackward = register({\r\n    name: \"sendBackward\",\r\n    perform: (elements, appState) => {\r\n        return {\r\n            elements: moveOneLeft(elements, appState),\r\n            appState,\r\n            commitToHistory: true,\r\n        };\r\n    },\r\n    contextItemLabel: \"labels.sendBackward\",\r\n    keyPriority: 40,\r\n    keyTest: (event) => event[KEYS.CTRL_OR_CMD] &&\r\n        !event.shiftKey &&\r\n        event.code === CODES.BRACKET_LEFT,\r\n    PanelComponent: ({ updateData, appState }) => (<button type=\"button\" className=\"zIndexButton\" onClick={() => updateData(null)} title={`${t(\"labels.sendBackward\")}  ${getShortcutKey(\"CtrlOrCmd+[\")}`}>\r\n      <SendBackwardIcon theme={appState.theme}/>\r\n    </button>),\r\n});\r\nexport const actionBringForward = register({\r\n    name: \"bringForward\",\r\n    perform: (elements, appState) => {\r\n        return {\r\n            elements: moveOneRight(elements, appState),\r\n            appState,\r\n            commitToHistory: true,\r\n        };\r\n    },\r\n    contextItemLabel: \"labels.bringForward\",\r\n    keyPriority: 40,\r\n    keyTest: (event) => event[KEYS.CTRL_OR_CMD] &&\r\n        !event.shiftKey &&\r\n        event.code === CODES.BRACKET_RIGHT,\r\n    PanelComponent: ({ updateData, appState }) => (<button type=\"button\" className=\"zIndexButton\" onClick={() => updateData(null)} title={`${t(\"labels.bringForward\")}  ${getShortcutKey(\"CtrlOrCmd+]\")}`}>\r\n      <BringForwardIcon theme={appState.theme}/>\r\n    </button>),\r\n});\r\nexport const actionSendToBack = register({\r\n    name: \"sendToBack\",\r\n    perform: (elements, appState) => {\r\n        return {\r\n            elements: moveAllLeft(elements, appState),\r\n            appState,\r\n            commitToHistory: true,\r\n        };\r\n    },\r\n    contextItemLabel: \"labels.sendToBack\",\r\n    keyTest: (event) => isDarwin\r\n        ? event[KEYS.CTRL_OR_CMD] &&\r\n            event.altKey &&\r\n            event.code === CODES.BRACKET_LEFT\r\n        : event[KEYS.CTRL_OR_CMD] &&\r\n            event.shiftKey &&\r\n            event.code === CODES.BRACKET_LEFT,\r\n    PanelComponent: ({ updateData, appState }) => (<button type=\"button\" className=\"zIndexButton\" onClick={() => updateData(null)} title={`${t(\"labels.sendToBack\")}  ${isDarwin\r\n            ? getShortcutKey(\"CtrlOrCmd+Alt+[\")\r\n            : getShortcutKey(\"CtrlOrCmd+Shift+[\")}`}>\r\n      <SendToBackIcon theme={appState.theme}/>\r\n    </button>),\r\n});\r\nexport const actionBringToFront = register({\r\n    name: \"bringToFront\",\r\n    perform: (elements, appState) => {\r\n        return {\r\n            elements: moveAllRight(elements, appState),\r\n            appState,\r\n            commitToHistory: true,\r\n        };\r\n    },\r\n    contextItemLabel: \"labels.bringToFront\",\r\n    keyTest: (event) => isDarwin\r\n        ? event[KEYS.CTRL_OR_CMD] &&\r\n            event.altKey &&\r\n            event.code === CODES.BRACKET_RIGHT\r\n        : event[KEYS.CTRL_OR_CMD] &&\r\n            event.shiftKey &&\r\n            event.code === CODES.BRACKET_RIGHT,\r\n    PanelComponent: ({ updateData, appState }) => (<button type=\"button\" className=\"zIndexButton\" onClick={(event) => updateData(null)} title={`${t(\"labels.bringToFront\")}  ${isDarwin\r\n            ? getShortcutKey(\"CtrlOrCmd+Alt+]\")\r\n            : getShortcutKey(\"CtrlOrCmd+Shift+]\")}`}>\r\n      <BringToFrontIcon theme={appState.theme}/>\r\n    </button>),\r\n});\r\n","import { KEYS } from \"../keys\";\r\nimport { register } from \"./register\";\r\nimport { selectGroupsForSelectedElements } from \"../groups\";\r\nimport { getNonDeletedElements } from \"../element\";\r\nexport const actionSelectAll = register({\r\n    name: \"selectAll\",\r\n    perform: (elements, appState) => {\r\n        if (appState.editingLinearElement) {\r\n            return false;\r\n        }\r\n        return {\r\n            appState: selectGroupsForSelectedElements({\r\n                ...appState,\r\n                editingGroupId: null,\r\n                selectedElementIds: elements.reduce((map, element) => {\r\n                    if (!element.isDeleted) {\r\n                        map[element.id] = true;\r\n                    }\r\n                    return map;\r\n                }, {}),\r\n            }, getNonDeletedElements(elements)),\r\n            commitToHistory: true,\r\n        };\r\n    },\r\n    contextItemLabel: \"labels.selectAll\",\r\n    keyTest: (event) => event[KEYS.CTRL_OR_CMD] && event.key === KEYS.A,\r\n});\r\n","import { KEYS } from \"../keys\";\r\nimport { register } from \"./register\";\r\nimport { duplicateElement, getNonDeletedElements } from \"../element\";\r\nimport { isSomeElementSelected } from \"../scene\";\r\nimport { ToolButton } from \"../components/ToolButton\";\r\nimport { clone } from \"../components/icons\";\r\nimport { t } from \"../i18n\";\r\nimport { getShortcutKey } from \"../utils\";\r\nimport { LinearElementEditor } from \"../element/linearElementEditor\";\r\nimport { mutateElement } from \"../element/mutateElement\";\r\nimport { selectGroupsForSelectedElements, getSelectedGroupForElement, getElementsInGroup, } from \"../groups\";\r\nimport { fixBindingsAfterDuplication } from \"../element/binding\";\r\nimport { GRID_SIZE } from \"../constants\";\r\nexport const actionDuplicateSelection = register({\r\n    name: \"duplicateSelection\",\r\n    perform: (elements, appState) => {\r\n        // duplicate point if selected while editing multi-point element\r\n        if (appState.editingLinearElement) {\r\n            const { activePointIndex, elementId } = appState.editingLinearElement;\r\n            const element = LinearElementEditor.getElement(elementId);\r\n            if (!element || activePointIndex === null) {\r\n                return false;\r\n            }\r\n            const { points } = element;\r\n            const selectedPoint = points[activePointIndex];\r\n            const nextPoint = points[activePointIndex + 1];\r\n            mutateElement(element, {\r\n                points: [\r\n                    ...points.slice(0, activePointIndex + 1),\r\n                    nextPoint\r\n                        ? [\r\n                            (selectedPoint[0] + nextPoint[0]) / 2,\r\n                            (selectedPoint[1] + nextPoint[1]) / 2,\r\n                        ]\r\n                        : [selectedPoint[0] + 30, selectedPoint[1] + 30],\r\n                    ...points.slice(activePointIndex + 1),\r\n                ],\r\n            });\r\n            return {\r\n                appState: {\r\n                    ...appState,\r\n                    editingLinearElement: {\r\n                        ...appState.editingLinearElement,\r\n                        activePointIndex: activePointIndex + 1,\r\n                    },\r\n                },\r\n                elements,\r\n                commitToHistory: true,\r\n            };\r\n        }\r\n        return {\r\n            ...duplicateElements(elements, appState),\r\n            commitToHistory: true,\r\n        };\r\n    },\r\n    contextItemLabel: \"labels.duplicateSelection\",\r\n    keyTest: (event) => event[KEYS.CTRL_OR_CMD] && event.key === KEYS.D,\r\n    PanelComponent: ({ elements, appState, updateData }) => (<ToolButton type=\"button\" icon={clone} title={`${t(\"labels.duplicateSelection\")}  ${getShortcutKey(\"CtrlOrCmd+D\")}`} aria-label={t(\"labels.duplicateSelection\")} onClick={() => updateData(null)} visible={isSomeElementSelected(getNonDeletedElements(elements), appState)}/>),\r\n});\r\nconst duplicateElements = (elements, appState) => {\r\n    const groupIdMap = new Map();\r\n    const newElements = [];\r\n    const oldElements = [];\r\n    const oldIdToDuplicatedId = new Map();\r\n    const duplicateAndOffsetElement = (element) => {\r\n        const newElement = duplicateElement(appState.editingGroupId, groupIdMap, element, {\r\n            x: element.x + GRID_SIZE / 2,\r\n            y: element.y + GRID_SIZE / 2,\r\n        });\r\n        oldIdToDuplicatedId.set(element.id, newElement.id);\r\n        oldElements.push(element);\r\n        newElements.push(newElement);\r\n        return newElement;\r\n    };\r\n    const finalElements = [];\r\n    let index = 0;\r\n    while (index < elements.length) {\r\n        const element = elements[index];\r\n        if (appState.selectedElementIds[element.id]) {\r\n            if (element.groupIds.length) {\r\n                const groupId = getSelectedGroupForElement(appState, element);\r\n                // if group selected, duplicate it atomically\r\n                if (groupId) {\r\n                    const groupElements = getElementsInGroup(elements, groupId);\r\n                    finalElements.push(...groupElements, ...groupElements.map((element) => duplicateAndOffsetElement(element)));\r\n                    index = index + groupElements.length;\r\n                    continue;\r\n                }\r\n            }\r\n            finalElements.push(element, duplicateAndOffsetElement(element));\r\n        }\r\n        else {\r\n            finalElements.push(element);\r\n        }\r\n        index++;\r\n    }\r\n    fixBindingsAfterDuplication(finalElements, oldElements, oldIdToDuplicatedId);\r\n    return {\r\n        elements: finalElements,\r\n        appState: selectGroupsForSelectedElements({\r\n            ...appState,\r\n            selectedGroupIds: {},\r\n            selectedElementIds: newElements.reduce((acc, element) => {\r\n                acc[element.id] = true;\r\n                return acc;\r\n            }, {}),\r\n        }, getNonDeletedElements(finalElements)),\r\n    };\r\n};\r\n","import clsx from \"clsx\";\r\n// TODO: It might be \"clever\" to add option.icon to the existing component <ButtonSelect />\r\nexport const ButtonIconSelect = ({ options, value, onChange, group, }) => (<div className=\"buttonList buttonListIcon\">\r\n    {options.map((option) => (<label key={option.text} className={clsx({ active: value === option.value })} title={option.text}>\r\n        <input type=\"radio\" name={group} onChange={() => onChange(option.value)} checked={value === option.value}/>\r\n        {option.icon}\r\n      </label>))}\r\n  </div>);\r\n","import React, { useLayoutEffect, useRef, useEffect } from \"react\";\r\nimport \"./Popover.scss\";\r\nimport { unstable_batchedUpdates } from \"react-dom\";\r\nexport const Popover = ({\r\n  children,\r\n  left,\r\n  top,\r\n  onCloseRequest,\r\n  fitInViewport = false,\r\n}) => {\r\n  const popoverRef = useRef(null);\r\n  // ensure the popover doesn't overflow the viewport\r\n  useLayoutEffect(() => {\r\n    if (fitInViewport && popoverRef.current) {\r\n      const element = popoverRef.current;\r\n      const { x, y, width, height } = element.getBoundingClientRect();\r\n      const viewportWidth = window.innerWidth;\r\n      if (x + width > viewportWidth) {\r\n        element.style.left = `${viewportWidth - width}px`;\r\n      }\r\n      const viewportHeight = window.innerHeight;\r\n      if (y + height > viewportHeight) {\r\n        element.style.top = `${viewportHeight - height}px`;\r\n      }\r\n    }\r\n  }, [fitInViewport]);\r\n  useEffect(() => {\r\n    if (onCloseRequest) {\r\n      const handler = (event) => {\r\n        if (!popoverRef.current?.contains(event.target)) {\r\n          unstable_batchedUpdates(() => onCloseRequest(event));\r\n        }\r\n      };\r\n      document.addEventListener(\"click\", handler, false);\r\n      //check with pointer down\r\n      return () => document.removeEventListener(\"click\", handler, false);\r\n    }\r\n  }, [onCloseRequest]);\r\n  return (\r\n    <div className=\"popover\" style={{ top, left }} ref={popoverRef}>\r\n      {children}\r\n    </div>\r\n  );\r\n};\r\n","import React from \"react\";\r\nimport { Popover } from \"./Popover\";\r\nimport { isTransparent } from \"../utils\";\r\nimport \"./ColorPicker.scss\";\r\nimport { isArrowKey, KEYS } from \"../keys\";\r\nimport { t, getLanguage } from \"../i18n\";\r\nimport { isWritableElement } from \"../utils\";\r\nimport colors from \"../colors\";\r\nconst isValidColor = (color) => {\r\n  const style = new Option().style;\r\n  style.color = color;\r\n  return !!style.color;\r\n};\r\nconst getColor = (color) => {\r\n  if (isTransparent(color)) {\r\n    return color;\r\n  }\r\n  return isValidColor(color)\r\n    ? color\r\n    : isValidColor(`#${color}`)\r\n    ? `#${color}`\r\n    : null;\r\n};\r\n// This is a narrow reimplementation of the awesome react-color Twitter component\r\n// https://github.com/casesandberg/react-color/blob/master/src/components/twitter/Twitter.js\r\n// Unfortunately, we can't detect keyboard layout in the browser. So this will\r\n// only work well for QWERTY but not AZERTY or others...\r\nconst keyBindings = [\r\n  [\"1\", \"2\", \"3\", \"4\", \"5\"],\r\n  [\"q\", \"w\", \"e\", \"r\", \"t\"],\r\n  [\"a\", \"s\", \"d\", \"f\", \"g\"],\r\n].flat();\r\nconst Picker = ({\r\n  colors,\r\n  color,\r\n  onChange,\r\n  onClose,\r\n  label,\r\n  showInput = true,\r\n  type,\r\n}) => {\r\n  const firstItem = React.useRef();\r\n  const activeItem = React.useRef();\r\n  const gallery = React.useRef();\r\n  const colorInput = React.useRef();\r\n  React.useEffect(() => {\r\n    // After the component is first mounted focus on first input\r\n    if (activeItem.current) {\r\n      activeItem.current.focus();\r\n    } else if (colorInput.current) {\r\n      colorInput.current.focus();\r\n    } else if (gallery.current) {\r\n      gallery.current.focus();\r\n    }\r\n  }, []);\r\n  const handleKeyDown = (event) => {\r\n    if (event.key === KEYS.TAB) {\r\n      const { activeElement } = document;\r\n      if (event.shiftKey) {\r\n        if (activeElement === firstItem.current) {\r\n          colorInput.current?.focus();\r\n          event.preventDefault();\r\n        }\r\n      } else if (activeElement === colorInput.current) {\r\n        firstItem.current?.focus();\r\n        event.preventDefault();\r\n      }\r\n    } else if (isArrowKey(event.key)) {\r\n      const { activeElement } = document;\r\n      const isRTL = getLanguage().rtl;\r\n      const index = Array.prototype.indexOf.call(\r\n        gallery.current.children,\r\n        activeElement\r\n      );\r\n      if (index !== -1) {\r\n        const length = gallery.current.children.length - (showInput ? 1 : 0);\r\n        const nextIndex =\r\n          event.key === (isRTL ? KEYS.ARROW_LEFT : KEYS.ARROW_RIGHT)\r\n            ? (index + 1) % length\r\n            : event.key === (isRTL ? KEYS.ARROW_RIGHT : KEYS.ARROW_LEFT)\r\n            ? (length + index - 1) % length\r\n            : event.key === KEYS.ARROW_DOWN\r\n            ? (index + 5) % length\r\n            : event.key === KEYS.ARROW_UP\r\n            ? (length + index - 5) % length\r\n            : index;\r\n        gallery.current.children[nextIndex].focus();\r\n      }\r\n      event.preventDefault();\r\n    } else if (\r\n      keyBindings.includes(event.key.toLowerCase()) &&\r\n      !isWritableElement(event.target)\r\n    ) {\r\n      const index = keyBindings.indexOf(event.key.toLowerCase());\r\n      gallery.current.children[index].focus();\r\n      event.preventDefault();\r\n    } else if (event.key === KEYS.ESCAPE || event.key === KEYS.ENTER) {\r\n      event.preventDefault();\r\n      onClose();\r\n    }\r\n    event.nativeEvent.stopImmediatePropagation();\r\n    event.stopPropagation();\r\n  };\r\n  return (\r\n    <div\r\n      className={`color-picker color-picker-type-${type}`}\r\n      role=\"dialog\"\r\n      aria-modal=\"true\"\r\n      aria-label={t(\"labels.colorPicker\")}\r\n      onKeyDown={handleKeyDown}\r\n    >\r\n      <div className=\"color-picker-triangle color-picker-triangle-shadow\"></div>\r\n      <div className=\"color-picker-triangle\"></div>\r\n      <div\r\n        className=\"color-picker-content\"\r\n        ref={(el) => {\r\n          if (el) {\r\n            gallery.current = el;\r\n          }\r\n        }}\r\n        tabIndex={0}\r\n      >\r\n        {colors.map((_color, i) => {\r\n          const _colorWithoutHash = _color.replace(\"#\", \"\");\r\n          return (\r\n            <button\r\n              className={`${_color} color-picker-swatch`}\r\n              onClick={(event) => {\r\n                event.currentTarget.focus();\r\n                console.log(event.currentTarget);\r\n                onChange(_color);\r\n              }}\r\n              title={`${t(`colors.${_colorWithoutHash}`)}${\r\n                !isTransparent(_color) ? ` (${_color})` : \"\"\r\n              }  ${keyBindings[i].toUpperCase()}`}\r\n              aria-label={t(`colors.${_colorWithoutHash}`)}\r\n              aria-keyshortcuts={keyBindings[i]}\r\n              style={{ color: _color }}\r\n              key={_color}\r\n              ref={(el) => {\r\n                if (el && i === 0) {\r\n                  firstItem.current = el;\r\n                }\r\n                if (el && _color === color) {\r\n                  activeItem.current = el;\r\n                }\r\n              }}\r\n              onFocus={() => {\r\n                onChange(_color);\r\n              }}\r\n            >\r\n              {isTransparent(_color) ? (\r\n                <div className=\"color-picker-transparent\"></div>\r\n              ) : undefined}\r\n              <span className={`${_color} color-picker-keybinding`}>\r\n                {keyBindings[i]}\r\n              </span>\r\n            </button>\r\n          );\r\n        })}\r\n        {showInput && (\r\n          <ColorInput\r\n            color={color}\r\n            label={label}\r\n            onChange={(color) => {\r\n              onChange(color);\r\n            }}\r\n            ref={colorInput}\r\n          />\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\nconst ColorInput = React.forwardRef(({ color, onChange, label }, ref) => {\r\n  const [innerValue, setInnerValue] = React.useState(color);\r\n  const inputRef = React.useRef(null);\r\n  React.useEffect(() => {\r\n    setInnerValue(color);\r\n  }, [color]);\r\n  React.useImperativeHandle(ref, () => inputRef.current);\r\n  const changeColor = React.useCallback(\r\n    (inputValue) => {\r\n      const value = inputValue.toLowerCase();\r\n      const color = getColor(value);\r\n      if (color) {\r\n        onChange(color);\r\n      }\r\n      setInnerValue(value);\r\n    },\r\n    [onChange]\r\n  );\r\n  return (\r\n    <label className=\"color-input-container\">\r\n      <div className=\"color-picker-hash\">#</div>\r\n      <input\r\n        spellCheck={false}\r\n        className=\"color-picker-input\"\r\n        aria-label={label}\r\n        onChange={(event) => changeColor(event.target.value)}\r\n        value={(innerValue || \"\").replace(/^#/, \"\")}\r\n        onBlur={() => setInnerValue(color)}\r\n        ref={inputRef}\r\n      />\r\n    </label>\r\n  );\r\n});\r\nexport const ColorPicker = ({\r\n  type,\r\n  color,\r\n  onChange,\r\n  label,\r\n  isActive,\r\n  setActive,\r\n}) => {\r\n  const pickerButton = React.useRef(null);\r\n  return (\r\n    <div>\r\n      <div className=\"color-picker-control-container\">\r\n        <button\r\n          className={`${type} color-picker-label-swatch`}\r\n          aria-label={label}\r\n          style={color ? { \"--swatch-color\": color } : undefined}\r\n          onClick={() => setActive(!isActive)}\r\n          ref={pickerButton}\r\n        />\r\n        <ColorInput\r\n          color={color}\r\n          label={label}\r\n          onChange={(color) => {\r\n            onChange(color);\r\n          }}\r\n        />\r\n      </div>\r\n      <React.Suspense fallback=\"\">\r\n        {isActive ? (\r\n          <Popover\r\n            onCloseRequest={(event) =>\r\n              event.target !== pickerButton.current && setActive(false)\r\n            }\r\n          >\r\n            <Picker\r\n              colors={colors[type]}\r\n              color={color || null}\r\n              onChange={(changedColor) => {\r\n                onChange(changedColor);\r\n              }}\r\n              onClose={() => {\r\n                setActive(false);\r\n                pickerButton.current?.focus();\r\n              }}\r\n              label={label}\r\n              showInput={false}\r\n              type={type}\r\n            />\r\n          </Popover>\r\n        ) : null}\r\n      </React.Suspense>\r\n    </div>\r\n  );\r\n};\r\n","import React from \"react\";\r\nimport { Popover } from \"./Popover\";\r\nimport \"./IconPicker.scss\";\r\nimport { isArrowKey, KEYS } from \"../keys\";\r\nimport { getLanguage } from \"../i18n\";\r\nfunction Picker({ options, value, label, onChange, onClose }) {\r\n  const rFirstItem = React.useRef();\r\n  const rActiveItem = React.useRef();\r\n  const rGallery = React.useRef(null);\r\n  React.useEffect(() => {\r\n    // After the component is first mounted focus on first input\r\n    if (rActiveItem.current) {\r\n      rActiveItem.current.focus();\r\n    } else if (rGallery.current) {\r\n      rGallery.current.focus();\r\n    }\r\n  }, []);\r\n  const handleKeyDown = (event) => {\r\n    const pressedOption = options.find(\r\n      (option) => option.keyBinding === event.key.toLowerCase()\r\n    );\r\n    if (!(event.metaKey || event.altKey || event.ctrlKey) && pressedOption) {\r\n      // Keybinding navigation\r\n      const index = options.indexOf(pressedOption);\r\n      rGallery.current.children[index].focus();\r\n      event.preventDefault();\r\n    } else if (event.key === KEYS.TAB) {\r\n      // Tab navigation cycle through options. If the user tabs\r\n      // away from the picker, close the picker. We need to use\r\n      // a timeout here to let the stack clear before checking.\r\n      setTimeout(() => {\r\n        const active = rActiveItem.current;\r\n        const docActive = document.activeElement;\r\n        if (active !== docActive) {\r\n          onClose();\r\n        }\r\n      }, 0);\r\n    } else if (isArrowKey(event.key)) {\r\n      // Arrow navigation\r\n      const { activeElement } = document;\r\n      const isRTL = getLanguage().rtl;\r\n      const index = Array.prototype.indexOf.call(\r\n        rGallery.current.children,\r\n        activeElement\r\n      );\r\n      if (index !== -1) {\r\n        const length = options.length;\r\n        let nextIndex = index;\r\n        switch (event.key) {\r\n          // Select the next option\r\n          case isRTL ? KEYS.ARROW_LEFT : KEYS.ARROW_RIGHT:\r\n          case KEYS.ARROW_DOWN: {\r\n            nextIndex = (index + 1) % length;\r\n            break;\r\n          }\r\n          // Select the previous option\r\n          case isRTL ? KEYS.ARROW_RIGHT : KEYS.ARROW_LEFT:\r\n          case KEYS.ARROW_UP: {\r\n            nextIndex = (length + index - 1) % length;\r\n            break;\r\n          }\r\n        }\r\n        rGallery.current.children[nextIndex].focus();\r\n      }\r\n      event.preventDefault();\r\n    } else if (event.key === KEYS.ESCAPE || event.key === KEYS.ENTER) {\r\n      // Close on escape or enter\r\n      event.preventDefault();\r\n      onClose();\r\n    }\r\n    event.nativeEvent.stopImmediatePropagation();\r\n    event.stopPropagation();\r\n  };\r\n  return (\r\n    <div\r\n      className={`picker`}\r\n      role=\"dialog\"\r\n      aria-modal=\"true\"\r\n      aria-label={label}\r\n      onKeyDown={handleKeyDown}\r\n    >\r\n      <div className=\"picker-content\" ref={rGallery}>\r\n        {options.map((option, i) => (\r\n          <button\r\n            className=\"picker-option\"\r\n            onClick={(event) => {\r\n              event.currentTarget.focus();\r\n              onChange(option.value);\r\n            }}\r\n            title={`${option.text}  ${option.keyBinding.toUpperCase()}`}\r\n            aria-label={option.text || \"none\"}\r\n            aria-keyshortcuts={option.keyBinding}\r\n            key={option.text}\r\n            ref={(el) => {\r\n              if (el && i === 0) {\r\n                rFirstItem.current = el;\r\n              }\r\n              if (el && option.value === value) {\r\n                rActiveItem.current = el;\r\n              }\r\n            }}\r\n            onFocus={() => {\r\n              onChange(option.value);\r\n            }}\r\n          >\r\n            {option.icon}\r\n            <span className=\"picker-keybinding\">{option.keyBinding}</span>\r\n          </button>\r\n        ))}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\nexport function IconPicker({ value, label, options, onChange, group = \"\" }) {\r\n  const [isActive, setActive] = React.useState(false);\r\n  const rPickerButton = React.useRef(null);\r\n  const isRTL = getLanguage().rtl;\r\n  return (\r\n    <label className={\"picker-container\"}>\r\n      <button\r\n        name={group}\r\n        className={isActive ? \"active\" : \"\"}\r\n        aria-label={label}\r\n        onClick={() => setActive(!isActive)}\r\n        ref={rPickerButton}\r\n      >\r\n        {options.find((option) => option.value === value)?.icon}\r\n      </button>\r\n      <React.Suspense fallback=\"\">\r\n        {isActive ? (\r\n          <>\r\n            <Popover\r\n              onCloseRequest={(event) =>\r\n                event.target !== rPickerButton.current && setActive(false)\r\n              }\r\n              {...(isRTL ? { right: 5.5 } : { left: -5.5 })}\r\n            >\r\n              <Picker\r\n                options={options}\r\n                value={value}\r\n                label={label}\r\n                onChange={onChange}\r\n                onClose={() => {\r\n                  setActive(false);\r\n                  rPickerButton.current?.focus();\r\n                }}\r\n              />\r\n            </Popover>\r\n            <div className=\"picker-triangle\" />\r\n          </>\r\n        ) : null}\r\n      </React.Suspense>\r\n    </label>\r\n  );\r\n}\r\n","import { ButtonIconSelect } from \"../components/ButtonIconSelect\";\r\nimport { ColorPicker } from \"../components/ColorPicker\";\r\nimport { IconPicker } from \"../components/IconPicker\";\r\nimport { ArrowheadArrowIcon, ArrowheadBarIcon, ArrowheadDotIcon, ArrowheadTriangleIcon, ArrowheadNoneIcon, EdgeRoundIcon, EdgeSharpIcon, FillCrossHatchIcon, FillHachureIcon, FillSolidIcon, FontFamilyCodeIcon, FontFamilyHandDrawnIcon, FontFamilyNormalIcon, FontSizeExtraLargeIcon, FontSizeLargeIcon, FontSizeMediumIcon, FontSizeSmallIcon, SloppinessArchitectIcon, SloppinessArtistIcon, SloppinessCartoonistIcon, StrokeStyleDashedIcon, StrokeStyleDottedIcon, StrokeStyleSolidIcon, StrokeWidthIcon, TextAlignCenterIcon, TextAlignLeftIcon, TextAlignRightIcon, } from \"../components/icons\";\r\nimport { DEFAULT_FONT_FAMILY, DEFAULT_FONT_SIZE, FONT_FAMILY, } from \"../constants\";\r\nimport { getNonDeletedElements, isTextElement, redrawTextBoundingBox, } from \"../element\";\r\nimport { newElementWith } from \"../element/mutateElement\";\r\nimport { isLinearElement, isLinearElementType } from \"../element/typeChecks\";\r\nimport { getLanguage, t } from \"../i18n\";\r\nimport { randomInteger } from \"../random\";\r\nimport { canChangeSharpness, canHaveArrowheads, getCommonAttributeOfSelectedElements, getTargetElements, isSomeElementSelected, } from \"../scene\";\r\nimport { hasStrokeColor } from \"../scene/comparisons\";\r\nimport { register } from \"./register\";\r\nconst changeProperty = (elements, appState, callback) => {\r\n    return elements.map((element) => {\r\n        if (appState.selectedElementIds[element.id] ||\r\n            element.id === appState.editingElement?.id) {\r\n            return callback(element);\r\n        }\r\n        return element;\r\n    });\r\n};\r\nconst getFormValue = function (elements, appState, getAttribute, defaultValue) {\r\n    const editingElement = appState.editingElement;\r\n    const nonDeletedElements = getNonDeletedElements(elements);\r\n    return ((editingElement && getAttribute(editingElement)) ??\r\n        (isSomeElementSelected(nonDeletedElements, appState)\r\n            ? getCommonAttributeOfSelectedElements(nonDeletedElements, appState, getAttribute)\r\n            : defaultValue) ??\r\n        null);\r\n};\r\nexport const actionChangeStrokeColor = register({\r\n    name: \"changeStrokeColor\",\r\n    perform: (elements, appState, value) => {\r\n        return {\r\n            ...(value.currentItemStrokeColor && {\r\n                elements: changeProperty(elements, appState, (el) => {\r\n                    return hasStrokeColor(el.type)\r\n                        ? newElementWith(el, {\r\n                            strokeColor: value.currentItemStrokeColor,\r\n                        })\r\n                        : el;\r\n                }),\r\n            }),\r\n            appState: {\r\n                ...appState,\r\n                ...value,\r\n            },\r\n            commitToHistory: !!value.currentItemStrokeColor,\r\n        };\r\n    },\r\n    PanelComponent: ({ elements, appState, updateData }) => (<>\r\n      <h3 aria-hidden=\"true\">{t(\"labels.stroke\")}</h3>\r\n      <ColorPicker type=\"elementStroke\" label={t(\"labels.stroke\")} color={getFormValue(elements, appState, (element) => element.strokeColor, appState.currentItemStrokeColor)} onChange={(color) => updateData({ currentItemStrokeColor: color })} isActive={appState.openPopup === \"strokeColorPicker\"} setActive={(active) => updateData({ openPopup: active ? \"strokeColorPicker\" : null })}/>\r\n    </>),\r\n});\r\nexport const actionChangeBackgroundColor = register({\r\n    name: \"changeBackgroundColor\",\r\n    perform: (elements, appState, value) => {\r\n        return {\r\n            ...(value.currentItemBackgroundColor && {\r\n                elements: changeProperty(elements, appState, (el) => newElementWith(el, {\r\n                    backgroundColor: value.currentItemBackgroundColor,\r\n                })),\r\n            }),\r\n            appState: {\r\n                ...appState,\r\n                ...value,\r\n            },\r\n            commitToHistory: !!value.currentItemBackgroundColor,\r\n        };\r\n    },\r\n    PanelComponent: ({ elements, appState, updateData }) => (<>\r\n      <h3 aria-hidden=\"true\">{t(\"labels.background\")}</h3>\r\n      <ColorPicker type=\"elementBackground\" label={t(\"labels.background\")} color={getFormValue(elements, appState, (element) => element.backgroundColor, appState.currentItemBackgroundColor)} onChange={(color) => updateData({ currentItemBackgroundColor: color })} isActive={appState.openPopup === \"backgroundColorPicker\"} setActive={(active) => updateData({ openPopup: active ? \"backgroundColorPicker\" : null })}/>\r\n    </>),\r\n});\r\nexport const actionChangeFillStyle = register({\r\n    name: \"changeFillStyle\",\r\n    perform: (elements, appState, value) => {\r\n        return {\r\n            elements: changeProperty(elements, appState, (el) => newElementWith(el, {\r\n                fillStyle: value,\r\n            })),\r\n            appState: { ...appState, currentItemFillStyle: value },\r\n            commitToHistory: true,\r\n        };\r\n    },\r\n    PanelComponent: ({ elements, appState, updateData }) => (<fieldset>\r\n      <legend>{t(\"labels.fill\")}</legend>\r\n      <ButtonIconSelect options={[\r\n            {\r\n                value: \"hachure\",\r\n                text: t(\"labels.hachure\"),\r\n                icon: <FillHachureIcon theme={appState.theme}/>,\r\n            },\r\n            {\r\n                value: \"cross-hatch\",\r\n                text: t(\"labels.crossHatch\"),\r\n                icon: <FillCrossHatchIcon theme={appState.theme}/>,\r\n            },\r\n            {\r\n                value: \"solid\",\r\n                text: t(\"labels.solid\"),\r\n                icon: <FillSolidIcon theme={appState.theme}/>,\r\n            },\r\n        ]} group=\"fill\" value={getFormValue(elements, appState, (element) => element.fillStyle, appState.currentItemFillStyle)} onChange={(value) => {\r\n            updateData(value);\r\n        }}/>\r\n    </fieldset>),\r\n});\r\nexport const actionChangeStrokeWidth = register({\r\n    name: \"changeStrokeWidth\",\r\n    perform: (elements, appState, value) => {\r\n        return {\r\n            elements: changeProperty(elements, appState, (el) => newElementWith(el, {\r\n                strokeWidth: value,\r\n            })),\r\n            appState: { ...appState, currentItemStrokeWidth: value },\r\n            commitToHistory: true,\r\n        };\r\n    },\r\n    PanelComponent: ({ elements, appState, updateData }) => (<fieldset>\r\n      <legend>{t(\"labels.strokeWidth\")}</legend>\r\n      <ButtonIconSelect group=\"stroke-width\" options={[\r\n            {\r\n                value: 1,\r\n                text: t(\"labels.thin\"),\r\n                icon: <StrokeWidthIcon theme={appState.theme} strokeWidth={2}/>,\r\n            },\r\n            {\r\n                value: 2,\r\n                text: t(\"labels.bold\"),\r\n                icon: <StrokeWidthIcon theme={appState.theme} strokeWidth={6}/>,\r\n            },\r\n            {\r\n                value: 4,\r\n                text: t(\"labels.extraBold\"),\r\n                icon: <StrokeWidthIcon theme={appState.theme} strokeWidth={10}/>,\r\n            },\r\n        ]} value={getFormValue(elements, appState, (element) => element.strokeWidth, appState.currentItemStrokeWidth)} onChange={(value) => updateData(value)}/>\r\n    </fieldset>),\r\n});\r\nexport const actionChangeSloppiness = register({\r\n    name: \"changeSloppiness\",\r\n    perform: (elements, appState, value) => {\r\n        return {\r\n            elements: changeProperty(elements, appState, (el) => newElementWith(el, {\r\n                seed: randomInteger(),\r\n                roughness: value,\r\n            })),\r\n            appState: { ...appState, currentItemRoughness: value },\r\n            commitToHistory: true,\r\n        };\r\n    },\r\n    PanelComponent: ({ elements, appState, updateData }) => (<fieldset>\r\n      <legend>{t(\"labels.sloppiness\")}</legend>\r\n      <ButtonIconSelect group=\"sloppiness\" options={[\r\n            {\r\n                value: 0,\r\n                text: t(\"labels.architect\"),\r\n                icon: <SloppinessArchitectIcon theme={appState.theme}/>,\r\n            },\r\n            {\r\n                value: 1,\r\n                text: t(\"labels.artist\"),\r\n                icon: <SloppinessArtistIcon theme={appState.theme}/>,\r\n            },\r\n            {\r\n                value: 2,\r\n                text: t(\"labels.cartoonist\"),\r\n                icon: <SloppinessCartoonistIcon theme={appState.theme}/>,\r\n            },\r\n        ]} value={getFormValue(elements, appState, (element) => element.roughness, appState.currentItemRoughness)} onChange={(value) => updateData(value)}/>\r\n    </fieldset>),\r\n});\r\nexport const actionChangeStrokeStyle = register({\r\n    name: \"changeStrokeStyle\",\r\n    perform: (elements, appState, value) => {\r\n        return {\r\n            elements: changeProperty(elements, appState, (el) => newElementWith(el, {\r\n                strokeStyle: value,\r\n            })),\r\n            appState: { ...appState, currentItemStrokeStyle: value },\r\n            commitToHistory: true,\r\n        };\r\n    },\r\n    PanelComponent: ({ elements, appState, updateData }) => (<fieldset>\r\n      <legend>{t(\"labels.strokeStyle\")}</legend>\r\n      <ButtonIconSelect group=\"strokeStyle\" options={[\r\n            {\r\n                value: \"solid\",\r\n                text: t(\"labels.strokeStyle_solid\"),\r\n                icon: <StrokeStyleSolidIcon theme={appState.theme}/>,\r\n            },\r\n            {\r\n                value: \"dashed\",\r\n                text: t(\"labels.strokeStyle_dashed\"),\r\n                icon: <StrokeStyleDashedIcon theme={appState.theme}/>,\r\n            },\r\n            {\r\n                value: \"dotted\",\r\n                text: t(\"labels.strokeStyle_dotted\"),\r\n                icon: <StrokeStyleDottedIcon theme={appState.theme}/>,\r\n            },\r\n        ]} value={getFormValue(elements, appState, (element) => element.strokeStyle, appState.currentItemStrokeStyle)} onChange={(value) => updateData(value)}/>\r\n    </fieldset>),\r\n});\r\nexport const actionChangeOpacity = register({\r\n    name: \"changeOpacity\",\r\n    perform: (elements, appState, value) => {\r\n        return {\r\n            elements: changeProperty(elements, appState, (el) => newElementWith(el, {\r\n                opacity: value,\r\n            })),\r\n            appState: { ...appState, currentItemOpacity: value },\r\n            commitToHistory: true,\r\n        };\r\n    },\r\n    PanelComponent: ({ elements, appState, updateData }) => (<label className=\"control-label\">\r\n      {t(\"labels.opacity\")}\r\n      <input type=\"range\" min=\"0\" max=\"100\" step=\"10\" onChange={(event) => updateData(+event.target.value)} onWheel={(event) => {\r\n            event.stopPropagation();\r\n            const target = event.target;\r\n            const STEP = 10;\r\n            const MAX = 100;\r\n            const MIN = 0;\r\n            const value = +target.value;\r\n            if (event.deltaY < 0 && value < MAX) {\r\n                updateData(value + STEP);\r\n            }\r\n            else if (event.deltaY > 0 && value > MIN) {\r\n                updateData(value - STEP);\r\n            }\r\n        }} value={getFormValue(elements, appState, (element) => element.opacity, appState.currentItemOpacity) ?? undefined}/>\r\n    </label>),\r\n});\r\nexport const actionChangeFontSize = register({\r\n    name: \"changeFontSize\",\r\n    perform: (elements, appState, value) => {\r\n        return {\r\n            elements: changeProperty(elements, appState, (el) => {\r\n                if (isTextElement(el)) {\r\n                    const element = newElementWith(el, {\r\n                        fontSize: value,\r\n                    });\r\n                    redrawTextBoundingBox(element);\r\n                    return element;\r\n                }\r\n                return el;\r\n            }),\r\n            appState: {\r\n                ...appState,\r\n                currentItemFontSize: value,\r\n            },\r\n            commitToHistory: true,\r\n        };\r\n    },\r\n    PanelComponent: ({ elements, appState, updateData }) => (<fieldset>\r\n      <legend>{t(\"labels.fontSize\")}</legend>\r\n      <ButtonIconSelect group=\"font-size\" options={[\r\n            {\r\n                value: 16,\r\n                text: t(\"labels.small\"),\r\n                icon: <FontSizeSmallIcon theme={appState.theme}/>,\r\n            },\r\n            {\r\n                value: 20,\r\n                text: t(\"labels.medium\"),\r\n                icon: <FontSizeMediumIcon theme={appState.theme}/>,\r\n            },\r\n            {\r\n                value: 28,\r\n                text: t(\"labels.large\"),\r\n                icon: <FontSizeLargeIcon theme={appState.theme}/>,\r\n            },\r\n            {\r\n                value: 36,\r\n                text: t(\"labels.veryLarge\"),\r\n                icon: <FontSizeExtraLargeIcon theme={appState.theme}/>,\r\n            },\r\n        ]} value={getFormValue(elements, appState, (element) => isTextElement(element) && element.fontSize, appState.currentItemFontSize || DEFAULT_FONT_SIZE)} onChange={(value) => updateData(value)}/>\r\n    </fieldset>),\r\n});\r\nexport const actionChangeFontFamily = register({\r\n    name: \"changeFontFamily\",\r\n    perform: (elements, appState, value) => {\r\n        return {\r\n            elements: changeProperty(elements, appState, (el) => {\r\n                if (isTextElement(el)) {\r\n                    const element = newElementWith(el, {\r\n                        fontFamily: value,\r\n                    });\r\n                    redrawTextBoundingBox(element);\r\n                    return element;\r\n                }\r\n                return el;\r\n            }),\r\n            appState: {\r\n                ...appState,\r\n                currentItemFontFamily: value,\r\n            },\r\n            commitToHistory: true,\r\n        };\r\n    },\r\n    PanelComponent: ({ elements, appState, updateData }) => {\r\n        const options = [\r\n            {\r\n                value: FONT_FAMILY.Virgil,\r\n                text: t(\"labels.handDrawn\"),\r\n                icon: <FontFamilyHandDrawnIcon theme={appState.theme}/>,\r\n            },\r\n            {\r\n                value: FONT_FAMILY.Helvetica,\r\n                text: t(\"labels.normal\"),\r\n                icon: <FontFamilyNormalIcon theme={appState.theme}/>,\r\n            },\r\n            {\r\n                value: FONT_FAMILY.Cascadia,\r\n                text: t(\"labels.code\"),\r\n                icon: <FontFamilyCodeIcon theme={appState.theme}/>,\r\n            },\r\n        ];\r\n        return (<fieldset>\r\n        <legend>{t(\"labels.fontFamily\")}</legend>\r\n        <ButtonIconSelect group=\"font-family\" options={options} value={getFormValue(elements, appState, (element) => isTextElement(element) && element.fontFamily, appState.currentItemFontFamily || DEFAULT_FONT_FAMILY)} onChange={(value) => updateData(value)}/>\r\n      </fieldset>);\r\n    },\r\n});\r\nexport const actionChangeTextAlign = register({\r\n    name: \"changeTextAlign\",\r\n    perform: (elements, appState, value) => {\r\n        return {\r\n            elements: changeProperty(elements, appState, (el) => {\r\n                if (isTextElement(el)) {\r\n                    const element = newElementWith(el, {\r\n                        textAlign: value,\r\n                    });\r\n                    redrawTextBoundingBox(element);\r\n                    return element;\r\n                }\r\n                return el;\r\n            }),\r\n            appState: {\r\n                ...appState,\r\n                currentItemTextAlign: value,\r\n            },\r\n            commitToHistory: true,\r\n        };\r\n    },\r\n    PanelComponent: ({ elements, appState, updateData }) => (<fieldset>\r\n      <legend>{t(\"labels.textAlign\")}</legend>\r\n      <ButtonIconSelect group=\"text-align\" options={[\r\n            {\r\n                value: \"left\",\r\n                text: t(\"labels.left\"),\r\n                icon: <TextAlignLeftIcon theme={appState.theme}/>,\r\n            },\r\n            {\r\n                value: \"center\",\r\n                text: t(\"labels.center\"),\r\n                icon: <TextAlignCenterIcon theme={appState.theme}/>,\r\n            },\r\n            {\r\n                value: \"right\",\r\n                text: t(\"labels.right\"),\r\n                icon: <TextAlignRightIcon theme={appState.theme}/>,\r\n            },\r\n        ]} value={getFormValue(elements, appState, (element) => isTextElement(element) && element.textAlign, appState.currentItemTextAlign)} onChange={(value) => updateData(value)}/>\r\n    </fieldset>),\r\n});\r\nexport const actionChangeSharpness = register({\r\n    name: \"changeSharpness\",\r\n    perform: (elements, appState, value) => {\r\n        const targetElements = getTargetElements(getNonDeletedElements(elements), appState);\r\n        const shouldUpdateForNonLinearElements = targetElements.length\r\n            ? targetElements.every((el) => !isLinearElement(el))\r\n            : !isLinearElementType(appState.elementType);\r\n        const shouldUpdateForLinearElements = targetElements.length\r\n            ? targetElements.every(isLinearElement)\r\n            : isLinearElementType(appState.elementType);\r\n        return {\r\n            elements: changeProperty(elements, appState, (el) => newElementWith(el, {\r\n                strokeSharpness: value,\r\n            })),\r\n            appState: {\r\n                ...appState,\r\n                currentItemStrokeSharpness: shouldUpdateForNonLinearElements\r\n                    ? value\r\n                    : appState.currentItemStrokeSharpness,\r\n                currentItemLinearStrokeSharpness: shouldUpdateForLinearElements\r\n                    ? value\r\n                    : appState.currentItemLinearStrokeSharpness,\r\n            },\r\n            commitToHistory: true,\r\n        };\r\n    },\r\n    PanelComponent: ({ elements, appState, updateData }) => (<fieldset>\r\n      <legend>{t(\"labels.edges\")}</legend>\r\n      <ButtonIconSelect group=\"edges\" options={[\r\n            {\r\n                value: \"sharp\",\r\n                text: t(\"labels.sharp\"),\r\n                icon: <EdgeSharpIcon theme={appState.theme}/>,\r\n            },\r\n            {\r\n                value: \"round\",\r\n                text: t(\"labels.round\"),\r\n                icon: <EdgeRoundIcon theme={appState.theme}/>,\r\n            },\r\n        ]} value={getFormValue(elements, appState, (element) => element.strokeSharpness, (canChangeSharpness(appState.elementType) &&\r\n            (isLinearElementType(appState.elementType)\r\n                ? appState.currentItemLinearStrokeSharpness\r\n                : appState.currentItemStrokeSharpness)) ||\r\n            null)} onChange={(value) => updateData(value)}/>\r\n    </fieldset>),\r\n});\r\nexport const actionChangeArrowhead = register({\r\n    name: \"changeArrowhead\",\r\n    perform: (elements, appState, value) => {\r\n        return {\r\n            elements: changeProperty(elements, appState, (el) => {\r\n                if (isLinearElement(el)) {\r\n                    const { position, type } = value;\r\n                    if (position === \"start\") {\r\n                        const element = newElementWith(el, {\r\n                            startArrowhead: type,\r\n                        });\r\n                        return element;\r\n                    }\r\n                    else if (position === \"end\") {\r\n                        const element = newElementWith(el, {\r\n                            endArrowhead: type,\r\n                        });\r\n                        return element;\r\n                    }\r\n                }\r\n                return el;\r\n            }),\r\n            appState: {\r\n                ...appState,\r\n                [value.position === \"start\"\r\n                    ? \"currentItemStartArrowhead\"\r\n                    : \"currentItemEndArrowhead\"]: value.type,\r\n            },\r\n            commitToHistory: true,\r\n        };\r\n    },\r\n    PanelComponent: ({ elements, appState, updateData }) => {\r\n        const isRTL = getLanguage().rtl;\r\n        return (<fieldset>\r\n        <legend>{t(\"labels.arrowheads\")}</legend>\r\n        <div className=\"iconSelectList\">\r\n          <IconPicker label=\"arrowhead_start\" options={[\r\n                {\r\n                    value: null,\r\n                    text: t(\"labels.arrowhead_none\"),\r\n                    icon: <ArrowheadNoneIcon theme={appState.theme}/>,\r\n                    keyBinding: \"q\",\r\n                },\r\n                {\r\n                    value: \"arrow\",\r\n                    text: t(\"labels.arrowhead_arrow\"),\r\n                    icon: (<ArrowheadArrowIcon theme={appState.theme} flip={!isRTL}/>),\r\n                    keyBinding: \"w\",\r\n                },\r\n                {\r\n                    value: \"bar\",\r\n                    text: t(\"labels.arrowhead_bar\"),\r\n                    icon: <ArrowheadBarIcon theme={appState.theme} flip={!isRTL}/>,\r\n                    keyBinding: \"e\",\r\n                },\r\n                {\r\n                    value: \"dot\",\r\n                    text: t(\"labels.arrowhead_dot\"),\r\n                    icon: <ArrowheadDotIcon theme={appState.theme} flip={!isRTL}/>,\r\n                    keyBinding: \"r\",\r\n                },\r\n                {\r\n                    value: \"triangle\",\r\n                    text: t(\"labels.arrowhead_triangle\"),\r\n                    icon: (<ArrowheadTriangleIcon theme={appState.theme} flip={!isRTL}/>),\r\n                    keyBinding: \"t\",\r\n                },\r\n            ]} value={getFormValue(elements, appState, (element) => isLinearElement(element) && canHaveArrowheads(element.type)\r\n                ? element.startArrowhead\r\n                : appState.currentItemStartArrowhead, appState.currentItemStartArrowhead)} onChange={(value) => updateData({ position: \"start\", type: value })}/>\r\n          <IconPicker label=\"arrowhead_end\" group=\"arrowheads\" options={[\r\n                {\r\n                    value: null,\r\n                    text: t(\"labels.arrowhead_none\"),\r\n                    keyBinding: \"q\",\r\n                    icon: <ArrowheadNoneIcon theme={appState.theme}/>,\r\n                },\r\n                {\r\n                    value: \"arrow\",\r\n                    text: t(\"labels.arrowhead_arrow\"),\r\n                    keyBinding: \"w\",\r\n                    icon: (<ArrowheadArrowIcon theme={appState.theme} flip={isRTL}/>),\r\n                },\r\n                {\r\n                    value: \"bar\",\r\n                    text: t(\"labels.arrowhead_bar\"),\r\n                    keyBinding: \"e\",\r\n                    icon: <ArrowheadBarIcon theme={appState.theme} flip={isRTL}/>,\r\n                },\r\n                {\r\n                    value: \"dot\",\r\n                    text: t(\"labels.arrowhead_dot\"),\r\n                    keyBinding: \"r\",\r\n                    icon: <ArrowheadDotIcon theme={appState.theme} flip={isRTL}/>,\r\n                },\r\n                {\r\n                    value: \"triangle\",\r\n                    text: t(\"labels.arrowhead_triangle\"),\r\n                    icon: (<ArrowheadTriangleIcon theme={appState.theme} flip={isRTL}/>),\r\n                    keyBinding: \"t\",\r\n                },\r\n            ]} value={getFormValue(elements, appState, (element) => isLinearElement(element) && canHaveArrowheads(element.type)\r\n                ? element.endArrowhead\r\n                : appState.currentItemEndArrowhead, appState.currentItemEndArrowhead)} onChange={(value) => updateData({ position: \"end\", type: value })}/>\r\n        </div>\r\n      </fieldset>);\r\n    },\r\n});\r\n","export var UserIdleState;\r\n(function (UserIdleState) {\r\n    UserIdleState[\"ACTIVE\"] = \"active\";\r\n    UserIdleState[\"AWAY\"] = \"away\";\r\n    UserIdleState[\"IDLE\"] = \"idle\";\r\n})(UserIdleState || (UserIdleState = {}));\r\n","import \"./ToolIcon.scss\";\r\nimport { t } from \"../i18n\";\r\nimport { ToolButton } from \"./ToolButton\";\r\nimport { THEME } from \"../constants\";\r\n// We chose to use only explicit toggle and not a third option for system value,\r\n// but this could be added in the future.\r\nexport const DarkModeToggle = (props) => {\r\n    const title = props.title ||\r\n        (props.value === \"dark\" ? t(\"buttons.lightMode\") : t(\"buttons.darkMode\"));\r\n    return (<ToolButton type=\"icon\" icon={props.value === THEME.LIGHT ? ICONS.MOON : ICONS.SUN} title={title} aria-label={title} onClick={() => props.onChange(props.value === THEME.DARK ? THEME.LIGHT : THEME.DARK)} data-testid=\"toggle-dark-mode\"/>);\r\n};\r\nconst ICONS = {\r\n    SUN: (<svg width=\"512\" height=\"512\" className=\"rtl-mirror\" viewBox=\"0 0 512 512\">\r\n      <path fill=\"currentColor\" d=\"M256 160c-52.9 0-96 43.1-96 96s43.1 96 96 96 96-43.1 96-96-43.1-96-96-96zm246.4 80.5l-94.7-47.3 33.5-100.4c4.5-13.6-8.4-26.5-21.9-21.9l-100.4 33.5-47.4-94.8c-6.4-12.8-24.6-12.8-31 0l-47.3 94.7L92.7 70.8c-13.6-4.5-26.5 8.4-21.9 21.9l33.5 100.4-94.7 47.4c-12.8 6.4-12.8 24.6 0 31l94.7 47.3-33.5 100.5c-4.5 13.6 8.4 26.5 21.9 21.9l100.4-33.5 47.3 94.7c6.4 12.8 24.6 12.8 31 0l47.3-94.7 100.4 33.5c13.6 4.5 26.5-8.4 21.9-21.9l-33.5-100.4 94.7-47.3c13-6.5 13-24.7.2-31.1zm-155.9 106c-49.9 49.9-131.1 49.9-181 0-49.9-49.9-49.9-131.1 0-181 49.9-49.9 131.1-49.9 181 0 49.9 49.9 49.9 131.1 0 181z\"></path>\r\n    </svg>),\r\n    MOON: (<svg width=\"512\" height=\"512\" className=\"rtl-mirror\" viewBox=\"0 0 512 512\">\r\n      <path fill=\"currentColor\" d=\"M283.211 512c78.962 0 151.079-35.925 198.857-94.792 7.068-8.708-.639-21.43-11.562-19.35-124.203 23.654-238.262-71.576-238.262-196.954 0-72.222 38.662-138.635 101.498-174.394 9.686-5.512 7.25-20.197-3.756-22.23A258.156 258.156 0 0 0 283.211 0c-141.309 0-256 114.511-256 256 0 141.309 114.511 256 256 256z\"></path>\r\n    </svg>),\r\n};\r\n","import \"./Tooltip.scss\";\r\nimport React, { useEffect } from \"react\";\r\nconst getTooltipDiv = () => {\r\n    const existingDiv = document.querySelector(\".excalidraw-tooltip\");\r\n    if (existingDiv) {\r\n        return existingDiv;\r\n    }\r\n    const div = document.createElement(\"div\");\r\n    document.body.appendChild(div);\r\n    div.classList.add(\"excalidraw-tooltip\");\r\n    return div;\r\n};\r\nconst updateTooltip = (item, tooltip, label, long) => {\r\n    tooltip.classList.add(\"excalidraw-tooltip--visible\");\r\n    tooltip.style.minWidth = long ? \"50ch\" : \"10ch\";\r\n    tooltip.style.maxWidth = long ? \"50ch\" : \"15ch\";\r\n    tooltip.textContent = label;\r\n    const { x: itemX, bottom: itemBottom, top: itemTop, width: itemWidth, } = item.getBoundingClientRect();\r\n    const { width: labelWidth, height: labelHeight } = tooltip.getBoundingClientRect();\r\n    const viewportWidth = window.innerWidth;\r\n    const viewportHeight = window.innerHeight;\r\n    const margin = 5;\r\n    const left = itemX + itemWidth / 2 - labelWidth / 2;\r\n    const offsetLeft = left + labelWidth >= viewportWidth ? left + labelWidth - viewportWidth : 0;\r\n    const top = itemBottom + margin;\r\n    const offsetTop = top + labelHeight >= viewportHeight\r\n        ? itemBottom - itemTop + labelHeight + margin * 2\r\n        : 0;\r\n    Object.assign(tooltip.style, {\r\n        top: `${top - offsetTop}px`,\r\n        left: `${left - offsetLeft}px`,\r\n    });\r\n};\r\nexport const Tooltip = ({ children, label, long = false }) => {\r\n    useEffect(() => {\r\n        return () => getTooltipDiv().classList.remove(\"excalidraw-tooltip--visible\");\r\n    }, []);\r\n    return (<div className=\"excalidraw-tooltip-wrapper\" onPointerEnter={(event) => updateTooltip(event.currentTarget, getTooltipDiv(), label, long)} onPointerLeave={() => getTooltipDiv().classList.remove(\"excalidraw-tooltip--visible\")}>\r\n      {children}\r\n    </div>);\r\n};\r\n","import { useState } from \"react\";\r\nimport { t } from \"../i18n\";\r\nimport { useIsMobile } from \"./App\";\r\nimport { Dialog } from \"./Dialog\";\r\nimport { trash } from \"./icons\";\r\nimport { ToolButton } from \"./ToolButton\";\r\nimport \"./ClearCanvas.scss\";\r\nconst ClearCanvas = ({ onConfirm }) => {\r\n    const [showDialog, setShowDialog] = useState(false);\r\n    const toggleDialog = () => {\r\n        setShowDialog(!showDialog);\r\n    };\r\n    return (<>\r\n      <ToolButton type=\"button\" icon={trash} title={t(\"buttons.clearReset\")} aria-label={t(\"buttons.clearReset\")} showAriaLabel={useIsMobile()} onClick={toggleDialog} data-testid=\"clear-canvas-button\"/>\r\n\r\n      {showDialog && (<Dialog onCloseRequest={toggleDialog} title={t(\"clearCanvasDialog.title\")} className=\"clear-canvas\" small={true}>\r\n          <>\r\n            <p className=\"clear-canvas__content\"> {t(\"alerts.clearReset\")}</p>\r\n            <div className=\"clear-canvas-buttons\">\r\n              <ToolButton type=\"button\" title={t(\"buttons.clear\")} aria-label={t(\"buttons.clear\")} label={t(\"buttons.clear\")} onClick={() => {\r\n                onConfirm();\r\n                toggleDialog();\r\n            }} data-testid=\"confirm-clear-canvas-button\" className=\"clear-canvas--confirm\"/>\r\n              <ToolButton type=\"button\" title={t(\"buttons.cancel\")} aria-label={t(\"buttons.cancel\")} label={t(\"buttons.cancel\")} onClick={toggleDialog} data-testid=\"cancel-clear-canvas-button\" className=\"clear-canvas--cancel\"/>\r\n            </div>\r\n          </>\r\n        </Dialog>)}\r\n    </>);\r\n};\r\nexport default ClearCanvas;\r\n","import { ColorPicker } from \"../components/ColorPicker\";\r\nimport { zoomIn, zoomOut } from \"../components/icons\";\r\nimport { ToolButton } from \"../components/ToolButton\";\r\nimport { DarkModeToggle } from \"../components/DarkModeToggle\";\r\nimport { THEME, ZOOM_STEP } from \"../constants\";\r\nimport { getCommonBounds, getNonDeletedElements } from \"../element\";\r\nimport { t } from \"../i18n\";\r\nimport { CODES, KEYS } from \"../keys\";\r\nimport { getNormalizedZoom, getSelectedElements } from \"../scene\";\r\nimport { centerScrollOn } from \"../scene/scroll\";\r\nimport { getNewZoom } from \"../scene/zoom\";\r\nimport { getShortcutKey } from \"../utils\";\r\nimport { register } from \"./register\";\r\nimport { Tooltip } from \"../components/Tooltip\";\r\nimport { newElementWith } from \"../element/mutateElement\";\r\nimport { getDefaultAppState } from \"../appState\";\r\nimport ClearCanvas from \"../components/ClearCanvas\";\r\nexport const actionChangeViewBackgroundColor = register({\r\n    name: \"changeViewBackgroundColor\",\r\n    perform: (_, appState, value) => {\r\n        return {\r\n            appState: { ...appState, ...value },\r\n            commitToHistory: !!value.viewBackgroundColor,\r\n        };\r\n    },\r\n    PanelComponent: ({ appState, updateData }) => {\r\n        return (<div style={{ position: \"relative\" }}>\r\n        <ColorPicker label={t(\"labels.canvasBackground\")} type=\"canvasBackground\" color={appState.viewBackgroundColor} onChange={(color) => updateData({ viewBackgroundColor: color })} isActive={appState.openPopup === \"canvasColorPicker\"} setActive={(active) => updateData({ openPopup: active ? \"canvasColorPicker\" : null })} data-testid=\"canvas-background-picker\"/>\r\n      </div>);\r\n    },\r\n});\r\nexport const actionClearCanvas = register({\r\n    name: \"clearCanvas\",\r\n    perform: (elements, appState, _, app) => {\r\n        app.imageCache.clear();\r\n        return {\r\n            elements: elements.map((element) => newElementWith(element, { isDeleted: true })),\r\n            appState: {\r\n                ...getDefaultAppState(),\r\n                files: {},\r\n                theme: appState.theme,\r\n                elementLocked: appState.elementLocked,\r\n                exportBackground: appState.exportBackground,\r\n                exportEmbedScene: appState.exportEmbedScene,\r\n                gridSize: appState.gridSize,\r\n                showStats: appState.showStats,\r\n                pasteDialog: appState.pasteDialog,\r\n            },\r\n            commitToHistory: true,\r\n        };\r\n    },\r\n    PanelComponent: ({ updateData }) => <ClearCanvas onConfirm={updateData}/>,\r\n});\r\nexport const actionZoomIn = register({\r\n    name: \"zoomIn\",\r\n    perform: (_elements, appState) => {\r\n        const zoom = getNewZoom(getNormalizedZoom(appState.zoom.value + ZOOM_STEP), appState.zoom, { left: appState.offsetLeft, top: appState.offsetTop }, { x: appState.width / 2, y: appState.height / 2 });\r\n        return {\r\n            appState: {\r\n                ...appState,\r\n                zoom,\r\n            },\r\n            commitToHistory: false,\r\n        };\r\n    },\r\n    PanelComponent: ({ updateData }) => (<ToolButton type=\"button\" icon={zoomIn} title={`${t(\"buttons.zoomIn\")}  ${getShortcutKey(\"CtrlOrCmd++\")}`} aria-label={t(\"buttons.zoomIn\")} onClick={() => {\r\n            updateData(null);\r\n        }} size=\"small\"/>),\r\n    keyTest: (event) => (event.code === CODES.EQUAL || event.code === CODES.NUM_ADD) &&\r\n        (event[KEYS.CTRL_OR_CMD] || event.shiftKey),\r\n});\r\nexport const actionZoomOut = register({\r\n    name: \"zoomOut\",\r\n    perform: (_elements, appState) => {\r\n        const zoom = getNewZoom(getNormalizedZoom(appState.zoom.value - ZOOM_STEP), appState.zoom, { left: appState.offsetLeft, top: appState.offsetTop }, { x: appState.width / 2, y: appState.height / 2 });\r\n        return {\r\n            appState: {\r\n                ...appState,\r\n                zoom,\r\n            },\r\n            commitToHistory: false,\r\n        };\r\n    },\r\n    PanelComponent: ({ updateData }) => (<ToolButton type=\"button\" icon={zoomOut} title={`${t(\"buttons.zoomOut\")}  ${getShortcutKey(\"CtrlOrCmd+-\")}`} aria-label={t(\"buttons.zoomOut\")} onClick={() => {\r\n            updateData(null);\r\n        }} size=\"small\"/>),\r\n    keyTest: (event) => (event.code === CODES.MINUS || event.code === CODES.NUM_SUBTRACT) &&\r\n        (event[KEYS.CTRL_OR_CMD] || event.shiftKey),\r\n});\r\nexport const actionResetZoom = register({\r\n    name: \"resetZoom\",\r\n    perform: (_elements, appState) => {\r\n        return {\r\n            appState: {\r\n                ...appState,\r\n                zoom: getNewZoom(1, appState.zoom, { left: appState.offsetLeft, top: appState.offsetTop }, {\r\n                    x: appState.width / 2,\r\n                    y: appState.height / 2,\r\n                }),\r\n            },\r\n            commitToHistory: false,\r\n        };\r\n    },\r\n    PanelComponent: ({ updateData, appState }) => (<Tooltip label={t(\"buttons.resetZoom\")}>\r\n      <ToolButton type=\"button\" className=\"reset-zoom-button\" title={t(\"buttons.resetZoom\")} aria-label={t(\"buttons.resetZoom\")} onClick={() => {\r\n            updateData(null);\r\n        }} size=\"small\">\r\n        {(appState.zoom.value * 100).toFixed(0)}%\r\n      </ToolButton>\r\n    </Tooltip>),\r\n    keyTest: (event) => (event.code === CODES.ZERO || event.code === CODES.NUM_ZERO) &&\r\n        (event[KEYS.CTRL_OR_CMD] || event.shiftKey),\r\n});\r\nconst zoomValueToFitBoundsOnViewport = (bounds, viewportDimensions) => {\r\n    const [x1, y1, x2, y2] = bounds;\r\n    const commonBoundsWidth = x2 - x1;\r\n    const zoomValueForWidth = viewportDimensions.width / commonBoundsWidth;\r\n    const commonBoundsHeight = y2 - y1;\r\n    const zoomValueForHeight = viewportDimensions.height / commonBoundsHeight;\r\n    const smallestZoomValue = Math.min(zoomValueForWidth, zoomValueForHeight);\r\n    const zoomAdjustedToSteps = Math.floor(smallestZoomValue / ZOOM_STEP) * ZOOM_STEP;\r\n    const clampedZoomValueToFitElements = Math.min(Math.max(zoomAdjustedToSteps, ZOOM_STEP), 1);\r\n    return clampedZoomValueToFitElements;\r\n};\r\nconst zoomToFitElements = (elements, appState, zoomToSelection) => {\r\n    const nonDeletedElements = getNonDeletedElements(elements);\r\n    const selectedElements = getSelectedElements(nonDeletedElements, appState);\r\n    const commonBounds = zoomToSelection && selectedElements.length > 0\r\n        ? getCommonBounds(selectedElements)\r\n        : getCommonBounds(nonDeletedElements);\r\n    const zoomValue = zoomValueToFitBoundsOnViewport(commonBounds, {\r\n        width: appState.width,\r\n        height: appState.height,\r\n    });\r\n    const newZoom = getNewZoom(zoomValue, appState.zoom, {\r\n        left: appState.offsetLeft,\r\n        top: appState.offsetTop,\r\n    });\r\n    const [x1, y1, x2, y2] = commonBounds;\r\n    const centerX = (x1 + x2) / 2;\r\n    const centerY = (y1 + y2) / 2;\r\n    return {\r\n        appState: {\r\n            ...appState,\r\n            ...centerScrollOn({\r\n                scenePoint: { x: centerX, y: centerY },\r\n                viewportDimensions: {\r\n                    width: appState.width,\r\n                    height: appState.height,\r\n                },\r\n                zoom: newZoom,\r\n            }),\r\n            zoom: newZoom,\r\n        },\r\n        commitToHistory: false,\r\n    };\r\n};\r\nexport const actionZoomToSelected = register({\r\n    name: \"zoomToSelection\",\r\n    perform: (elements, appState) => zoomToFitElements(elements, appState, true),\r\n    keyTest: (event) => event.code === CODES.TWO &&\r\n        event.shiftKey &&\r\n        !event.altKey &&\r\n        !event[KEYS.CTRL_OR_CMD],\r\n});\r\nexport const actionZoomToFit = register({\r\n    name: \"zoomToFit\",\r\n    perform: (elements, appState) => zoomToFitElements(elements, appState, false),\r\n    keyTest: (event) => event.code === CODES.ONE &&\r\n        event.shiftKey &&\r\n        !event.altKey &&\r\n        !event[KEYS.CTRL_OR_CMD],\r\n});\r\nexport const actionToggleTheme = register({\r\n    name: \"toggleTheme\",\r\n    perform: (_, appState, value) => {\r\n        return {\r\n            appState: {\r\n                ...appState,\r\n                theme: value || (appState.theme === THEME.LIGHT ? THEME.DARK : THEME.LIGHT),\r\n            },\r\n            commitToHistory: false,\r\n        };\r\n    },\r\n    PanelComponent: ({ appState, updateData }) => (<div style={{ marginInlineStart: \"0.25rem\" }}>\r\n      <DarkModeToggle value={appState.theme} onChange={(theme) => {\r\n            updateData(theme);\r\n        }}/>\r\n    </div>),\r\n    keyTest: (event) => event.altKey && event.shiftKey && event.code === CODES.D,\r\n});\r\n","import { KEYS } from \"../keys\";\r\nimport { isInvisiblySmallElement } from \"../element\";\r\nimport { resetCursor } from \"../utils\";\r\nimport { ToolButton } from \"../components/ToolButton\";\r\nimport { done } from \"../components/icons\";\r\nimport { t } from \"../i18n\";\r\nimport { register } from \"./register\";\r\nimport { mutateElement } from \"../element/mutateElement\";\r\nimport { isPathALoop } from \"../math\";\r\nimport { LinearElementEditor } from \"../element/linearElementEditor\";\r\nimport Scene from \"../scene/Scene\";\r\nimport { maybeBindLinearElement, bindOrUnbindLinearElement, } from \"../element/binding\";\r\nimport { isBindingElement } from \"../element/typeChecks\";\r\nexport const actionFinalize = register({\r\n    name: \"finalize\",\r\n    perform: (elements, appState, _, { canvas, focusContainer }) => {\r\n        if (appState.editingLinearElement) {\r\n            const { elementId, startBindingElement, endBindingElement } = appState.editingLinearElement;\r\n            const element = LinearElementEditor.getElement(elementId);\r\n            if (element) {\r\n                if (isBindingElement(element)) {\r\n                    bindOrUnbindLinearElement(element, startBindingElement, endBindingElement);\r\n                }\r\n                return {\r\n                    elements: element.points.length < 2 || isInvisiblySmallElement(element)\r\n                        ? elements.filter((el) => el.id !== element.id)\r\n                        : undefined,\r\n                    appState: {\r\n                        ...appState,\r\n                        editingLinearElement: null,\r\n                    },\r\n                    commitToHistory: true,\r\n                };\r\n            }\r\n        }\r\n        let newElements = elements;\r\n        if (appState.pendingImageElement) {\r\n            mutateElement(appState.pendingImageElement, { isDeleted: true }, false);\r\n        }\r\n        if (window.document.activeElement instanceof HTMLElement) {\r\n            focusContainer();\r\n        }\r\n        const multiPointElement = appState.multiElement\r\n            ? appState.multiElement\r\n            : appState.editingElement?.type === \"freedraw\"\r\n                ? appState.editingElement\r\n                : null;\r\n        if (multiPointElement) {\r\n            // pen and mouse have hover\r\n            if (multiPointElement.type !== \"freedraw\" &&\r\n                appState.lastPointerDownWith !== \"touch\") {\r\n                const { points, lastCommittedPoint } = multiPointElement;\r\n                if (!lastCommittedPoint ||\r\n                    points[points.length - 1] !== lastCommittedPoint) {\r\n                    mutateElement(multiPointElement, {\r\n                        points: multiPointElement.points.slice(0, -1),\r\n                    });\r\n                }\r\n            }\r\n            if (isInvisiblySmallElement(multiPointElement)) {\r\n                newElements = newElements.slice(0, -1);\r\n            }\r\n            // If the multi point line closes the loop,\r\n            // set the last point to first point.\r\n            // This ensures that loop remains closed at different scales.\r\n            const isLoop = isPathALoop(multiPointElement.points, appState.zoom.value);\r\n            if (multiPointElement.type === \"line\" ||\r\n                multiPointElement.type === \"freedraw\") {\r\n                if (isLoop) {\r\n                    const linePoints = multiPointElement.points;\r\n                    const firstPoint = linePoints[0];\r\n                    mutateElement(multiPointElement, {\r\n                        points: linePoints.map((point, index) => index === linePoints.length - 1\r\n                            ? [firstPoint[0], firstPoint[1]]\r\n                            : point),\r\n                    });\r\n                }\r\n            }\r\n            if (isBindingElement(multiPointElement) &&\r\n                !isLoop &&\r\n                multiPointElement.points.length > 1) {\r\n                const [x, y] = LinearElementEditor.getPointAtIndexGlobalCoordinates(multiPointElement, -1);\r\n                maybeBindLinearElement(multiPointElement, appState, Scene.getScene(multiPointElement), { x, y });\r\n            }\r\n            if (!appState.elementLocked && appState.elementType !== \"freedraw\") {\r\n                appState.selectedElementIds[multiPointElement.id] = true;\r\n            }\r\n        }\r\n        if ((!appState.elementLocked && appState.elementType !== \"freedraw\") ||\r\n            !multiPointElement) {\r\n            resetCursor(canvas);\r\n        }\r\n        return {\r\n            elements: newElements,\r\n            appState: {\r\n                ...appState,\r\n                elementType: (appState.elementLocked || appState.elementType === \"freedraw\") &&\r\n                    multiPointElement\r\n                    ? appState.elementType\r\n                    : \"selection\",\r\n                draggingElement: null,\r\n                multiElement: null,\r\n                editingElement: null,\r\n                startBoundElement: null,\r\n                suggestedBindings: [],\r\n                selectedElementIds: multiPointElement &&\r\n                    !appState.elementLocked &&\r\n                    appState.elementType !== \"freedraw\"\r\n                    ? {\r\n                        ...appState.selectedElementIds,\r\n                        [multiPointElement.id]: true,\r\n                    }\r\n                    : appState.selectedElementIds,\r\n                pendingImageElement: null,\r\n            },\r\n            commitToHistory: appState.elementType === \"freedraw\",\r\n        };\r\n    },\r\n    keyTest: (event, appState) => (event.key === KEYS.ESCAPE &&\r\n        (appState.editingLinearElement !== null ||\r\n            (!appState.draggingElement && appState.multiElement === null))) ||\r\n        ((event.key === KEYS.ESCAPE || event.key === KEYS.ENTER) &&\r\n            appState.multiElement !== null),\r\n    PanelComponent: ({ appState, updateData }) => (<ToolButton type=\"button\" icon={done} title={t(\"buttons.done\")} aria-label={t(\"buttons.done\")} onClick={updateData} visible={appState.multiElement != null}/>),\r\n});\r\n","import \"./TextInput.scss\";\r\nimport React, { useState } from \"react\";\r\nimport { focusNearestParent } from \"../utils\";\r\nimport \"./ProjectName.scss\";\r\nimport { useExcalidrawContainer } from \"./App\";\r\nexport const ProjectName = (props) => {\r\n    const { id } = useExcalidrawContainer();\r\n    const [fileName, setFileName] = useState(props.value);\r\n    const handleBlur = (event) => {\r\n        focusNearestParent(event.target);\r\n        const value = event.target.value;\r\n        if (value !== props.value) {\r\n            props.onChange(value);\r\n        }\r\n    };\r\n    const handleKeyDown = (event) => {\r\n        if (event.key === \"Enter\") {\r\n            event.preventDefault();\r\n            if (event.nativeEvent.isComposing || event.keyCode === 229) {\r\n                return;\r\n            }\r\n            event.currentTarget.blur();\r\n        }\r\n    };\r\n    return (<div className=\"ProjectName\">\r\n      <label className=\"ProjectName-label\" htmlFor=\"filename\">\r\n        {`${props.label}${props.isNameEditable ? \"\" : \":\"}`}\r\n      </label>\r\n      {props.isNameEditable ? (<input className=\"TextInput\" onBlur={handleBlur} onKeyDown={handleKeyDown} id={`${id}-filename`} value={fileName} onChange={(event) => setFileName(event.target.value)}/>) : (<span className=\"TextInput TextInput--readonly\" id={`${id}-filename`}>\r\n          {props.value}\r\n        </span>)}\r\n    </div>);\r\n};\r\n","/**\r\n * https://stackoverflow.com/a/3368118\r\n * Draws a rounded rectangle using the current state of the canvas.\r\n * @param {CanvasRenderingContext2D} context\r\n * @param {Number} x The top left x coordinate\r\n * @param {Number} y The top left y coordinate\r\n * @param {Number} width The width of the rectangle\r\n * @param {Number} height The height of the rectangle\r\n * @param {Number} radius The corner radius\r\n */\r\nexport const roundRect = (context, x, y, width, height, radius) => {\r\n    context.beginPath();\r\n    context.moveTo(x + radius, y);\r\n    context.lineTo(x + width - radius, y);\r\n    context.quadraticCurveTo(x + width, y, x + width, y + radius);\r\n    context.lineTo(x + width, y + height - radius);\r\n    context.quadraticCurveTo(x + width, y + height, x + width - radius, y + height);\r\n    context.lineTo(x + radius, y + height);\r\n    context.quadraticCurveTo(x, y + height, x, y + height - radius);\r\n    context.lineTo(x, y + radius);\r\n    context.quadraticCurveTo(x, y, x + radius, y);\r\n    context.closePath();\r\n    context.fill();\r\n    context.stroke();\r\n};\r\n","import colors from \"./colors\";\r\nexport const getClientColors = (clientId, appState) => {\r\n    if (appState?.collaborators) {\r\n        const currentUser = appState.collaborators.get(clientId);\r\n        if (currentUser?.color) {\r\n            return currentUser.color;\r\n        }\r\n    }\r\n    // Naive way of getting an integer out of the clientId\r\n    const sum = clientId.split(\"\").reduce((a, str) => a + str.charCodeAt(0), 0);\r\n    // Skip transparent background.\r\n    const backgrounds = colors.elementBackground.slice(1);\r\n    const strokes = colors.elementStroke.slice(1);\r\n    return {\r\n        background: backgrounds[sum % backgrounds.length],\r\n        stroke: strokes[sum % strokes.length],\r\n    };\r\n};\r\nexport const getClientInitials = (username) => {\r\n    if (!username) {\r\n        return \"?\";\r\n    }\r\n    const names = username.trim().split(\" \");\r\n    if (names.length < 2) {\r\n        return names[0].substring(0, 2).toUpperCase();\r\n    }\r\n    const firstName = names[0];\r\n    const lastName = names[names.length - 1];\r\n    return (firstName[0] + lastName[0]).toUpperCase();\r\n};\r\n","import oc from \"open-color\";\r\nimport {\r\n  getElementAbsoluteCoords,\r\n  OMIT_SIDES_FOR_MULTIPLE_ELEMENTS,\r\n  getTransformHandlesFromCoords,\r\n  getTransformHandles,\r\n  getElementBounds,\r\n  getCommonBounds,\r\n} from \"../element\";\r\nimport { roundRect } from \"./roundRect\";\r\nimport {\r\n  getScrollBars,\r\n  SCROLLBAR_COLOR,\r\n  SCROLLBAR_WIDTH,\r\n} from \"../scene/scrollbars\";\r\nimport { getSelectedElements } from \"../scene/selection\";\r\nimport { renderElement, renderElementToSvg } from \"./renderElement\";\r\nimport { getClientColors } from \"../clients\";\r\nimport { LinearElementEditor } from \"../element/linearElementEditor\";\r\nimport {\r\n  isSelectedViaGroup,\r\n  getSelectedGroupIds,\r\n  getElementsInGroup,\r\n} from \"../groups\";\r\nimport { maxBindingGap } from \"../element/collision\";\r\nimport { isBindingEnabled } from \"../element/binding\";\r\nimport { viewportCoordsToSceneCoords, supportsEmoji } from \"../utils\";\r\nimport { UserIdleState } from \"../types\";\r\nimport { THEME_FILTER } from \"../constants\";\r\nconst hasEmojiSupport = supportsEmoji();\r\nconst strokeRectWithRotation = (\r\n  context,\r\n  x,\r\n  y,\r\n  width,\r\n  height,\r\n  cx,\r\n  cy,\r\n  angle,\r\n  fill = false\r\n) => {\r\n  context.save();\r\n  context.translate(cx, cy);\r\n  context.rotate(angle);\r\n  if (fill) {\r\n    context.fillRect(x - cx, y - cy, width, height);\r\n  }\r\n  context.strokeRect(x - cx, y - cy, width, height);\r\n  context.restore();\r\n};\r\nconst strokeDiamondWithRotation = (context, width, height, cx, cy, angle) => {\r\n  context.save();\r\n  context.translate(cx, cy);\r\n  context.rotate(angle);\r\n  context.beginPath();\r\n  context.moveTo(0, height / 2);\r\n  context.lineTo(width / 2, 0);\r\n  context.lineTo(0, -height / 2);\r\n  context.lineTo(-width / 2, 0);\r\n  context.closePath();\r\n  context.stroke();\r\n  context.restore();\r\n};\r\nconst strokeEllipseWithRotation = (context, width, height, cx, cy, angle) => {\r\n  context.beginPath();\r\n  context.ellipse(cx, cy, width / 2, height / 2, angle, 0, Math.PI * 2);\r\n  context.stroke();\r\n};\r\nconst fillCircle = (context, cx, cy, radius) => {\r\n  context.beginPath();\r\n  context.arc(cx, cy, radius, 0, Math.PI * 2);\r\n  context.fill();\r\n  context.stroke();\r\n};\r\nconst strokeGrid = (context, gridSize, offsetX, offsetY, width, height) => {\r\n  context.save();\r\n  context.strokeStyle = \"rgba(0,0,0,0.1)\";\r\n  context.beginPath();\r\n  for (let x = offsetX; x < offsetX + width + gridSize * 2; x += gridSize) {\r\n    context.moveTo(x, offsetY - gridSize);\r\n    context.lineTo(x, offsetY + height + gridSize * 2);\r\n  }\r\n  for (let y = offsetY; y < offsetY + height + gridSize * 2; y += gridSize) {\r\n    context.moveTo(offsetX - gridSize, y);\r\n    context.lineTo(offsetX + width + gridSize * 2, y);\r\n  }\r\n  context.stroke();\r\n  context.restore();\r\n};\r\nconst renderLinearPointHandles = (context, appState, sceneState, element) => {\r\n  context.save();\r\n  context.translate(sceneState.scrollX, sceneState.scrollY);\r\n  context.lineWidth = 1 / sceneState.zoom.value;\r\n  LinearElementEditor.getPointsGlobalCoordinates(element).forEach(\r\n    (point, idx) => {\r\n      context.strokeStyle = \"red\";\r\n      context.setLineDash([]);\r\n      context.fillStyle =\r\n        appState.editingLinearElement?.activePointIndex === idx\r\n          ? \"rgba(255, 127, 127, 0.9)\"\r\n          : \"rgba(255, 255, 255, 0.9)\";\r\n      const { POINT_HANDLE_SIZE } = LinearElementEditor;\r\n      fillCircle(\r\n        context,\r\n        point[0],\r\n        point[1],\r\n        POINT_HANDLE_SIZE / 2 / sceneState.zoom.value\r\n      );\r\n    }\r\n  );\r\n  context.restore();\r\n};\r\nexport const renderScene = (\r\n  elements,\r\n  appState,\r\n  selectionElement,\r\n  scale,\r\n  rc,\r\n  canvas,\r\n  sceneState,\r\n  // extra options passed to the renderer\r\n  {\r\n    renderScrollbars = true,\r\n    renderSelection = true,\r\n    // Whether to employ render optimizations to improve performance.\r\n    // Should not be turned on for export operations and similar, because it\r\n    // doesn't guarantee pixel-perfect output.\r\n    renderOptimizations = false,\r\n    renderGrid = true,\r\n    /** when exporting the behavior is slightly different (e.g. we can't use\r\n    CSS filters) */\r\n    isExport = false,\r\n  } = {}\r\n) => {\r\n  if (canvas === null) {\r\n    return { atLeastOneVisibleElement: false };\r\n  }\r\n  const context = canvas.getContext(\"2d\");\r\n  context.setTransform(1, 0, 0, 1, 0, 0);\r\n  context.save();\r\n  context.scale(scale, scale);\r\n  // When doing calculations based on canvas width we should used normalized one\r\n  const normalizedCanvasWidth = canvas.width / scale;\r\n  const normalizedCanvasHeight = canvas.height / scale;\r\n//   if (isExport && sceneState.theme === \"dark\") {\r\n//     context.filter = THEME_FILTER;\r\n//   }\r\n  sceneState.viewBackgroundColor = \"transparent\"\r\n  // Paint background\r\n  if (typeof sceneState.viewBackgroundColor === \"string\") {\r\n    const hasTransparence =\r\n      sceneState.viewBackgroundColor === \"transparent\" ||\r\n      sceneState.viewBackgroundColor.length === 5 || // #RGBA\r\n      sceneState.viewBackgroundColor.length === 9 || // #RRGGBBA\r\n      /(hsla|rgba)\\(/.test(sceneState.viewBackgroundColor);\r\n    if (hasTransparence) {\r\n      context.clearRect(0, 0, normalizedCanvasWidth, normalizedCanvasHeight);\r\n    }\r\n    context.save();\r\n    context.fillStyle = sceneState.viewBackgroundColor;\r\n    context.fillRect(0, 0, normalizedCanvasWidth, normalizedCanvasHeight);\r\n    context.restore();\r\n  } else {\r\n    context.clearRect(0, 0, normalizedCanvasWidth, normalizedCanvasHeight);\r\n  }\r\n  // Apply zoom\r\n  const zoomTranslationX = sceneState.zoom.translation.x;\r\n  const zoomTranslationY = sceneState.zoom.translation.y;\r\n  context.save();\r\n  context.translate(zoomTranslationX, zoomTranslationY);\r\n  context.scale(sceneState.zoom.value, sceneState.zoom.value);\r\n  // Grid\r\n  if (renderGrid && appState.gridSize) {\r\n    strokeGrid(\r\n      context,\r\n      appState.gridSize,\r\n      -Math.ceil(zoomTranslationX / sceneState.zoom.value / appState.gridSize) *\r\n        appState.gridSize +\r\n        (sceneState.scrollX % appState.gridSize),\r\n      -Math.ceil(zoomTranslationY / sceneState.zoom.value / appState.gridSize) *\r\n        appState.gridSize +\r\n        (sceneState.scrollY % appState.gridSize),\r\n      normalizedCanvasWidth / sceneState.zoom.value,\r\n      normalizedCanvasHeight / sceneState.zoom.value\r\n    );\r\n  }\r\n  // Paint visible elements\r\n  const visibleElements = elements.filter((element) =>\r\n    isVisibleElement(element, normalizedCanvasWidth, normalizedCanvasHeight, {\r\n      zoom: sceneState.zoom,\r\n      offsetLeft: appState.offsetLeft,\r\n      offsetTop: appState.offsetTop,\r\n      scrollX: sceneState.scrollX,\r\n      scrollY: sceneState.scrollY,\r\n    })\r\n  );\r\n  visibleElements.forEach((element) => {\r\n    try {\r\n      renderElement(element, rc, context, renderOptimizations, sceneState);\r\n    } catch (error) {\r\n      console.error(error);\r\n    }\r\n  });\r\n  if (appState.editingLinearElement) {\r\n    const element = LinearElementEditor.getElement(\r\n      appState.editingLinearElement.elementId\r\n    );\r\n    if (element) {\r\n      renderLinearPointHandles(context, appState, sceneState, element);\r\n    }\r\n  }\r\n  // Paint selection element\r\n  if (selectionElement) {\r\n    try {\r\n      renderElement(\r\n        selectionElement,\r\n        rc,\r\n        context,\r\n        renderOptimizations,\r\n        sceneState\r\n      );\r\n    } catch (error) {\r\n      console.error(error);\r\n    }\r\n  }\r\n  if (isBindingEnabled(appState)) {\r\n    appState.suggestedBindings\r\n      .filter((binding) => binding != null)\r\n      .forEach((suggestedBinding) => {\r\n        renderBindingHighlight(context, sceneState, suggestedBinding);\r\n      });\r\n  }\r\n  // Paint selected elements\r\n  if (\r\n    renderSelection &&\r\n    !appState.multiElement &&\r\n    !appState.editingLinearElement\r\n  ) {\r\n    const selections = elements.reduce((acc, element) => {\r\n      const selectionColors = [];\r\n      // local user\r\n      if (\r\n        appState.selectedElementIds[element.id] &&\r\n        !isSelectedViaGroup(appState, element)\r\n      ) {\r\n        selectionColors.push(oc.black);\r\n      }\r\n      // remote users\r\n      if (sceneState.remoteSelectedElementIds[element.id]) {\r\n        selectionColors.push(\r\n          ...sceneState.remoteSelectedElementIds[element.id].map((socketId) => {\r\n            const { background } = getClientColors(socketId, appState);\r\n            return background;\r\n          })\r\n        );\r\n      }\r\n      if (selectionColors.length) {\r\n        const [elementX1, elementY1, elementX2, elementY2] =\r\n          getElementAbsoluteCoords(element);\r\n        acc.push({\r\n          angle: element.angle,\r\n          elementX1,\r\n          elementY1,\r\n          elementX2,\r\n          elementY2,\r\n          selectionColors,\r\n        });\r\n      }\r\n      return acc;\r\n    }, []);\r\n    const addSelectionForGroupId = (groupId) => {\r\n      const groupElements = getElementsInGroup(elements, groupId);\r\n      const [elementX1, elementY1, elementX2, elementY2] =\r\n        getCommonBounds(groupElements);\r\n      selections.push({\r\n        angle: 0,\r\n        elementX1,\r\n        elementX2,\r\n        elementY1,\r\n        elementY2,\r\n        selectionColors: [oc.black],\r\n      });\r\n    };\r\n    for (const groupId of getSelectedGroupIds(appState)) {\r\n      // TODO: support multiplayer selected group IDs\r\n      addSelectionForGroupId(groupId);\r\n    }\r\n    if (appState.editingGroupId) {\r\n      addSelectionForGroupId(appState.editingGroupId);\r\n    }\r\n    selections.forEach((selection) =>\r\n      renderSelectionBorder(context, sceneState, selection)\r\n    );\r\n    const locallySelectedElements = getSelectedElements(elements, appState);\r\n    // Paint resize transformHandles\r\n    context.save();\r\n    context.translate(sceneState.scrollX, sceneState.scrollY);\r\n    if (locallySelectedElements.length === 1) {\r\n      context.fillStyle = oc.white;\r\n      const transformHandles = getTransformHandles(\r\n        locallySelectedElements[0],\r\n        sceneState.zoom,\r\n        \"mouse\"\r\n      );\r\n      if (!appState.viewModeEnabled) {\r\n        renderTransformHandles(\r\n          context,\r\n          sceneState,\r\n          transformHandles,\r\n          locallySelectedElements[0].angle\r\n        );\r\n      }\r\n    } else if (locallySelectedElements.length > 1 && !appState.isRotating) {\r\n      const dashedLinePadding = 4 / sceneState.zoom.value;\r\n      context.fillStyle = oc.white;\r\n      const [x1, y1, x2, y2] = getCommonBounds(locallySelectedElements);\r\n      const initialLineDash = context.getLineDash();\r\n      context.setLineDash([2 / sceneState.zoom.value]);\r\n      const lineWidth = context.lineWidth;\r\n      context.lineWidth = 1 / sceneState.zoom.value;\r\n      strokeRectWithRotation(\r\n        context,\r\n        x1 - dashedLinePadding,\r\n        y1 - dashedLinePadding,\r\n        x2 - x1 + dashedLinePadding * 2,\r\n        y2 - y1 + dashedLinePadding * 2,\r\n        (x1 + x2) / 2,\r\n        (y1 + y2) / 2,\r\n        0\r\n      );\r\n      context.lineWidth = lineWidth;\r\n      context.setLineDash(initialLineDash);\r\n      const transformHandles = getTransformHandlesFromCoords(\r\n        [x1, y1, x2, y2],\r\n        0,\r\n        sceneState.zoom,\r\n        \"mouse\",\r\n        OMIT_SIDES_FOR_MULTIPLE_ELEMENTS\r\n      );\r\n      renderTransformHandles(context, sceneState, transformHandles, 0);\r\n    }\r\n    context.restore();\r\n  }\r\n  // Reset zoom\r\n  context.restore();\r\n  // Paint remote pointers\r\n  for (const clientId in sceneState.remotePointerViewportCoords) {\r\n    let { x, y } = sceneState.remotePointerViewportCoords[clientId];\r\n    x -= appState.offsetLeft;\r\n    y -= appState.offsetTop;\r\n    const width = 9;\r\n    const height = 14;\r\n    const isOutOfBounds =\r\n      x < 0 ||\r\n      x > normalizedCanvasWidth - width ||\r\n      y < 0 ||\r\n      y > normalizedCanvasHeight - height;\r\n    x = Math.max(x, 0);\r\n    x = Math.min(x, normalizedCanvasWidth - width);\r\n    y = Math.max(y, 0);\r\n    y = Math.min(y, normalizedCanvasHeight - height);\r\n    const { background, stroke } = getClientColors(clientId, appState);\r\n    context.save();\r\n    context.strokeStyle = stroke;\r\n    context.fillStyle = background;\r\n    const userState = sceneState.remotePointerUserStates[clientId];\r\n    if (isOutOfBounds || userState === UserIdleState.AWAY) {\r\n      context.globalAlpha = 0.48;\r\n    }\r\n    if (\r\n      sceneState.remotePointerButton &&\r\n      sceneState.remotePointerButton[clientId] === \"down\"\r\n    ) {\r\n      context.beginPath();\r\n      context.arc(x, y, 15, 0, 2 * Math.PI, false);\r\n      context.lineWidth = 3;\r\n      context.strokeStyle = \"#ffffff88\";\r\n      context.stroke();\r\n      context.closePath();\r\n      context.beginPath();\r\n      context.arc(x, y, 15, 0, 2 * Math.PI, false);\r\n      context.lineWidth = 1;\r\n      context.strokeStyle = stroke;\r\n      context.stroke();\r\n      context.closePath();\r\n    }\r\n    context.beginPath();\r\n    context.moveTo(x, y);\r\n    context.lineTo(x + 1, y + 14);\r\n    context.lineTo(x + 4, y + 9);\r\n    context.lineTo(x + 9, y + 10);\r\n    context.lineTo(x, y);\r\n    context.fill();\r\n    context.stroke();\r\n    const username = sceneState.remotePointerUsernames[clientId];\r\n    let idleState = \"\";\r\n    if (userState === UserIdleState.AWAY) {\r\n      idleState = hasEmojiSupport ? \"\" : ` (${UserIdleState.AWAY})`;\r\n    } else if (userState === UserIdleState.IDLE) {\r\n      idleState = hasEmojiSupport ? \"\" : ` (${UserIdleState.IDLE})`;\r\n    } else if (userState === UserIdleState.ACTIVE) {\r\n      idleState = hasEmojiSupport ? \"\" : \"\";\r\n    }\r\n    const usernameAndIdleState = `${\r\n      username ? `${username} ` : \"\"\r\n    }${idleState}`;\r\n    if (!isOutOfBounds && usernameAndIdleState) {\r\n      const offsetX = x + width;\r\n      const offsetY = y + height;\r\n      const paddingHorizontal = 4;\r\n      const paddingVertical = 4;\r\n      const measure = context.measureText(usernameAndIdleState);\r\n      const measureHeight =\r\n        measure.actualBoundingBoxDescent + measure.actualBoundingBoxAscent;\r\n      // Border\r\n      context.fillStyle = stroke;\r\n      context.fillRect(\r\n        offsetX - 1,\r\n        offsetY - 1,\r\n        measure.width + 2 * paddingHorizontal + 2,\r\n        measureHeight + 2 * paddingVertical + 2\r\n      );\r\n      // Background\r\n      context.fillStyle = background;\r\n      context.fillRect(\r\n        offsetX,\r\n        offsetY,\r\n        measure.width + 2 * paddingHorizontal,\r\n        measureHeight + 2 * paddingVertical\r\n      );\r\n      context.fillStyle = oc.white;\r\n      context.fillText(\r\n        usernameAndIdleState,\r\n        offsetX + paddingHorizontal,\r\n        offsetY + paddingVertical + measure.actualBoundingBoxAscent\r\n      );\r\n    }\r\n    context.restore();\r\n    context.closePath();\r\n  }\r\n  // Paint scrollbars\r\n  let scrollBars;\r\n  if (renderScrollbars) {\r\n    scrollBars = getScrollBars(\r\n      elements,\r\n      normalizedCanvasWidth,\r\n      normalizedCanvasHeight,\r\n      sceneState\r\n    );\r\n    context.save();\r\n    context.fillStyle = SCROLLBAR_COLOR;\r\n    context.strokeStyle = \"rgba(255,255,255,0.8)\";\r\n    [scrollBars.horizontal, scrollBars.vertical].forEach((scrollBar) => {\r\n      if (scrollBar) {\r\n        roundRect(\r\n          context,\r\n          scrollBar.x,\r\n          scrollBar.y,\r\n          scrollBar.width,\r\n          scrollBar.height,\r\n          SCROLLBAR_WIDTH / 2\r\n        );\r\n      }\r\n    });\r\n    context.restore();\r\n  }\r\n  context.restore();\r\n  return { atLeastOneVisibleElement: visibleElements.length > 0, scrollBars };\r\n};\r\nconst renderTransformHandles = (\r\n  context,\r\n  sceneState,\r\n  transformHandles,\r\n  angle\r\n) => {\r\n  Object.keys(transformHandles).forEach((key) => {\r\n    const transformHandle = transformHandles[key];\r\n    if (transformHandle !== undefined) {\r\n      context.save();\r\n      context.lineWidth = 1 / sceneState.zoom.value;\r\n      if (key === \"rotation\") {\r\n        fillCircle(\r\n          context,\r\n          transformHandle[0] + transformHandle[2] / 2,\r\n          transformHandle[1] + transformHandle[3] / 2,\r\n          transformHandle[2] / 2\r\n        );\r\n      } else {\r\n        strokeRectWithRotation(\r\n          context,\r\n          transformHandle[0],\r\n          transformHandle[1],\r\n          transformHandle[2],\r\n          transformHandle[3],\r\n          transformHandle[0] + transformHandle[2] / 2,\r\n          transformHandle[1] + transformHandle[3] / 2,\r\n          angle,\r\n          true\r\n        );\r\n      }\r\n      context.restore();\r\n    }\r\n  });\r\n};\r\nconst renderSelectionBorder = (context, sceneState, elementProperties) => {\r\n  const { angle, elementX1, elementY1, elementX2, elementY2, selectionColors } =\r\n    elementProperties;\r\n  const elementWidth = elementX2 - elementX1;\r\n  const elementHeight = elementY2 - elementY1;\r\n  const dashedLinePadding = 4 / sceneState.zoom.value;\r\n  const dashWidth = 8 / sceneState.zoom.value;\r\n  const spaceWidth = 4 / sceneState.zoom.value;\r\n  context.save();\r\n  context.translate(sceneState.scrollX, sceneState.scrollY);\r\n  context.lineWidth = 1 / sceneState.zoom.value;\r\n  const count = selectionColors.length;\r\n  for (let index = 0; index < count; ++index) {\r\n    context.strokeStyle = selectionColors[index];\r\n    context.setLineDash([\r\n      dashWidth,\r\n      spaceWidth + (dashWidth + spaceWidth) * (count - 1),\r\n    ]);\r\n    context.lineDashOffset = (dashWidth + spaceWidth) * index;\r\n    strokeRectWithRotation(\r\n      context,\r\n      elementX1 - dashedLinePadding,\r\n      elementY1 - dashedLinePadding,\r\n      elementWidth + dashedLinePadding * 2,\r\n      elementHeight + dashedLinePadding * 2,\r\n      elementX1 + elementWidth / 2,\r\n      elementY1 + elementHeight / 2,\r\n      angle\r\n    );\r\n  }\r\n  context.restore();\r\n};\r\nconst renderBindingHighlight = (context, sceneState, suggestedBinding) => {\r\n  const renderHighlight = Array.isArray(suggestedBinding)\r\n    ? renderBindingHighlightForSuggestedPointBinding\r\n    : renderBindingHighlightForBindableElement;\r\n  context.save();\r\n  context.translate(sceneState.scrollX, sceneState.scrollY);\r\n  renderHighlight(context, suggestedBinding);\r\n  context.restore();\r\n};\r\nconst renderBindingHighlightForBindableElement = (context, element) => {\r\n  const [x1, y1, x2, y2] = getElementAbsoluteCoords(element);\r\n  const width = x2 - x1;\r\n  const height = y2 - y1;\r\n  const threshold = maxBindingGap(element, width, height);\r\n  // So that we don't overlap the element itself\r\n  const strokeOffset = 4;\r\n  context.strokeStyle = \"rgba(0,0,0,.05)\";\r\n  context.lineWidth = threshold - strokeOffset;\r\n  const padding = strokeOffset / 2 + threshold / 2;\r\n  switch (element.type) {\r\n    case \"rectangle\":\r\n    case \"text\":\r\n      strokeRectWithRotation(\r\n        context,\r\n        x1 - padding,\r\n        y1 - padding,\r\n        width + padding * 2,\r\n        height + padding * 2,\r\n        x1 + width / 2,\r\n        y1 + height / 2,\r\n        element.angle\r\n      );\r\n      break;\r\n    case \"diamond\":\r\n      const side = Math.hypot(width, height);\r\n      const wPadding = (padding * side) / height;\r\n      const hPadding = (padding * side) / width;\r\n      strokeDiamondWithRotation(\r\n        context,\r\n        width + wPadding * 2,\r\n        height + hPadding * 2,\r\n        x1 + width / 2,\r\n        y1 + height / 2,\r\n        element.angle\r\n      );\r\n      break;\r\n    case \"ellipse\":\r\n      strokeEllipseWithRotation(\r\n        context,\r\n        width + padding * 2,\r\n        height + padding * 2,\r\n        x1 + width / 2,\r\n        y1 + height / 2,\r\n        element.angle\r\n      );\r\n      break;\r\n  }\r\n};\r\nconst renderBindingHighlightForSuggestedPointBinding = (\r\n  context,\r\n  suggestedBinding\r\n) => {\r\n  const [element, startOrEnd, bindableElement] = suggestedBinding;\r\n  const threshold = maxBindingGap(\r\n    bindableElement,\r\n    bindableElement.width,\r\n    bindableElement.height\r\n  );\r\n  context.strokeStyle = \"rgba(0,0,0,0)\";\r\n  context.fillStyle = \"rgba(0,0,0,.05)\";\r\n  const pointIndices =\r\n    startOrEnd === \"both\" ? [0, -1] : startOrEnd === \"start\" ? [0] : [-1];\r\n  pointIndices.forEach((index) => {\r\n    const [x, y] = LinearElementEditor.getPointAtIndexGlobalCoordinates(\r\n      element,\r\n      index\r\n    );\r\n    fillCircle(context, x, y, threshold);\r\n  });\r\n};\r\nconst isVisibleElement = (\r\n  element,\r\n  canvasWidth,\r\n  canvasHeight,\r\n  viewTransformations\r\n) => {\r\n  const [x1, y1, x2, y2] = getElementBounds(element); // scene coordinates\r\n  const topLeftSceneCoords = viewportCoordsToSceneCoords(\r\n    {\r\n      clientX: viewTransformations.offsetLeft,\r\n      clientY: viewTransformations.offsetTop,\r\n    },\r\n    viewTransformations\r\n  );\r\n  const bottomRightSceneCoords = viewportCoordsToSceneCoords(\r\n    {\r\n      clientX: viewTransformations.offsetLeft + canvasWidth,\r\n      clientY: viewTransformations.offsetTop + canvasHeight,\r\n    },\r\n    viewTransformations\r\n  );\r\n  return (\r\n    topLeftSceneCoords.x <= x2 &&\r\n    topLeftSceneCoords.y <= y2 &&\r\n    bottomRightSceneCoords.x >= x1 &&\r\n    bottomRightSceneCoords.y >= y1\r\n  );\r\n};\r\n// This should be only called for exporting purposes\r\nexport const renderSceneToSvg = (\r\n  elements,\r\n  rsvg,\r\n  svgRoot,\r\n  files,\r\n  { offsetX = 0, offsetY = 0 } = {}\r\n) => {\r\n  if (!svgRoot) {\r\n    return;\r\n  }\r\n  // render elements\r\n  elements.forEach((element) => {\r\n    if (!element.isDeleted) {\r\n      try {\r\n        renderElementToSvg(\r\n          element,\r\n          rsvg,\r\n          svgRoot,\r\n          files,\r\n          element.x + offsetX,\r\n          element.y + offsetY\r\n        );\r\n      } catch (error) {\r\n        console.error(error);\r\n      }\r\n    }\r\n  });\r\n};\r\n","import { fileOpen as _fileOpen, fileSave as _fileSave, supported as nativeFileSystemSupported, } from \"browser-fs-access\";\r\nimport { EVENT, MIME_TYPES } from \"../constants\";\r\nimport { AbortError } from \"../errors\";\r\nimport { debounce } from \"../utils\";\r\nconst INPUT_CHANGE_INTERVAL_MS = 500;\r\nexport const fileOpen = (opts) => {\r\n    const mimeTypes = opts.extensions?.reduce((mimeTypes, type) => {\r\n        mimeTypes.push(MIME_TYPES[type]);\r\n        return mimeTypes;\r\n    }, []);\r\n    const extensions = opts.extensions?.reduce((acc, ext) => {\r\n        if (ext === \"jpg\") {\r\n            return acc.concat(\".jpg\", \".jpeg\");\r\n        }\r\n        return acc.concat(`.${ext}`);\r\n    }, []);\r\n    return _fileOpen({\r\n        description: opts.description,\r\n        extensions,\r\n        mimeTypes,\r\n        multiple: opts.multiple ?? false,\r\n        legacySetup: (resolve, reject, input) => {\r\n            const scheduleRejection = debounce(reject, INPUT_CHANGE_INTERVAL_MS);\r\n            const focusHandler = () => {\r\n                checkForFile();\r\n                document.addEventListener(EVENT.KEYUP, scheduleRejection);\r\n                document.addEventListener(EVENT.POINTER_UP, scheduleRejection);\r\n                scheduleRejection();\r\n            };\r\n            const checkForFile = () => {\r\n                // this hack might not work when expecting multiple files\r\n                if (input.files?.length) {\r\n                    const ret = opts.multiple ? [...input.files] : input.files[0];\r\n                    resolve(ret);\r\n                }\r\n            };\r\n            requestAnimationFrame(() => {\r\n                window.addEventListener(EVENT.FOCUS, focusHandler);\r\n            });\r\n            const interval = window.setInterval(() => {\r\n                checkForFile();\r\n            }, INPUT_CHANGE_INTERVAL_MS);\r\n            return (rejectPromise) => {\r\n                clearInterval(interval);\r\n                scheduleRejection.cancel();\r\n                window.removeEventListener(EVENT.FOCUS, focusHandler);\r\n                document.removeEventListener(EVENT.KEYUP, scheduleRejection);\r\n                document.removeEventListener(EVENT.POINTER_UP, scheduleRejection);\r\n                if (rejectPromise) {\r\n                    // so that something is shown in console if we need to debug this\r\n                    console.warn(\"Opening the file was canceled (legacy-fs).\");\r\n                    rejectPromise(new AbortError());\r\n                }\r\n            };\r\n        },\r\n    });\r\n};\r\nexport const fileSave = (blob, opts) => {\r\n    return _fileSave(blob, {\r\n        fileName: `${opts.name}.${opts.extension}`,\r\n        description: opts.description,\r\n        extensions: [`.${opts.extension}`],\r\n    }, opts.fileHandle);\r\n};\r\nexport { nativeFileSystemSupported };\r\n","import { getElementMap, getNormalizedDimensions, isInvisiblySmallElement, } from \"../element\";\r\nimport { isLinearElementType } from \"../element/typeChecks\";\r\nimport { randomId } from \"../random\";\r\nimport { DEFAULT_FONT_FAMILY, DEFAULT_TEXT_ALIGN, DEFAULT_VERTICAL_ALIGN, FONT_FAMILY, } from \"../constants\";\r\nimport { getDefaultAppState } from \"../appState\";\r\nimport { LinearElementEditor } from \"../element/linearElementEditor\";\r\nimport { bumpVersion } from \"../element/mutateElement\";\r\nexport const AllowedExcalidrawElementTypes = {\r\n    selection: true,\r\n    text: true,\r\n    rectangle: true,\r\n    diamond: true,\r\n    ellipse: true,\r\n    line: true,\r\n    image: true,\r\n    arrow: true,\r\n    freedraw: true,\r\n};\r\nconst getFontFamilyByName = (fontFamilyName) => {\r\n    if (Object.keys(FONT_FAMILY).includes(fontFamilyName)) {\r\n        return FONT_FAMILY[fontFamilyName];\r\n    }\r\n    return DEFAULT_FONT_FAMILY;\r\n};\r\nconst restoreElementWithProperties = (element, extra) => {\r\n    const base = {\r\n        type: extra.type || element.type,\r\n        // all elements must have version > 0 so getSceneVersion() will pick up\r\n        // newly added elements\r\n        version: element.version || 1,\r\n        versionNonce: element.versionNonce ?? 0,\r\n        isDeleted: element.isDeleted ?? false,\r\n        id: element.id || randomId(),\r\n        fillStyle: element.fillStyle || \"hachure\",\r\n        strokeWidth: element.strokeWidth || 1,\r\n        strokeStyle: element.strokeStyle ?? \"solid\",\r\n        roughness: element.roughness ?? 1,\r\n        opacity: element.opacity == null ? 100 : element.opacity,\r\n        angle: element.angle || 0,\r\n        x: extra.x ?? element.x ?? 0,\r\n        y: extra.y ?? element.y ?? 0,\r\n        strokeColor: element.strokeColor,\r\n        backgroundColor: element.backgroundColor,\r\n        width: element.width || 0,\r\n        height: element.height || 0,\r\n        seed: element.seed ?? 1,\r\n        groupIds: element.groupIds ?? [],\r\n        strokeSharpness: element.strokeSharpness ??\r\n            (isLinearElementType(element.type) ? \"round\" : \"sharp\"),\r\n        boundElementIds: element.boundElementIds ?? [],\r\n    };\r\n    return {\r\n        ...base,\r\n        ...getNormalizedDimensions(base),\r\n        ...extra,\r\n    };\r\n};\r\nconst restoreElement = (element) => {\r\n    switch (element.type) {\r\n        case \"text\":\r\n            let fontSize = element.fontSize;\r\n            let fontFamily = element.fontFamily;\r\n            if (\"font\" in element) {\r\n                const [fontPx, _fontFamily] = element.font.split(\" \");\r\n                fontSize = parseInt(fontPx, 10);\r\n                fontFamily = getFontFamilyByName(_fontFamily);\r\n            }\r\n            return restoreElementWithProperties(element, {\r\n                fontSize,\r\n                fontFamily,\r\n                text: element.text ?? \"\",\r\n                baseline: element.baseline,\r\n                textAlign: element.textAlign || DEFAULT_TEXT_ALIGN,\r\n                verticalAlign: element.verticalAlign || DEFAULT_VERTICAL_ALIGN,\r\n            });\r\n        case \"freedraw\": {\r\n            return restoreElementWithProperties(element, {\r\n                points: element.points,\r\n                lastCommittedPoint: null,\r\n                simulatePressure: element.simulatePressure,\r\n                pressures: element.pressures,\r\n            });\r\n        }\r\n        case \"image\":\r\n            return restoreElementWithProperties(element, {\r\n                status: element.status || \"pending\",\r\n                fileId: element.fileId,\r\n                scale: element.scale || [1, 1],\r\n            });\r\n        case \"line\":\r\n        // @ts-ignore LEGACY type\r\n        // eslint-disable-next-line no-fallthrough\r\n        case \"draw\":\r\n        case \"arrow\": {\r\n            const { startArrowhead = null, endArrowhead = element.type === \"arrow\" ? \"arrow\" : null, } = element;\r\n            let x = element.x;\r\n            let y = element.y;\r\n            let points = // migrate old arrow model to new one\r\n             !Array.isArray(element.points) || element.points.length < 2\r\n                ? [\r\n                    [0, 0],\r\n                    [element.width, element.height],\r\n                ]\r\n                : element.points;\r\n            if (points[0][0] !== 0 || points[0][1] !== 0) {\r\n                ({ points, x, y } = LinearElementEditor.getNormalizedPoints(element));\r\n            }\r\n            return restoreElementWithProperties(element, {\r\n                type: element.type === \"draw\"\r\n                    ? \"line\"\r\n                    : element.type,\r\n                startBinding: element.startBinding,\r\n                endBinding: element.endBinding,\r\n                lastCommittedPoint: null,\r\n                startArrowhead,\r\n                endArrowhead,\r\n                points,\r\n                x,\r\n                y,\r\n            });\r\n        }\r\n        // generic elements\r\n        case \"ellipse\":\r\n            return restoreElementWithProperties(element, {});\r\n        case \"rectangle\":\r\n            return restoreElementWithProperties(element, {});\r\n        case \"diamond\":\r\n            return restoreElementWithProperties(element, {});\r\n        // Don't use default case so as to catch a missing an element type case.\r\n        // We also don't want to throw, but instead return void so we filter\r\n        // out these unsupported elements from the restored array.\r\n    }\r\n};\r\nexport const restoreElements = (elements, \r\n/** NOTE doesn't serve for reconciliation */\r\nlocalElements) => {\r\n    const localElementsMap = localElements ? getElementMap(localElements) : null;\r\n    return (elements || []).reduce((elements, element) => {\r\n        // filtering out selection, which is legacy, no longer kept in elements,\r\n        // and causing issues if retained\r\n        if (element.type !== \"selection\" && !isInvisiblySmallElement(element)) {\r\n            let migratedElement = restoreElement(element);\r\n            if (migratedElement) {\r\n                const localElement = localElementsMap?.[element.id];\r\n                if (localElement && localElement.version > migratedElement.version) {\r\n                    migratedElement = bumpVersion(migratedElement, localElement.version);\r\n                }\r\n                elements.push(migratedElement);\r\n            }\r\n        }\r\n        return elements;\r\n    }, []);\r\n};\r\nexport const restoreAppState = (appState, localAppState) => {\r\n    appState = appState || {};\r\n    const defaultAppState = getDefaultAppState();\r\n    const nextAppState = {};\r\n    for (const [key, defaultValue] of Object.entries(defaultAppState)) {\r\n        const suppliedValue = appState[key];\r\n        const localValue = localAppState ? localAppState[key] : undefined;\r\n        nextAppState[key] =\r\n            suppliedValue !== undefined\r\n                ? suppliedValue\r\n                : localValue !== undefined\r\n                    ? localValue\r\n                    : defaultValue;\r\n    }\r\n    return {\r\n        ...nextAppState,\r\n        elementType: AllowedExcalidrawElementTypes[nextAppState.elementType]\r\n            ? nextAppState.elementType\r\n            : \"selection\",\r\n        // Migrates from previous version where appState.zoom was a number\r\n        zoom: typeof appState.zoom === \"number\"\r\n            ? {\r\n                value: appState.zoom,\r\n                translation: defaultAppState.zoom.translation,\r\n            }\r\n            : appState.zoom || defaultAppState.zoom,\r\n    };\r\n};\r\nexport const restore = (data, \r\n/**\r\n * Local AppState (`this.state` or initial state from localStorage) so that we\r\n * don't overwrite local state with default values (when values not\r\n * explicitly specified).\r\n * Supply `null` if you can't get access to it.\r\n */\r\nlocalAppState, localElements) => {\r\n    return {\r\n        elements: restoreElements(data?.elements, localElements),\r\n        appState: restoreAppState(data?.appState, localAppState || null),\r\n        files: data?.files || {},\r\n    };\r\n};\r\n","import { nanoid } from \"nanoid\";\r\nimport { cleanAppStateForExport } from \"../appState\";\r\nimport { ALLOWED_IMAGE_MIME_TYPES, EXPORT_DATA_TYPES, MIME_TYPES, } from \"../constants\";\r\nimport { clearElementsForExport } from \"../element\";\r\nimport { CanvasError } from \"../errors\";\r\nimport { t } from \"../i18n\";\r\nimport { calculateScrollCenter } from \"../scene\";\r\nimport { isValidExcalidrawData } from \"./json\";\r\nimport { restore } from \"./restore\";\r\nconst parseFileContents = async (blob) => {\r\n    let contents;\r\n    if (blob.type === MIME_TYPES.png) {\r\n        try {\r\n            return await (await import(/* webpackChunkName: \"image\" */ \"./image\")).decodePngMetadata(blob);\r\n        }\r\n        catch (error) {\r\n            if (error.message === \"INVALID\") {\r\n                throw new DOMException(t(\"alerts.imageDoesNotContainScene\"), \"EncodingError\");\r\n            }\r\n            else {\r\n                throw new DOMException(t(\"alerts.cannotRestoreFromImage\"), \"EncodingError\");\r\n            }\r\n        }\r\n    }\r\n    else {\r\n        if (\"text\" in Blob) {\r\n            contents = await blob.text();\r\n        }\r\n        else {\r\n            contents = await new Promise((resolve) => {\r\n                const reader = new FileReader();\r\n                reader.readAsText(blob, \"utf8\");\r\n                reader.onloadend = () => {\r\n                    if (reader.readyState === FileReader.DONE) {\r\n                        resolve(reader.result);\r\n                    }\r\n                };\r\n            });\r\n        }\r\n        if (blob.type === MIME_TYPES.svg) {\r\n            try {\r\n                return await (await import(/* webpackChunkName: \"image\" */ \"./image\")).decodeSvgMetadata({\r\n                    svg: contents,\r\n                });\r\n            }\r\n            catch (error) {\r\n                if (error.message === \"INVALID\") {\r\n                    throw new DOMException(t(\"alerts.imageDoesNotContainScene\"), \"EncodingError\");\r\n                }\r\n                else {\r\n                    throw new DOMException(t(\"alerts.cannotRestoreFromImage\"), \"EncodingError\");\r\n                }\r\n            }\r\n        }\r\n    }\r\n    return contents;\r\n};\r\nexport const getMimeType = (blob) => {\r\n    let name;\r\n    if (typeof blob === \"string\") {\r\n        name = blob;\r\n    }\r\n    else {\r\n        if (blob.type) {\r\n            return blob.type;\r\n        }\r\n        name = blob.name || \"\";\r\n    }\r\n    if (/\\.(excalidraw|json)$/.test(name)) {\r\n        return MIME_TYPES.json;\r\n    }\r\n    else if (/\\.png$/.test(name)) {\r\n        return MIME_TYPES.png;\r\n    }\r\n    else if (/\\.jpe?g$/.test(name)) {\r\n        return MIME_TYPES.jpg;\r\n    }\r\n    else if (/\\.svg$/.test(name)) {\r\n        return MIME_TYPES.svg;\r\n    }\r\n    return \"\";\r\n};\r\nexport const getFileHandleType = (handle) => {\r\n    if (!handle) {\r\n        return null;\r\n    }\r\n    return handle.name.match(/\\.(json|excalidraw|png|svg)$/)?.[1] || null;\r\n};\r\nexport const isImageFileHandleType = (type) => {\r\n    return type === \"png\" || type === \"svg\";\r\n};\r\nexport const isImageFileHandle = (handle) => {\r\n    const type = getFileHandleType(handle);\r\n    return type === \"png\" || type === \"svg\";\r\n};\r\nexport const isSupportedImageFile = (blob) => {\r\n    const { type } = blob || {};\r\n    return (!!type && ALLOWED_IMAGE_MIME_TYPES.includes(type));\r\n};\r\nexport const loadFromBlob = async (blob, \r\n/** @see restore.localAppState */\r\nlocalAppState, localElements) => {\r\n    const contents = await parseFileContents(blob);\r\n    try {\r\n        const data = JSON.parse(contents);\r\n        if (!isValidExcalidrawData(data)) {\r\n            throw new Error(t(\"alerts.couldNotLoadInvalidFile\"));\r\n        }\r\n        const result = restore({\r\n            elements: clearElementsForExport(data.elements || []),\r\n            appState: {\r\n                theme: localAppState?.theme,\r\n                fileHandle: blob.handle || null,\r\n                ...cleanAppStateForExport(data.appState || {}),\r\n                ...(localAppState\r\n                    ? calculateScrollCenter(data.elements || [], localAppState, null)\r\n                    : {}),\r\n            },\r\n            files: data.files,\r\n        }, localAppState, localElements);\r\n        return result;\r\n    }\r\n    catch (error) {\r\n        console.error(error.message);\r\n        throw new Error(t(\"alerts.couldNotLoadInvalidFile\"));\r\n    }\r\n};\r\nexport const loadLibraryFromBlob = async (blob) => {\r\n    const contents = await parseFileContents(blob);\r\n    const data = JSON.parse(contents);\r\n    if (data.type !== EXPORT_DATA_TYPES.excalidrawLibrary) {\r\n        throw new Error(t(\"alerts.couldNotLoadInvalidFile\"));\r\n    }\r\n    return data;\r\n};\r\nexport const canvasToBlob = async (canvas) => {\r\n    return new Promise((resolve, reject) => {\r\n        try {\r\n            canvas.toBlob((blob) => {\r\n                if (!blob) {\r\n                    return reject(new CanvasError(t(\"canvasError.canvasTooBig\"), \"CANVAS_POSSIBLY_TOO_BIG\"));\r\n                }\r\n                resolve(blob);\r\n            });\r\n        }\r\n        catch (error) {\r\n            reject(error);\r\n        }\r\n    });\r\n};\r\n/** generates SHA-1 digest from supplied file (if not supported, falls back\r\n    to a 40-char base64 random id) */\r\nexport const generateIdFromFile = async (file) => {\r\n    let id;\r\n    try {\r\n        const hashBuffer = await window.crypto.subtle.digest(\"SHA-1\", await file.arrayBuffer());\r\n        id =\r\n            // convert buffer to byte array\r\n            Array.from(new Uint8Array(hashBuffer))\r\n                // convert to hex string\r\n                .map((byte) => byte.toString(16).padStart(2, \"0\"))\r\n                .join(\"\");\r\n    }\r\n    catch (error) {\r\n        console.error(error);\r\n        // length 40 to align with the HEX length of SHA-1 (which is 160 bit)\r\n        id = nanoid(40);\r\n    }\r\n    return id;\r\n};\r\nexport const getDataURL = async (file) => {\r\n    return new Promise((resolve, reject) => {\r\n        const reader = new FileReader();\r\n        reader.onload = () => {\r\n            const dataURL = reader.result;\r\n            resolve(dataURL);\r\n        };\r\n        reader.onerror = (error) => reject(error);\r\n        reader.readAsDataURL(file);\r\n    });\r\n};\r\nexport const dataURLToFile = (dataURL, filename = \"\") => {\r\n    const dataIndexStart = dataURL.indexOf(\",\");\r\n    const byteString = atob(dataURL.slice(dataIndexStart + 1));\r\n    const mimeType = dataURL.slice(0, dataIndexStart).split(\":\")[1].split(\";\")[0];\r\n    const ab = new ArrayBuffer(byteString.length);\r\n    const ia = new Uint8Array(ab);\r\n    for (let i = 0; i < byteString.length; i++) {\r\n        ia[i] = byteString.charCodeAt(i);\r\n    }\r\n    return new File([ab], filename, { type: mimeType });\r\n};\r\nexport const resizeImageFile = async (file, maxWidthOrHeight) => {\r\n    // SVG files shouldn't a can't be resized\r\n    if (file.type === MIME_TYPES.svg) {\r\n        return file;\r\n    }\r\n    const [pica, imageBlobReduce] = await Promise.all([\r\n        import(\"pica\").then((res) => res.default),\r\n        // a wrapper for pica for better API\r\n        import(\"image-blob-reduce\").then((res) => res.default),\r\n    ]);\r\n    // CRA's minification settings break pica in WebWorkers, so let's disable\r\n    // them for now\r\n    // https://github.com/nodeca/image-blob-reduce/issues/21#issuecomment-757365513\r\n    const reduce = imageBlobReduce({\r\n        pica: pica({ features: [\"js\", \"wasm\"] }),\r\n    });\r\n    const fileType = file.type;\r\n    if (!isSupportedImageFile(file)) {\r\n        throw new Error(t(\"errors.unsupportedFileType\"));\r\n    }\r\n    return new File([await reduce.toBlob(file, { max: maxWidthOrHeight })], file.name, { type: fileType });\r\n};\r\nexport const SVGStringToFile = (SVGString, filename = \"\") => {\r\n    return new File([new TextEncoder().encode(SVGString)], filename, {\r\n        type: MIME_TYPES.svg,\r\n    });\r\n};\r\n","import { fileOpen, fileSave } from \"./filesystem\";\r\nimport { cleanAppStateForExport, clearAppStateForDatabase } from \"../appState\";\r\nimport { EXPORT_DATA_TYPES, EXPORT_SOURCE, MIME_TYPES } from \"../constants\";\r\nimport { clearElementsForDatabase, clearElementsForExport } from \"../element\";\r\nimport { isImageFileHandle, loadFromBlob } from \"./blob\";\r\n/**\r\n * Strips out files which are only referenced by deleted elements\r\n */\r\nconst filterOutDeletedFiles = (elements, files) => {\r\n    const nextFiles = {};\r\n    for (const element of elements) {\r\n        if (!element.isDeleted &&\r\n            \"fileId\" in element &&\r\n            element.fileId &&\r\n            files[element.fileId]) {\r\n            nextFiles[element.fileId] = files[element.fileId];\r\n        }\r\n    }\r\n    return nextFiles;\r\n};\r\nexport const serializeAsJSON = (elements, appState, files, type) => {\r\n    const data = {\r\n        type: EXPORT_DATA_TYPES.excalidraw,\r\n        version: 2,\r\n        source: EXPORT_SOURCE,\r\n        elements: type === \"local\"\r\n            ? clearElementsForExport(elements)\r\n            : clearElementsForDatabase(elements),\r\n        appState: type === \"local\"\r\n            ? cleanAppStateForExport(appState)\r\n            : clearAppStateForDatabase(appState),\r\n        files: type === \"local\"\r\n            ? filterOutDeletedFiles(elements, files)\r\n            : // will be stripped from JSON\r\n                undefined,\r\n    };\r\n    return JSON.stringify(data, null, 2);\r\n};\r\nexport const saveAsJSON = async (elements, appState, files) => {\r\n    const serialized = serializeAsJSON(elements, appState, files, \"local\");\r\n    const blob = new Blob([serialized], {\r\n        type: MIME_TYPES.excalidraw,\r\n    });\r\n    const fileHandle = await fileSave(blob, {\r\n        name: appState.name,\r\n        extension: \"excalidraw\",\r\n        description: \"Excalidraw file\",\r\n        fileHandle: isImageFileHandle(appState.fileHandle)\r\n            ? null\r\n            : appState.fileHandle,\r\n    });\r\n    return { fileHandle };\r\n};\r\nexport const loadFromJSON = async (localAppState, localElements) => {\r\n    const blob = await fileOpen({\r\n        description: \"Excalidraw files\",\r\n        // ToDo: Be over-permissive until https://bugs.webkit.org/show_bug.cgi?id=34442\r\n        // gets resolved. Else, iOS users cannot open `.excalidraw` files.\r\n        // extensions: [\"json\", \"excalidraw\", \"png\", \"svg\"],\r\n    });\r\n    return loadFromBlob(blob, localAppState, localElements);\r\n};\r\nexport const isValidExcalidrawData = (data) => {\r\n    return (data?.type === EXPORT_DATA_TYPES.excalidraw &&\r\n        (!data.elements ||\r\n            (Array.isArray(data.elements) &&\r\n                (!data.appState || typeof data.appState === \"object\"))));\r\n};\r\nexport const isValidLibrary = (json) => {\r\n    return (typeof json === \"object\" &&\r\n        json &&\r\n        json.type === EXPORT_DATA_TYPES.excalidrawLibrary &&\r\n        json.version === 1);\r\n};\r\nexport const saveLibraryAsJSON = async (library) => {\r\n    const libraryItems = await library.loadLibrary();\r\n    const data = {\r\n        type: EXPORT_DATA_TYPES.excalidrawLibrary,\r\n        version: 1,\r\n        source: EXPORT_SOURCE,\r\n        library: libraryItems,\r\n    };\r\n    const serialized = JSON.stringify(data, null, 2);\r\n    await fileSave(new Blob([serialized], {\r\n        type: MIME_TYPES.excalidrawlib,\r\n    }), {\r\n        name: \"library\",\r\n        extension: \"excalidrawlib\",\r\n        description: \"Excalidraw library file\",\r\n    });\r\n};\r\nexport const importLibraryFromJSON = async (library) => {\r\n    const blob = await fileOpen({\r\n        description: \"Excalidraw library files\",\r\n        // ToDo: Be over-permissive until https://bugs.webkit.org/show_bug.cgi?id=34442\r\n        // gets resolved. Else, iOS users cannot open `.excalidraw` files.\r\n        /*\r\n        extensions: [\".json\", \".excalidrawlib\"],\r\n        */\r\n    });\r\n    await library.importLibrary(blob);\r\n};\r\n","// -----------------------------------------------------------------------------\r\n// ExcalidrawImageElement & related helpers\r\n// -----------------------------------------------------------------------------\r\nimport { MIME_TYPES, SVG_NS } from \"../constants\";\r\nimport { t } from \"../i18n\";\r\nimport { isInitializedImageElement } from \"./typeChecks\";\r\nexport const loadHTMLImageElement = (dataURL) => {\r\n    return new Promise((resolve, reject) => {\r\n        const image = new Image();\r\n        image.onload = () => {\r\n            resolve(image);\r\n        };\r\n        image.onerror = (error) => {\r\n            reject(error);\r\n        };\r\n        image.src = dataURL;\r\n    });\r\n};\r\n/** NOTE: updates cache even if already populated with given image. Thus,\r\n * you should filter out the images upstream if you want to optimize this. */\r\nexport const updateImageCache = async ({ fileIds, files, imageCache, }) => {\r\n    const updatedFiles = new Map();\r\n    const erroredFiles = new Map();\r\n    await Promise.all(fileIds.reduce((promises, fileId) => {\r\n        const fileData = files[fileId];\r\n        if (fileData && !updatedFiles.has(fileId)) {\r\n            updatedFiles.set(fileId, true);\r\n            return promises.concat((async () => {\r\n                try {\r\n                    if (fileData.mimeType === MIME_TYPES.binary) {\r\n                        throw new Error(\"Only images can be added to ImageCache\");\r\n                    }\r\n                    const imagePromise = loadHTMLImageElement(fileData.dataURL);\r\n                    const data = {\r\n                        image: imagePromise,\r\n                        mimeType: fileData.mimeType,\r\n                    };\r\n                    // store the promise immediately to indicate there's an in-progress\r\n                    // initialization\r\n                    imageCache.set(fileId, data);\r\n                    const image = await imagePromise;\r\n                    imageCache.set(fileId, { ...data, image });\r\n                }\r\n                catch (error) {\r\n                    erroredFiles.set(fileId, true);\r\n                }\r\n            })());\r\n        }\r\n        return promises;\r\n    }, []));\r\n    return {\r\n        imageCache,\r\n        /** includes errored files because they cache was updated nonetheless */\r\n        updatedFiles,\r\n        /** files that failed when creating HTMLImageElement */\r\n        erroredFiles,\r\n    };\r\n};\r\nexport const getInitializedImageElements = (elements) => elements.filter((element) => isInitializedImageElement(element));\r\nexport const isHTMLSVGElement = (node) => {\r\n    // lower-casing due to XML/HTML convention differences\r\n    // https://johnresig.com/blog/nodename-case-sensitivity\r\n    return node?.nodeName.toLowerCase() === \"svg\";\r\n};\r\nexport const normalizeSVG = async (SVGString) => {\r\n    const doc = new DOMParser().parseFromString(SVGString, MIME_TYPES.svg);\r\n    const svg = doc.querySelector(\"svg\");\r\n    const errorNode = doc.querySelector(\"parsererror\");\r\n    if (errorNode || !isHTMLSVGElement(svg)) {\r\n        throw new Error(t(\"errors.invalidSVGString\"));\r\n    }\r\n    else {\r\n        if (!svg.hasAttribute(\"xmlns\")) {\r\n            svg.setAttribute(\"xmlns\", SVG_NS);\r\n        }\r\n        return svg.outerHTML;\r\n    }\r\n};\r\n","import rough from \"roughjs/bin/rough\";\r\nimport { getCommonBounds } from \"../element/bounds\";\r\nimport { renderScene, renderSceneToSvg } from \"../renderer/renderScene\";\r\nimport { distance } from \"../utils\";\r\nimport { DEFAULT_EXPORT_PADDING, SVG_NS, THEME_FILTER } from \"../constants\";\r\nimport { getDefaultAppState } from \"../appState\";\r\nimport { serializeAsJSON } from \"../data/json\";\r\nimport { getInitializedImageElements, updateImageCache, } from \"../element/image\";\r\nexport const SVG_EXPORT_TAG = `<!-- svg-source:excalidraw -->`;\r\nexport const exportToCanvas = async (elements, appState, files, { exportBackground, exportPadding = DEFAULT_EXPORT_PADDING, viewBackgroundColor, }, createCanvas = (width, height) => {\r\n    const canvas = document.createElement(\"canvas\");\r\n    canvas.width = width * appState.exportScale;\r\n    canvas.height = height * appState.exportScale;\r\n    return { canvas, scale: appState.exportScale };\r\n}) => {\r\n    const [minX, minY, width, height] = getCanvasSize(elements, exportPadding);\r\n    const { canvas, scale = 1 } = createCanvas(width, height);\r\n    const defaultAppState = getDefaultAppState();\r\n    const { imageCache } = await updateImageCache({\r\n        imageCache: new Map(),\r\n        fileIds: getInitializedImageElements(elements).map((element) => element.fileId),\r\n        files,\r\n    });\r\n    renderScene(elements, appState, null, scale, rough.canvas(canvas), canvas, {\r\n        viewBackgroundColor: exportBackground ? viewBackgroundColor : null,\r\n        scrollX: -minX + exportPadding,\r\n        scrollY: -minY + exportPadding,\r\n        zoom: defaultAppState.zoom,\r\n        remotePointerViewportCoords: {},\r\n        remoteSelectedElementIds: {},\r\n        shouldCacheIgnoreZoom: false,\r\n        remotePointerUsernames: {},\r\n        remotePointerUserStates: {},\r\n        theme: appState.exportWithDarkMode ? \"dark\" : \"light\",\r\n        imageCache,\r\n    }, {\r\n        renderScrollbars: false,\r\n        renderSelection: false,\r\n        renderOptimizations: true,\r\n        renderGrid: false,\r\n        isExport: true,\r\n    });\r\n    return canvas;\r\n};\r\nexport const exportToSvg = async (elements, appState, files) => {\r\n    const { exportPadding = DEFAULT_EXPORT_PADDING, viewBackgroundColor, exportScale = 1, exportEmbedScene, } = appState;\r\n    let metadata = \"\";\r\n    if (exportEmbedScene) {\r\n        try {\r\n            metadata = await (await import(/* webpackChunkName: \"image\" */ \"../../../src/ChalkBoard/data/image\")).encodeSvgMetadata({\r\n                text: serializeAsJSON(elements, appState, files || {}, \"local\"),\r\n            });\r\n        }\r\n        catch (error) {\r\n            console.error(error);\r\n        }\r\n    }\r\n    const [minX, minY, width, height] = getCanvasSize(elements, exportPadding);\r\n    // initialze SVG root\r\n    const svgRoot = document.createElementNS(SVG_NS, \"svg\");\r\n    svgRoot.setAttribute(\"version\", \"1.1\");\r\n    svgRoot.setAttribute(\"xmlns\", SVG_NS);\r\n    svgRoot.setAttribute(\"viewBox\", `0 0 ${width} ${height}`);\r\n    svgRoot.setAttribute(\"width\", `${width * exportScale}`);\r\n    svgRoot.setAttribute(\"height\", `${height * exportScale}`);\r\n    if (appState.exportWithDarkMode) {\r\n        svgRoot.setAttribute(\"filter\", THEME_FILTER);\r\n    }\r\n    svgRoot.innerHTML = `\r\n  ${SVG_EXPORT_TAG}\r\n  ${metadata}\r\n  <defs>\r\n    <style>\r\n      @font-face {\r\n        font-family: \"Virgil\";\r\n        src: url(\"https://excalidraw.com/Virgil.woff2\");\r\n      }\r\n      @font-face {\r\n        font-family: \"Cascadia\";\r\n        src: url(\"https://excalidraw.com/Cascadia.woff2\");\r\n      }\r\n    </style>\r\n  </defs>\r\n  `;\r\n    // render background rect\r\n    if (appState.exportBackground && viewBackgroundColor) {\r\n        const rect = svgRoot.ownerDocument.createElementNS(SVG_NS, \"rect\");\r\n        rect.setAttribute(\"x\", \"0\");\r\n        rect.setAttribute(\"y\", \"0\");\r\n        rect.setAttribute(\"width\", `${width}`);\r\n        rect.setAttribute(\"height\", `${height}`);\r\n        rect.setAttribute(\"fill\", viewBackgroundColor);\r\n        svgRoot.appendChild(rect);\r\n    }\r\n    const rsvg = rough.svg(svgRoot);\r\n    renderSceneToSvg(elements, rsvg, svgRoot, files || {}, {\r\n        offsetX: -minX + exportPadding,\r\n        offsetY: -minY + exportPadding,\r\n    });\r\n    return svgRoot;\r\n};\r\n// calculate smallest area to fit the contents in\r\nconst getCanvasSize = (elements, exportPadding) => {\r\n    const [minX, minY, maxX, maxY] = getCommonBounds(elements);\r\n    const width = distance(minX, maxX) + exportPadding * 2;\r\n    const height = distance(minY, maxY) + exportPadding + exportPadding;\r\n    return [minX, minY, width, height];\r\n};\r\nexport const getExportSize = (elements, exportPadding, scale) => {\r\n    const [, , width, height] = getCanvasSize(elements, exportPadding).map((dimension) => Math.trunc(dimension * scale));\r\n    return [width, height];\r\n};\r\n","import colors from \"./colors\";\r\nimport { DEFAULT_FONT_FAMILY, DEFAULT_FONT_SIZE, ENV } from \"./constants\";\r\nimport { newElement, newLinearElement, newTextElement } from \"./element\";\r\nimport { randomId } from \"./random\";\r\nconst BAR_WIDTH = 32;\r\nconst BAR_GAP = 12;\r\nconst BAR_HEIGHT = 256;\r\nconst GRID_OPACITY = 50;\r\nexport const NOT_SPREADSHEET = \"NOT_SPREADSHEET\";\r\nexport const VALID_SPREADSHEET = \"VALID_SPREADSHEET\";\r\nconst tryParseNumber = (s) => {\r\n    const match = /^[$]?([0-9,]+(\\.[0-9]+)?)$/.exec(s);\r\n    if (!match) {\r\n        return null;\r\n    }\r\n    return parseFloat(match[1].replace(/,/g, \"\"));\r\n};\r\nconst isNumericColumn = (lines, columnIndex) => lines.slice(1).every((line) => tryParseNumber(line[columnIndex]) !== null);\r\nconst tryParseCells = (cells) => {\r\n    const numCols = cells[0].length;\r\n    if (numCols > 2) {\r\n        return { type: NOT_SPREADSHEET, reason: \"More than 2 columns\" };\r\n    }\r\n    if (numCols === 1) {\r\n        if (!isNumericColumn(cells, 0)) {\r\n            return { type: NOT_SPREADSHEET, reason: \"Value is not numeric\" };\r\n        }\r\n        const hasHeader = tryParseNumber(cells[0][0]) === null;\r\n        const values = (hasHeader ? cells.slice(1) : cells).map((line) => tryParseNumber(line[0]));\r\n        if (values.length < 2) {\r\n            return { type: NOT_SPREADSHEET, reason: \"Less than two rows\" };\r\n        }\r\n        return {\r\n            type: VALID_SPREADSHEET,\r\n            spreadsheet: {\r\n                title: hasHeader ? cells[0][0] : null,\r\n                labels: null,\r\n                values: values,\r\n            },\r\n        };\r\n    }\r\n    const valueColumnIndex = isNumericColumn(cells, 0) ? 0 : 1;\r\n    if (!isNumericColumn(cells, valueColumnIndex)) {\r\n        return { type: NOT_SPREADSHEET, reason: \"Value is not numeric\" };\r\n    }\r\n    const labelColumnIndex = (valueColumnIndex + 1) % 2;\r\n    const hasHeader = tryParseNumber(cells[0][valueColumnIndex]) === null;\r\n    const rows = hasHeader ? cells.slice(1) : cells;\r\n    if (rows.length < 2) {\r\n        return { type: NOT_SPREADSHEET, reason: \"Less than 2 rows\" };\r\n    }\r\n    return {\r\n        type: VALID_SPREADSHEET,\r\n        spreadsheet: {\r\n            title: hasHeader ? cells[0][valueColumnIndex] : null,\r\n            labels: rows.map((row) => row[labelColumnIndex]),\r\n            values: rows.map((row) => tryParseNumber(row[valueColumnIndex])),\r\n        },\r\n    };\r\n};\r\nconst transposeCells = (cells) => {\r\n    const nextCells = [];\r\n    for (let col = 0; col < cells[0].length; col++) {\r\n        const nextCellRow = [];\r\n        for (let row = 0; row < cells.length; row++) {\r\n            nextCellRow.push(cells[row][col]);\r\n        }\r\n        nextCells.push(nextCellRow);\r\n    }\r\n    return nextCells;\r\n};\r\nexport const tryParseSpreadsheet = (text) => {\r\n    // Copy/paste from excel, spreadhseets, tsv, csv.\r\n    // For now we only accept 2 columns with an optional header\r\n    // Check for tab separated values\r\n    let lines = text\r\n        .trim()\r\n        .split(\"\\n\")\r\n        .map((line) => line.trim().split(\"\\t\"));\r\n    // Check for comma separated files\r\n    if (lines.length && lines[0].length !== 2) {\r\n        lines = text\r\n            .trim()\r\n            .split(\"\\n\")\r\n            .map((line) => line.trim().split(\",\"));\r\n    }\r\n    if (lines.length === 0) {\r\n        return { type: NOT_SPREADSHEET, reason: \"No values\" };\r\n    }\r\n    const numColsFirstLine = lines[0].length;\r\n    const isSpreadsheet = lines.every((line) => line.length === numColsFirstLine);\r\n    if (!isSpreadsheet) {\r\n        return {\r\n            type: NOT_SPREADSHEET,\r\n            reason: \"All rows don't have same number of columns\",\r\n        };\r\n    }\r\n    const result = tryParseCells(lines);\r\n    if (result.type !== VALID_SPREADSHEET) {\r\n        const transposedResults = tryParseCells(transposeCells(lines));\r\n        if (transposedResults.type === VALID_SPREADSHEET) {\r\n            return transposedResults;\r\n        }\r\n    }\r\n    return result;\r\n};\r\nconst bgColors = colors.elementBackground.slice(2, colors.elementBackground.length);\r\n// Put all the common properties here so when the whole chart is selected\r\n// the properties dialog shows the correct selected values\r\nconst commonProps = {\r\n    fillStyle: \"hachure\",\r\n    fontFamily: DEFAULT_FONT_FAMILY,\r\n    fontSize: DEFAULT_FONT_SIZE,\r\n    opacity: 100,\r\n    roughness: 1,\r\n    strokeColor: colors.elementStroke[0],\r\n    strokeSharpness: \"sharp\",\r\n    strokeStyle: \"solid\",\r\n    strokeWidth: 1,\r\n    verticalAlign: \"middle\",\r\n};\r\nconst getChartDimentions = (spreadsheet) => {\r\n    const chartWidth = (BAR_WIDTH + BAR_GAP) * spreadsheet.values.length + BAR_GAP;\r\n    const chartHeight = BAR_HEIGHT + BAR_GAP * 2;\r\n    return { chartWidth, chartHeight };\r\n};\r\nconst chartXLabels = (spreadsheet, x, y, groupId, backgroundColor) => {\r\n    return (spreadsheet.labels?.map((label, index) => {\r\n        return newTextElement({\r\n            groupIds: [groupId],\r\n            backgroundColor,\r\n            ...commonProps,\r\n            text: label.length > 8 ? `${label.slice(0, 5)}...` : label,\r\n            x: x + index * (BAR_WIDTH + BAR_GAP) + BAR_GAP * 2,\r\n            y: y + BAR_GAP / 2,\r\n            width: BAR_WIDTH,\r\n            angle: 5.87,\r\n            fontSize: 16,\r\n            textAlign: \"center\",\r\n            verticalAlign: \"top\",\r\n        });\r\n    }) || []);\r\n};\r\nconst chartYLabels = (spreadsheet, x, y, groupId, backgroundColor) => {\r\n    const minYLabel = newTextElement({\r\n        groupIds: [groupId],\r\n        backgroundColor,\r\n        ...commonProps,\r\n        x: x - BAR_GAP,\r\n        y: y - BAR_GAP,\r\n        text: \"0\",\r\n        textAlign: \"right\",\r\n    });\r\n    const maxYLabel = newTextElement({\r\n        groupIds: [groupId],\r\n        backgroundColor,\r\n        ...commonProps,\r\n        x: x - BAR_GAP,\r\n        y: y - BAR_HEIGHT - minYLabel.height / 2,\r\n        text: Math.max(...spreadsheet.values).toLocaleString(),\r\n        textAlign: \"right\",\r\n    });\r\n    return [minYLabel, maxYLabel];\r\n};\r\nconst chartLines = (spreadsheet, x, y, groupId, backgroundColor) => {\r\n    const { chartWidth, chartHeight } = getChartDimentions(spreadsheet);\r\n    const xLine = newLinearElement({\r\n        backgroundColor,\r\n        groupIds: [groupId],\r\n        ...commonProps,\r\n        type: \"line\",\r\n        x,\r\n        y,\r\n        startArrowhead: null,\r\n        endArrowhead: null,\r\n        width: chartWidth,\r\n        points: [\r\n            [0, 0],\r\n            [chartWidth, 0],\r\n        ],\r\n    });\r\n    const yLine = newLinearElement({\r\n        backgroundColor,\r\n        groupIds: [groupId],\r\n        ...commonProps,\r\n        type: \"line\",\r\n        x,\r\n        y,\r\n        startArrowhead: null,\r\n        endArrowhead: null,\r\n        height: chartHeight,\r\n        points: [\r\n            [0, 0],\r\n            [0, -chartHeight],\r\n        ],\r\n    });\r\n    const maxLine = newLinearElement({\r\n        backgroundColor,\r\n        groupIds: [groupId],\r\n        ...commonProps,\r\n        type: \"line\",\r\n        x,\r\n        y: y - BAR_HEIGHT - BAR_GAP,\r\n        startArrowhead: null,\r\n        endArrowhead: null,\r\n        strokeStyle: \"dotted\",\r\n        width: chartWidth,\r\n        opacity: GRID_OPACITY,\r\n        points: [\r\n            [0, 0],\r\n            [chartWidth, 0],\r\n        ],\r\n    });\r\n    return [xLine, yLine, maxLine];\r\n};\r\n// For the maths behind it https://excalidraw.com/#json=6320864370884608,O_5xfD-Agh32tytHpRJx1g\r\nconst chartBaseElements = (spreadsheet, x, y, groupId, backgroundColor, debug) => {\r\n    const { chartWidth, chartHeight } = getChartDimentions(spreadsheet);\r\n    const title = spreadsheet.title\r\n        ? newTextElement({\r\n            backgroundColor,\r\n            groupIds: [groupId],\r\n            ...commonProps,\r\n            text: spreadsheet.title,\r\n            x: x + chartWidth / 2,\r\n            y: y - BAR_HEIGHT - BAR_GAP * 2 - DEFAULT_FONT_SIZE,\r\n            strokeSharpness: \"sharp\",\r\n            strokeStyle: \"solid\",\r\n            textAlign: \"center\",\r\n        })\r\n        : null;\r\n    const debugRect = debug\r\n        ? newElement({\r\n            backgroundColor,\r\n            groupIds: [groupId],\r\n            ...commonProps,\r\n            type: \"rectangle\",\r\n            x,\r\n            y: y - chartHeight,\r\n            width: chartWidth,\r\n            height: chartHeight,\r\n            strokeColor: colors.elementStroke[0],\r\n            fillStyle: \"solid\",\r\n            opacity: 6,\r\n        })\r\n        : null;\r\n    return [\r\n        ...(debugRect ? [debugRect] : []),\r\n        ...(title ? [title] : []),\r\n        ...chartXLabels(spreadsheet, x, y, groupId, backgroundColor),\r\n        ...chartYLabels(spreadsheet, x, y, groupId, backgroundColor),\r\n        ...chartLines(spreadsheet, x, y, groupId, backgroundColor),\r\n    ];\r\n};\r\nconst chartTypeBar = (spreadsheet, x, y) => {\r\n    const max = Math.max(...spreadsheet.values);\r\n    const groupId = randomId();\r\n    const backgroundColor = bgColors[Math.floor(Math.random() * bgColors.length)];\r\n    const bars = spreadsheet.values.map((value, index) => {\r\n        const barHeight = (value / max) * BAR_HEIGHT;\r\n        return newElement({\r\n            backgroundColor,\r\n            groupIds: [groupId],\r\n            ...commonProps,\r\n            type: \"rectangle\",\r\n            x: x + index * (BAR_WIDTH + BAR_GAP) + BAR_GAP,\r\n            y: y - barHeight - BAR_GAP,\r\n            width: BAR_WIDTH,\r\n            height: barHeight,\r\n        });\r\n    });\r\n    return [\r\n        ...bars,\r\n        ...chartBaseElements(spreadsheet, x, y, groupId, backgroundColor, process.env.NODE_ENV === ENV.DEVELOPMENT),\r\n    ];\r\n};\r\nconst chartTypeLine = (spreadsheet, x, y) => {\r\n    const max = Math.max(...spreadsheet.values);\r\n    const groupId = randomId();\r\n    const backgroundColor = bgColors[Math.floor(Math.random() * bgColors.length)];\r\n    let index = 0;\r\n    const points = [];\r\n    for (const value of spreadsheet.values) {\r\n        const cx = index * (BAR_WIDTH + BAR_GAP);\r\n        const cy = -(value / max) * BAR_HEIGHT;\r\n        points.push([cx, cy]);\r\n        index++;\r\n    }\r\n    const maxX = Math.max(...points.map((element) => element[0]));\r\n    const maxY = Math.max(...points.map((element) => element[1]));\r\n    const minX = Math.min(...points.map((element) => element[0]));\r\n    const minY = Math.min(...points.map((element) => element[1]));\r\n    const line = newLinearElement({\r\n        backgroundColor,\r\n        groupIds: [groupId],\r\n        ...commonProps,\r\n        type: \"line\",\r\n        x: x + BAR_GAP + BAR_WIDTH / 2,\r\n        y: y - BAR_GAP,\r\n        startArrowhead: null,\r\n        endArrowhead: null,\r\n        height: maxY - minY,\r\n        width: maxX - minX,\r\n        strokeWidth: 2,\r\n        points: points,\r\n    });\r\n    const dots = spreadsheet.values.map((value, index) => {\r\n        const cx = index * (BAR_WIDTH + BAR_GAP) + BAR_GAP / 2;\r\n        const cy = -(value / max) * BAR_HEIGHT + BAR_GAP / 2;\r\n        return newElement({\r\n            backgroundColor,\r\n            groupIds: [groupId],\r\n            ...commonProps,\r\n            fillStyle: \"solid\",\r\n            strokeWidth: 2,\r\n            type: \"ellipse\",\r\n            x: x + cx + BAR_WIDTH / 2,\r\n            y: y + cy - BAR_GAP * 2,\r\n            width: BAR_GAP,\r\n            height: BAR_GAP,\r\n        });\r\n    });\r\n    const lines = spreadsheet.values.map((value, index) => {\r\n        const cx = index * (BAR_WIDTH + BAR_GAP) + BAR_GAP / 2;\r\n        const cy = (value / max) * BAR_HEIGHT + BAR_GAP / 2 + BAR_GAP;\r\n        return newLinearElement({\r\n            backgroundColor,\r\n            groupIds: [groupId],\r\n            ...commonProps,\r\n            type: \"line\",\r\n            x: x + cx + BAR_WIDTH / 2 + BAR_GAP / 2,\r\n            y: y - cy,\r\n            startArrowhead: null,\r\n            endArrowhead: null,\r\n            height: cy,\r\n            strokeStyle: \"dotted\",\r\n            opacity: GRID_OPACITY,\r\n            points: [\r\n                [0, 0],\r\n                [0, cy],\r\n            ],\r\n        });\r\n    });\r\n    return [\r\n        ...chartBaseElements(spreadsheet, x, y, groupId, backgroundColor, process.env.NODE_ENV === ENV.DEVELOPMENT),\r\n        line,\r\n        ...lines,\r\n        ...dots,\r\n    ];\r\n};\r\nexport const renderSpreadsheet = (chartType, spreadsheet, x, y) => {\r\n    if (chartType === \"line\") {\r\n        return chartTypeLine(spreadsheet, x, y);\r\n    }\r\n    return chartTypeBar(spreadsheet, x, y);\r\n};\r\n","import { getSelectedElements } from \"./scene\";\r\nimport { SVG_EXPORT_TAG } from \"./scene/export\";\r\nimport { tryParseSpreadsheet, VALID_SPREADSHEET } from \"./charts\";\r\nimport { EXPORT_DATA_TYPES, MIME_TYPES } from \"./constants\";\r\nimport { isInitializedImageElement } from \"./element/typeChecks\";\r\nlet CLIPBOARD = \"\";\r\nlet PREFER_APP_CLIPBOARD = false;\r\nexport const probablySupportsClipboardReadText = \"clipboard\" in navigator && \"readText\" in navigator.clipboard;\r\nexport const probablySupportsClipboardWriteText = \"clipboard\" in navigator && \"writeText\" in navigator.clipboard;\r\nexport const probablySupportsClipboardBlob = \"clipboard\" in navigator &&\r\n    \"write\" in navigator.clipboard &&\r\n    \"ClipboardItem\" in window &&\r\n    \"toBlob\" in HTMLCanvasElement.prototype;\r\nconst clipboardContainsElements = (contents) => {\r\n    if ([\r\n        EXPORT_DATA_TYPES.excalidraw,\r\n        EXPORT_DATA_TYPES.excalidrawClipboard,\r\n    ].includes(contents?.type) &&\r\n        Array.isArray(contents.elements)) {\r\n        return true;\r\n    }\r\n    return false;\r\n};\r\nexport const copyToClipboard = async (elements, appState, files) => {\r\n    const selectedElements = getSelectedElements(elements, appState);\r\n    const contents = {\r\n        type: EXPORT_DATA_TYPES.excalidrawClipboard,\r\n        elements: selectedElements,\r\n        files: selectedElements.reduce((acc, element) => {\r\n            if (isInitializedImageElement(element) && files[element.fileId]) {\r\n                acc[element.fileId] = files[element.fileId];\r\n            }\r\n            return acc;\r\n        }, {}),\r\n    };\r\n    const json = JSON.stringify(contents);\r\n    CLIPBOARD = json;\r\n    try {\r\n        PREFER_APP_CLIPBOARD = false;\r\n        await copyTextToSystemClipboard(json);\r\n    }\r\n    catch (error) {\r\n        PREFER_APP_CLIPBOARD = true;\r\n        console.error(error);\r\n    }\r\n};\r\nconst getAppClipboard = () => {\r\n    if (!CLIPBOARD) {\r\n        return {};\r\n    }\r\n    try {\r\n        return JSON.parse(CLIPBOARD);\r\n    }\r\n    catch (error) {\r\n        console.error(error);\r\n        return {};\r\n    }\r\n};\r\nconst parsePotentialSpreadsheet = (text) => {\r\n    const result = tryParseSpreadsheet(text);\r\n    if (result.type === VALID_SPREADSHEET) {\r\n        return { spreadsheet: result.spreadsheet };\r\n    }\r\n    return null;\r\n};\r\n/**\r\n * Retrieves content from system clipboard (either from ClipboardEvent or\r\n *  via async clipboard API if supported)\r\n */\r\nconst getSystemClipboard = async (event) => {\r\n    try {\r\n        const text = event\r\n            ? event.clipboardData?.getData(\"text/plain\").trim()\r\n            : probablySupportsClipboardReadText &&\r\n                (await navigator.clipboard.readText());\r\n        return text || \"\";\r\n    }\r\n    catch {\r\n        return \"\";\r\n    }\r\n};\r\n/**\r\n * Attemps to parse clipboard. Prefers system clipboard.\r\n */\r\nexport const parseClipboard = async (event) => {\r\n    const systemClipboard = await getSystemClipboard(event);\r\n    // if system clipboard empty, couldn't be resolved, or contains previously\r\n    // copied excalidraw scene as SVG, fall back to previously copied excalidraw\r\n    // elements\r\n    if (!systemClipboard || systemClipboard.includes(SVG_EXPORT_TAG)) {\r\n        return getAppClipboard();\r\n    }\r\n    // if system clipboard contains spreadsheet, use it even though it's\r\n    // technically possible it's staler than in-app clipboard\r\n    const spreadsheetResult = parsePotentialSpreadsheet(systemClipboard);\r\n    if (spreadsheetResult) {\r\n        return spreadsheetResult;\r\n    }\r\n    const appClipboardData = getAppClipboard();\r\n    try {\r\n        const systemClipboardData = JSON.parse(systemClipboard);\r\n        if (clipboardContainsElements(systemClipboardData)) {\r\n            return {\r\n                elements: systemClipboardData.elements,\r\n                files: systemClipboardData.files,\r\n            };\r\n        }\r\n        return appClipboardData;\r\n    }\r\n    catch {\r\n        // system clipboard doesn't contain excalidraw elements  return plaintext\r\n        // unless we set a flag to prefer in-app clipboard because browser didn't\r\n        // support storing to system clipboard on copy\r\n        return PREFER_APP_CLIPBOARD && appClipboardData.elements\r\n            ? appClipboardData\r\n            : { text: systemClipboard };\r\n    }\r\n};\r\nexport const copyBlobToClipboardAsPng = async (blob) => {\r\n    await navigator.clipboard.write([\r\n        new window.ClipboardItem({ [MIME_TYPES.png]: blob }),\r\n    ]);\r\n};\r\nexport const copyTextToSystemClipboard = async (text) => {\r\n    let copied = false;\r\n    if (probablySupportsClipboardWriteText) {\r\n        try {\r\n            // NOTE: doesn't work on FF on non-HTTPS domains, or when document\r\n            // not focused\r\n            await navigator.clipboard.writeText(text || \"\");\r\n            copied = true;\r\n        }\r\n        catch (error) {\r\n            console.error(error);\r\n        }\r\n    }\r\n    // Note that execCommand doesn't allow copying empty strings, so if we're\r\n    // clearing clipboard using this API, we must copy at least an empty char\r\n    if (!copied && !copyTextViaExecCommand(text || \" \")) {\r\n        throw new Error(\"couldn't copy\");\r\n    }\r\n};\r\n// adapted from https://github.com/zenorocha/clipboard.js/blob/ce79f170aa655c408b6aab33c9472e8e4fa52e19/src/clipboard-action.js#L48\r\nconst copyTextViaExecCommand = (text) => {\r\n    const isRTL = document.documentElement.getAttribute(\"dir\") === \"rtl\";\r\n    const textarea = document.createElement(\"textarea\");\r\n    textarea.style.border = \"0\";\r\n    textarea.style.padding = \"0\";\r\n    textarea.style.margin = \"0\";\r\n    textarea.style.position = \"absolute\";\r\n    textarea.style[isRTL ? \"right\" : \"left\"] = \"-9999px\";\r\n    const yPosition = window.pageYOffset || document.documentElement.scrollTop;\r\n    textarea.style.top = `${yPosition}px`;\r\n    // Prevent zooming on iOS\r\n    textarea.style.fontSize = \"12pt\";\r\n    textarea.setAttribute(\"readonly\", \"\");\r\n    textarea.value = text;\r\n    document.body.appendChild(textarea);\r\n    let success = false;\r\n    try {\r\n        textarea.select();\r\n        textarea.setSelectionRange(0, textarea.value.length);\r\n        success = document.execCommand(\"copy\");\r\n    }\r\n    catch (error) {\r\n        console.error(error);\r\n    }\r\n    textarea.remove();\r\n    return success;\r\n};\r\n","import { copyBlobToClipboardAsPng, copyTextToSystemClipboard, } from \"../clipboard\";\r\nimport { DEFAULT_EXPORT_PADDING, MIME_TYPES } from \"../constants\";\r\nimport { t } from \"../i18n\";\r\nimport { exportToCanvas, exportToSvg } from \"../scene/export\";\r\nimport { canvasToBlob } from \"./blob\";\r\nimport { fileSave } from \"./filesystem\";\r\nimport { serializeAsJSON } from \"./json\";\r\nexport { loadFromBlob } from \"./blob\";\r\nexport { loadFromJSON, saveAsJSON } from \"./json\";\r\nexport const exportCanvas = async (type, elements, appState, files, { exportBackground, exportPadding = DEFAULT_EXPORT_PADDING, viewBackgroundColor, name, fileHandle = null, }) => {\r\n    if (elements.length === 0) {\r\n        throw new Error(t(\"alerts.cannotExportEmptyCanvas\"));\r\n    }\r\n    if (type === \"svg\" || type === \"clipboard-svg\") {\r\n        const tempSvg = await exportToSvg(elements, {\r\n            exportBackground,\r\n            exportWithDarkMode: appState.exportWithDarkMode,\r\n            viewBackgroundColor,\r\n            exportPadding,\r\n            exportScale: appState.exportScale,\r\n            exportEmbedScene: appState.exportEmbedScene && type === \"svg\",\r\n        }, files);\r\n        if (type === \"svg\") {\r\n            return await fileSave(new Blob([tempSvg.outerHTML], { type: MIME_TYPES.svg }), {\r\n                name,\r\n                extension: \"svg\",\r\n                fileHandle,\r\n            });\r\n        }\r\n        else if (type === \"clipboard-svg\") {\r\n            await copyTextToSystemClipboard(tempSvg.outerHTML);\r\n            return;\r\n        }\r\n    }\r\n    const tempCanvas = await exportToCanvas(elements, appState, files, {\r\n        exportBackground,\r\n        viewBackgroundColor,\r\n        exportPadding,\r\n    });\r\n    tempCanvas.style.display = \"none\";\r\n    document.body.appendChild(tempCanvas);\r\n    let blob = await canvasToBlob(tempCanvas);\r\n    tempCanvas.remove();\r\n    if (type === \"png\") {\r\n        if (appState.exportEmbedScene) {\r\n            blob = await (await import(/* webpackChunkName: \"image\" */ \"./image\")).encodePngMetadata({\r\n                blob,\r\n                metadata: serializeAsJSON(elements, appState, files, \"local\"),\r\n            });\r\n        }\r\n        return await fileSave(blob, {\r\n            name,\r\n            extension: \"png\",\r\n            fileHandle,\r\n        });\r\n    }\r\n    else if (type === \"clipboard\") {\r\n        try {\r\n            await copyBlobToClipboardAsPng(blob);\r\n        }\r\n        catch (error) {\r\n            if (error.name === \"CANVAS_POSSIBLY_TOO_BIG\") {\r\n                throw error;\r\n            }\r\n            throw new Error(t(\"alerts.couldNotCopyToClipboard\"));\r\n        }\r\n    }\r\n};\r\n","import { exportCanvas } from \".\";\r\nimport { getNonDeletedElements } from \"../element\";\r\nimport { getFileHandleType, isImageFileHandleType } from \"./blob\";\r\nexport const resaveAsImageWithScene = async (elements, appState, files) => {\r\n    const { exportBackground, viewBackgroundColor, name, fileHandle } = appState;\r\n    const fileHandleType = getFileHandleType(fileHandle);\r\n    if (!fileHandle || !isImageFileHandleType(fileHandleType)) {\r\n        throw new Error(\"fileHandle should exist and should be of type svg or png when resaving\");\r\n    }\r\n    appState = {\r\n        ...appState,\r\n        exportEmbedScene: true,\r\n    };\r\n    await exportCanvas(fileHandleType, getNonDeletedElements(elements), appState, files, {\r\n        exportBackground,\r\n        viewBackgroundColor,\r\n        name,\r\n        fileHandle,\r\n    });\r\n    return { fileHandle };\r\n};\r\n","import React from \"react\";\r\nimport clsx from \"clsx\";\r\nimport { checkIcon } from \"./icons\";\r\nimport \"./CheckboxItem.scss\";\r\nexport const CheckboxItem = ({ children, checked, onChange }) => {\r\n    return (<div className={clsx(\"Checkbox\", { \"is-checked\": checked })} onClick={(event) => {\r\n            onChange(!checked);\r\n            event.currentTarget.querySelector(\".Checkbox-box\").focus();\r\n        }}>\r\n      <button className=\"Checkbox-box\" role=\"checkbox\" aria-checked={checked}>\r\n        {checkIcon}\r\n      </button>\r\n      <div className=\"Checkbox-label\">{children}</div>\r\n    </div>);\r\n};\r\n","import \"./Stack.scss\";\r\nimport React from \"react\";\r\nimport clsx from \"clsx\";\r\nconst RowStack = ({ children, gap, align, justifyContent, className, style, }) => {\r\n    return (<div className={clsx(\"Stack Stack_horizontal\", className)} style={{\r\n            \"--gap\": gap,\r\n            alignItems: align,\r\n            justifyContent,\r\n            ...style,\r\n        }}>\r\n      {children}\r\n    </div>);\r\n};\r\nconst ColStack = ({ children, gap, align, justifyContent, className, }) => {\r\n    return (<div className={clsx(\"Stack Stack_vertical\", className)} style={{\r\n            \"--gap\": gap,\r\n            justifyItems: align,\r\n            justifyContent,\r\n        }}>\r\n      {children}\r\n    </div>);\r\n};\r\nexport default {\r\n    Row: RowStack,\r\n    Col: ColStack,\r\n};\r\n","import Stack from \"../components/Stack\";\r\nimport { ToolButton } from \"../components/ToolButton\";\r\nimport { save, file } from \"../components/icons\";\r\nimport { t } from \"../i18n\";\r\nimport \"./ActiveFile.scss\";\r\nexport const ActiveFile = ({ fileName, onSave }) => (<Stack.Row className=\"ActiveFile\" gap={1} align=\"center\">\r\n    <span className=\"ActiveFile__fileName\">\r\n      {file}\r\n      <span>{fileName}</span>\r\n    </span>\r\n    <ToolButton type=\"icon\" icon={save} title={t(\"buttons.save\")} aria-label={t(\"buttons.save\")} onClick={onSave} data-testid=\"save-button\"/>\r\n  </Stack.Row>);\r\n","import { trackEvent } from \"../analytics\";\r\nimport { load, questionCircle, saveAs } from \"../components/icons\";\r\nimport { ProjectName } from \"../components/ProjectName\";\r\nimport { ToolButton } from \"../components/ToolButton\";\r\nimport \"../components/ToolIcon.scss\";\r\nimport { Tooltip } from \"../components/Tooltip\";\r\nimport { DarkModeToggle } from \"../components/DarkModeToggle\";\r\nimport { loadFromJSON, saveAsJSON } from \"../data\";\r\nimport { resaveAsImageWithScene } from \"../data/resave\";\r\nimport { t } from \"../i18n\";\r\nimport { useIsMobile } from \"../components/App\";\r\nimport { KEYS } from \"../keys\";\r\nimport { register } from \"./register\";\r\nimport { CheckboxItem } from \"../components/CheckboxItem\";\r\nimport { getExportSize } from \"../scene/export\";\r\nimport { DEFAULT_EXPORT_PADDING, EXPORT_SCALES, THEME } from \"../constants\";\r\nimport { getSelectedElements, isSomeElementSelected } from \"../scene\";\r\nimport { getNonDeletedElements } from \"../element\";\r\nimport { ActiveFile } from \"../components/ActiveFile\";\r\nimport { isImageFileHandle } from \"../data/blob\";\r\nimport { nativeFileSystemSupported } from \"../data/filesystem\";\r\nexport const actionChangeProjectName = register({\r\n    name: \"changeProjectName\",\r\n    perform: (_elements, appState, value) => {\r\n        trackEvent(\"change\", \"title\");\r\n        return { appState: { ...appState, name: value }, commitToHistory: false };\r\n    },\r\n    PanelComponent: ({ appState, updateData, appProps }) => (<ProjectName label={t(\"labels.fileTitle\")} value={appState.name || \"Unnamed\"} onChange={(name) => updateData(name)} isNameEditable={typeof appProps.name === \"undefined\" && !appState.viewModeEnabled}/>),\r\n});\r\nexport const actionChangeExportScale = register({\r\n    name: \"changeExportScale\",\r\n    perform: (_elements, appState, value) => {\r\n        return {\r\n            appState: { ...appState, exportScale: value },\r\n            commitToHistory: false,\r\n        };\r\n    },\r\n    PanelComponent: ({ elements: allElements, appState, updateData }) => {\r\n        const elements = getNonDeletedElements(allElements);\r\n        const exportSelected = isSomeElementSelected(elements, appState);\r\n        const exportedElements = exportSelected\r\n            ? getSelectedElements(elements, appState)\r\n            : elements;\r\n        return (<>\r\n        {EXPORT_SCALES.map((s) => {\r\n                const [width, height] = getExportSize(exportedElements, DEFAULT_EXPORT_PADDING, s);\r\n                const scaleButtonTitle = `${t(\"buttons.scale\")} ${s}x (${width}x${height})`;\r\n                return (<ToolButton key={s} size=\"small\" type=\"radio\" icon={`${s}x`} name=\"export-canvas-scale\" title={scaleButtonTitle} aria-label={scaleButtonTitle} id=\"export-canvas-scale\" checked={s === appState.exportScale} onChange={() => updateData(s)}/>);\r\n            })}\r\n      </>);\r\n    },\r\n});\r\nexport const actionChangeExportBackground = register({\r\n    name: \"changeExportBackground\",\r\n    perform: (_elements, appState, value) => {\r\n        return {\r\n            appState: { ...appState, exportBackground: value },\r\n            commitToHistory: false,\r\n        };\r\n    },\r\n    PanelComponent: ({ appState, updateData }) => (<CheckboxItem checked={appState.exportBackground} onChange={(checked) => updateData(checked)}>\r\n      {t(\"labels.withBackground\")}\r\n    </CheckboxItem>),\r\n});\r\nexport const actionChangeExportEmbedScene = register({\r\n    name: \"changeExportEmbedScene\",\r\n    perform: (_elements, appState, value) => {\r\n        return {\r\n            appState: { ...appState, exportEmbedScene: value },\r\n            commitToHistory: false,\r\n        };\r\n    },\r\n    PanelComponent: ({ appState, updateData }) => (<CheckboxItem checked={appState.exportEmbedScene} onChange={(checked) => updateData(checked)}>\r\n      {t(\"labels.exportEmbedScene\")}\r\n      <Tooltip label={t(\"labels.exportEmbedScene_details\")} long={true}>\r\n        <div className=\"chalkboard-tooltip-icon\">{questionCircle}</div>\r\n      </Tooltip>\r\n    </CheckboxItem>),\r\n});\r\nexport const actionSaveToActiveFile = register({\r\n    name: \"saveToActiveFile\",\r\n    perform: async (elements, appState, value, app) => {\r\n        const fileHandleExists = !!appState.fileHandle;\r\n        try {\r\n            const { fileHandle } = isImageFileHandle(appState.fileHandle)\r\n                ? await resaveAsImageWithScene(elements, appState, app.files)\r\n                : await saveAsJSON(elements, appState, app.files);\r\n            return {\r\n                commitToHistory: false,\r\n                appState: {\r\n                    ...appState,\r\n                    fileHandle,\r\n                    toastMessage: fileHandleExists\r\n                        ? fileHandle?.name\r\n                            ? t(\"toast.fileSavedToFilename\").replace(\"{filename}\", `\"${fileHandle.name}\"`)\r\n                            : t(\"toast.fileSaved\")\r\n                        : null,\r\n                },\r\n            };\r\n        }\r\n        catch (error) {\r\n            if (error?.name !== \"AbortError\") {\r\n                console.error(error);\r\n            }\r\n            return { commitToHistory: false };\r\n        }\r\n    },\r\n    keyTest: (event) => event.key === KEYS.S && event[KEYS.CTRL_OR_CMD] && !event.shiftKey,\r\n    PanelComponent: ({ updateData, appState }) => (<ActiveFile onSave={() => updateData(null)} fileName={appState.fileHandle?.name}/>),\r\n});\r\nexport const actionSaveFileToDisk = register({\r\n    name: \"saveFileToDisk\",\r\n    perform: async (elements, appState, value, app) => {\r\n        try {\r\n            const { fileHandle } = await saveAsJSON(elements, {\r\n                ...appState,\r\n                fileHandle: null,\r\n            }, app.files);\r\n            return { commitToHistory: false, appState: { ...appState, fileHandle } };\r\n        }\r\n        catch (error) {\r\n            if (error?.name !== \"AbortError\") {\r\n                console.error(error);\r\n            }\r\n            return { commitToHistory: false };\r\n        }\r\n    },\r\n    keyTest: (event) => event.key === KEYS.S && event.shiftKey && event[KEYS.CTRL_OR_CMD],\r\n    PanelComponent: ({ updateData }) => (<ToolButton type=\"button\" icon={saveAs} title={t(\"buttons.saveAs\")} aria-label={t(\"buttons.saveAs\")} showAriaLabel={useIsMobile()} hidden={!nativeFileSystemSupported} onClick={() => updateData(null)} data-testid=\"save-as-button\"/>),\r\n});\r\nexport const actionLoadScene = register({\r\n    name: \"loadScene\",\r\n    perform: async (elements, appState, _, app) => {\r\n        try {\r\n            const { elements: loadedElements, appState: loadedAppState, files, } = await loadFromJSON(appState, elements);\r\n            return {\r\n                elements: loadedElements,\r\n                appState: loadedAppState,\r\n                files,\r\n                commitToHistory: true,\r\n            };\r\n        }\r\n        catch (error) {\r\n            if (error?.name === \"AbortError\") {\r\n                return false;\r\n            }\r\n            return {\r\n                elements,\r\n                appState: { ...appState, errorMessage: error.message },\r\n                files: app.files,\r\n                commitToHistory: false,\r\n            };\r\n        }\r\n    },\r\n    keyTest: (event) => event[KEYS.CTRL_OR_CMD] && event.key === KEYS.O,\r\n    PanelComponent: ({ updateData, appState }) => (<ToolButton type=\"button\" icon={load} title={t(\"buttons.load\")} aria-label={t(\"buttons.load\")} showAriaLabel={useIsMobile()} onClick={updateData} data-testid=\"load-button\"/>),\r\n});\r\nexport const actionExportWithDarkMode = register({\r\n    name: \"exportWithDarkMode\",\r\n    perform: (_elements, appState, value) => {\r\n        return {\r\n            appState: { ...appState, exportWithDarkMode: value },\r\n            commitToHistory: false,\r\n        };\r\n    },\r\n    PanelComponent: ({ appState, updateData }) => (<div style={{\r\n            display: \"flex\",\r\n            justifyContent: \"flex-end\",\r\n            marginTop: \"-45px\",\r\n            marginBottom: \"10px\",\r\n        }}>\r\n      <DarkModeToggle value={appState.exportWithDarkMode ? THEME.DARK : THEME.LIGHT} onChange={(theme) => {\r\n            updateData(theme === THEME.DARK);\r\n        }} title={t(\"labels.toggleExportColorScheme\")}/>\r\n    </div>),\r\n});\r\n","import { isTextElement, isExcalidrawElement, redrawTextBoundingBox, } from \"../element\";\r\nimport { CODES, KEYS } from \"../keys\";\r\nimport { t } from \"../i18n\";\r\nimport { register } from \"./register\";\r\nimport { mutateElement, newElementWith } from \"../element/mutateElement\";\r\nimport { DEFAULT_FONT_SIZE, DEFAULT_FONT_FAMILY, DEFAULT_TEXT_ALIGN, } from \"../constants\";\r\n// `copiedStyles` is exported only for tests.\r\nexport let copiedStyles = \"{}\";\r\nexport const actionCopyStyles = register({\r\n    name: \"copyStyles\",\r\n    perform: (elements, appState) => {\r\n        const element = elements.find((el) => appState.selectedElementIds[el.id]);\r\n        if (element) {\r\n            copiedStyles = JSON.stringify(element);\r\n        }\r\n        return {\r\n            appState: {\r\n                ...appState,\r\n                toastMessage: t(\"toast.copyStyles\"),\r\n            },\r\n            commitToHistory: false,\r\n        };\r\n    },\r\n    contextItemLabel: \"labels.copyStyles\",\r\n    keyTest: (event) => event[KEYS.CTRL_OR_CMD] && event.altKey && event.code === CODES.C,\r\n});\r\nexport const actionPasteStyles = register({\r\n    name: \"pasteStyles\",\r\n    perform: (elements, appState) => {\r\n        const pastedElement = JSON.parse(copiedStyles);\r\n        if (!isExcalidrawElement(pastedElement)) {\r\n            return { elements, commitToHistory: false };\r\n        }\r\n        return {\r\n            elements: elements.map((element) => {\r\n                if (appState.selectedElementIds[element.id]) {\r\n                    const newElement = newElementWith(element, {\r\n                        backgroundColor: pastedElement?.backgroundColor,\r\n                        strokeWidth: pastedElement?.strokeWidth,\r\n                        strokeColor: pastedElement?.strokeColor,\r\n                        strokeStyle: pastedElement?.strokeStyle,\r\n                        fillStyle: pastedElement?.fillStyle,\r\n                        opacity: pastedElement?.opacity,\r\n                        roughness: pastedElement?.roughness,\r\n                    });\r\n                    if (isTextElement(newElement)) {\r\n                        mutateElement(newElement, {\r\n                            fontSize: pastedElement?.fontSize || DEFAULT_FONT_SIZE,\r\n                            fontFamily: pastedElement?.fontFamily || DEFAULT_FONT_FAMILY,\r\n                            textAlign: pastedElement?.textAlign || DEFAULT_TEXT_ALIGN,\r\n                        });\r\n                        redrawTextBoundingBox(newElement);\r\n                    }\r\n                    return newElement;\r\n                }\r\n                return element;\r\n            }),\r\n            commitToHistory: true,\r\n        };\r\n    },\r\n    contextItemLabel: \"labels.pasteStyles\",\r\n    keyTest: (event) => event[KEYS.CTRL_OR_CMD] && event.altKey && event.code === CODES.V,\r\n});\r\n","import { questionCircle } from \"../components/icons\";\r\nexport const HelpIcon = (props) => (<button className=\"help-icon\" onClick={props.onClick} type=\"button\" title={`${props.title}  ?`} aria-label={props.title}>\r\n    {questionCircle}\r\n  </button>);\r\n","import { CODES, KEYS } from \"../keys\";\r\nimport { t } from \"../i18n\";\r\nimport { getShortcutKey } from \"../utils\";\r\nimport { register } from \"./register\";\r\nimport { UngroupIcon, GroupIcon } from \"../components/icons\";\r\nimport { newElementWith } from \"../element/mutateElement\";\r\nimport { getSelectedElements, isSomeElementSelected } from \"../scene\";\r\nimport { getSelectedGroupIds, selectGroup, selectGroupsForSelectedElements, getElementsInGroup, addToGroup, removeFromSelectedGroups, isElementInGroup, } from \"../groups\";\r\nimport { getNonDeletedElements } from \"../element\";\r\nimport { randomId } from \"../random\";\r\nimport { ToolButton } from \"../components/ToolButton\";\r\nconst allElementsInSameGroup = (elements) => {\r\n    if (elements.length >= 2) {\r\n        const groupIds = elements[0].groupIds;\r\n        for (const groupId of groupIds) {\r\n            if (elements.reduce((acc, element) => acc && isElementInGroup(element, groupId), true)) {\r\n                return true;\r\n            }\r\n        }\r\n    }\r\n    return false;\r\n};\r\nconst enableActionGroup = (elements, appState) => {\r\n    const selectedElements = getSelectedElements(getNonDeletedElements(elements), appState);\r\n    return (selectedElements.length >= 2 && !allElementsInSameGroup(selectedElements));\r\n};\r\nexport const actionGroup = register({\r\n    name: \"group\",\r\n    perform: (elements, appState) => {\r\n        const selectedElements = getSelectedElements(getNonDeletedElements(elements), appState);\r\n        if (selectedElements.length < 2) {\r\n            // nothing to group\r\n            return { appState, elements, commitToHistory: false };\r\n        }\r\n        // if everything is already grouped into 1 group, there is nothing to do\r\n        const selectedGroupIds = getSelectedGroupIds(appState);\r\n        if (selectedGroupIds.length === 1) {\r\n            const selectedGroupId = selectedGroupIds[0];\r\n            const elementIdsInGroup = new Set(getElementsInGroup(elements, selectedGroupId).map((element) => element.id));\r\n            const selectedElementIds = new Set(selectedElements.map((element) => element.id));\r\n            const combinedSet = new Set([\r\n                ...Array.from(elementIdsInGroup),\r\n                ...Array.from(selectedElementIds),\r\n            ]);\r\n            if (combinedSet.size === elementIdsInGroup.size) {\r\n                // no incremental ids in the selected ids\r\n                return { appState, elements, commitToHistory: false };\r\n            }\r\n        }\r\n        const newGroupId = randomId();\r\n        const updatedElements = elements.map((element) => {\r\n            if (!appState.selectedElementIds[element.id]) {\r\n                return element;\r\n            }\r\n            return newElementWith(element, {\r\n                groupIds: addToGroup(element.groupIds, newGroupId, appState.editingGroupId),\r\n            });\r\n        });\r\n        // keep the z order within the group the same, but move them\r\n        // to the z order of the highest element in the layer stack\r\n        const elementsInGroup = getElementsInGroup(updatedElements, newGroupId);\r\n        const lastElementInGroup = elementsInGroup[elementsInGroup.length - 1];\r\n        const lastGroupElementIndex = updatedElements.lastIndexOf(lastElementInGroup);\r\n        const elementsAfterGroup = updatedElements.slice(lastGroupElementIndex + 1);\r\n        const elementsBeforeGroup = updatedElements\r\n            .slice(0, lastGroupElementIndex)\r\n            .filter((updatedElement) => !isElementInGroup(updatedElement, newGroupId));\r\n        const updatedElementsInOrder = [\r\n            ...elementsBeforeGroup,\r\n            ...elementsInGroup,\r\n            ...elementsAfterGroup,\r\n        ];\r\n        return {\r\n            appState: selectGroup(newGroupId, { ...appState, selectedGroupIds: {} }, getNonDeletedElements(updatedElementsInOrder)),\r\n            elements: updatedElementsInOrder,\r\n            commitToHistory: true,\r\n        };\r\n    },\r\n    contextItemLabel: \"labels.group\",\r\n    contextItemPredicate: (elements, appState) => enableActionGroup(elements, appState),\r\n    keyTest: (event) => !event.shiftKey && event[KEYS.CTRL_OR_CMD] && event.code === CODES.G,\r\n    PanelComponent: ({ elements, appState, updateData }) => (<ToolButton hidden={!enableActionGroup(elements, appState)} type=\"button\" icon={<GroupIcon theme={appState.theme}/>} onClick={() => updateData(null)} title={`${t(\"labels.group\")}  ${getShortcutKey(\"CtrlOrCmd+G\")}`} aria-label={t(\"labels.group\")} visible={isSomeElementSelected(getNonDeletedElements(elements), appState)}></ToolButton>),\r\n});\r\nexport const actionUngroup = register({\r\n    name: \"ungroup\",\r\n    perform: (elements, appState) => {\r\n        const groupIds = getSelectedGroupIds(appState);\r\n        if (groupIds.length === 0) {\r\n            return { appState, elements, commitToHistory: false };\r\n        }\r\n        const nextElements = elements.map((element) => {\r\n            const nextGroupIds = removeFromSelectedGroups(element.groupIds, appState.selectedGroupIds);\r\n            if (nextGroupIds.length === element.groupIds.length) {\r\n                return element;\r\n            }\r\n            return newElementWith(element, {\r\n                groupIds: nextGroupIds,\r\n            });\r\n        });\r\n        return {\r\n            appState: selectGroupsForSelectedElements({ ...appState, selectedGroupIds: {} }, getNonDeletedElements(nextElements)),\r\n            elements: nextElements,\r\n            commitToHistory: true,\r\n        };\r\n    },\r\n    keyTest: (event) => event.shiftKey && event[KEYS.CTRL_OR_CMD] && event.code === CODES.G,\r\n    contextItemLabel: \"labels.ungroup\",\r\n    contextItemPredicate: (elements, appState) => getSelectedGroupIds(appState).length > 0,\r\n    PanelComponent: ({ elements, appState, updateData }) => (<ToolButton type=\"button\" hidden={getSelectedGroupIds(appState).length === 0} icon={<UngroupIcon theme={appState.theme}/>} onClick={() => updateData(null)} title={`${t(\"labels.ungroup\")}  ${getShortcutKey(\"CtrlOrCmd+Shift+G\")}`} aria-label={t(\"labels.ungroup\")} visible={isSomeElementSelected(getNonDeletedElements(elements), appState)}></ToolButton>),\r\n});\r\n","import { menu, palette } from \"../components/icons\";\r\nimport { ToolButton } from \"../components/ToolButton\";\r\nimport { t } from \"../i18n\";\r\nimport { showSelectedShapeActions, getNonDeletedElements } from \"../element\";\r\nimport { register } from \"./register\";\r\nimport { allowFullScreen, exitFullScreen, isFullScreen } from \"../utils\";\r\nimport { CODES, KEYS } from \"../keys\";\r\nimport { HelpIcon } from \"../components/HelpIcon\";\r\nexport const actionToggleCanvasMenu = register({\r\n    name: \"toggleCanvasMenu\",\r\n    perform: (_, appState) => ({\r\n        appState: {\r\n            ...appState,\r\n            openMenu: appState.openMenu === \"canvas\" ? null : \"canvas\",\r\n        },\r\n        commitToHistory: false,\r\n    }),\r\n    PanelComponent: ({ appState, updateData }) => (<ToolButton type=\"button\" icon={menu} aria-label={t(\"buttons.menu\")} onClick={updateData} selected={appState.openMenu === \"canvas\"}/>),\r\n});\r\nexport const actionToggleEditMenu = register({\r\n    name: \"toggleEditMenu\",\r\n    perform: (_elements, appState) => ({\r\n        appState: {\r\n            ...appState,\r\n            openMenu: appState.openMenu === \"shape\" ? null : \"shape\",\r\n        },\r\n        commitToHistory: false,\r\n    }),\r\n    PanelComponent: ({ elements, appState, updateData }) => (<ToolButton visible={showSelectedShapeActions(appState, getNonDeletedElements(elements))} type=\"button\" icon={palette} aria-label={t(\"buttons.edit\")} onClick={updateData} selected={appState.openMenu === \"shape\"}/>),\r\n});\r\nexport const actionFullScreen = register({\r\n    name: \"toggleFullScreen\",\r\n    perform: () => {\r\n        if (!isFullScreen()) {\r\n            allowFullScreen();\r\n        }\r\n        if (isFullScreen()) {\r\n            exitFullScreen();\r\n        }\r\n        return {\r\n            commitToHistory: false,\r\n        };\r\n    },\r\n    keyTest: (event) => event.code === CODES.F && !event[KEYS.CTRL_OR_CMD],\r\n});\r\nexport const actionShortcuts = register({\r\n    name: \"toggleShortcuts\",\r\n    perform: (_elements, appState, _, { focusContainer }) => {\r\n        if (appState.showHelpDialog) {\r\n            focusContainer();\r\n        }\r\n        return {\r\n            appState: {\r\n                ...appState,\r\n                showHelpDialog: !appState.showHelpDialog,\r\n            },\r\n            commitToHistory: false,\r\n        };\r\n    },\r\n    PanelComponent: ({ updateData }) => (<HelpIcon title={t(\"helpDialog.title\")} onClick={updateData}/>),\r\n    keyTest: (event) => event.key === KEYS.QUESTION_MARK,\r\n});\r\n","import \"./Avatar.scss\";\r\nimport React from \"react\";\r\nexport const Avatar = ({ children, color, border, onClick }) => (<div className=\"Avatar\" style={{ background: color, border: `1px solid ${border}` }} onClick={onClick}>\r\n    {children}\r\n  </div>);\r\n","import { register } from \"./register\";\r\nimport { getSelectedElements } from \"../scene\";\r\nimport { getNonDeletedElements } from \"../element\";\r\nimport { deepCopyElement } from \"../element/newElement\";\r\nexport const actionAddToLibrary = register({\r\n    name: \"addToLibrary\",\r\n    perform: (elements, appState, _, app) => {\r\n        const selectedElements = getSelectedElements(getNonDeletedElements(elements), appState);\r\n        app.library.loadLibrary().then((items) => {\r\n            app.library.saveLibrary([\r\n                ...items,\r\n                selectedElements.map(deepCopyElement),\r\n            ]);\r\n        });\r\n        return false;\r\n    },\r\n    contextItemLabel: \"labels.addToLibrary\",\r\n});\r\n","import { getClientColors, getClientInitials } from \"../clients\";\r\nimport { Avatar } from \"../components/Avatar\";\r\nimport { centerScrollOn } from \"../scene/scroll\";\r\nimport { register } from \"./register\";\r\nexport const actionGoToCollaborator = register({\r\n    name: \"goToCollaborator\",\r\n    perform: (_elements, appState, value) => {\r\n        const point = value;\r\n        if (!point) {\r\n            return { appState, commitToHistory: false };\r\n        }\r\n        return {\r\n            appState: {\r\n                ...appState,\r\n                ...centerScrollOn({\r\n                    scenePoint: point,\r\n                    viewportDimensions: {\r\n                        width: appState.width,\r\n                        height: appState.height,\r\n                    },\r\n                    zoom: appState.zoom,\r\n                }),\r\n                // Close mobile menu\r\n                openMenu: appState.openMenu === \"canvas\" ? null : appState.openMenu,\r\n            },\r\n            commitToHistory: false,\r\n        };\r\n    },\r\n    PanelComponent: ({ appState, updateData, data }) => {\r\n        const clientId = data?.id;\r\n        if (!clientId) {\r\n            return null;\r\n        }\r\n        const collaborator = appState.collaborators.get(clientId);\r\n        if (!collaborator) {\r\n            return null;\r\n        }\r\n        const { background, stroke } = getClientColors(clientId, appState);\r\n        const shortName = getClientInitials(collaborator.username);\r\n        return (<Avatar color={background} border={stroke} onClick={() => updateData(collaborator.pointer)}>\r\n        {shortName}\r\n      </Avatar>);\r\n    },\r\n});\r\n","import { newElementWith } from \"./element/mutateElement\";\r\nimport { getCommonBounds } from \"./element\";\r\nexport const alignElements = (selectedElements, alignment) => {\r\n    const groups = getMaximumGroups(selectedElements);\r\n    const selectionBoundingBox = getCommonBoundingBox(selectedElements);\r\n    return groups.flatMap((group) => {\r\n        const translation = calculateTranslation(group, selectionBoundingBox, alignment);\r\n        return group.map((element) => newElementWith(element, {\r\n            x: element.x + translation.x,\r\n            y: element.y + translation.y,\r\n        }));\r\n    });\r\n};\r\nexport const getMaximumGroups = (elements) => {\r\n    const groups = new Map();\r\n    elements.forEach((element) => {\r\n        const groupId = element.groupIds.length === 0\r\n            ? element.id\r\n            : element.groupIds[element.groupIds.length - 1];\r\n        const currentGroupMembers = groups.get(groupId) || [];\r\n        groups.set(groupId, [...currentGroupMembers, element]);\r\n    });\r\n    return Array.from(groups.values());\r\n};\r\nconst calculateTranslation = (group, selectionBoundingBox, { axis, position }) => {\r\n    const groupBoundingBox = getCommonBoundingBox(group);\r\n    const [min, max] = axis === \"x\" ? [\"minX\", \"maxX\"] : [\"minY\", \"maxY\"];\r\n    const noTranslation = { x: 0, y: 0 };\r\n    if (position === \"start\") {\r\n        return {\r\n            ...noTranslation,\r\n            [axis]: selectionBoundingBox[min] - groupBoundingBox[min],\r\n        };\r\n    }\r\n    else if (position === \"end\") {\r\n        return {\r\n            ...noTranslation,\r\n            [axis]: selectionBoundingBox[max] - groupBoundingBox[max],\r\n        };\r\n    } // else if (position === \"center\") {\r\n    return {\r\n        ...noTranslation,\r\n        [axis]: (selectionBoundingBox[min] + selectionBoundingBox[max]) / 2 -\r\n            (groupBoundingBox[min] + groupBoundingBox[max]) / 2,\r\n    };\r\n};\r\nconst getCommonBoundingBox = (elements) => {\r\n    const [minX, minY, maxX, maxY] = getCommonBounds(elements);\r\n    return { minX, minY, maxX, maxY };\r\n};\r\n","import { alignElements } from \"../align\";\r\nimport { AlignBottomIcon, AlignLeftIcon, AlignRightIcon, AlignTopIcon, CenterHorizontallyIcon, CenterVerticallyIcon, } from \"../components/icons\";\r\nimport { ToolButton } from \"../components/ToolButton\";\r\nimport { getElementMap, getNonDeletedElements } from \"../element\";\r\nimport { t } from \"../i18n\";\r\nimport { KEYS } from \"../keys\";\r\nimport { getSelectedElements, isSomeElementSelected } from \"../scene\";\r\nimport { getShortcutKey } from \"../utils\";\r\nimport { register } from \"./register\";\r\nconst enableActionGroup = (elements, appState) => getSelectedElements(getNonDeletedElements(elements), appState).length > 1;\r\nconst alignSelectedElements = (elements, appState, alignment) => {\r\n    const selectedElements = getSelectedElements(getNonDeletedElements(elements), appState);\r\n    const updatedElements = alignElements(selectedElements, alignment);\r\n    const updatedElementsMap = getElementMap(updatedElements);\r\n    return elements.map((element) => updatedElementsMap[element.id] || element);\r\n};\r\nexport const actionAlignTop = register({\r\n    name: \"alignTop\",\r\n    perform: (elements, appState) => {\r\n        return {\r\n            appState,\r\n            elements: alignSelectedElements(elements, appState, {\r\n                position: \"start\",\r\n                axis: \"y\",\r\n            }),\r\n            commitToHistory: true,\r\n        };\r\n    },\r\n    keyTest: (event) => event[KEYS.CTRL_OR_CMD] && event.shiftKey && event.key === KEYS.ARROW_UP,\r\n    PanelComponent: ({ elements, appState, updateData }) => (<ToolButton hidden={!enableActionGroup(elements, appState)} type=\"button\" icon={<AlignTopIcon theme={appState.theme}/>} onClick={() => updateData(null)} title={`${t(\"labels.alignTop\")}  ${getShortcutKey(\"CtrlOrCmd+Shift+Up\")}`} aria-label={t(\"labels.alignTop\")} visible={isSomeElementSelected(getNonDeletedElements(elements), appState)}/>),\r\n});\r\nexport const actionAlignBottom = register({\r\n    name: \"alignBottom\",\r\n    perform: (elements, appState) => {\r\n        return {\r\n            appState,\r\n            elements: alignSelectedElements(elements, appState, {\r\n                position: \"end\",\r\n                axis: \"y\",\r\n            }),\r\n            commitToHistory: true,\r\n        };\r\n    },\r\n    keyTest: (event) => event[KEYS.CTRL_OR_CMD] && event.shiftKey && event.key === KEYS.ARROW_DOWN,\r\n    PanelComponent: ({ elements, appState, updateData }) => (<ToolButton hidden={!enableActionGroup(elements, appState)} type=\"button\" icon={<AlignBottomIcon theme={appState.theme}/>} onClick={() => updateData(null)} title={`${t(\"labels.alignBottom\")}  ${getShortcutKey(\"CtrlOrCmd+Shift+Down\")}`} aria-label={t(\"labels.alignBottom\")} visible={isSomeElementSelected(getNonDeletedElements(elements), appState)}/>),\r\n});\r\nexport const actionAlignLeft = register({\r\n    name: \"alignLeft\",\r\n    perform: (elements, appState) => {\r\n        return {\r\n            appState,\r\n            elements: alignSelectedElements(elements, appState, {\r\n                position: \"start\",\r\n                axis: \"x\",\r\n            }),\r\n            commitToHistory: true,\r\n        };\r\n    },\r\n    keyTest: (event) => event[KEYS.CTRL_OR_CMD] && event.shiftKey && event.key === KEYS.ARROW_LEFT,\r\n    PanelComponent: ({ elements, appState, updateData }) => (<ToolButton hidden={!enableActionGroup(elements, appState)} type=\"button\" icon={<AlignLeftIcon theme={appState.theme}/>} onClick={() => updateData(null)} title={`${t(\"labels.alignLeft\")}  ${getShortcutKey(\"CtrlOrCmd+Shift+Left\")}`} aria-label={t(\"labels.alignLeft\")} visible={isSomeElementSelected(getNonDeletedElements(elements), appState)}/>),\r\n});\r\nexport const actionAlignRight = register({\r\n    name: \"alignRight\",\r\n    perform: (elements, appState) => {\r\n        return {\r\n            appState,\r\n            elements: alignSelectedElements(elements, appState, {\r\n                position: \"end\",\r\n                axis: \"x\",\r\n            }),\r\n            commitToHistory: true,\r\n        };\r\n    },\r\n    keyTest: (event) => event[KEYS.CTRL_OR_CMD] && event.shiftKey && event.key === KEYS.ARROW_RIGHT,\r\n    PanelComponent: ({ elements, appState, updateData }) => (<ToolButton hidden={!enableActionGroup(elements, appState)} type=\"button\" icon={<AlignRightIcon theme={appState.theme}/>} onClick={() => updateData(null)} title={`${t(\"labels.alignRight\")}  ${getShortcutKey(\"CtrlOrCmd+Shift+Right\")}`} aria-label={t(\"labels.alignRight\")} visible={isSomeElementSelected(getNonDeletedElements(elements), appState)}/>),\r\n});\r\nexport const actionAlignVerticallyCentered = register({\r\n    name: \"alignVerticallyCentered\",\r\n    perform: (elements, appState) => {\r\n        return {\r\n            appState,\r\n            elements: alignSelectedElements(elements, appState, {\r\n                position: \"center\",\r\n                axis: \"y\",\r\n            }),\r\n            commitToHistory: true,\r\n        };\r\n    },\r\n    PanelComponent: ({ elements, appState, updateData }) => (<ToolButton hidden={!enableActionGroup(elements, appState)} type=\"button\" icon={<CenterVerticallyIcon theme={appState.theme}/>} onClick={() => updateData(null)} title={t(\"labels.centerVertically\")} aria-label={t(\"labels.centerVertically\")} visible={isSomeElementSelected(getNonDeletedElements(elements), appState)}/>),\r\n});\r\nexport const actionAlignHorizontallyCentered = register({\r\n    name: \"alignHorizontallyCentered\",\r\n    perform: (elements, appState) => {\r\n        return {\r\n            appState,\r\n            elements: alignSelectedElements(elements, appState, {\r\n                position: \"center\",\r\n                axis: \"x\",\r\n            }),\r\n            commitToHistory: true,\r\n        };\r\n    },\r\n    PanelComponent: ({ elements, appState, updateData }) => (<ToolButton hidden={!enableActionGroup(elements, appState)} type=\"button\" icon={<CenterHorizontallyIcon theme={appState.theme}/>} onClick={() => updateData(null)} title={t(\"labels.centerHorizontally\")} aria-label={t(\"labels.centerHorizontally\")} visible={isSomeElementSelected(getNonDeletedElements(elements), appState)}/>),\r\n});\r\n","import { newElementWith } from \"./element/mutateElement\";\r\nimport { getCommonBounds } from \"./element\";\r\nexport const distributeElements = (selectedElements, distribution) => {\r\n    const [start, mid, end, extent] = distribution.axis === \"x\"\r\n        ? [\"minX\", \"midX\", \"maxX\", \"width\"]\r\n        : [\"minY\", \"midY\", \"maxY\", \"height\"];\r\n    const bounds = getCommonBoundingBox(selectedElements);\r\n    const groups = getMaximumGroups(selectedElements)\r\n        .map((group) => [group, getCommonBoundingBox(group)])\r\n        .sort((a, b) => a[1][mid] - b[1][mid]);\r\n    let span = 0;\r\n    for (const group of groups) {\r\n        span += group[1][extent];\r\n    }\r\n    const step = (bounds[extent] - span) / (groups.length - 1);\r\n    if (step < 0) {\r\n        // If we have a negative step, we'll need to distribute from centers\r\n        // rather than from gaps. Buckle up, this is a weird one.\r\n        // Get indices of boxes that define start and end of our bounding box\r\n        const index0 = groups.findIndex((g) => g[1][start] === bounds[start]);\r\n        const index1 = groups.findIndex((g) => g[1][end] === bounds[end]);\r\n        // Get our step, based on the distance between the center points of our\r\n        // start and end boxes\r\n        const step = (groups[index1][1][mid] - groups[index0][1][mid]) / (groups.length - 1);\r\n        let pos = groups[index0][1][mid];\r\n        return groups.flatMap(([group, box], index) => {\r\n            const translation = {\r\n                x: 0,\r\n                y: 0,\r\n            };\r\n            // Don't move our start and end boxes\r\n            if (index !== index0 && index !== index1) {\r\n                pos += step;\r\n                translation[distribution.axis] = pos - box[mid];\r\n            }\r\n            return group.map((element) => newElementWith(element, {\r\n                x: element.x + translation.x,\r\n                y: element.y + translation.y,\r\n            }));\r\n        });\r\n    }\r\n    // Distribute from gaps\r\n    let pos = bounds[start];\r\n    return groups.flatMap(([group, box]) => {\r\n        const translation = {\r\n            x: 0,\r\n            y: 0,\r\n        };\r\n        translation[distribution.axis] = pos - box[start];\r\n        pos += step;\r\n        pos += box[extent];\r\n        return group.map((element) => newElementWith(element, {\r\n            x: element.x + translation.x,\r\n            y: element.y + translation.y,\r\n        }));\r\n    });\r\n};\r\nexport const getMaximumGroups = (elements) => {\r\n    const groups = new Map();\r\n    elements.forEach((element) => {\r\n        const groupId = element.groupIds.length === 0\r\n            ? element.id\r\n            : element.groupIds[element.groupIds.length - 1];\r\n        const currentGroupMembers = groups.get(groupId) || [];\r\n        groups.set(groupId, [...currentGroupMembers, element]);\r\n    });\r\n    return Array.from(groups.values());\r\n};\r\nconst getCommonBoundingBox = (elements) => {\r\n    const [minX, minY, maxX, maxY] = getCommonBounds(elements);\r\n    return {\r\n        minX,\r\n        minY,\r\n        maxX,\r\n        maxY,\r\n        width: maxX - minX,\r\n        height: maxY - minY,\r\n        midX: (minX + maxX) / 2,\r\n        midY: (minY + maxY) / 2,\r\n    };\r\n};\r\n","import { DistributeHorizontallyIcon, DistributeVerticallyIcon, } from \"../components/icons\";\r\nimport { ToolButton } from \"../components/ToolButton\";\r\nimport { distributeElements } from \"../disitrubte\";\r\nimport { getElementMap, getNonDeletedElements } from \"../element\";\r\nimport { t } from \"../i18n\";\r\nimport { CODES } from \"../keys\";\r\nimport { getSelectedElements, isSomeElementSelected } from \"../scene\";\r\nimport { getShortcutKey } from \"../utils\";\r\nimport { register } from \"./register\";\r\nconst enableActionGroup = (elements, appState) => getSelectedElements(getNonDeletedElements(elements), appState).length > 1;\r\nconst distributeSelectedElements = (elements, appState, distribution) => {\r\n    const selectedElements = getSelectedElements(getNonDeletedElements(elements), appState);\r\n    const updatedElements = distributeElements(selectedElements, distribution);\r\n    const updatedElementsMap = getElementMap(updatedElements);\r\n    return elements.map((element) => updatedElementsMap[element.id] || element);\r\n};\r\nexport const distributeHorizontally = register({\r\n    name: \"distributeHorizontally\",\r\n    perform: (elements, appState) => {\r\n        return {\r\n            appState,\r\n            elements: distributeSelectedElements(elements, appState, {\r\n                space: \"between\",\r\n                axis: \"x\",\r\n            }),\r\n            commitToHistory: true,\r\n        };\r\n    },\r\n    keyTest: (event) => event.altKey && event.code === CODES.H,\r\n    PanelComponent: ({ elements, appState, updateData }) => (<ToolButton hidden={!enableActionGroup(elements, appState)} type=\"button\" icon={<DistributeHorizontallyIcon theme={appState.theme}/>} onClick={() => updateData(null)} title={`${t(\"labels.distributeHorizontally\")}  ${getShortcutKey(\"Alt+H\")}`} aria-label={t(\"labels.distributeHorizontally\")} visible={isSomeElementSelected(getNonDeletedElements(elements), appState)}/>),\r\n});\r\nexport const distributeVertically = register({\r\n    name: \"distributeVertically\",\r\n    perform: (elements, appState) => {\r\n        return {\r\n            appState,\r\n            elements: distributeSelectedElements(elements, appState, {\r\n                space: \"between\",\r\n                axis: \"y\",\r\n            }),\r\n            commitToHistory: true,\r\n        };\r\n    },\r\n    keyTest: (event) => event.altKey && event.code === CODES.V,\r\n    PanelComponent: ({ elements, appState, updateData }) => (<ToolButton hidden={!enableActionGroup(elements, appState)} type=\"button\" icon={<DistributeVerticallyIcon theme={appState.theme}/>} onClick={() => updateData(null)} title={`${t(\"labels.distributeVertically\")}  ${getShortcutKey(\"Alt+V\")}`} aria-label={t(\"labels.distributeVertically\")} visible={isSomeElementSelected(getNonDeletedElements(elements), appState)}/>),\r\n});\r\n","import { register } from \"./register\";\r\nimport { getSelectedElements } from \"../scene\";\r\nimport { getElementMap, getNonDeletedElements } from \"../element\";\r\nimport { mutateElement } from \"../element/mutateElement\";\r\nimport { normalizeAngle, resizeSingleElement } from \"../element/resizeElements\";\r\nimport { getTransformHandles } from \"../element/transformHandles\";\r\nimport { isFreeDrawElement, isLinearElement } from \"../element/typeChecks\";\r\nimport { updateBoundElements } from \"../element/binding\";\r\nimport { LinearElementEditor } from \"../element/linearElementEditor\";\r\nconst enableActionFlipHorizontal = (elements, appState) => {\r\n    const eligibleElements = getSelectedElements(getNonDeletedElements(elements), appState);\r\n    return eligibleElements.length === 1 && eligibleElements[0].type !== \"text\";\r\n};\r\nconst enableActionFlipVertical = (elements, appState) => {\r\n    const eligibleElements = getSelectedElements(getNonDeletedElements(elements), appState);\r\n    return eligibleElements.length === 1;\r\n};\r\nexport const actionFlipHorizontal = register({\r\n    name: \"flipHorizontal\",\r\n    perform: (elements, appState) => {\r\n        return {\r\n            elements: flipSelectedElements(elements, appState, \"horizontal\"),\r\n            appState,\r\n            commitToHistory: true,\r\n        };\r\n    },\r\n    keyTest: (event) => event.shiftKey && event.code === \"KeyH\",\r\n    contextItemLabel: \"labels.flipHorizontal\",\r\n    contextItemPredicate: (elements, appState) => enableActionFlipHorizontal(elements, appState),\r\n});\r\nexport const actionFlipVertical = register({\r\n    name: \"flipVertical\",\r\n    perform: (elements, appState) => {\r\n        return {\r\n            elements: flipSelectedElements(elements, appState, \"vertical\"),\r\n            appState,\r\n            commitToHistory: true,\r\n        };\r\n    },\r\n    keyTest: (event) => event.shiftKey && event.code === \"KeyV\",\r\n    contextItemLabel: \"labels.flipVertical\",\r\n    contextItemPredicate: (elements, appState) => enableActionFlipVertical(elements, appState),\r\n});\r\nconst flipSelectedElements = (elements, appState, flipDirection) => {\r\n    const selectedElements = getSelectedElements(getNonDeletedElements(elements), appState);\r\n    // remove once we allow for groups of elements to be flipped\r\n    if (selectedElements.length > 1) {\r\n        return elements;\r\n    }\r\n    const updatedElements = flipElements(selectedElements, appState, flipDirection);\r\n    const updatedElementsMap = getElementMap(updatedElements);\r\n    return elements.map((element) => updatedElementsMap[element.id] || element);\r\n};\r\nconst flipElements = (elements, appState, flipDirection) => {\r\n    elements.forEach((element) => {\r\n        flipElement(element, appState);\r\n        // If vertical flip, rotate an extra 180\r\n        if (flipDirection === \"vertical\") {\r\n            rotateElement(element, Math.PI);\r\n        }\r\n    });\r\n    return elements;\r\n};\r\nconst flipElement = (element, appState) => {\r\n    const originalX = element.x;\r\n    const originalY = element.y;\r\n    const width = element.width;\r\n    const height = element.height;\r\n    const originalAngle = normalizeAngle(element.angle);\r\n    let finalOffsetX = 0;\r\n    if (isLinearElement(element) || isFreeDrawElement(element)) {\r\n        finalOffsetX =\r\n            element.points.reduce((max, point) => Math.max(max, point[0]), 0) * 2 -\r\n                element.width;\r\n    }\r\n    // Rotate back to zero, if necessary\r\n    mutateElement(element, {\r\n        angle: normalizeAngle(0),\r\n    });\r\n    // Flip unrotated by pulling TransformHandle to opposite side\r\n    const transformHandles = getTransformHandles(element, appState.zoom);\r\n    let usingNWHandle = true;\r\n    let newNCoordsX = 0;\r\n    let nHandle = transformHandles.nw;\r\n    if (!nHandle) {\r\n        // Use ne handle instead\r\n        usingNWHandle = false;\r\n        nHandle = transformHandles.ne;\r\n        if (!nHandle) {\r\n            mutateElement(element, {\r\n                angle: originalAngle,\r\n            });\r\n            return;\r\n        }\r\n    }\r\n    if (isLinearElement(element)) {\r\n        for (let i = 1; i < element.points.length; i++) {\r\n            LinearElementEditor.movePoint(element, i, [\r\n                -element.points[i][0],\r\n                element.points[i][1],\r\n            ]);\r\n        }\r\n        LinearElementEditor.normalizePoints(element);\r\n    }\r\n    else {\r\n        // calculate new x-coord for transformation\r\n        newNCoordsX = usingNWHandle ? element.x + 2 * width : element.x - 2 * width;\r\n        resizeSingleElement(element, true, element, usingNWHandle ? \"nw\" : \"ne\", false, newNCoordsX, nHandle[1]);\r\n        // fix the size to account for handle sizes\r\n        mutateElement(element, {\r\n            width,\r\n            height,\r\n        });\r\n    }\r\n    // Rotate by (360 degrees - original angle)\r\n    let angle = normalizeAngle(2 * Math.PI - originalAngle);\r\n    if (angle < 0) {\r\n        // check, probably unnecessary\r\n        angle = normalizeAngle(angle + 2 * Math.PI);\r\n    }\r\n    mutateElement(element, {\r\n        angle,\r\n    });\r\n    // Move back to original spot to appear \"flipped in place\"\r\n    mutateElement(element, {\r\n        x: originalX + finalOffsetX,\r\n        y: originalY,\r\n    });\r\n    updateBoundElements(element);\r\n};\r\nconst rotateElement = (element, rotationAngle) => {\r\n    const originalX = element.x;\r\n    const originalY = element.y;\r\n    let angle = normalizeAngle(element.angle + rotationAngle);\r\n    if (angle < 0) {\r\n        // check, probably unnecessary\r\n        angle = normalizeAngle(2 * Math.PI + angle);\r\n    }\r\n    mutateElement(element, {\r\n        angle,\r\n    });\r\n    // Move back to original spot\r\n    mutateElement(element, {\r\n        x: originalX,\r\n        y: originalY,\r\n    });\r\n};\r\n","import { CODES, KEYS } from \"../keys\";\r\nimport { register } from \"./register\";\r\nimport { copyToClipboard } from \"../clipboard\";\r\nimport { actionDeleteSelected } from \"./actionDeleteSelected\";\r\nimport { getSelectedElements } from \"../scene/selection\";\r\nimport { exportCanvas } from \"../data/index\";\r\nimport { getNonDeletedElements } from \"../element\";\r\nimport { t } from \"../i18n\";\r\nexport const actionCopy = register({\r\n    name: \"copy\",\r\n    perform: (elements, appState, _, app) => {\r\n        copyToClipboard(getNonDeletedElements(elements), appState, app.files);\r\n        return {\r\n            commitToHistory: false,\r\n        };\r\n    },\r\n    contextItemLabel: \"labels.copy\",\r\n    // don't supply a shortcut since we handle this conditionally via onCopy event\r\n    keyTest: undefined,\r\n});\r\nexport const actionCut = register({\r\n    name: \"cut\",\r\n    perform: (elements, appState, data, app) => {\r\n        actionCopy.perform(elements, appState, data, app);\r\n        return actionDeleteSelected.perform(elements, appState, data, app);\r\n    },\r\n    contextItemLabel: \"labels.cut\",\r\n    keyTest: (event) => event[KEYS.CTRL_OR_CMD] && event.code === CODES.X,\r\n});\r\nexport const actionCopyAsSvg = register({\r\n    name: \"copyAsSvg\",\r\n    perform: async (elements, appState, _data, app) => {\r\n        if (!app.canvas) {\r\n            return {\r\n                commitToHistory: false,\r\n            };\r\n        }\r\n        const selectedElements = getSelectedElements(getNonDeletedElements(elements), appState);\r\n        try {\r\n            await exportCanvas(\"clipboard-svg\", selectedElements.length\r\n                ? selectedElements\r\n                : getNonDeletedElements(elements), appState, app.files, appState);\r\n            return {\r\n                commitToHistory: false,\r\n            };\r\n        }\r\n        catch (error) {\r\n            console.error(error);\r\n            return {\r\n                appState: {\r\n                    ...appState,\r\n                    errorMessage: error.message,\r\n                },\r\n                commitToHistory: false,\r\n            };\r\n        }\r\n    },\r\n    contextItemLabel: \"labels.copyAsSvg\",\r\n});\r\nexport const actionCopyAsPng = register({\r\n    name: \"copyAsPng\",\r\n    perform: async (elements, appState, _data, app) => {\r\n        if (!app.canvas) {\r\n            return {\r\n                commitToHistory: false,\r\n            };\r\n        }\r\n        const selectedElements = getSelectedElements(getNonDeletedElements(elements), appState);\r\n        try {\r\n            await exportCanvas(\"clipboard\", selectedElements.length\r\n                ? selectedElements\r\n                : getNonDeletedElements(elements), appState, app.files, appState);\r\n            return {\r\n                appState: {\r\n                    ...appState,\r\n                    toastMessage: t(\"toast.copyToClipboardAsPng\", {\r\n                        exportSelection: selectedElements.length\r\n                            ? t(\"toast.selection\")\r\n                            : t(\"toast.canvas\"),\r\n                        exportColorScheme: appState.exportWithDarkMode\r\n                            ? t(\"buttons.darkMode\")\r\n                            : t(\"buttons.lightMode\"),\r\n                    }),\r\n                },\r\n                commitToHistory: false,\r\n            };\r\n        }\r\n        catch (error) {\r\n            console.error(error);\r\n            return {\r\n                appState: {\r\n                    ...appState,\r\n                    errorMessage: error.message,\r\n                },\r\n                commitToHistory: false,\r\n            };\r\n        }\r\n    },\r\n    contextItemLabel: \"labels.copyAsPng\",\r\n    keyTest: (event) => event.code === CODES.C && event.altKey && event.shiftKey,\r\n});\r\n","import { CODES, KEYS } from \"../keys\";\r\nimport { register } from \"./register\";\r\nimport { GRID_SIZE } from \"../constants\";\r\nimport { trackEvent } from \"../analytics\";\r\nexport const actionToggleGridMode = register({\r\n    name: \"gridMode\",\r\n    perform(elements, appState) {\r\n        trackEvent(\"view\", \"mode\", \"grid\");\r\n        return {\r\n            appState: {\r\n                ...appState,\r\n                gridSize: this.checked(appState) ? null : GRID_SIZE,\r\n            },\r\n            commitToHistory: false,\r\n        };\r\n    },\r\n    checked: (appState) => appState.gridSize !== null,\r\n    contextItemLabel: \"labels.showGrid\",\r\n    keyTest: (event) => event[KEYS.CTRL_OR_CMD] && event.code === CODES.QUOTE,\r\n});\r\n","import { CODES, KEYS } from \"../keys\";\r\nimport { register } from \"./register\";\r\nimport { trackEvent } from \"../analytics\";\r\nexport const actionToggleZenMode = register({\r\n    name: \"zenMode\",\r\n    perform(elements, appState) {\r\n        trackEvent(\"view\", \"mode\", \"zen\");\r\n        return {\r\n            appState: {\r\n                ...appState,\r\n                zenModeEnabled: !this.checked(appState),\r\n            },\r\n            commitToHistory: false,\r\n        };\r\n    },\r\n    checked: (appState) => appState.zenModeEnabled,\r\n    contextItemLabel: \"buttons.zenMode\",\r\n    keyTest: (event) => !event[KEYS.CTRL_OR_CMD] && event.altKey && event.code === CODES.Z,\r\n});\r\n","import { register } from \"./register\";\r\nimport { CODES, KEYS } from \"../keys\";\r\nexport const actionToggleStats = register({\r\n    name: \"stats\",\r\n    perform(elements, appState) {\r\n        return {\r\n            appState: {\r\n                ...appState,\r\n                showStats: !this.checked(appState),\r\n            },\r\n            commitToHistory: false,\r\n        };\r\n    },\r\n    checked: (appState) => appState.showStats,\r\n    contextItemLabel: \"stats.title\",\r\n    keyTest: (event) => !event[KEYS.CTRL_OR_CMD] && event.altKey && event.code === CODES.SLASH,\r\n});\r\n","import { undo, redo } from \"../components/icons\";\r\nimport { ToolButton } from \"../components/ToolButton\";\r\nimport { t } from \"../i18n\";\r\nimport { isWindows, KEYS } from \"../keys\";\r\nimport { getElementMap } from \"../element\";\r\nimport { newElementWith } from \"../element/mutateElement\";\r\nimport { fixBindingsAfterDeletion } from \"../element/binding\";\r\nconst writeData = (prevElements, appState, updater) => {\r\n    const commitToHistory = false;\r\n    if (!appState.multiElement &&\r\n        !appState.resizingElement &&\r\n        !appState.editingElement &&\r\n        !appState.draggingElement) {\r\n        const data = updater();\r\n        if (data === null) {\r\n            return { commitToHistory };\r\n        }\r\n        const prevElementMap = getElementMap(prevElements);\r\n        const nextElements = data.elements;\r\n        const nextElementMap = getElementMap(nextElements);\r\n        const deletedElements = prevElements.filter((prevElement) => !nextElementMap.hasOwnProperty(prevElement.id));\r\n        const elements = nextElements\r\n            .map((nextElement) => newElementWith(prevElementMap[nextElement.id] || nextElement, nextElement))\r\n            .concat(deletedElements.map((prevElement) => newElementWith(prevElement, { isDeleted: true })));\r\n        fixBindingsAfterDeletion(elements, deletedElements);\r\n        return {\r\n            elements,\r\n            appState: { ...appState, ...data.appState },\r\n            commitToHistory,\r\n            syncHistory: true,\r\n        };\r\n    }\r\n    return { commitToHistory };\r\n};\r\nexport const createUndoAction = (history) => ({\r\n    name: \"undo\",\r\n    perform: (elements, appState) => writeData(elements, appState, () => history.undoOnce()),\r\n    keyTest: (event) => event[KEYS.CTRL_OR_CMD] &&\r\n        event.key.toLowerCase() === KEYS.Z &&\r\n        !event.shiftKey,\r\n    PanelComponent: ({ updateData, data }) => (<ToolButton type=\"button\" icon={undo} aria-label={t(\"buttons.undo\")} onClick={updateData} size={data?.size || \"medium\"}/>),\r\n    commitToHistory: () => false,\r\n});\r\nexport const createRedoAction = (history) => ({\r\n    name: \"redo\",\r\n    perform: (elements, appState) => writeData(elements, appState, () => history.redoOnce()),\r\n    keyTest: (event) => (event[KEYS.CTRL_OR_CMD] &&\r\n        event.shiftKey &&\r\n        event.key.toLowerCase() === KEYS.Z) ||\r\n        (isWindows && event.ctrlKey && !event.shiftKey && event.key === KEYS.Y),\r\n    PanelComponent: ({ updateData, data }) => (<ToolButton type=\"button\" icon={redo} aria-label={t(\"buttons.redo\")} onClick={updateData} size={data?.size || \"medium\"}/>),\r\n    commitToHistory: () => false,\r\n});\r\n","import React from \"react\";\r\nimport { MODES } from \"../constants\";\r\nexport class ActionManager {\r\n    constructor(updater, getAppState, getElementsIncludingDeleted, app) {\r\n        this.actions = {};\r\n        /**\r\n         * @param data additional data sent to the PanelComponent\r\n         */\r\n        this.renderAction = (name, data) => {\r\n            const canvasActions = this.app.props.UIOptions.canvasActions;\r\n            if (this.actions[name] &&\r\n                \"PanelComponent\" in this.actions[name] &&\r\n                (name in canvasActions\r\n                    ? canvasActions[name]\r\n                    : true)) {\r\n                const action = this.actions[name];\r\n                const PanelComponent = action.PanelComponent;\r\n                const updateData = (formState) => {\r\n                    this.updater(action.perform(this.getElementsIncludingDeleted(), this.getAppState(), formState, this.app));\r\n                };\r\n                return (<PanelComponent elements={this.getElementsIncludingDeleted()} appState={this.getAppState()} updateData={updateData} appProps={this.app.props} data={data}/>);\r\n            }\r\n            return null;\r\n        };\r\n        this.updater = (actionResult) => {\r\n            if (actionResult && \"then\" in actionResult) {\r\n                actionResult.then((actionResult) => {\r\n                    return updater(actionResult);\r\n                });\r\n            }\r\n            else {\r\n                return updater(actionResult);\r\n            }\r\n        };\r\n        this.getAppState = getAppState;\r\n        this.getElementsIncludingDeleted = getElementsIncludingDeleted;\r\n        this.app = app;\r\n    }\r\n    registerAction(action) {\r\n        this.actions[action.name] = action;\r\n    }\r\n    registerAll(actions) {\r\n        actions.forEach((action) => this.registerAction(action));\r\n    }\r\n    handleKeyDown(event) {\r\n        const canvasActions = this.app.props.UIOptions.canvasActions;\r\n        const data = Object.values(this.actions)\r\n            .sort((a, b) => (b.keyPriority || 0) - (a.keyPriority || 0))\r\n            .filter((action) => (action.name in canvasActions\r\n            ? canvasActions[action.name]\r\n            : true) &&\r\n            action.keyTest &&\r\n            action.keyTest(event, this.getAppState(), this.getElementsIncludingDeleted()));\r\n        if (data.length === 0) {\r\n            return false;\r\n        }\r\n        const { viewModeEnabled } = this.getAppState();\r\n        if (viewModeEnabled) {\r\n            if (!Object.values(MODES).includes(data[0].name)) {\r\n                return false;\r\n            }\r\n        }\r\n        event.preventDefault();\r\n        this.updater(data[0].perform(this.getElementsIncludingDeleted(), this.getAppState(), null, this.app));\r\n        return true;\r\n    }\r\n    executeAction(action) {\r\n        this.updater(action.perform(this.getElementsIncludingDeleted(), this.getAppState(), null, this.app));\r\n    }\r\n}\r\n","import { loadLibraryFromBlob } from \"./blob\";\r\nimport { restoreElements } from \"./restore\";\r\nimport { getNonDeletedElements } from \"../element\";\r\nclass Library {\r\n    constructor(app) {\r\n        this.libraryCache = null;\r\n        this.resetLibrary = async () => {\r\n            await this.app.props.onLibraryChange?.([]);\r\n            this.libraryCache = [];\r\n        };\r\n        this.restoreLibraryItem = (libraryItem) => {\r\n            const elements = getNonDeletedElements(restoreElements(libraryItem, null));\r\n            return elements.length ? elements : null;\r\n        };\r\n        this.loadLibrary = () => {\r\n            return new Promise(async (resolve) => {\r\n                if (this.libraryCache) {\r\n                    return resolve(JSON.parse(JSON.stringify(this.libraryCache)));\r\n                }\r\n                try {\r\n                    const libraryItems = this.app.libraryItemsFromStorage;\r\n                    if (!libraryItems) {\r\n                        return resolve([]);\r\n                    }\r\n                    const items = libraryItems.reduce((acc, item) => {\r\n                        const restoredItem = this.restoreLibraryItem(item);\r\n                        if (restoredItem) {\r\n                            acc.push(item);\r\n                        }\r\n                        return acc;\r\n                    }, []);\r\n                    // clone to ensure we don't mutate the cached library elements in the app\r\n                    this.libraryCache = JSON.parse(JSON.stringify(items));\r\n                    resolve(items);\r\n                }\r\n                catch (error) {\r\n                    console.error(error);\r\n                    resolve([]);\r\n                }\r\n            });\r\n        };\r\n        this.saveLibrary = async (items) => {\r\n            const prevLibraryItems = this.libraryCache;\r\n            try {\r\n                const serializedItems = JSON.stringify(items);\r\n                // cache optimistically so that the app has access to the latest\r\n                // immediately\r\n                this.libraryCache = JSON.parse(serializedItems);\r\n                await this.app.props.onLibraryChange?.(items);\r\n            }\r\n            catch (error) {\r\n                this.libraryCache = prevLibraryItems;\r\n                throw error;\r\n            }\r\n        };\r\n        this.app = app;\r\n    }\r\n    /** imports library (currently merges, removing duplicates) */\r\n    async importLibrary(blob) {\r\n        const libraryFile = await loadLibraryFromBlob(blob);\r\n        if (!libraryFile || !libraryFile.library) {\r\n            return;\r\n        }\r\n        /**\r\n         * checks if library item does not exist already in current library\r\n         */\r\n        const isUniqueitem = (existingLibraryItems, targetLibraryItem) => {\r\n            return !existingLibraryItems.find((libraryItem) => {\r\n                if (libraryItem.length !== targetLibraryItem.length) {\r\n                    return false;\r\n                }\r\n                // detect z-index difference by checking the excalidraw elements\r\n                // are in order\r\n                return libraryItem.every((libItemExcalidrawItem, idx) => {\r\n                    return (libItemExcalidrawItem.id === targetLibraryItem[idx].id &&\r\n                        libItemExcalidrawItem.versionNonce ===\r\n                            targetLibraryItem[idx].versionNonce);\r\n                });\r\n            });\r\n        };\r\n        const existingLibraryItems = await this.loadLibrary();\r\n        const filtered = libraryFile.library.reduce((acc, libraryItem) => {\r\n            const restoredItem = this.restoreLibraryItem(libraryItem);\r\n            if (restoredItem && isUniqueitem(existingLibraryItems, restoredItem)) {\r\n                acc.push(restoredItem);\r\n            }\r\n            return acc;\r\n        }, []);\r\n        await this.saveLibrary([...existingLibraryItems, ...filtered]);\r\n    }\r\n}\r\nexport default Library;\r\n","export const getCenter = (pointers) => {\r\n    const allCoords = Array.from(pointers.values());\r\n    return {\r\n        x: sum(allCoords, (coords) => coords.x) / allCoords.length,\r\n        y: sum(allCoords, (coords) => coords.y) / allCoords.length,\r\n    };\r\n};\r\nexport const getDistance = ([a, b]) => Math.hypot(a.x - b.x, a.y - b.y);\r\nconst sum = (array, mapper) => array.reduce((acc, item) => acc + mapper(item), 0);\r\n","import { isLinearElement } from \"./element/typeChecks\";\r\nimport { deepCopyElement } from \"./element/newElement\";\r\nconst clearAppStatePropertiesForHistory = (appState) => {\r\n    return {\r\n        selectedElementIds: appState.selectedElementIds,\r\n        selectedGroupIds: appState.selectedGroupIds,\r\n        viewBackgroundColor: appState.viewBackgroundColor,\r\n        editingLinearElement: appState.editingLinearElement,\r\n        editingGroupId: appState.editingGroupId,\r\n        name: appState.name,\r\n    };\r\n};\r\nclass History {\r\n    constructor() {\r\n        this.elementCache = new Map();\r\n        this.recording = true;\r\n        this.stateHistory = [];\r\n        this.redoStack = [];\r\n        this.lastEntry = null;\r\n        this.generateEntry = (appState, elements) => this.dehydrateHistoryEntry({\r\n            appState: clearAppStatePropertiesForHistory(appState),\r\n            elements: elements.reduce((elements, element) => {\r\n                if (isLinearElement(element) &&\r\n                    appState.multiElement &&\r\n                    appState.multiElement.id === element.id) {\r\n                    // don't store multi-point arrow if still has only one point\r\n                    if (appState.multiElement &&\r\n                        appState.multiElement.id === element.id &&\r\n                        element.points.length < 2) {\r\n                        return elements;\r\n                    }\r\n                    elements.push({\r\n                        ...element,\r\n                        // don't store last point if not committed\r\n                        points: element.lastCommittedPoint !==\r\n                            element.points[element.points.length - 1]\r\n                            ? element.points.slice(0, -1)\r\n                            : element.points,\r\n                    });\r\n                }\r\n                else {\r\n                    elements.push(element);\r\n                }\r\n                return elements;\r\n            }, []),\r\n        });\r\n    }\r\n    hydrateHistoryEntry({ appState, elements, }) {\r\n        return {\r\n            appState: JSON.parse(appState),\r\n            elements: elements.map((dehydratedExcalidrawElement) => {\r\n                const element = this.elementCache\r\n                    .get(dehydratedExcalidrawElement.id)\r\n                    ?.get(dehydratedExcalidrawElement.versionNonce);\r\n                if (!element) {\r\n                    throw new Error(`Element not found: ${dehydratedExcalidrawElement.id}:${dehydratedExcalidrawElement.versionNonce}`);\r\n                }\r\n                return element;\r\n            }),\r\n        };\r\n    }\r\n    dehydrateHistoryEntry({ appState, elements, }) {\r\n        return {\r\n            appState: JSON.stringify(appState),\r\n            elements: elements.map((element) => {\r\n                if (!this.elementCache.has(element.id)) {\r\n                    this.elementCache.set(element.id, new Map());\r\n                }\r\n                const versions = this.elementCache.get(element.id);\r\n                if (!versions.has(element.versionNonce)) {\r\n                    versions.set(element.versionNonce, deepCopyElement(element));\r\n                }\r\n                return {\r\n                    id: element.id,\r\n                    versionNonce: element.versionNonce,\r\n                };\r\n            }),\r\n        };\r\n    }\r\n    getSnapshotForTest() {\r\n        return {\r\n            recording: this.recording,\r\n            stateHistory: this.stateHistory.map((dehydratedHistoryEntry) => this.hydrateHistoryEntry(dehydratedHistoryEntry)),\r\n            redoStack: this.redoStack.map((dehydratedHistoryEntry) => this.hydrateHistoryEntry(dehydratedHistoryEntry)),\r\n        };\r\n    }\r\n    clear() {\r\n        this.stateHistory.length = 0;\r\n        this.redoStack.length = 0;\r\n        this.lastEntry = null;\r\n        this.elementCache.clear();\r\n    }\r\n    shouldCreateEntry(nextEntry) {\r\n        const { lastEntry } = this;\r\n        if (!lastEntry) {\r\n            return true;\r\n        }\r\n        if (nextEntry.elements.length !== lastEntry.elements.length) {\r\n            return true;\r\n        }\r\n        // loop from right to left as changes are likelier to happen on new elements\r\n        for (let i = nextEntry.elements.length - 1; i > -1; i--) {\r\n            const prev = nextEntry.elements[i];\r\n            const next = lastEntry.elements[i];\r\n            if (!prev ||\r\n                !next ||\r\n                prev.id !== next.id ||\r\n                prev.versionNonce !== next.versionNonce) {\r\n                return true;\r\n            }\r\n        }\r\n        // note: this is safe because entry's appState is guaranteed no excess props\r\n        let key;\r\n        for (key in nextEntry.appState) {\r\n            if (key === \"editingLinearElement\") {\r\n                if (nextEntry.appState[key]?.elementId ===\r\n                    lastEntry.appState[key]?.elementId) {\r\n                    continue;\r\n                }\r\n            }\r\n            if (key === \"selectedElementIds\" || key === \"selectedGroupIds\") {\r\n                continue;\r\n            }\r\n            if (nextEntry.appState[key] !== lastEntry.appState[key]) {\r\n                return true;\r\n            }\r\n        }\r\n        return false;\r\n    }\r\n    pushEntry(appState, elements) {\r\n        const newEntryDehydrated = this.generateEntry(appState, elements);\r\n        const newEntry = this.hydrateHistoryEntry(newEntryDehydrated);\r\n        if (newEntry) {\r\n            if (!this.shouldCreateEntry(newEntry)) {\r\n                return;\r\n            }\r\n            this.stateHistory.push(newEntryDehydrated);\r\n            this.lastEntry = newEntry;\r\n            // As a new entry was pushed, we invalidate the redo stack\r\n            this.clearRedoStack();\r\n        }\r\n    }\r\n    clearRedoStack() {\r\n        this.redoStack.splice(0, this.redoStack.length);\r\n    }\r\n    redoOnce() {\r\n        if (this.redoStack.length === 0) {\r\n            return null;\r\n        }\r\n        const entryToRestore = this.redoStack.pop();\r\n        if (entryToRestore !== undefined) {\r\n            this.stateHistory.push(entryToRestore);\r\n            return this.hydrateHistoryEntry(entryToRestore);\r\n        }\r\n        return null;\r\n    }\r\n    undoOnce() {\r\n        if (this.stateHistory.length === 1) {\r\n            return null;\r\n        }\r\n        const currentEntry = this.stateHistory.pop();\r\n        const entryToRestore = this.stateHistory[this.stateHistory.length - 1];\r\n        if (currentEntry !== undefined) {\r\n            this.redoStack.push(currentEntry);\r\n            return this.hydrateHistoryEntry(entryToRestore);\r\n        }\r\n        return null;\r\n    }\r\n    /**\r\n     * Updates history's `lastEntry` to latest app state. This is necessary\r\n     *  when doing undo/redo which itself doesn't commit to history, but updates\r\n     *  app state in a way that would break `shouldCreateEntry` which relies on\r\n     *  `lastEntry` to reflect last comittable history state.\r\n     * We can't update `lastEntry` from within history when calling undo/redo\r\n     *  because the action potentially mutates appState/elements before storing\r\n     *  it.\r\n     */\r\n    setCurrentState(appState, elements) {\r\n        this.lastEntry = this.hydrateHistoryEntry(this.generateEntry(appState, elements));\r\n    }\r\n    // Suspicious that this is called so many places. Seems error-prone.\r\n    resumeRecording() {\r\n        this.recording = true;\r\n    }\r\n    record(state, elements) {\r\n        if (this.recording) {\r\n            this.pushEntry(state, elements);\r\n            this.recording = false;\r\n        }\r\n    }\r\n}\r\nexport default History;\r\n","import { KEYS } from \"./keys\";\r\n// We inline font-awesome icons in order to save on js size rather than including the font awesome react library\r\nexport const SHAPES = [\r\n    {\r\n        icon: (\r\n        // fa-mouse-pointer\r\n        <svg viewBox=\"0 0 320 512\" className=\"\">\r\n        <path d=\"M302.189 329.126H196.105l55.831 135.993c3.889 9.428-.555 19.999-9.444 23.999l-49.165 21.427c-9.165 4-19.443-.571-23.332-9.714l-53.053-129.136-86.664 89.138C18.729 472.71 0 463.554 0 447.977V18.299C0 1.899 19.921-6.096 30.277 5.443l284.412 292.542c11.472 11.179 3.007 31.141-12.5 31.141z\"/>\r\n      </svg>),\r\n        value: \"selection\",\r\n        key: KEYS.V,\r\n    },\r\n    {\r\n        icon: (\r\n        // fa-square\r\n        <svg viewBox=\"0 0 448 512\">\r\n        <path d=\"M400 32H48C21.5 32 0 53.5 0 80v352c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48V80c0-26.5-21.5-48-48-48z\"/>\r\n      </svg>),\r\n        value: \"rectangle\",\r\n        key: KEYS.R,\r\n    },\r\n    {\r\n        icon: (\r\n        // custom\r\n        <svg viewBox=\"0 0 223.646 223.646\">\r\n        <path d=\"M111.823 0L16.622 111.823 111.823 223.646 207.025 111.823z\"/>\r\n      </svg>),\r\n        value: \"diamond\",\r\n        key: KEYS.D,\r\n    },\r\n    {\r\n        icon: (\r\n        // fa-circle\r\n        <svg viewBox=\"0 0 512 512\">\r\n        <path d=\"M256 8C119 8 8 119 8 256s111 248 248 248 248-111 248-248S393 8 256 8z\"/>\r\n      </svg>),\r\n        value: \"ellipse\",\r\n        key: KEYS.E,\r\n    },\r\n    {\r\n        icon: (\r\n        // fa-long-arrow-alt-right\r\n        <svg viewBox=\"0 0 448 512\" className=\"rtl-mirror\">\r\n        <path d=\"M313.941 216H12c-6.627 0-12 5.373-12 12v56c0 6.627 5.373 12 12 12h301.941v46.059c0 21.382 25.851 32.09 40.971 16.971l86.059-86.059c9.373-9.373 9.373-24.569 0-33.941l-86.059-86.059c-15.119-15.119-40.971-4.411-40.971 16.971V216z\"/>\r\n      </svg>),\r\n        value: \"arrow\",\r\n        key: KEYS.A,\r\n    },\r\n    {\r\n        icon: (\r\n        // custom\r\n        <svg viewBox=\"0 0 6 6\">\r\n        <line x1=\"0\" y1=\"3\" x2=\"6\" y2=\"3\" stroke=\"currentColor\" strokeLinecap=\"round\"/>\r\n      </svg>),\r\n        value: \"line\",\r\n        key: [KEYS.P, KEYS.L],\r\n    },\r\n    {\r\n        icon: (\r\n        // fa-pencil\r\n        <svg viewBox=\"0 0 512 512\">\r\n        <path fill=\"currentColor\" d=\"M290.74 93.24l128.02 128.02-277.99 277.99-114.14 12.6C11.35 513.54-1.56 500.62.14 485.34l12.7-114.22 277.9-277.88zm207.2-19.06l-60.11-60.11c-18.75-18.75-49.16-18.75-67.91 0l-56.55 56.55 128.02 128.02 56.55-56.55c18.75-18.76 18.75-49.16 0-67.91z\"></path>\r\n      </svg>),\r\n        value: \"freedraw\",\r\n        key: KEYS.X,\r\n    },\r\n    {\r\n        icon: (\r\n        // fa-font\r\n        <svg viewBox=\"0 0 448 512\">\r\n        <path d=\"M432 416h-23.41L277.88 53.69A32 32 0 0 0 247.58 32h-47.16a32 32 0 0 0-30.3 21.69L39.41 416H16a16 16 0 0 0-16 16v32a16 16 0 0 0 16 16h128a16 16 0 0 0 16-16v-32a16 16 0 0 0-16-16h-19.58l23.3-64h152.56l23.3 64H304a16 16 0 0 0-16 16v32a16 16 0 0 0 16 16h128a16 16 0 0 0 16-16v-32a16 16 0 0 0-16-16zM176.85 272L224 142.51 271.15 272z\"/>\r\n      </svg>),\r\n        value: \"text\",\r\n        key: KEYS.T,\r\n    },\r\n    {\r\n        icon: (\r\n        // fa-image\r\n        <svg viewBox=\"0 0 512 512\">\r\n        <path fill=\"currentColor\" d=\"M464 64H48C21.49 64 0 85.49 0 112v288c0 26.51 21.49 48 48 48h416c26.51 0 48-21.49 48-48V112c0-26.51-21.49-48-48-48zm-6 336H54a6 6 0 0 1-6-6V118a6 6 0 0 1 6-6h404a6 6 0 0 1 6 6v276a6 6 0 0 1-6 6zM128 152c-22.091 0-40 17.909-40 40s17.909 40 40 40 40-17.909 40-40-17.909-40-40-40zM96 352h320v-80l-87.515-87.515c-4.686-4.686-12.284-4.686-16.971 0L192 304l-39.515-39.515c-4.686-4.686-12.284-4.686-16.971 0L96 304v48z\"></path>\r\n      </svg>),\r\n        value: \"image\",\r\n        key: null,\r\n    },\r\n];\r\nexport const findShapeByKey = (key) => {\r\n    const shape = SHAPES.find((shape, index) => {\r\n        return (key === (index + 1).toString() ||\r\n            (shape.key &&\r\n                (typeof shape.key === \"string\"\r\n                    ? shape.key === key\r\n                    : shape.key.includes(key))));\r\n    });\r\n    return shape?.value || null;\r\n};\r\n","import { t } from \"../i18n\";\r\nimport { isDarwin } from \"../keys\";\r\nimport { getShortcutKey } from \"../utils\";\r\nconst shortcutMap = {\r\n    cut: [getShortcutKey(\"CtrlOrCmd+X\")],\r\n    copy: [getShortcutKey(\"CtrlOrCmd+C\")],\r\n    paste: [getShortcutKey(\"CtrlOrCmd+V\")],\r\n    copyStyles: [getShortcutKey(\"CtrlOrCmd+Alt+C\")],\r\n    pasteStyles: [getShortcutKey(\"CtrlOrCmd+Alt+V\")],\r\n    selectAll: [getShortcutKey(\"CtrlOrCmd+A\")],\r\n    deleteSelectedElements: [getShortcutKey(\"Del\")],\r\n    duplicateSelection: [\r\n        getShortcutKey(\"CtrlOrCmd+D\"),\r\n        getShortcutKey(`Alt+${t(\"helpDialog.drag\")}`),\r\n    ],\r\n    sendBackward: [getShortcutKey(\"CtrlOrCmd+[\")],\r\n    bringForward: [getShortcutKey(\"CtrlOrCmd+]\")],\r\n    sendToBack: [\r\n        isDarwin\r\n            ? getShortcutKey(\"CtrlOrCmd+Alt+[\")\r\n            : getShortcutKey(\"CtrlOrCmd+Shift+[\"),\r\n    ],\r\n    bringToFront: [\r\n        isDarwin\r\n            ? getShortcutKey(\"CtrlOrCmd+Alt+]\")\r\n            : getShortcutKey(\"CtrlOrCmd+Shift+]\"),\r\n    ],\r\n    copyAsPng: [getShortcutKey(\"Shift+Alt+C\")],\r\n    copyAsSvg: [],\r\n    group: [getShortcutKey(\"CtrlOrCmd+G\")],\r\n    ungroup: [getShortcutKey(\"CtrlOrCmd+Shift+G\")],\r\n    gridMode: [getShortcutKey(\"CtrlOrCmd+'\")],\r\n    zenMode: [getShortcutKey(\"Alt+Z\")],\r\n    stats: [getShortcutKey(\"Alt+/\")],\r\n    addToLibrary: [],\r\n    flipHorizontal: [getShortcutKey(\"Shift+H\")],\r\n    flipVertical: [getShortcutKey(\"Shift+V\")],\r\n    viewMode: [getShortcutKey(\"Alt+R\")],\r\n};\r\nexport const getShortcutFromShortcutName = (name) => {\r\n    const shortcuts = shortcutMap[name];\r\n    // if multiple shortcuts availiable, take the first one\r\n    return shortcuts && shortcuts.length > 0 ? shortcuts[0] : \"\";\r\n};\r\n","import { render, unmountComponentAtNode } from \"react-dom\";\r\nimport clsx from \"clsx\";\r\nimport { Popover } from \"./Popover\";\r\nimport { t } from \"../i18n\";\r\nimport \"./ContextMenu.scss\";\r\nimport { getShortcutFromShortcutName, } from \"../actions/shortcuts\";\r\nconst ContextMenu = ({ options, onCloseRequest, top, left, actionManager, appState, }) => {\r\n    return (<Popover onCloseRequest={onCloseRequest} top={top} left={left} fitInViewport={true}>\r\n      <ul className=\"context-menu\" onContextMenu={(event) => event.preventDefault()}>\r\n        {options.map((option, idx) => {\r\n            if (option === \"separator\") {\r\n                return <hr key={idx} className=\"context-menu-option-separator\"/>;\r\n            }\r\n            const actionName = option.name;\r\n            const label = option.contextItemLabel\r\n                ? t(option.contextItemLabel)\r\n                : \"\";\r\n            return (<li key={idx} data-testid={actionName} onClick={onCloseRequest}>\r\n              <button className={clsx(\"context-menu-option\", {\r\n                    dangerous: actionName === \"deleteSelectedElements\",\r\n                    checkmark: option.checked?.(appState),\r\n                })} onClick={() => actionManager.executeAction(option)}>\r\n                <div className=\"context-menu-option__label\">{label}</div>\r\n                <kbd className=\"context-menu-option__shortcut\">\r\n                  {actionName\r\n                    ? getShortcutFromShortcutName(actionName)\r\n                    : \"\"}\r\n                </kbd>\r\n              </button>\r\n            </li>);\r\n        })}\r\n      </ul>\r\n    </Popover>);\r\n};\r\nconst contextMenuNodeByContainer = new WeakMap();\r\nconst getContextMenuNode = (container) => {\r\n    let contextMenuNode = contextMenuNodeByContainer.get(container);\r\n    if (contextMenuNode) {\r\n        return contextMenuNode;\r\n    }\r\n    contextMenuNode = document.createElement(\"div\");\r\n    container\r\n        .querySelector(\".excalidraw-contextMenuContainer\")\r\n        .appendChild(contextMenuNode);\r\n    contextMenuNodeByContainer.set(container, contextMenuNode);\r\n    return contextMenuNode;\r\n};\r\nconst handleClose = (container) => {\r\n    const contextMenuNode = contextMenuNodeByContainer.get(container);\r\n    if (contextMenuNode) {\r\n        unmountComponentAtNode(contextMenuNode);\r\n        contextMenuNode.remove();\r\n        contextMenuNodeByContainer.delete(container);\r\n    }\r\n};\r\nexport default {\r\n    push(params) {\r\n        const options = Array.of();\r\n        params.options.forEach((option) => {\r\n            if (option) {\r\n                options.push(option);\r\n            }\r\n        });\r\n        if (options.length) {\r\n            render(<ContextMenu top={params.top} left={params.left} options={options} onCloseRequest={() => handleClose(params.container)} actionManager={params.actionManager} appState={params.appState}/>, getContextMenuNode(params.container));\r\n        }\r\n    },\r\n};\r\n","import React from \"react\";\r\nimport { getNonDeletedElements } from \"../element\";\r\nimport { t } from \"../i18n\";\r\nimport { useIsMobile } from \"../components/App\";\r\nimport { canChangeSharpness, canHaveArrowheads, getTargetElements, hasBackground, hasStrokeStyle, hasStrokeWidth, hasText, } from \"../scene\";\r\nimport { SHAPES } from \"../shapes\";\r\nimport { capitalizeString, isTransparent, setCursorForShape } from \"../utils\";\r\nimport Stack from \"./Stack\";\r\nimport { ToolButton } from \"./ToolButton\";\r\nimport { hasStrokeColor } from \"../scene/comparisons\";\r\nexport const SelectedShapeActions = ({ appState, elements, renderAction, elementType, }) => {\r\n    const targetElements = getTargetElements(getNonDeletedElements(elements), appState);\r\n    const isEditing = Boolean(appState.editingElement);\r\n    const isMobile = useIsMobile();\r\n    const isRTL = document.documentElement.getAttribute(\"dir\") === \"rtl\";\r\n    const showFillIcons = hasBackground(elementType) ||\r\n        targetElements.some((element) => hasBackground(element.type) && !isTransparent(element.backgroundColor));\r\n    const showChangeBackgroundIcons = hasBackground(elementType) ||\r\n        targetElements.some((element) => hasBackground(element.type));\r\n    let commonSelectedType = targetElements[0]?.type || null;\r\n    for (const element of targetElements) {\r\n        if (element.type !== commonSelectedType) {\r\n            commonSelectedType = null;\r\n            break;\r\n        }\r\n    }\r\n    return (<div className=\"panelColumn\">\r\n      {((hasStrokeColor(elementType) &&\r\n            elementType !== \"image\" &&\r\n            commonSelectedType !== \"image\") ||\r\n            targetElements.some((element) => hasStrokeColor(element.type))) &&\r\n            renderAction(\"changeStrokeColor\")}\r\n      {showChangeBackgroundIcons && renderAction(\"changeBackgroundColor\")}\r\n      {showFillIcons && renderAction(\"changeFillStyle\")}\r\n\r\n      {(hasStrokeWidth(elementType) ||\r\n            targetElements.some((element) => hasStrokeWidth(element.type))) &&\r\n            renderAction(\"changeStrokeWidth\")}\r\n\r\n      {(elementType === \"freedraw\" ||\r\n            targetElements.some((element) => element.type === \"freedraw\")) &&\r\n            renderAction(\"changeStrokeShape\")}\r\n\r\n      {(hasStrokeStyle(elementType) ||\r\n            targetElements.some((element) => hasStrokeStyle(element.type))) && (<>\r\n          {renderAction(\"changeStrokeStyle\")}\r\n          {renderAction(\"changeSloppiness\")}\r\n        </>)}\r\n\r\n      {(canChangeSharpness(elementType) ||\r\n            targetElements.some((element) => canChangeSharpness(element.type))) && (<>{renderAction(\"changeSharpness\")}</>)}\r\n\r\n      {(hasText(elementType) ||\r\n            targetElements.some((element) => hasText(element.type))) && (<>\r\n          {renderAction(\"changeFontSize\")}\r\n\r\n          {renderAction(\"changeFontFamily\")}\r\n\r\n          {renderAction(\"changeTextAlign\")}\r\n        </>)}\r\n\r\n      {(canHaveArrowheads(elementType) ||\r\n            targetElements.some((element) => canHaveArrowheads(element.type))) && (<>{renderAction(\"changeArrowhead\")}</>)}\r\n\r\n      {renderAction(\"changeOpacity\")}\r\n\r\n      <fieldset>\r\n        <legend>{t(\"labels.layers\")}</legend>\r\n        <div className=\"buttonList\">\r\n          {renderAction(\"sendToBack\")}\r\n          {renderAction(\"sendBackward\")}\r\n          {renderAction(\"bringToFront\")}\r\n          {renderAction(\"bringForward\")}\r\n        </div>\r\n      </fieldset>\r\n\r\n      {targetElements.length > 1 && (<fieldset>\r\n          <legend>{t(\"labels.align\")}</legend>\r\n          <div className=\"buttonList\">\r\n            {\r\n            // swap this order for RTL so the button positions always match their action\r\n            // (i.e. the leftmost button aligns left)\r\n            }\r\n            {isRTL ? (<>\r\n                {renderAction(\"alignRight\")}\r\n                {renderAction(\"alignHorizontallyCentered\")}\r\n                {renderAction(\"alignLeft\")}\r\n              </>) : (<>\r\n                {renderAction(\"alignLeft\")}\r\n                {renderAction(\"alignHorizontallyCentered\")}\r\n                {renderAction(\"alignRight\")}\r\n              </>)}\r\n            {targetElements.length > 2 &&\r\n                renderAction(\"distributeHorizontally\")}\r\n            <div className=\"iconRow\">\r\n              {renderAction(\"alignTop\")}\r\n              {renderAction(\"alignVerticallyCentered\")}\r\n              {renderAction(\"alignBottom\")}\r\n              {targetElements.length > 2 &&\r\n                renderAction(\"distributeVertically\")}\r\n            </div>\r\n          </div>\r\n        </fieldset>)}\r\n      {!isMobile && !isEditing && targetElements.length > 0 && (<fieldset>\r\n          <legend>{t(\"labels.actions\")}</legend>\r\n          <div className=\"buttonList\">\r\n            {renderAction(\"duplicateSelection\")}\r\n            {renderAction(\"deleteSelectedElements\")}\r\n            {renderAction(\"group\")}\r\n            {renderAction(\"ungroup\")}\r\n          </div>\r\n        </fieldset>)}\r\n    </div>);\r\n};\r\nexport const ShapesSwitcher = ({ canvas, elementType, setAppState, onImageAction, }) => (<>\r\n    {SHAPES.map(({ value, icon, key }, index) => {\r\n        const label = t(`toolBar.${value}`);\r\n        const letter = key && (typeof key === \"string\" ? key : key[0]);\r\n        const shortcut = letter\r\n            ? `${capitalizeString(letter)} ${t(\"helpDialog.or\")} ${index + 1}`\r\n            : `${index + 1}`;\r\n        return (<ToolButton className=\"Shape\" key={value} type=\"radio\" icon={icon} checked={elementType === value} name=\"editor-current-shape\" title={`${capitalizeString(label)}  ${shortcut}`} keyBindingLabel={`${index + 1}`} aria-label={capitalizeString(label)} aria-keyshortcuts={shortcut} data-testid={value} onChange={({ pointerType }) => {\r\n                setAppState({\r\n                    elementType: value,\r\n                    multiElement: null,\r\n                    selectedElementIds: {},\r\n                });\r\n                setCursorForShape(canvas, value);\r\n                if (value === \"image\") {\r\n                    onImageAction({ pointerType });\r\n                }\r\n            }}/>);\r\n    })}\r\n  </>);\r\nexport const ZoomActions = ({ renderAction, zoom, }) => (<Stack.Col gap={1}>\r\n    <Stack.Row gap={1} align=\"center\">\r\n      {renderAction(\"zoomOut\")}\r\n      {renderAction(\"zoomIn\")}\r\n      {renderAction(\"resetZoom\")}\r\n    </Stack.Row>\r\n  </Stack.Col>);\r\n","import React from \"react\";\r\nexport const BackgroundPickerAndDarkModeToggle = ({ appState, setAppState, actionManager, showThemeBtn, }) => (<div style={{ display: \"flex\" }}>\r\n    {actionManager.renderAction(\"changeViewBackgroundColor\")}\r\n    {showThemeBtn && actionManager.renderAction(\"toggleTheme\")}\r\n  </div>);\r\n","import clsx from \"clsx\";\r\nimport { ToolButton } from \"./ToolButton\";\r\nimport { t } from \"../i18n\";\r\nimport { useIsMobile } from \"../components/App\";\r\nimport { users } from \"./icons\";\r\nimport \"./CollabButton.scss\";\r\nconst CollabButton = ({ isCollaborating, collaboratorCount, onClick, }) => {\r\n    return (<>\r\n      {/* <ToolButton className={clsx(\"CollabButton\", {\r\n            \"is-collaborating\": isCollaborating,\r\n        })} onClick={onClick} icon={users} type=\"button\" title={t(\"labels.liveCollaboration\")} aria-label={t(\"labels.liveCollaboration\")} showAriaLabel={useIsMobile()}>\r\n        {collaboratorCount > 0 && (<div className=\"CollabButton-collaborators\">{collaboratorCount}</div>)}\r\n      </ToolButton> */}\r\n    </>);\r\n};\r\nexport default CollabButton;\r\n","export const libraries = (data) => {\r\n  //console.log(data)\r\n  if (data === \"maths\") {\r\n    return {\r\n      type: \"chalkboardlib\",\r\n      version: 1,\r\n      library: [\r\n        [\r\n          {\r\n            type: \"line\",\r\n            version: 1699,\r\n            versionNonce: 1813275999,\r\n            isDeleted: false,\r\n            id: \"1OMHrnYMU3LJ3w3IaXU_R\",\r\n            fillStyle: \"hachure\",\r\n            strokeWidth: 1,\r\n            strokeStyle: \"solid\",\r\n            roughness: 1,\r\n            opacity: 100,\r\n            angle: 0,\r\n            x: 209.72304760646858,\r\n            y: 338.83587294718825,\r\n            strokeColor: \"#881fa3\",\r\n            backgroundColor: \"#be4bdb\",\r\n            width: 116.42036295658873,\r\n            height: 103.65107323746608,\r\n            seed: 1445523839,\r\n            groupIds: [],\r\n            strokeSharpness: \"sharp\",\r\n            boundElementIds: [],\r\n            startBinding: null,\r\n            endBinding: null,\r\n            points: [\r\n              [-92.28090097254909, 7.105427357601002e-15],\r\n              [-154.72281841151394, 19.199290805487394],\r\n              [-155.45758928571422, 79.43840749607878],\r\n              [-99.89923520113778, 103.6510732374661],\r\n              [-40.317783799181804, 79.1587107641305],\r\n              [-39.037226329125524, 21.285677238400705],\r\n              [-92.28090097254909, 7.105427357601002e-15],\r\n            ],\r\n            lastCommittedPoint: null,\r\n            startArrowhead: null,\r\n            endArrowhead: null,\r\n          },\r\n        ],\r\n        [\r\n          {\r\n            id: \"b-rwW8s76ztV_uTu1SHq1\",\r\n            type: \"line\",\r\n            x: -249.48446738689245,\r\n            y: 374.851387389359,\r\n            width: 88.21658171083376,\r\n            height: 113.8575037534261,\r\n            angle: 0,\r\n            strokeColor: \"#0a11d3\",\r\n            backgroundColor: \"#228be6\",\r\n            fillStyle: \"solid\",\r\n            strokeWidth: 1,\r\n            strokeStyle: \"solid\",\r\n            roughness: 1,\r\n            opacity: 100,\r\n            groupIds: [\"N2YAi9nU-wlRb0rDaDZoe\"],\r\n            strokeSharpness: \"round\",\r\n            seed: 1513238033,\r\n            version: 3901,\r\n            versionNonce: 540959103,\r\n            isDeleted: false,\r\n            boundElementIds: null,\r\n            points: [\r\n              [-0.22814350714115691, -43.414939319563715],\r\n              [0.06274947619197979, 42.63794490105306],\r\n              [-0.21453039840335475, 52.43469208825097],\r\n              [4.315205554872581, 56.66774540453215],\r\n              [20.089784992984285, 60.25027917349701],\r\n              [46.7532926683984, 61.365826671969444],\r\n              [72.22851104292477, 59.584691681394986],\r\n              [85.76368213524371, 55.325139565662596],\r\n              [87.67263486434864, 51.7342924478499],\r\n              [87.94074036468018, 43.84700272879395],\r\n              [87.73030872197806, -36.195582644606276],\r\n              [87.2559282533682, -43.758132174307036],\r\n              [81.5915337527493, -47.984890854524416],\r\n              [69.66352776578219, -50.4328058257654],\r\n              [42.481213744224995, -52.49167708145666],\r\n              [20.68789182864576, -51.26396751574663],\r\n              [3.5475921483286084, -47.099726468136254],\r\n              [-0.2758413461535838, -43.46664538034193],\r\n              [-0.22814350714115691, -43.414939319563715],\r\n            ],\r\n            lastCommittedPoint: [1.0602678571428896, 551.8638392857142],\r\n            startBinding: null,\r\n            endBinding: null,\r\n            startArrowhead: null,\r\n            endArrowhead: null,\r\n          },\r\n          {\r\n            id: \"3CMZYj34FwjhgPB7jUC3f\",\r\n            type: \"line\",\r\n            x: -249.02524930453623,\r\n            y: 398.8804363713438,\r\n            width: 88.30808627974527,\r\n            height: 9.797916664247975,\r\n            angle: 0,\r\n            strokeColor: \"#0a11d3\",\r\n            backgroundColor: \"transparent\",\r\n            fillStyle: \"solid\",\r\n            strokeWidth: 1,\r\n            strokeStyle: \"solid\",\r\n            roughness: 1,\r\n            opacity: 100,\r\n            groupIds: [\"N2YAi9nU-wlRb0rDaDZoe\"],\r\n            strokeSharpness: \"round\",\r\n            seed: 683951089,\r\n            version: 1635,\r\n            versionNonce: 1383184881,\r\n            isDeleted: false,\r\n            boundElementIds: null,\r\n            points: [\r\n              [0, -2.1538602707609424],\r\n              [2.326538897826852, 1.751753055375216],\r\n              [12.359939318521995, 5.028526743934819],\r\n              [25.710950037209347, 7.012921076245119],\r\n              [46.6269757640547, 7.193749997581346],\r\n              [71.03526003420632, 5.930375670950649],\r\n              [85.2899738827162, 1.3342483900732343],\r\n              [88.30808627974527, -2.6041666666666288],\r\n            ],\r\n            lastCommittedPoint: [510.69444444444457, -2.6041666666666288],\r\n            startBinding: null,\r\n            endBinding: null,\r\n            startArrowhead: null,\r\n            endArrowhead: null,\r\n          },\r\n          {\r\n            id: \"DX3fUhBWtlJwYyrBDhebG\",\r\n            type: \"line\",\r\n            x: -250.11899081659772,\r\n            y: 365.80628180927204,\r\n            width: 88.30808627974527,\r\n            height: 9.797916664247975,\r\n            angle: 0,\r\n            strokeColor: \"#0a11d3\",\r\n            backgroundColor: \"transparent\",\r\n            fillStyle: \"solid\",\r\n            strokeWidth: 1,\r\n            strokeStyle: \"solid\",\r\n            roughness: 1,\r\n            opacity: 100,\r\n            groupIds: [\"N2YAi9nU-wlRb0rDaDZoe\"],\r\n            strokeSharpness: \"round\",\r\n            seed: 1817746897,\r\n            version: 1722,\r\n            versionNonce: 303290783,\r\n            isDeleted: false,\r\n            boundElementIds: null,\r\n            points: [\r\n              [0, -2.1538602707609424],\r\n              [2.326538897826852, 1.751753055375216],\r\n              [12.359939318521995, 5.028526743934819],\r\n              [25.710950037209347, 7.012921076245119],\r\n              [46.6269757640547, 7.193749997581346],\r\n              [71.03526003420632, 5.930375670950649],\r\n              [85.2899738827162, 1.3342483900732343],\r\n              [88.30808627974527, -2.6041666666666288],\r\n            ],\r\n            lastCommittedPoint: [510.69444444444457, -2.6041666666666288],\r\n            startBinding: null,\r\n            endBinding: null,\r\n            startArrowhead: null,\r\n            endArrowhead: null,\r\n          },\r\n          {\r\n            type: \"ellipse\",\r\n            version: 4738,\r\n            versionNonce: 753357777,\r\n            isDeleted: false,\r\n            id: \"a-Snvp2FgqDYqSLylF44S\",\r\n            fillStyle: \"solid\",\r\n            strokeWidth: 1,\r\n            strokeStyle: \"solid\",\r\n            roughness: 1,\r\n            opacity: 100,\r\n            angle: 0,\r\n            x: -251.23981350275943,\r\n            y: 323.4117518426986,\r\n            strokeColor: \"#0a11d3\",\r\n            backgroundColor: \"#fff\",\r\n            width: 87.65074610854188,\r\n            height: 17.72670397681366,\r\n            seed: 1409727409,\r\n            groupIds: [\"N2YAi9nU-wlRb0rDaDZoe\"],\r\n            strokeSharpness: \"sharp\",\r\n            boundElementIds: [\"bxuMGTzXLn7H-uBCptINx\"],\r\n          },\r\n          {\r\n            id: \"7-6c-JFuB2yGoNQRgb2WM\",\r\n            type: \"ellipse\",\r\n            x: -179.73008120217884,\r\n            y: 347.98755471983213,\r\n            width: 12.846057046979809,\r\n            height: 13.941904362416096,\r\n            angle: 0,\r\n            strokeColor: \"#0a11d3\",\r\n            backgroundColor: \"#fff\",\r\n            fillStyle: \"solid\",\r\n            strokeWidth: 1,\r\n            strokeStyle: \"solid\",\r\n            roughness: 1,\r\n            opacity: 100,\r\n            groupIds: [\"N2YAi9nU-wlRb0rDaDZoe\"],\r\n            strokeSharpness: \"sharp\",\r\n            seed: 1073094033,\r\n            version: 109,\r\n            versionNonce: 1992641983,\r\n            isDeleted: false,\r\n            boundElementIds: null,\r\n          },\r\n          {\r\n            id: \"150XitJtlKDhTPRCyzv56\",\r\n            type: \"ellipse\",\r\n            x: -179.73008120217884,\r\n            y: 378.5900085788926,\r\n            width: 12.846057046979809,\r\n            height: 13.941904362416096,\r\n            angle: 0,\r\n            strokeColor: \"#0a11d3\",\r\n            backgroundColor: \"#fff\",\r\n            fillStyle: \"solid\",\r\n            strokeWidth: 1,\r\n            strokeStyle: \"solid\",\r\n            roughness: 1,\r\n            opacity: 100,\r\n            groupIds: [\"N2YAi9nU-wlRb0rDaDZoe\"],\r\n            strokeSharpness: \"sharp\",\r\n            seed: 526271345,\r\n            version: 158,\r\n            versionNonce: 1028567473,\r\n            isDeleted: false,\r\n            boundElementIds: null,\r\n          },\r\n          {\r\n            id: \"cmwAR3NBl1VqvSorrQN2W\",\r\n            type: \"ellipse\",\r\n            x: -179.73008120217884,\r\n            y: 411.8508097533892,\r\n            width: 12.846057046979809,\r\n            height: 13.941904362416096,\r\n            angle: 0,\r\n            strokeColor: \"#0a11d3\",\r\n            backgroundColor: \"#fff\",\r\n            fillStyle: \"solid\",\r\n            strokeWidth: 1,\r\n            strokeStyle: \"solid\",\r\n            roughness: 1,\r\n            opacity: 100,\r\n            groupIds: [\"N2YAi9nU-wlRb0rDaDZoe\"],\r\n            strokeSharpness: \"sharp\",\r\n            seed: 243707217,\r\n            version: 212,\r\n            versionNonce: 158547423,\r\n            isDeleted: false,\r\n            boundElementIds: null,\r\n          },\r\n        ],\r\n        [\r\n          {\r\n            id: \"aDDArXRjZugwyEawdhCeZ\",\r\n            type: \"diamond\",\r\n            x: -109.55894395256101,\r\n            y: 381.22641397493356,\r\n            width: 112.64736525303451,\r\n            height: 36.77344700318558,\r\n            angle: 0,\r\n            strokeColor: \"#c92a2a\",\r\n            backgroundColor: \"#fd8888\",\r\n            fillStyle: \"solid\",\r\n            strokeWidth: 1,\r\n            strokeStyle: \"solid\",\r\n            roughness: 1,\r\n            opacity: 100,\r\n            groupIds: [\"M6ByXuSmtHCr3RtPPKJQh\"],\r\n            strokeSharpness: \"sharp\",\r\n            seed: 511870335,\r\n            version: 659,\r\n            versionNonce: 1294871039,\r\n            isDeleted: false,\r\n            boundElementIds: null,\r\n          },\r\n          {\r\n            id: \"Hzx8zkeyDs3YicO2Tdv6G\",\r\n            type: \"diamond\",\r\n            x: -109.55894395256101,\r\n            y: 372.354634046675,\r\n            width: 112.64736525303451,\r\n            height: 36.77344700318558,\r\n            angle: 0,\r\n            strokeColor: \"#c92a2a\",\r\n            backgroundColor: \"#fd8888\",\r\n            fillStyle: \"solid\",\r\n            strokeWidth: 1,\r\n            strokeStyle: \"solid\",\r\n            roughness: 1,\r\n            opacity: 100,\r\n            groupIds: [\"M6ByXuSmtHCr3RtPPKJQh\"],\r\n            strokeSharpness: \"sharp\",\r\n            seed: 1283079231,\r\n            version: 700,\r\n            versionNonce: 60864881,\r\n            isDeleted: false,\r\n            boundElementIds: null,\r\n          },\r\n          {\r\n            id: \"PNzYhT295VNCT5EXmqvmw\",\r\n            type: \"diamond\",\r\n            x: -109.55894395256101,\r\n            y: 359.72407445196296,\r\n            width: 112.64736525303451,\r\n            height: 36.77344700318558,\r\n            angle: 0,\r\n            strokeColor: \"#c92a2a\",\r\n            backgroundColor: \"#fd8888\",\r\n            fillStyle: \"solid\",\r\n            strokeWidth: 1,\r\n            strokeStyle: \"solid\",\r\n            roughness: 1,\r\n            opacity: 100,\r\n            groupIds: [\"M6ByXuSmtHCr3RtPPKJQh\"],\r\n            strokeSharpness: \"sharp\",\r\n            seed: 996251633,\r\n            version: 780,\r\n            versionNonce: 251040287,\r\n            isDeleted: false,\r\n            boundElementIds: null,\r\n          },\r\n          {\r\n            id: \"jiMMAhQF3__7bF-obgXc0\",\r\n            type: \"diamond\",\r\n            x: -109.55894395256101,\r\n            y: 347.1924021546656,\r\n            width: 112.64736525303451,\r\n            height: 36.77344700318558,\r\n            angle: 0,\r\n            strokeColor: \"#c92a2a\",\r\n            backgroundColor: \"#fd8888\",\r\n            fillStyle: \"solid\",\r\n            strokeWidth: 1,\r\n            strokeStyle: \"solid\",\r\n            roughness: 1,\r\n            opacity: 100,\r\n            groupIds: [\"M6ByXuSmtHCr3RtPPKJQh\"],\r\n            strokeSharpness: \"sharp\",\r\n            seed: 1764842481,\r\n            version: 822,\r\n            versionNonce: 1862951761,\r\n            isDeleted: false,\r\n            boundElementIds: null,\r\n          },\r\n        ],\r\n        [\r\n          {\r\n            id: \"BXfdLRoPYZ9MIumzzoA9-\",\r\n            type: \"line\",\r\n            x: -471.6208001976387,\r\n            y: 520.7681448415112,\r\n            width: 52.317507746132115,\r\n            height: 154.56722543646003,\r\n            angle: 1.5707963267948957,\r\n            strokeColor: \"#087f5b\",\r\n            backgroundColor: \"#40c057\",\r\n            fillStyle: \"hachure\",\r\n            strokeWidth: 1,\r\n            strokeStyle: \"solid\",\r\n            roughness: 1,\r\n            opacity: 100,\r\n            groupIds: [\"HSrtfEf-CssQTf160Fb6R\"],\r\n            strokeSharpness: \"round\",\r\n            seed: 1424381745,\r\n            version: 4766,\r\n            versionNonce: 2003030321,\r\n            isDeleted: false,\r\n            boundElementIds: null,\r\n            points: [\r\n              [-0.24755378372925183, -40.169554027464216],\r\n              [-0.07503751055611152, 76.6515171914404],\r\n              [-0.23948042713317108, 89.95108885873196],\r\n              [2.446913573036335, 95.69766931810295],\r\n              [11.802146636255692, 100.56113713047068],\r\n              [27.615140546177496, 102.07554835500338],\r\n              [42.72341054254274, 99.65756899883291],\r\n              [50.75054563137204, 93.87501510096598],\r\n              [51.88266441510958, 89.00026150397161],\r\n              [52.04166639997853, 78.29287333983132],\r\n              [51.916868330459295, -30.36891819848148],\r\n              [51.635533423123285, -40.63545540065934],\r\n              [48.27622163143906, -46.37349057843314],\r\n              [41.202227904674494, -49.69665692879073],\r\n              [25.081551986374073, -52.49167708145666],\r\n              [12.15685839679867, -50.825000270901],\r\n              [1.9916746648394732, -45.171835889467935],\r\n              [-0.2758413461535838, -40.23974757720194],\r\n              [-0.24755378372925183, -40.169554027464216],\r\n            ],\r\n            lastCommittedPoint: [1.0602678571428896, 551.8638392857142],\r\n            startBinding: null,\r\n            endBinding: null,\r\n            startArrowhead: null,\r\n            endArrowhead: null,\r\n          },\r\n          {\r\n            id: \"TYsYe2VvJ60T_yKa3kyOw\",\r\n            type: \"line\",\r\n            x: -496.3957643857249,\r\n            y: 541.7241190920508,\r\n            width: 50.7174766392476,\r\n            height: 12.698053371678215,\r\n            angle: 1.5707963267948957,\r\n            strokeColor: \"#087f5b\",\r\n            backgroundColor: \"transparent\",\r\n            fillStyle: \"solid\",\r\n            strokeWidth: 1,\r\n            strokeStyle: \"solid\",\r\n            roughness: 1,\r\n            opacity: 100,\r\n            groupIds: [\"HSrtfEf-CssQTf160Fb6R\"],\r\n            strokeSharpness: \"round\",\r\n            seed: 726657713,\r\n            version: 2405,\r\n            versionNonce: 2120341087,\r\n            isDeleted: false,\r\n            boundElementIds: null,\r\n            points: [\r\n              [0, -2.0205717204386002],\r\n              [1.3361877396713384, 3.0410845646550486],\r\n              [7.098613049589299, 7.287767671898479],\r\n              [14.766422451441104, 9.859533283467512],\r\n              [26.779003528407447, 10.093886705011586],\r\n              [40.79727342221974, 8.456559589697127],\r\n              [48.98410145879092, 2.500000505196364],\r\n              [50.7174766392476, -2.6041666666666288],\r\n            ],\r\n            lastCommittedPoint: [510.69444444444457, -2.6041666666666288],\r\n            startBinding: null,\r\n            endBinding: null,\r\n            startArrowhead: null,\r\n            endArrowhead: null,\r\n          },\r\n          {\r\n            id: \"VIuxhGjvYUBniitomEkKm\",\r\n            type: \"line\",\r\n            x: -450.969983237283,\r\n            y: 542.1789894334747,\r\n            width: 50.57247907260371,\r\n            height: 10.178760037658167,\r\n            angle: 1.5707963267948957,\r\n            strokeColor: \"#087f5b\",\r\n            backgroundColor: \"transparent\",\r\n            fillStyle: \"solid\",\r\n            strokeWidth: 1,\r\n            strokeStyle: \"solid\",\r\n            roughness: 1,\r\n            opacity: 100,\r\n            groupIds: [\"HSrtfEf-CssQTf160Fb6R\"],\r\n            strokeSharpness: \"round\",\r\n            seed: 1977326481,\r\n            version: 2538,\r\n            versionNonce: 1913946897,\r\n            isDeleted: false,\r\n            boundElementIds: null,\r\n            points: [\r\n              [0, -2.136356936862347],\r\n              [1.332367676378171, 1.9210669226078037],\r\n              [7.078318632616268, 5.325208253515953],\r\n              [14.724206326638113, 7.386735659885842],\r\n              [26.70244431044034, 7.574593370991538],\r\n              [40.68063699304561, 6.262111896696538],\r\n              [48.84405948536458, 1.4873339211608216],\r\n              [50.57247907260371, -2.6041666666666288],\r\n            ],\r\n            lastCommittedPoint: [510.69444444444457, -2.6041666666666288],\r\n            startBinding: null,\r\n            endBinding: null,\r\n            startArrowhead: null,\r\n            endArrowhead: null,\r\n          },\r\n          {\r\n            type: \"ellipse\",\r\n            version: 5503,\r\n            versionNonce: 1236644479,\r\n            isDeleted: false,\r\n            id: \"1acGiqpJjntE3sr1JVnBP\",\r\n            fillStyle: \"solid\",\r\n            strokeWidth: 1,\r\n            strokeStyle: \"solid\",\r\n            roughness: 1,\r\n            opacity: 100,\r\n            angle: 1.5707963267948957,\r\n            x: -404.36521010516793,\r\n            y: 534.1894365757241,\r\n            strokeColor: \"#087f5b\",\r\n            backgroundColor: \"#fff\",\r\n            width: 51.27812853552538,\r\n            height: 22.797152568995934,\r\n            seed: 1774660383,\r\n            groupIds: [\"HSrtfEf-CssQTf160Fb6R\"],\r\n            strokeSharpness: \"sharp\",\r\n            boundElementIds: [\"bxuMGTzXLn7H-uBCptINx\"],\r\n          },\r\n        ],\r\n        [\r\n          {\r\n            type: \"rectangle\",\r\n            version: 4270,\r\n            versionNonce: 309922463,\r\n            isDeleted: false,\r\n            id: \"SqGRpNqls7OV1QB2Eq-0m\",\r\n            fillStyle: \"solid\",\r\n            strokeWidth: 2,\r\n            strokeStyle: \"solid\",\r\n            roughness: 1,\r\n            opacity: 100,\r\n            angle: 0,\r\n            x: -393.3000561423187,\r\n            y: 338.9742643666818,\r\n            strokeColor: \"#000000\",\r\n            backgroundColor: \"#fff\",\r\n            width: 70.67858069123133,\r\n            height: 107.25081879410921,\r\n            seed: 371096063,\r\n            groupIds: [\"9ppmKFUbA4iKjt8FaDFox\"],\r\n            strokeSharpness: \"sharp\",\r\n            boundElementIds: [\r\n              \"CFu0B4Mw_1wC1Hbgx8Fs0\",\r\n              \"XIl_NhaFtRO00pX5Pq6VU\",\r\n              \"EndiSTFlx1AT7vcBVjgve\",\r\n            ],\r\n          },\r\n          {\r\n            type: \"rectangle\",\r\n            version: 4319,\r\n            versionNonce: 896119505,\r\n            isDeleted: false,\r\n            id: \"fayss6b_GPh6LK1x4iX-q\",\r\n            fillStyle: \"solid\",\r\n            strokeWidth: 2,\r\n            strokeStyle: \"solid\",\r\n            roughness: 1,\r\n            opacity: 100,\r\n            angle: 0,\r\n            x: -400.8474891780329,\r\n            y: 331.95417508096745,\r\n            strokeColor: \"#000000\",\r\n            backgroundColor: \"#fff\",\r\n            width: 70.67858069123133,\r\n            height: 107.25081879410921,\r\n            seed: 685932433,\r\n            groupIds: [\"0RJwA-yKP5dqk5oMiSeot\", \"9ppmKFUbA4iKjt8FaDFox\"],\r\n            strokeSharpness: \"sharp\",\r\n            boundElementIds: [\r\n              \"CFu0B4Mw_1wC1Hbgx8Fs0\",\r\n              \"XIl_NhaFtRO00pX5Pq6VU\",\r\n              \"EndiSTFlx1AT7vcBVjgve\",\r\n            ],\r\n          },\r\n          {\r\n            type: \"rectangle\",\r\n            version: 4417,\r\n            versionNonce: 1968987839,\r\n            isDeleted: false,\r\n            id: \"HgAnv2rwYhUpLiJiZAXv-\",\r\n            fillStyle: \"solid\",\r\n            strokeWidth: 2,\r\n            strokeStyle: \"solid\",\r\n            roughness: 1,\r\n            opacity: 100,\r\n            angle: 0,\r\n            x: -410.24257846374826,\r\n            y: 323.7002688309677,\r\n            strokeColor: \"#000000\",\r\n            backgroundColor: \"#fff\",\r\n            width: 70.67858069123133,\r\n            height: 107.25081879410921,\r\n            seed: 58634943,\r\n            groupIds: [\"9ppmKFUbA4iKjt8FaDFox\"],\r\n            strokeSharpness: \"sharp\",\r\n            boundElementIds: [\r\n              \"CFu0B4Mw_1wC1Hbgx8Fs0\",\r\n              \"XIl_NhaFtRO00pX5Pq6VU\",\r\n              \"EndiSTFlx1AT7vcBVjgve\",\r\n            ],\r\n          },\r\n          {\r\n            type: \"draw\",\r\n            version: 3541,\r\n            versionNonce: 1680683185,\r\n            isDeleted: false,\r\n            id: \"12aO-Bs9HdALZN_-tuQTr\",\r\n            fillStyle: \"solid\",\r\n            strokeWidth: 1,\r\n            strokeStyle: \"solid\",\r\n            roughness: 1,\r\n            opacity: 100,\r\n            angle: 0,\r\n            x: -398.2561518768373,\r\n            y: 371.84603609547054,\r\n            strokeColor: \"#000000\",\r\n            backgroundColor: \"#fff\",\r\n            width: 46.57983585730082,\r\n            height: 3.249953844290203,\r\n            seed: 1673003743,\r\n            groupIds: [\"9ppmKFUbA4iKjt8FaDFox\"],\r\n            strokeSharpness: \"round\",\r\n            boundElementIds: [],\r\n            points: [\r\n              [0, 0.6014697828497827],\r\n              [40.42449133807562, 0.7588628355182573],\r\n              [46.57983585730082, -2.491091008771946],\r\n            ],\r\n            lastCommittedPoint: null,\r\n            startArrowhead: null,\r\n            endArrowhead: null,\r\n          },\r\n          {\r\n            type: \"draw\",\r\n            version: 3567,\r\n            versionNonce: 620768991,\r\n            isDeleted: false,\r\n            id: \"Ck_Y0EVPh_fsY0qoRnGiD\",\r\n            fillStyle: \"solid\",\r\n            strokeWidth: 1,\r\n            strokeStyle: \"solid\",\r\n            roughness: 1,\r\n            opacity: 100,\r\n            angle: 0,\r\n            x: -396.400899638823,\r\n            y: 340.9822185794818,\r\n            strokeColor: \"#000000\",\r\n            backgroundColor: \"#fff\",\r\n            width: 45.567415680676426,\r\n            height: 2.8032978840147194,\r\n            seed: 1821527807,\r\n            groupIds: [\"9ppmKFUbA4iKjt8FaDFox\"],\r\n            strokeSharpness: \"round\",\r\n            boundElementIds: [],\r\n            points: [\r\n              [0, 0],\r\n              [16.832548902953302, -2.8032978840147194],\r\n              [45.567415680676426, -0.3275477042019195],\r\n            ],\r\n            lastCommittedPoint: null,\r\n            startArrowhead: null,\r\n            endArrowhead: null,\r\n          },\r\n          {\r\n            type: \"draw\",\r\n            version: 3592,\r\n            versionNonce: 1300624017,\r\n            isDeleted: false,\r\n            id: \"a_7IZapEuD918VW1P8Ss_\",\r\n            fillStyle: \"solid\",\r\n            strokeWidth: 1,\r\n            strokeStyle: \"solid\",\r\n            roughness: 1,\r\n            opacity: 100,\r\n            angle: 0,\r\n            x: -396.4774991551924,\r\n            y: 408.37659284983897,\r\n            strokeColor: \"#000000\",\r\n            backgroundColor: \"#fff\",\r\n            width: 48.33668263438425,\r\n            height: 4.280657518731036,\r\n            seed: 1485707039,\r\n            groupIds: [\"9ppmKFUbA4iKjt8FaDFox\"],\r\n            strokeSharpness: \"round\",\r\n            boundElementIds: [],\r\n            points: [\r\n              [0, 0],\r\n              [26.41225578429045, -0.2552319773002338],\r\n              [37.62000339651456, 2.3153712935189787],\r\n              [48.33668263438425, -1.9652862252120569],\r\n            ],\r\n            lastCommittedPoint: null,\r\n            startArrowhead: null,\r\n            endArrowhead: null,\r\n          },\r\n          {\r\n            type: \"draw\",\r\n            version: 3629,\r\n            versionNonce: 737475327,\r\n            isDeleted: false,\r\n            id: \"8io6FVNdFOLsQ266W8Lni\",\r\n            fillStyle: \"solid\",\r\n            strokeWidth: 1,\r\n            strokeStyle: \"solid\",\r\n            roughness: 1,\r\n            opacity: 100,\r\n            angle: 0,\r\n            x: -399.6615463367227,\r\n            y: 419.61974125811776,\r\n            strokeColor: \"#000000\",\r\n            backgroundColor: \"#fff\",\r\n            width: 54.40694982784246,\r\n            height: 2.9096445412231735,\r\n            seed: 1042012991,\r\n            groupIds: [\"9ppmKFUbA4iKjt8FaDFox\"],\r\n            strokeSharpness: \"round\",\r\n            boundElementIds: [],\r\n            points: [\r\n              [0, 0],\r\n              [10.166093050596771, -1.166642430373031],\r\n              [16.130660965377448, -0.8422655250909383],\r\n              [46.26079588567538, 0.6125567455206506],\r\n              [54.40694982784246, -2.297087795702523],\r\n            ],\r\n            lastCommittedPoint: null,\r\n            startArrowhead: null,\r\n            endArrowhead: null,\r\n          },\r\n          {\r\n            type: \"draw\",\r\n            version: 3594,\r\n            versionNonce: 1982560369,\r\n            isDeleted: false,\r\n            id: \"LJI5kY6tg7UFAjPV3fKL-\",\r\n            fillStyle: \"solid\",\r\n            strokeWidth: 1,\r\n            strokeStyle: \"solid\",\r\n            roughness: 1,\r\n            opacity: 100,\r\n            angle: 0,\r\n            x: -399.3767034411569,\r\n            y: 356.042820132743,\r\n            strokeColor: \"#000000\",\r\n            backgroundColor: \"#fff\",\r\n            width: 46.92865289294453,\r\n            height: 2.4757501798128,\r\n            seed: 295443295,\r\n            groupIds: [\"9ppmKFUbA4iKjt8FaDFox\"],\r\n            strokeSharpness: \"round\",\r\n            boundElementIds: [],\r\n            points: [\r\n              [0, 0],\r\n              [18.193786115221407, -0.5912874140789839],\r\n              [46.92865289294453, 1.884462765733816],\r\n            ],\r\n            lastCommittedPoint: null,\r\n            startArrowhead: null,\r\n            endArrowhead: null,\r\n          },\r\n          {\r\n            type: \"draw\",\r\n            version: 3609,\r\n            versionNonce: 1857766175,\r\n            isDeleted: false,\r\n            id: \"zCrZOHW-q8YWKLw6ltKxX\",\r\n            fillStyle: \"solid\",\r\n            strokeWidth: 1,\r\n            strokeStyle: \"solid\",\r\n            roughness: 1,\r\n            opacity: 100,\r\n            angle: 0,\r\n            x: -399.26921524500654,\r\n            y: 390.5261491685826,\r\n            strokeColor: \"#000000\",\r\n            backgroundColor: \"#fff\",\r\n            width: 46.92865289294453,\r\n            height: 2.4757501798128,\r\n            seed: 1734301567,\r\n            groupIds: [\"9ppmKFUbA4iKjt8FaDFox\"],\r\n            strokeSharpness: \"round\",\r\n            boundElementIds: [],\r\n            points: [\r\n              [0, 0],\r\n              [8.093938105125233, 1.4279702913643746],\r\n              [18.193786115221407, -0.5912874140789839],\r\n              [46.92865289294453, 1.884462765733816],\r\n            ],\r\n            lastCommittedPoint: null,\r\n            startArrowhead: null,\r\n            endArrowhead: null,\r\n          },\r\n        ],\r\n        [\r\n          {\r\n            id: \"XOD3vRhtoLWoxC9wF9Sk8\",\r\n            type: \"rectangle\",\r\n            x: -593.9896997899341,\r\n            y: 343.9798351106279,\r\n            width: 127.88383573213892,\r\n            height: 76.53703389977764,\r\n            angle: 0,\r\n            strokeColor: \"#000000\",\r\n            backgroundColor: \"transparent\",\r\n            fillStyle: \"solid\",\r\n            strokeWidth: 1,\r\n            strokeStyle: \"solid\",\r\n            roughness: 1,\r\n            opacity: 100,\r\n            groupIds: [\"TC0RSM64Cxmu17MlE12-o\"],\r\n            strokeSharpness: \"sharp\",\r\n            seed: 106569279,\r\n            version: 676,\r\n            versionNonce: 1841530687,\r\n            isDeleted: false,\r\n            boundElementIds: null,\r\n          },\r\n          {\r\n            id: \"WBkTga1PjKzYK-tcGjnjZ\",\r\n            type: \"line\",\r\n            x: -595.0652975408293,\r\n            y: 354.6963695028721,\r\n            width: 128.84193229844433,\r\n            height: 0,\r\n            angle: 0,\r\n            strokeColor: \"#000000\",\r\n            backgroundColor: \"transparent\",\r\n            fillStyle: \"solid\",\r\n            strokeWidth: 1,\r\n            strokeStyle: \"solid\",\r\n            roughness: 1,\r\n            opacity: 100,\r\n            groupIds: [\"TC0RSM64Cxmu17MlE12-o\"],\r\n            strokeSharpness: \"round\",\r\n            seed: 73916127,\r\n            version: 462,\r\n            versionNonce: 1737150513,\r\n            isDeleted: false,\r\n            boundElementIds: null,\r\n            points: [\r\n              [0, 0],\r\n              [128.84193229844433, 0],\r\n            ],\r\n            lastCommittedPoint: null,\r\n            startBinding: null,\r\n            endBinding: null,\r\n            startArrowhead: null,\r\n            endArrowhead: null,\r\n          },\r\n          {\r\n            id: \"FHX0ZsIzUUfYPJqrZ8Lso\",\r\n            type: \"ellipse\",\r\n            x: -589.5016643209792,\r\n            y: 348.2514049106367,\r\n            width: 5.001953125,\r\n            height: 5.001953125,\r\n            angle: 0,\r\n            strokeColor: \"#000000\",\r\n            backgroundColor: \"#fa5252\",\r\n            fillStyle: \"solid\",\r\n            strokeWidth: 1,\r\n            strokeStyle: \"solid\",\r\n            roughness: 0,\r\n            opacity: 100,\r\n            groupIds: [\"TC0RSM64Cxmu17MlE12-o\"],\r\n            strokeSharpness: \"sharp\",\r\n            seed: 387857791,\r\n            version: 282,\r\n            versionNonce: 1198409567,\r\n            isDeleted: false,\r\n            boundElementIds: null,\r\n          },\r\n          {\r\n            id: \"ugVRR0f_uDOjrllO10yAs\",\r\n            type: \"ellipse\",\r\n            x: -579.2389690084792,\r\n            y: 348.2514049106367,\r\n            width: 5.001953125,\r\n            height: 5.001953125,\r\n            angle: 0,\r\n            strokeColor: \"#000000\",\r\n            backgroundColor: \"#fab005\",\r\n            fillStyle: \"solid\",\r\n            strokeWidth: 1,\r\n            strokeStyle: \"solid\",\r\n            roughness: 0,\r\n            opacity: 100,\r\n            groupIds: [\"TC0RSM64Cxmu17MlE12-o\"],\r\n            strokeSharpness: \"sharp\",\r\n            seed: 1486370207,\r\n            version: 327,\r\n            versionNonce: 1661182481,\r\n            isDeleted: false,\r\n            boundElementIds: null,\r\n          },\r\n          {\r\n            id: \"SBzNA0Sn-ou4QGxotj0SB\",\r\n            type: \"ellipse\",\r\n            x: -568.525552542133,\r\n            y: 348.7021260644829,\r\n            width: 5.001953125,\r\n            height: 5.001953125,\r\n            angle: 0,\r\n            strokeColor: \"#000000\",\r\n            backgroundColor: \"#40c057\",\r\n            fillStyle: \"solid\",\r\n            strokeWidth: 1,\r\n            strokeStyle: \"solid\",\r\n            roughness: 0,\r\n            opacity: 100,\r\n            groupIds: [\"TC0RSM64Cxmu17MlE12-o\"],\r\n            strokeSharpness: \"sharp\",\r\n            seed: 610150847,\r\n            version: 385,\r\n            versionNonce: 2047607679,\r\n            isDeleted: false,\r\n            boundElementIds: null,\r\n          },\r\n          {\r\n            id: \"VKcfbELTVlyJ90m0bGsj0\",\r\n            type: \"ellipse\",\r\n            x: -552.4984915525058,\r\n            y: 364.75449494249875,\r\n            width: 42.72020253937572,\r\n            height: 42.72020253937572,\r\n            angle: 0,\r\n            strokeColor: \"#000000\",\r\n            backgroundColor: \"#04aaf7\",\r\n            fillStyle: \"solid\",\r\n            strokeWidth: 1,\r\n            strokeStyle: \"solid\",\r\n            roughness: 1,\r\n            opacity: 90,\r\n            groupIds: [\"TC0RSM64Cxmu17MlE12-o\"],\r\n            strokeSharpness: \"sharp\",\r\n            seed: 144280593,\r\n            version: 664,\r\n            versionNonce: 2135373809,\r\n            isDeleted: false,\r\n            boundElementIds: null,\r\n          },\r\n          {\r\n            id: \"zWrJVrKnkF5K8iXNxi9Aa\",\r\n            type: \"draw\",\r\n            x: -530.327851842306,\r\n            y: 378.9357912947449,\r\n            width: 28.226201983883442,\r\n            height: 24.44112284281997,\r\n            angle: 0,\r\n            strokeColor: \"#087f5b\",\r\n            backgroundColor: \"#40c057\",\r\n            fillStyle: \"solid\",\r\n            strokeWidth: 1,\r\n            strokeStyle: \"solid\",\r\n            roughness: 0,\r\n            opacity: 100,\r\n            groupIds: [\"TC0RSM64Cxmu17MlE12-o\"],\r\n            strokeSharpness: \"round\",\r\n            seed: 29167967,\r\n            version: 1281,\r\n            versionNonce: 1708997535,\r\n            isDeleted: false,\r\n            boundElementIds: null,\r\n            points: [\r\n              [4.907524351775825, 2.043055712211473],\r\n              [3.0769604829149455, 1.6284171290602836],\r\n              [-2.66472604008681, -4.228569719133945],\r\n              [-6.450168189798415, -2.304577297733668],\r\n              [-7.704241049212052, 4.416384506147983],\r\n              [-6.361372181234263, 8.783101300254884],\r\n              [-12.516984713388897, 10.9291595737194],\r\n              [-12.295677738198286, 15.686226498407976],\r\n              [-7.473371426945252, 15.393030178104425],\r\n              [-3.787654025313423, 11.5207568827343],\r\n              [1.2873793872375165, 19.910682356036197],\r\n              [4.492232250183542, 20.212553123686025],\r\n              [1.1302787567009416, 6.843494873631317],\r\n              [6.294108177816019, 6.390688722156585],\r\n              [8.070028349098962, 7.910451897221202],\r\n              [14.143675334886687, 7.910451897221202],\r\n              [15.709217270494545, 2.6780252579576427],\r\n              [9.128749989671498, 3.1533849725326517],\r\n              [10.393751588600717, -3.7167773257046695],\r\n              [7.380151667177483, -3.30213874255348],\r\n              [4.669824267311791, 1.1200945145694894],\r\n              [4.907524351775825, 2.043055712211473],\r\n            ],\r\n            lastCommittedPoint: null,\r\n            startBinding: null,\r\n            endBinding: null,\r\n            startArrowhead: null,\r\n            endArrowhead: null,\r\n          },\r\n          {\r\n            id: \"LX6kTl9A8K36ld2MEV4tI\",\r\n            type: \"line\",\r\n            x: -551.4394290784783,\r\n            y: 385.71736850567976,\r\n            width: 42.095115772272244,\r\n            height: 0,\r\n            angle: 0,\r\n            strokeColor: \"#000000\",\r\n            backgroundColor: \"#99bcff\",\r\n            fillStyle: \"solid\",\r\n            strokeWidth: 1,\r\n            strokeStyle: \"solid\",\r\n            roughness: 1,\r\n            opacity: 90,\r\n            groupIds: [\"TC0RSM64Cxmu17MlE12-o\"],\r\n            strokeSharpness: \"round\",\r\n            seed: 1443027377,\r\n            version: 701,\r\n            versionNonce: 1583157713,\r\n            isDeleted: false,\r\n            boundElementIds: null,\r\n            points: [\r\n              [0, 0],\r\n              [42.095115772272244, 0],\r\n            ],\r\n            lastCommittedPoint: null,\r\n            startBinding: null,\r\n            endBinding: null,\r\n            startArrowhead: null,\r\n            endArrowhead: null,\r\n          },\r\n          {\r\n            id: \"SHmV_QtcwxIE-peI_QOX1\",\r\n            type: \"line\",\r\n            x: -546.3441000487039,\r\n            y: 372.6245229061568,\r\n            width: 29.31860660384862,\r\n            height: 5.711199931375845,\r\n            angle: 0,\r\n            strokeColor: \"#000000\",\r\n            backgroundColor: \"#99bcff\",\r\n            fillStyle: \"solid\",\r\n            strokeWidth: 1,\r\n            strokeStyle: \"solid\",\r\n            roughness: 0,\r\n            opacity: 90,\r\n            groupIds: [\"TC0RSM64Cxmu17MlE12-o\"],\r\n            strokeSharpness: \"round\",\r\n            seed: 244310513,\r\n            version: 2908,\r\n            versionNonce: 252866495,\r\n            isDeleted: false,\r\n            boundElementIds: null,\r\n            points: [\r\n              [0, -2.341683327443203],\r\n              [0.7724193963150375, -0.06510358900749044],\r\n              [4.103544916365185, 1.84492589414448],\r\n              [8.536129150893453, 3.0016281808630056],\r\n              [15.480325949120388, 3.1070332647092163],\r\n              [23.583965316012858, 2.3706131055211244],\r\n              [28.316582284417855, -0.3084668090492442],\r\n              [29.31860660384862, -2.6041666666666288],\r\n            ],\r\n            lastCommittedPoint: [510.69444444444457, -2.6041666666666288],\r\n            startBinding: null,\r\n            endBinding: null,\r\n            startArrowhead: null,\r\n            endArrowhead: null,\r\n          },\r\n          {\r\n            id: \"PKRg6SqIetkWIgRqBAnDY\",\r\n            type: \"ellipse\",\r\n            x: -538.2701841247845,\r\n            y: 363.37196531290607,\r\n            width: 15.528434353116108,\r\n            height: 44.82230388130942,\r\n            angle: 0,\r\n            strokeColor: \"#000000\",\r\n            backgroundColor: \"transparent\",\r\n            fillStyle: \"solid\",\r\n            strokeWidth: 1,\r\n            strokeStyle: \"solid\",\r\n            roughness: 1,\r\n            opacity: 90,\r\n            groupIds: [\"TC0RSM64Cxmu17MlE12-o\"],\r\n            strokeSharpness: \"sharp\",\r\n            seed: 683572113,\r\n            version: 725,\r\n            versionNonce: 1969008561,\r\n            isDeleted: false,\r\n            boundElementIds: null,\r\n          },\r\n          {\r\n            id: \"HrelUAgvfxi_4v8MyL_iT\",\r\n            type: \"line\",\r\n            x: -544.828148539078,\r\n            y: 402.0199316371545,\r\n            width: 29.31860660384862,\r\n            height: 5.896061363392446,\r\n            angle: 0,\r\n            strokeColor: \"#000000\",\r\n            backgroundColor: \"#99bcff\",\r\n            fillStyle: \"solid\",\r\n            strokeWidth: 1,\r\n            strokeStyle: \"solid\",\r\n            roughness: 0,\r\n            opacity: 90,\r\n            groupIds: [\"TC0RSM64Cxmu17MlE12-o\"],\r\n            strokeSharpness: \"round\",\r\n            seed: 318798801,\r\n            version: 3113,\r\n            versionNonce: 533471199,\r\n            isDeleted: false,\r\n            boundElementIds: null,\r\n            points: [\r\n              [0, 0],\r\n              [4.103544916365185, -4.322122351104391],\r\n              [8.536129150893453, -5.516265043290966],\r\n              [15.480325949120388, -5.625081903117008],\r\n              [23.583965316012858, -4.8648251269605955],\r\n              [28.316582284417855, -2.0990281379671547],\r\n              [29.31860660384862, 0.2709794602754383],\r\n            ],\r\n            lastCommittedPoint: [510.69444444444457, -2.6041666666666288],\r\n            startBinding: null,\r\n            endBinding: null,\r\n            startArrowhead: null,\r\n            endArrowhead: null,\r\n          },\r\n        ],\r\n        [\r\n          {\r\n            id: \"dba8s5bDYEnF20oGn2a8b\",\r\n            type: \"rectangle\",\r\n            x: -715.1043446306466,\r\n            y: 330.4231266309418,\r\n            width: 70.81644178885557,\r\n            height: 108.30428902193904,\r\n            angle: 0,\r\n            strokeColor: \"#000000\",\r\n            backgroundColor: \"#ced4da\",\r\n            fillStyle: \"solid\",\r\n            strokeWidth: 1,\r\n            strokeStyle: \"solid\",\r\n            roughness: 1,\r\n            opacity: 100,\r\n            groupIds: [\"GMZ-NW9lG7c1AtfBInZ0n\"],\r\n            strokeSharpness: \"sharp\",\r\n            seed: 1914896753,\r\n            version: 685,\r\n            versionNonce: 706399231,\r\n            isDeleted: false,\r\n            boundElementIds: null,\r\n          },\r\n          {\r\n            id: \"3HxCT4mFZF-jJ6m9pyOCt\",\r\n            type: \"rectangle\",\r\n            x: -706.996640540555,\r\n            y: 338.68030798133873,\r\n            width: 55.801163535143246,\r\n            height: 82.83278895375764,\r\n            angle: 0,\r\n            strokeColor: \"#000000\",\r\n            backgroundColor: \"#fff\",\r\n            fillStyle: \"solid\",\r\n            strokeWidth: 1,\r\n            strokeStyle: \"solid\",\r\n            roughness: 1,\r\n            opacity: 100,\r\n            groupIds: [\"GMZ-NW9lG7c1AtfBInZ0n\"],\r\n            strokeSharpness: \"sharp\",\r\n            seed: 1306468145,\r\n            version: 835,\r\n            versionNonce: 851916657,\r\n            isDeleted: false,\r\n            boundElementIds: null,\r\n          },\r\n          {\r\n            id: \"xX9mcMHy_0Bn-D0UAMyCc\",\r\n            type: \"ellipse\",\r\n            x: -684.8099707762028,\r\n            y: 425.0579911039235,\r\n            width: 11.427824006438863,\r\n            height: 11.427824006438863,\r\n            angle: 0,\r\n            strokeColor: \"#000000\",\r\n            backgroundColor: \"#fff\",\r\n            fillStyle: \"solid\",\r\n            strokeWidth: 1,\r\n            strokeStyle: \"solid\",\r\n            roughness: 1,\r\n            opacity: 100,\r\n            groupIds: [\"GMZ-NW9lG7c1AtfBInZ0n\"],\r\n            strokeSharpness: \"sharp\",\r\n            seed: 93422161,\r\n            version: 881,\r\n            versionNonce: 704574495,\r\n            isDeleted: false,\r\n            boundElementIds: null,\r\n          },\r\n          {\r\n            id: \"h60d2h6UPYkopTlW_XEs4\",\r\n            type: \"rectangle\",\r\n            x: -698.7169501405845,\r\n            y: 349.2244646574789,\r\n            width: 39.2417827352022,\r\n            height: 19.889460471185775,\r\n            angle: 0,\r\n            strokeColor: \"#000000\",\r\n            backgroundColor: \"#fab005\",\r\n            fillStyle: \"cross-hatch\",\r\n            strokeWidth: 1,\r\n            strokeStyle: \"solid\",\r\n            roughness: 1,\r\n            opacity: 100,\r\n            groupIds: [\"GMZ-NW9lG7c1AtfBInZ0n\"],\r\n            strokeSharpness: \"sharp\",\r\n            seed: 11646495,\r\n            version: 528,\r\n            versionNonce: 816914769,\r\n            isDeleted: false,\r\n            boundElementIds: null,\r\n          },\r\n          {\r\n            id: \"bZbx28BjXM33JV1UezMcH\",\r\n            type: \"rectangle\",\r\n            x: -698.7169501405845,\r\n            y: 384.7822247024333,\r\n            width: 39.2417827352022,\r\n            height: 19.889460471185775,\r\n            angle: 0,\r\n            strokeColor: \"#000000\",\r\n            backgroundColor: \"#fab005\",\r\n            fillStyle: \"cross-hatch\",\r\n            strokeWidth: 1,\r\n            strokeStyle: \"solid\",\r\n            roughness: 1,\r\n            opacity: 100,\r\n            groupIds: [\"GMZ-NW9lG7c1AtfBInZ0n\"],\r\n            strokeSharpness: \"sharp\",\r\n            seed: 291717649,\r\n            version: 570,\r\n            versionNonce: 1198069823,\r\n            isDeleted: false,\r\n            boundElementIds: null,\r\n          },\r\n        ],\r\n      ],\r\n    };\r\n  }\r\n  if (data === \"chem\") {\r\n    return {\r\n      type: \"excalidrawlib\",\r\n      version: 1,\r\n      library: [\r\n        [\r\n          {\r\n            type: \"line\",\r\n            version: 925,\r\n            versionNonce: 1578395480,\r\n            isDeleted: false,\r\n            id: \"tSGYZIRuJSGL2PN24OQ2z\",\r\n            fillStyle: \"hachure\",\r\n            strokeWidth: 1,\r\n            strokeStyle: \"solid\",\r\n            roughness: 1,\r\n            opacity: 100,\r\n            angle: 6.165054667603804,\r\n            x: 244.5272543819237,\r\n            y: 382.210430231427,\r\n            strokeColor: \"#000000\",\r\n            backgroundColor: \"#000000\",\r\n            width: 4.436780764520887,\r\n            height: 22.583875173094885,\r\n            seed: 2106748737,\r\n            groupIds: [\"BD43vcF63KMHRTtgeRwpI\"],\r\n            strokeSharpness: \"round\",\r\n            boundElementIds: [],\r\n            startBinding: null,\r\n            endBinding: null,\r\n            points: [\r\n              [0, 1.0191854321821059],\r\n              [4.436780764520887, -9.102259501714405],\r\n              [0.6168540813604092, -21.56468974091278],\r\n            ],\r\n            lastCommittedPoint: null,\r\n            startArrowhead: null,\r\n            endArrowhead: null,\r\n          },\r\n          {\r\n            type: \"ellipse\",\r\n            version: 919,\r\n            versionNonce: 155867688,\r\n            isDeleted: false,\r\n            id: \"dOLiQlj5eQVqBRRLDn7F1\",\r\n            fillStyle: \"hachure\",\r\n            strokeWidth: 1,\r\n            strokeStyle: \"solid\",\r\n            roughness: 1,\r\n            opacity: 100,\r\n            angle: 6.165054667603804,\r\n            x: 236.69194929960844,\r\n            y: 352.34768166770857,\r\n            strokeColor: \"#000000\",\r\n            backgroundColor: \"#000000\",\r\n            width: 9.654050386347059,\r\n            height: 11.139288907323724,\r\n            seed: 780132687,\r\n            groupIds: [\"BD43vcF63KMHRTtgeRwpI\"],\r\n            strokeSharpness: \"sharp\",\r\n            boundElementIds: [],\r\n          },\r\n          {\r\n            type: \"ellipse\",\r\n            version: 1292,\r\n            versionNonce: 1253948504,\r\n            isDeleted: false,\r\n            id: \"HlrfzzHMdRQ1B3U3vwRhi\",\r\n            fillStyle: \"hachure\",\r\n            strokeWidth: 1,\r\n            strokeStyle: \"solid\",\r\n            roughness: 1,\r\n            opacity: 100,\r\n            angle: 0,\r\n            x: 222.4086267905256,\r\n            y: 383.3337587471785,\r\n            strokeColor: \"#000000\",\r\n            backgroundColor: \"#000000\",\r\n            width: 44.43094095525345,\r\n            height: 52.36947455644437,\r\n            seed: 2013272321,\r\n            groupIds: [\"BD43vcF63KMHRTtgeRwpI\"],\r\n            strokeSharpness: \"sharp\",\r\n            boundElementIds: [],\r\n          },\r\n          {\r\n            type: \"line\",\r\n            version: 1196,\r\n            versionNonce: 374134056,\r\n            isDeleted: false,\r\n            id: \"bkHx1uM4hDo1nAFBP-nq7\",\r\n            fillStyle: \"hachure\",\r\n            strokeWidth: 1,\r\n            strokeStyle: \"solid\",\r\n            roughness: 1,\r\n            opacity: 100,\r\n            angle: 6.173279198979622,\r\n            x: 248.61766672819348,\r\n            y: 439.63913194403494,\r\n            strokeColor: \"#000000\",\r\n            backgroundColor: \"#000000\",\r\n            width: 42.74179264310312,\r\n            height: 58.07755643143159,\r\n            seed: 1000693825,\r\n            groupIds: [\"BD43vcF63KMHRTtgeRwpI\"],\r\n            strokeSharpness: \"round\",\r\n            boundElementIds: [],\r\n            startBinding: null,\r\n            endBinding: null,\r\n            points: [\r\n              [0.9970276339563775, 0],\r\n              [21.64593421491494, 10.897554738789612],\r\n              [10.671690157902008, 53.7185345359158],\r\n              [-5.500880031380251, 58.07755643143159],\r\n              [-21.09585842818818, 13.205272212886165],\r\n              [0.9970276339563775, 0],\r\n            ],\r\n            lastCommittedPoint: null,\r\n            startArrowhead: null,\r\n            endArrowhead: null,\r\n          },\r\n          {\r\n            type: \"line\",\r\n            version: 1432,\r\n            versionNonce: 1635021144,\r\n            isDeleted: false,\r\n            id: \"pCHGXH0y1wx2UBRz-OJL3\",\r\n            fillStyle: \"solid\",\r\n            strokeWidth: 1,\r\n            strokeStyle: \"solid\",\r\n            roughness: 1,\r\n            opacity: 100,\r\n            angle: 0,\r\n            x: 248.77438055867088,\r\n            y: 422.57686933025576,\r\n            strokeColor: \"#000000\",\r\n            backgroundColor: \"#ffffff\",\r\n            width: 26.6281425068129,\r\n            height: 11.028332853109607,\r\n            seed: 738113263,\r\n            groupIds: [\"BD43vcF63KMHRTtgeRwpI\"],\r\n            strokeSharpness: \"round\",\r\n            boundElementIds: [],\r\n            startBinding: null,\r\n            endBinding: null,\r\n            points: [\r\n              [0.9582323920678653, 0.13736629102658318],\r\n              [-9.036549184386008, 0.8017921117338412],\r\n              [-20.27499960472758, 0.1146508783526254],\r\n              [-5.123819351330802, 8.121833845852525],\r\n              [6.353142902085321, -2.9064990072570818],\r\n              [0.9582323920678653, 0.13736629102658318],\r\n            ],\r\n            lastCommittedPoint: null,\r\n            startArrowhead: null,\r\n            endArrowhead: null,\r\n          },\r\n          {\r\n            type: \"ellipse\",\r\n            version: 847,\r\n            versionNonce: 1934094376,\r\n            isDeleted: false,\r\n            id: \"XaUB1khdWwHkGsRyun1vM\",\r\n            fillStyle: \"solid\",\r\n            strokeWidth: 1,\r\n            strokeStyle: \"solid\",\r\n            roughness: 1,\r\n            opacity: 100,\r\n            angle: 0,\r\n            x: 245.71550966356747,\r\n            y: 399.69691160323424,\r\n            strokeColor: \"#000000\",\r\n            backgroundColor: \"#ffffff\",\r\n            width: 8.53531631216429,\r\n            height: 9.478005938125602,\r\n            seed: 184188705,\r\n            groupIds: [\"BD43vcF63KMHRTtgeRwpI\"],\r\n            strokeSharpness: \"sharp\",\r\n            boundElementIds: [],\r\n          },\r\n          {\r\n            type: \"ellipse\",\r\n            version: 897,\r\n            versionNonce: 965510744,\r\n            isDeleted: false,\r\n            id: \"23AktPdcz_s8Ve8XZwNCt\",\r\n            fillStyle: \"solid\",\r\n            strokeWidth: 1,\r\n            strokeStyle: \"solid\",\r\n            roughness: 0,\r\n            opacity: 100,\r\n            angle: 0,\r\n            x: 246.42626537073633,\r\n            y: 403.8253536150297,\r\n            strokeColor: \"#000000\",\r\n            backgroundColor: \"#000000\",\r\n            width: 2.606593604313782,\r\n            height: 3.4754581390851125,\r\n            seed: 632893473,\r\n            groupIds: [\"BD43vcF63KMHRTtgeRwpI\"],\r\n            strokeSharpness: \"sharp\",\r\n            boundElementIds: [],\r\n          },\r\n          {\r\n            type: \"ellipse\",\r\n            version: 836,\r\n            versionNonce: 1478994728,\r\n            isDeleted: false,\r\n            id: \"37udM5fCYGO_ckwez-V1a\",\r\n            fillStyle: \"solid\",\r\n            strokeWidth: 1,\r\n            strokeStyle: \"solid\",\r\n            roughness: 1,\r\n            opacity: 100,\r\n            angle: 0,\r\n            x: 229.46365157342214,\r\n            y: 400.50727136476377,\r\n            strokeColor: \"#000000\",\r\n            backgroundColor: \"#ffffff\",\r\n            width: 9.495042497631012,\r\n            height: 9.875525659916542,\r\n            seed: 1269160207,\r\n            groupIds: [\"BD43vcF63KMHRTtgeRwpI\"],\r\n            strokeSharpness: \"sharp\",\r\n            boundElementIds: [],\r\n          },\r\n          {\r\n            type: \"ellipse\",\r\n            version: 919,\r\n            versionNonce: 1608121176,\r\n            isDeleted: false,\r\n            id: \"Pg-vGwasi_NE-NvWPllZd\",\r\n            fillStyle: \"solid\",\r\n            strokeWidth: 1,\r\n            strokeStyle: \"solid\",\r\n            roughness: 0,\r\n            opacity: 100,\r\n            angle: 0,\r\n            x: 230.86037211987738,\r\n            y: 404.6841622030912,\r\n            strokeColor: \"#000000\",\r\n            backgroundColor: \"#000000\",\r\n            width: 2.2204315888598063,\r\n            height: 3.475458139085001,\r\n            seed: 1790239695,\r\n            groupIds: [\"BD43vcF63KMHRTtgeRwpI\"],\r\n            strokeSharpness: \"sharp\",\r\n            boundElementIds: [],\r\n          },\r\n        ],\r\n        [\r\n          {\r\n            type: \"line\",\r\n            version: 840,\r\n            versionNonce: 1857539805,\r\n            isDeleted: false,\r\n            id: \"3Cx7NWDjFN8Vzb9zO-Q4U\",\r\n            fillStyle: \"hachure\",\r\n            strokeWidth: 1,\r\n            strokeStyle: \"solid\",\r\n            roughness: 1,\r\n            opacity: 100,\r\n            angle: 6.577355931884643,\r\n            x: 344.6594303066651,\r\n            y: 388.5350061460536,\r\n            strokeColor: \"#000000\",\r\n            backgroundColor: \"#000000\",\r\n            width: 3.443642015262143,\r\n            height: 17.30481003408347,\r\n            seed: 1824127105,\r\n            groupIds: [\"pdFncHLcB1-TCiUDvfvYB\"],\r\n            strokeSharpness: \"sharp\",\r\n            boundElementIds: [],\r\n            startBinding: null,\r\n            endBinding: null,\r\n            points: [\r\n              [0, 0],\r\n              [-3.443642015262143, -17.30481003408347],\r\n            ],\r\n            lastCommittedPoint: null,\r\n            startArrowhead: null,\r\n            endArrowhead: null,\r\n          },\r\n          {\r\n            type: \"ellipse\",\r\n            version: 874,\r\n            versionNonce: 1419172211,\r\n            isDeleted: false,\r\n            id: \"7V3ZTfl_I8wl_ld_mrrEH\",\r\n            fillStyle: \"hachure\",\r\n            strokeWidth: 1,\r\n            strokeStyle: \"solid\",\r\n            roughness: 1,\r\n            opacity: 100,\r\n            angle: 6.577355931884643,\r\n            x: 341.31949034671396,\r\n            y: 361.9571432394244,\r\n            strokeColor: \"#000000\",\r\n            backgroundColor: \"#000000\",\r\n            width: 7.455246158929383,\r\n            height: 8.602207106457122,\r\n            seed: 1314950159,\r\n            groupIds: [\"pdFncHLcB1-TCiUDvfvYB\"],\r\n            strokeSharpness: \"sharp\",\r\n            boundElementIds: [],\r\n          },\r\n          {\r\n            type: \"line\",\r\n            version: 1309,\r\n            versionNonce: 133425981,\r\n            isDeleted: false,\r\n            id: \"WIMVqIS70wksfuC7CYpFF\",\r\n            fillStyle: \"hachure\",\r\n            strokeWidth: 1,\r\n            strokeStyle: \"solid\",\r\n            roughness: 1,\r\n            opacity: 100,\r\n            angle: 6.2138034488305856,\r\n            x: 356.03572428728216,\r\n            y: 425.8195045835785,\r\n            strokeColor: \"#000000\",\r\n            backgroundColor: \"#000000\",\r\n            width: 33.923909985611196,\r\n            height: 70.9326778643838,\r\n            seed: 395338447,\r\n            groupIds: [\"pdFncHLcB1-TCiUDvfvYB\"],\r\n            strokeSharpness: \"round\",\r\n            boundElementIds: [],\r\n            startBinding: null,\r\n            endBinding: null,\r\n            points: [\r\n              [-5.3495831107633425, 0],\r\n              [11.039332862015005, 13.197275896065692],\r\n              [2.3291397576013515, 65.05480706413564],\r\n              [-15.910804028057555, 70.9326778643838],\r\n              [-22.884577123596195, 15.991993144644246],\r\n              [-5.3495831107633425, 0],\r\n            ],\r\n            lastCommittedPoint: null,\r\n            startArrowhead: null,\r\n            endArrowhead: null,\r\n          },\r\n          {\r\n            type: \"line\",\r\n            version: 956,\r\n            versionNonce: 302068499,\r\n            isDeleted: false,\r\n            id: \"lqAtZFwQ7Iq0z8-FzfTxX\",\r\n            fillStyle: \"hachure\",\r\n            strokeWidth: 1,\r\n            strokeStyle: \"solid\",\r\n            roughness: 1,\r\n            opacity: 100,\r\n            angle: 0.12535992280317831,\r\n            x: 368.2750998334306,\r\n            y: 434.9516922988722,\r\n            strokeColor: \"#000000\",\r\n            backgroundColor: \"#000000\",\r\n            width: 27.83862617888879,\r\n            height: 63.506865970589956,\r\n            seed: 1765773903,\r\n            groupIds: [\"pdFncHLcB1-TCiUDvfvYB\"],\r\n            strokeSharpness: \"round\",\r\n            boundElementIds: [],\r\n            startBinding: null,\r\n            endBinding: null,\r\n            points: [\r\n              [0, 7.353019816743884],\r\n              [27.83862617888879, -22.225520498325494],\r\n              [8.264592146857424, -56.153846153846075],\r\n            ],\r\n            lastCommittedPoint: null,\r\n            startArrowhead: null,\r\n            endArrowhead: null,\r\n          },\r\n          {\r\n            type: \"line\",\r\n            version: 1073,\r\n            versionNonce: 1882028957,\r\n            isDeleted: false,\r\n            id: \"ToHMYIBkfksup2TsytqYY\",\r\n            fillStyle: \"hachure\",\r\n            strokeWidth: 1,\r\n            strokeStyle: \"solid\",\r\n            roughness: 1,\r\n            opacity: 100,\r\n            angle: 6.084301356735907,\r\n            x: 322.0112475413562,\r\n            y: 438.19116472600126,\r\n            strokeColor: \"#000000\",\r\n            backgroundColor: \"#000000\",\r\n            width: 29.199302190040857,\r\n            height: 60.02703769822892,\r\n            seed: 1788681551,\r\n            groupIds: [\"pdFncHLcB1-TCiUDvfvYB\"],\r\n            strokeSharpness: \"round\",\r\n            boundElementIds: [],\r\n            startBinding: null,\r\n            endBinding: null,\r\n            points: [\r\n              [3.380784807392175, 6.950114621305829],\r\n              [-25.81851738264868, -9.144091138364173],\r\n              [-14.166293663014217, -53.076923076923094],\r\n            ],\r\n            lastCommittedPoint: null,\r\n            startArrowhead: null,\r\n            endArrowhead: null,\r\n          },\r\n          {\r\n            type: \"rectangle\",\r\n            version: 865,\r\n            versionNonce: 271538355,\r\n            isDeleted: false,\r\n            id: \"FjmS1OJIszRkqG1M_Ne0X\",\r\n            fillStyle: \"hachure\",\r\n            strokeWidth: 1,\r\n            strokeStyle: \"solid\",\r\n            roughness: 1,\r\n            opacity: 100,\r\n            angle: 6.110994492656649,\r\n            x: 319.2559857389925,\r\n            y: 389.20283936917417,\r\n            strokeColor: \"#000000\",\r\n            backgroundColor: \"#000000\",\r\n            width: 48.70230284004767,\r\n            height: 32.01197584771487,\r\n            seed: 1663932801,\r\n            groupIds: [\"pdFncHLcB1-TCiUDvfvYB\"],\r\n            strokeSharpness: \"round\",\r\n            boundElementIds: [],\r\n          },\r\n          {\r\n            type: \"line\",\r\n            version: 1490,\r\n            versionNonce: 1335230461,\r\n            isDeleted: false,\r\n            id: \"ib5q4jwH6YLl0BvxEpjeW\",\r\n            fillStyle: \"solid\",\r\n            strokeWidth: 1,\r\n            strokeStyle: \"solid\",\r\n            roughness: 1,\r\n            opacity: 100,\r\n            angle: 0,\r\n            x: 349.2798248776245,\r\n            y: 410.8487300304048,\r\n            strokeColor: \"#000000\",\r\n            backgroundColor: \"#ffffff\",\r\n            width: 31.19410176445818,\r\n            height: 12.919374200592463,\r\n            seed: 1311881295,\r\n            groupIds: [\"pdFncHLcB1-TCiUDvfvYB\"],\r\n            strokeSharpness: \"round\",\r\n            boundElementIds: [],\r\n            startBinding: null,\r\n            endBinding: null,\r\n            points: [\r\n              [2.880001887449388, 0.4128593237959122],\r\n              [-8.828596770142477, 1.1912150300106055],\r\n              [-21.994117647058943, 0.38624887230115307],\r\n              [-4.244946500209904, 9.766433024121788],\r\n              [9.199984117399234, -3.1529411764706765],\r\n              [2.880001887449388, 0.4128593237959122],\r\n            ],\r\n            lastCommittedPoint: null,\r\n            startArrowhead: null,\r\n            endArrowhead: null,\r\n          },\r\n          {\r\n            type: \"ellipse\",\r\n            version: 913,\r\n            versionNonce: 482855507,\r\n            isDeleted: false,\r\n            id: \"kZA12dWsK7gAAeTRJLFeh\",\r\n            fillStyle: \"solid\",\r\n            strokeWidth: 1,\r\n            strokeStyle: \"solid\",\r\n            roughness: 1,\r\n            opacity: 100,\r\n            angle: 0,\r\n            x: 328.5320120870809,\r\n            y: 394.01491559143943,\r\n            strokeColor: \"#000000\",\r\n            backgroundColor: \"#ffffff\",\r\n            width: 9.998877149067804,\r\n            height: 11.103210886091052,\r\n            seed: 1251384609,\r\n            groupIds: [\"1SuVgRLZWtwQsIKuvN--w\", \"pdFncHLcB1-TCiUDvfvYB\"],\r\n            strokeSharpness: \"sharp\",\r\n            boundElementIds: [],\r\n          },\r\n          {\r\n            type: \"ellipse\",\r\n            version: 908,\r\n            versionNonce: 1278146653,\r\n            isDeleted: false,\r\n            id: \"up_ZJIAXzTQdcGl7anmD4\",\r\n            fillStyle: \"solid\",\r\n            strokeWidth: 1,\r\n            strokeStyle: \"solid\",\r\n            roughness: 0,\r\n            opacity: 100,\r\n            angle: 0,\r\n            x: 330.9800193681876,\r\n            y: 396.6816339481188,\r\n            strokeColor: \"#000000\",\r\n            backgroundColor: \"#000000\",\r\n            width: 3.053549308996914,\r\n            height: 4.071399078662633,\r\n            seed: 115274991,\r\n            groupIds: [\"1SuVgRLZWtwQsIKuvN--w\", \"pdFncHLcB1-TCiUDvfvYB\"],\r\n            strokeSharpness: \"sharp\",\r\n            boundElementIds: [],\r\n          },\r\n          {\r\n            type: \"ellipse\",\r\n            version: 914,\r\n            versionNonce: 211879923,\r\n            isDeleted: false,\r\n            id: \"pXHnoNRA5J1A3P4UffpTV\",\r\n            fillStyle: \"solid\",\r\n            strokeWidth: 1,\r\n            strokeStyle: \"solid\",\r\n            roughness: 1,\r\n            opacity: 100,\r\n            angle: 0,\r\n            x: 346.3890255899843,\r\n            y: 392.82444802457877,\r\n            strokeColor: \"#000000\",\r\n            backgroundColor: \"#ffffff\",\r\n            width: 9.998877149067804,\r\n            height: 11.103210886091052,\r\n            seed: 474641985,\r\n            groupIds: [\"MjtGnzTWnGk8dJsWOJvHA\", \"pdFncHLcB1-TCiUDvfvYB\"],\r\n            strokeSharpness: \"sharp\",\r\n            boundElementIds: [],\r\n          },\r\n          {\r\n            type: \"ellipse\",\r\n            version: 909,\r\n            versionNonce: 1338631357,\r\n            isDeleted: false,\r\n            id: \"8QDZ3WzdjQAZq90DdkY4j\",\r\n            fillStyle: \"solid\",\r\n            strokeWidth: 1,\r\n            strokeStyle: \"solid\",\r\n            roughness: 0,\r\n            opacity: 100,\r\n            angle: 0,\r\n            x: 348.8370328710926,\r\n            y: 395.49116638125906,\r\n            strokeColor: \"#000000\",\r\n            backgroundColor: \"#000000\",\r\n            width: 3.053549308996914,\r\n            height: 4.071399078662633,\r\n            seed: 2087701071,\r\n            groupIds: [\"MjtGnzTWnGk8dJsWOJvHA\", \"pdFncHLcB1-TCiUDvfvYB\"],\r\n            strokeSharpness: \"sharp\",\r\n            boundElementIds: [],\r\n          },\r\n        ],\r\n        [\r\n          {\r\n            type: \"line\",\r\n            version: 606,\r\n            versionNonce: 325818712,\r\n            isDeleted: false,\r\n            id: \"jolFzcHKSeMcQimE4bWv0\",\r\n            fillStyle: \"hachure\",\r\n            strokeWidth: 1,\r\n            strokeStyle: \"solid\",\r\n            roughness: 1,\r\n            opacity: 100,\r\n            angle: 0,\r\n            x: 440.78991887614376,\r\n            y: 388.8747872504298,\r\n            strokeColor: \"#000000\",\r\n            backgroundColor: \"#000000\",\r\n            width: 47.40828314724102,\r\n            height: 42.23647044026888,\r\n            seed: 1395374785,\r\n            groupIds: [\"OlqcxOUBJMiyTYP_GRksc\"],\r\n            strokeSharpness: \"sharp\",\r\n            boundElementIds: [],\r\n            startBinding: null,\r\n            endBinding: null,\r\n            points: [\r\n              [-7.494005416219807e-16, -0.17297480682640304],\r\n              [8.447294088053956, 37.2364704402688],\r\n              [38.61620154538881, 33.61620154538864],\r\n              [47.40828314724102, -5.0000000000000675],\r\n              [-7.494005416219807e-16, -0.17297480682640304],\r\n            ],\r\n            lastCommittedPoint: null,\r\n            startArrowhead: null,\r\n            endArrowhead: null,\r\n          },\r\n          {\r\n            type: \"line\",\r\n            version: 872,\r\n            versionNonce: 1572292648,\r\n            isDeleted: false,\r\n            id: \"6gNlvUY-yD-OMltu0OKeL\",\r\n            fillStyle: \"hachure\",\r\n            strokeWidth: 1,\r\n            strokeStyle: \"solid\",\r\n            roughness: 1,\r\n            opacity: 100,\r\n            angle: 0.40882349476951774,\r\n            x: 468.16026303777386,\r\n            y: 390.75731545781355,\r\n            strokeColor: \"#000000\",\r\n            backgroundColor: \"#000000\",\r\n            width: 4.3655066474850415,\r\n            height: 19.19795129578255,\r\n            seed: 1156847969,\r\n            groupIds: [\"OlqcxOUBJMiyTYP_GRksc\"],\r\n            strokeSharpness: \"round\",\r\n            boundElementIds: [],\r\n            startBinding: null,\r\n            endBinding: null,\r\n            points: [\r\n              [-0.15643644663716574, -0.687952058246376],\r\n              [-4.521943094122207, -10.649451500769453],\r\n              [-3.471485376985587, -19.885903354028926],\r\n            ],\r\n            lastCommittedPoint: null,\r\n            startArrowhead: null,\r\n            endArrowhead: null,\r\n          },\r\n          {\r\n            type: \"ellipse\",\r\n            version: 814,\r\n            versionNonce: 1918807640,\r\n            isDeleted: false,\r\n            id: \"cSn-_DJiIdLvI5gyG8dSM\",\r\n            fillStyle: \"hachure\",\r\n            strokeWidth: 1,\r\n            strokeStyle: \"solid\",\r\n            roughness: 1,\r\n            opacity: 100,\r\n            angle: 6.577355931884643,\r\n            x: 468.7545534381128,\r\n            y: 362.6417674911562,\r\n            strokeColor: \"#000000\",\r\n            backgroundColor: \"#000000\",\r\n            width: 7.455246158929383,\r\n            height: 8.602207106457122,\r\n            seed: 1191012655,\r\n            groupIds: [\"OlqcxOUBJMiyTYP_GRksc\"],\r\n            strokeSharpness: \"sharp\",\r\n            boundElementIds: [],\r\n          },\r\n          {\r\n            type: \"line\",\r\n            version: 1304,\r\n            versionNonce: 1793852200,\r\n            isDeleted: false,\r\n            id: \"_Khnnl2TzT9oGcFqs4vhM\",\r\n            fillStyle: \"hachure\",\r\n            strokeWidth: 1,\r\n            strokeStyle: \"solid\",\r\n            roughness: 1,\r\n            opacity: 100,\r\n            angle: 6.2138034488305856,\r\n            x: 471.8390065830894,\r\n            y: 428.8891966208175,\r\n            strokeColor: \"#000000\",\r\n            backgroundColor: \"#000000\",\r\n            width: 39.29300902779922,\r\n            height: 68.77782361754986,\r\n            seed: 1087128897,\r\n            groupIds: [\"OlqcxOUBJMiyTYP_GRksc\"],\r\n            strokeSharpness: \"round\",\r\n            boundElementIds: [],\r\n            startBinding: null,\r\n            endBinding: null,\r\n            points: [\r\n              [-0.8102077035983696, -0.030247553102711804],\r\n              [15.873190891755792, 8.929466148881628],\r\n              [6.883375094577075, 62.02561875508576],\r\n              [-11.356568691081847, 67.9034895553339],\r\n              [-23.419818136043432, 9.609146375181243],\r\n              [-1.81605595710515, -0.8743340622159508],\r\n            ],\r\n            lastCommittedPoint: null,\r\n            startArrowhead: null,\r\n            endArrowhead: null,\r\n          },\r\n          {\r\n            type: \"line\",\r\n            version: 979,\r\n            versionNonce: 203891544,\r\n            isDeleted: false,\r\n            id: \"29FnuivmBgF2WIRIOzwgX\",\r\n            fillStyle: \"hachure\",\r\n            strokeWidth: 1,\r\n            strokeStyle: \"solid\",\r\n            roughness: 1,\r\n            opacity: 100,\r\n            angle: 0.12535992280317831,\r\n            x: 483.9238134759266,\r\n            y: 432.2600303833312,\r\n            strokeColor: \"#000000\",\r\n            backgroundColor: \"#000000\",\r\n            width: 23.075399803185277,\r\n            height: 28.669461230941998,\r\n            seed: 888564559,\r\n            groupIds: [\"OlqcxOUBJMiyTYP_GRksc\"],\r\n            strokeSharpness: \"round\",\r\n            boundElementIds: [],\r\n            startBinding: null,\r\n            endBinding: null,\r\n            points: [\r\n              [0, 0],\r\n              [23.075399803185277, 11.381293186013435],\r\n              [6.744672688701114, 28.669461230941998],\r\n            ],\r\n            lastCommittedPoint: null,\r\n            startArrowhead: null,\r\n            endArrowhead: null,\r\n          },\r\n          {\r\n            type: \"line\",\r\n            version: 1173,\r\n            versionNonce: 131161640,\r\n            isDeleted: false,\r\n            id: \"iMg-Jv2LGmCa98Lt03BFU\",\r\n            fillStyle: \"hachure\",\r\n            strokeWidth: 1,\r\n            strokeStyle: \"solid\",\r\n            roughness: 1,\r\n            opacity: 100,\r\n            angle: 6.084301356735907,\r\n            x: 450.30020788716456,\r\n            y: 435.205830959623,\r\n            strokeColor: \"#000000\",\r\n            backgroundColor: \"#000000\",\r\n            width: 25.305332016762545,\r\n            height: 29.388604609666395,\r\n            seed: 208925985,\r\n            groupIds: [\"OlqcxOUBJMiyTYP_GRksc\"],\r\n            strokeSharpness: \"round\",\r\n            boundElementIds: [],\r\n            startBinding: null,\r\n            endBinding: null,\r\n            points: [\r\n              [-0.9068079701485557, 0],\r\n              [-26.212139986911097, 14.968302266693643],\r\n              [-8.167416572260866, 29.388604609666395],\r\n            ],\r\n            lastCommittedPoint: null,\r\n            startArrowhead: null,\r\n            endArrowhead: null,\r\n          },\r\n          {\r\n            type: \"line\",\r\n            version: 1697,\r\n            versionNonce: 521730136,\r\n            isDeleted: false,\r\n            id: \"oWptn0FRb3TZqzqq8LO-r\",\r\n            fillStyle: \"solid\",\r\n            strokeWidth: 1,\r\n            strokeStyle: \"solid\",\r\n            roughness: 1,\r\n            opacity: 100,\r\n            angle: 0,\r\n            x: 480.0754744236487,\r\n            y: 406.3262093487953,\r\n            strokeColor: \"#000000\",\r\n            backgroundColor: \"#ffffff\",\r\n            width: 29.12190170450102,\r\n            height: 14.277139397362983,\r\n            seed: 190490881,\r\n            groupIds: [\"OlqcxOUBJMiyTYP_GRksc\"],\r\n            strokeSharpness: \"round\",\r\n            boundElementIds: [],\r\n            startBinding: null,\r\n            endBinding: null,\r\n            points: [\r\n              [-1.026275966764388, 0],\r\n              [-13.217577143673564, 6.281164426432507],\r\n              [-20.089959093722122, 8.147383188369325],\r\n              [-29.665475151948044, 7.310467842129093],\r\n              [-16.839869702136237, 14.277139397362983],\r\n              [-0.5435734474470231, 1.737729069542447],\r\n            ],\r\n            lastCommittedPoint: null,\r\n            startArrowhead: null,\r\n            endArrowhead: null,\r\n          },\r\n          {\r\n            type: \"ellipse\",\r\n            version: 844,\r\n            versionNonce: 894654760,\r\n            isDeleted: false,\r\n            id: \"jHcnIXGBjVI6TFcJlnMXa\",\r\n            fillStyle: \"solid\",\r\n            strokeWidth: 1,\r\n            strokeStyle: \"solid\",\r\n            roughness: 1,\r\n            opacity: 100,\r\n            angle: 0,\r\n            x: 449.40232091576166,\r\n            y: 396.5338094165776,\r\n            strokeColor: \"#000000\",\r\n            backgroundColor: \"#ffffff\",\r\n            width: 9.998877149067804,\r\n            height: 11.103210886091052,\r\n            seed: 1807819663,\r\n            groupIds: [\"VFTxiX31iSFER_HftEm80\", \"OlqcxOUBJMiyTYP_GRksc\"],\r\n            strokeSharpness: \"sharp\",\r\n            boundElementIds: [],\r\n          },\r\n          {\r\n            type: \"ellipse\",\r\n            version: 847,\r\n            versionNonce: 2131242328,\r\n            isDeleted: false,\r\n            id: \"KOSXSZu6YQqZJ-UlzUC9x\",\r\n            fillStyle: \"solid\",\r\n            strokeWidth: 1,\r\n            strokeStyle: \"solid\",\r\n            roughness: 0,\r\n            opacity: 100,\r\n            angle: 0,\r\n            x: 451.8503281968671,\r\n            y: 399.20052777325634,\r\n            strokeColor: \"#000000\",\r\n            backgroundColor: \"#000000\",\r\n            width: 3.053549308996914,\r\n            height: 4.071399078662633,\r\n            seed: 117432545,\r\n            groupIds: [\"VFTxiX31iSFER_HftEm80\", \"OlqcxOUBJMiyTYP_GRksc\"],\r\n            strokeSharpness: \"sharp\",\r\n            boundElementIds: [],\r\n          },\r\n          {\r\n            type: \"ellipse\",\r\n            version: 831,\r\n            versionNonce: 1994257448,\r\n            isDeleted: false,\r\n            id: \"EKqTbi_nYYmQNSbJpJpW2\",\r\n            fillStyle: \"solid\",\r\n            strokeWidth: 1,\r\n            strokeStyle: \"solid\",\r\n            roughness: 1,\r\n            opacity: 100,\r\n            angle: 0,\r\n            x: 465.71468635685125,\r\n            y: 394.18485580335505,\r\n            strokeColor: \"#000000\",\r\n            backgroundColor: \"#ffffff\",\r\n            width: 9.998877149067804,\r\n            height: 11.103210886091052,\r\n            seed: 1377032623,\r\n            groupIds: [\"OlqcxOUBJMiyTYP_GRksc\"],\r\n            strokeSharpness: \"sharp\",\r\n            boundElementIds: [],\r\n          },\r\n          {\r\n            type: \"ellipse\",\r\n            version: 832,\r\n            versionNonce: 1699267160,\r\n            isDeleted: false,\r\n            id: \"diTddjodzafWKLYdU6xSZ\",\r\n            fillStyle: \"solid\",\r\n            strokeWidth: 1,\r\n            strokeStyle: \"solid\",\r\n            roughness: 0,\r\n            opacity: 100,\r\n            angle: 0,\r\n            x: 468.1626936379609,\r\n            y: 396.85157416003455,\r\n            strokeColor: \"#000000\",\r\n            backgroundColor: \"#000000\",\r\n            width: 3.053549308996914,\r\n            height: 4.071399078662633,\r\n            seed: 1827871937,\r\n            groupIds: [\"OlqcxOUBJMiyTYP_GRksc\"],\r\n            strokeSharpness: \"sharp\",\r\n            boundElementIds: [],\r\n          },\r\n        ],\r\n        [\r\n          {\r\n            type: \"line\",\r\n            version: 714,\r\n            versionNonce: 39661352,\r\n            isDeleted: false,\r\n            id: \"jd4Wjd5-oJHHKt-aEuG-8\",\r\n            fillStyle: \"hachure\",\r\n            strokeWidth: 1,\r\n            strokeStyle: \"solid\",\r\n            roughness: 1,\r\n            opacity: 100,\r\n            angle: 0,\r\n            x: 535.2190806089988,\r\n            y: 401.42312942706957,\r\n            strokeColor: \"#000000\",\r\n            backgroundColor: \"#000000\",\r\n            width: 62.6925637262964,\r\n            height: 36.30762427908835,\r\n            seed: 2056700225,\r\n            groupIds: [\"Z8SbsG4yz-KuGZYaPkqJA\"],\r\n            strokeSharpness: \"sharp\",\r\n            boundElementIds: [],\r\n            startBinding: null,\r\n            endBinding: null,\r\n            points: [\r\n              [0, 0],\r\n              [62.6925637262964, 1.8720462923091503],\r\n              [43.23335607798968, 36.09775361851542],\r\n              [9.863921046919952, 36.30762427908835],\r\n              [0, 0],\r\n            ],\r\n            lastCommittedPoint: null,\r\n            startArrowhead: null,\r\n            endArrowhead: null,\r\n          },\r\n          {\r\n            type: \"line\",\r\n            version: 674,\r\n            versionNonce: 1085192024,\r\n            isDeleted: false,\r\n            id: \"0niWpR15qstdvGbOE0cFV\",\r\n            fillStyle: \"hachure\",\r\n            strokeWidth: 1,\r\n            strokeStyle: \"solid\",\r\n            roughness: 1,\r\n            opacity: 100,\r\n            angle: 6.165054667603804,\r\n            x: 565.304796421962,\r\n            y: 400.51588299886987,\r\n            strokeColor: \"#000000\",\r\n            backgroundColor: \"#000000\",\r\n            width: 9.847632855647175,\r\n            height: 20.38712415985236,\r\n            seed: 751566799,\r\n            groupIds: [\"Z8SbsG4yz-KuGZYaPkqJA\"],\r\n            strokeSharpness: \"round\",\r\n            boundElementIds: [],\r\n            startBinding: null,\r\n            endBinding: null,\r\n            points: [\r\n              [-0.24011909376834667, -0.7305656635651329],\r\n              [2.906763888257258, -13.870172853278925],\r\n              [-6.9408689673899175, -21.117689823417493],\r\n            ],\r\n            lastCommittedPoint: null,\r\n            startArrowhead: null,\r\n            endArrowhead: null,\r\n          },\r\n          {\r\n            type: \"ellipse\",\r\n            version: 704,\r\n            versionNonce: 1883048488,\r\n            isDeleted: false,\r\n            id: \"Rgm15jsI9bBiJvOLnOKvX\",\r\n            fillStyle: \"hachure\",\r\n            strokeWidth: 1,\r\n            strokeStyle: \"solid\",\r\n            roughness: 1,\r\n            opacity: 100,\r\n            angle: 6.165054667603804,\r\n            x: 547.4748133342842,\r\n            y: 372.49171199022635,\r\n            strokeColor: \"#000000\",\r\n            backgroundColor: \"#000000\",\r\n            width: 9.654050386347059,\r\n            height: 11.139288907323724,\r\n            seed: 1439688865,\r\n            groupIds: [\"Z8SbsG4yz-KuGZYaPkqJA\"],\r\n            strokeSharpness: \"sharp\",\r\n            boundElementIds: [],\r\n          },\r\n          {\r\n            type: \"ellipse\",\r\n            version: 771,\r\n            versionNonce: 93195352,\r\n            isDeleted: false,\r\n            id: \"Crv-DH1xY9vzNjqjUbTBu\",\r\n            fillStyle: \"solid\",\r\n            strokeWidth: 1,\r\n            strokeStyle: \"solid\",\r\n            roughness: 1,\r\n            opacity: 100,\r\n            angle: 6.165054667603804,\r\n            x: 569.8626088207701,\r\n            y: 408.71879587114165,\r\n            strokeColor: \"#000000\",\r\n            backgroundColor: \"#ffffff\",\r\n            width: 14.43030675701005,\r\n            height: 7.864899525844297,\r\n            seed: 722177455,\r\n            groupIds: [\"Z8SbsG4yz-KuGZYaPkqJA\"],\r\n            strokeSharpness: \"sharp\",\r\n            boundElementIds: [],\r\n          },\r\n          {\r\n            type: \"ellipse\",\r\n            version: 853,\r\n            versionNonce: 1802077480,\r\n            isDeleted: false,\r\n            id: \"YVWZ0fOHMx2wMAWQkz9r8\",\r\n            fillStyle: \"solid\",\r\n            strokeWidth: 1,\r\n            strokeStyle: \"solid\",\r\n            roughness: 1,\r\n            opacity: 100,\r\n            angle: 6.165054667603804,\r\n            x: 547.5733243362038,\r\n            y: 410.77612753520935,\r\n            strokeColor: \"#000000\",\r\n            backgroundColor: \"#ffffff\",\r\n            width: 12.73852411923849,\r\n            height: 8.065685741300339,\r\n            seed: 125872321,\r\n            groupIds: [\"Z8SbsG4yz-KuGZYaPkqJA\"],\r\n            strokeSharpness: \"sharp\",\r\n            boundElementIds: [],\r\n          },\r\n          {\r\n            type: \"line\",\r\n            version: 659,\r\n            versionNonce: 2109391192,\r\n            isDeleted: false,\r\n            id: \"LZy147QNgdcGeAlH8EwlG\",\r\n            fillStyle: \"cross-hatch\",\r\n            strokeWidth: 1,\r\n            strokeStyle: \"solid\",\r\n            roughness: 1,\r\n            opacity: 100,\r\n            angle: 0.585636727785606,\r\n            x: 567.2135266454284,\r\n            y: 408.51659328807324,\r\n            strokeColor: \"#000000\",\r\n            backgroundColor: \"#ffffff\",\r\n            width: 16.99112867997105,\r\n            height: 6.178592247262278,\r\n            seed: 502869487,\r\n            groupIds: [\"Z8SbsG4yz-KuGZYaPkqJA\"],\r\n            strokeSharpness: \"round\",\r\n            boundElementIds: [],\r\n            startBinding: null,\r\n            endBinding: null,\r\n            points: [\r\n              [0, 0],\r\n              [16.99112867997105, -6.178592247262278],\r\n            ],\r\n            lastCommittedPoint: null,\r\n            startArrowhead: null,\r\n            endArrowhead: null,\r\n          },\r\n          {\r\n            type: \"line\",\r\n            version: 682,\r\n            versionNonce: 1632542760,\r\n            isDeleted: false,\r\n            id: \"Dgigozd_YaXorDzOKIiE2\",\r\n            fillStyle: \"cross-hatch\",\r\n            strokeWidth: 1,\r\n            strokeStyle: \"solid\",\r\n            roughness: 1,\r\n            opacity: 100,\r\n            angle: 5.633127811824813,\r\n            x: 543.9993274322642,\r\n            y: 405.83569996438683,\r\n            strokeColor: \"#000000\",\r\n            backgroundColor: \"#ffffff\",\r\n            width: 15.83264263360934,\r\n            height: 4.247782169992625,\r\n            seed: 1005333633,\r\n            groupIds: [\"Z8SbsG4yz-KuGZYaPkqJA\"],\r\n            strokeSharpness: \"round\",\r\n            boundElementIds: [],\r\n            startBinding: null,\r\n            endBinding: null,\r\n            points: [\r\n              [0, 0],\r\n              [15.83264263360934, 4.247782169992625],\r\n            ],\r\n            lastCommittedPoint: null,\r\n            startArrowhead: null,\r\n            endArrowhead: null,\r\n          },\r\n          {\r\n            type: \"ellipse\",\r\n            version: 551,\r\n            versionNonce: 411620952,\r\n            isDeleted: false,\r\n            id: \"kAMF4RIbBhOPsLP6N40_O\",\r\n            fillStyle: \"solid\",\r\n            strokeWidth: 1,\r\n            strokeStyle: \"solid\",\r\n            roughness: 1,\r\n            opacity: 100,\r\n            angle: 0,\r\n            x: 552.8313382713591,\r\n            y: 425.71674019433516,\r\n            strokeColor: \"#000000\",\r\n            backgroundColor: \"#ffffff\",\r\n            width: 23.567240649023955,\r\n            height: 7.950394435815332,\r\n            seed: 1343436783,\r\n            groupIds: [\"Z8SbsG4yz-KuGZYaPkqJA\"],\r\n            strokeSharpness: \"round\",\r\n            boundElementIds: [],\r\n          },\r\n          {\r\n            type: \"ellipse\",\r\n            version: 710,\r\n            versionNonce: 836262696,\r\n            isDeleted: false,\r\n            id: \"Jqe002qKW6nE5I0mvIy0B\",\r\n            fillStyle: \"solid\",\r\n            strokeWidth: 1,\r\n            strokeStyle: \"solid\",\r\n            roughness: 0,\r\n            opacity: 100,\r\n            angle: 0,\r\n            x: 573.5847071754209,\r\n            y: 412.0363829115653,\r\n            strokeColor: \"#000000\",\r\n            backgroundColor: \"#000000\",\r\n            width: 3.2823771313580172,\r\n            height: 4.344322673856117,\r\n            seed: 1001853423,\r\n            groupIds: [\"Z8SbsG4yz-KuGZYaPkqJA\"],\r\n            strokeSharpness: \"sharp\",\r\n            boundElementIds: [],\r\n          },\r\n          {\r\n            type: \"ellipse\",\r\n            version: 736,\r\n            versionNonce: 986467160,\r\n            isDeleted: false,\r\n            id: \"_oVnCbOoONOOelmM_bRIA\",\r\n            fillStyle: \"solid\",\r\n            strokeWidth: 1,\r\n            strokeStyle: \"solid\",\r\n            roughness: 0,\r\n            opacity: 100,\r\n            angle: 0,\r\n            x: 551.4769317906872,\r\n            y: 413.87065248496947,\r\n            strokeColor: \"#000000\",\r\n            backgroundColor: \"#000000\",\r\n            width: 3.2823771313580172,\r\n            height: 4.344322673856117,\r\n            seed: 1540618817,\r\n            groupIds: [\"Z8SbsG4yz-KuGZYaPkqJA\"],\r\n            strokeSharpness: \"sharp\",\r\n            boundElementIds: [],\r\n          },\r\n          {\r\n            type: \"line\",\r\n            version: 541,\r\n            versionNonce: 1601353256,\r\n            isDeleted: false,\r\n            id: \"yWyemnQw49dVrT09IS-vR\",\r\n            fillStyle: \"hachure\",\r\n            strokeWidth: 1,\r\n            strokeStyle: \"solid\",\r\n            roughness: 1,\r\n            opacity: 100,\r\n            angle: 0,\r\n            x: 547.0288198527583,\r\n            y: 503.5027954198498,\r\n            strokeColor: \"#000000\",\r\n            backgroundColor: \"#000000\",\r\n            width: 58.80194326229637,\r\n            height: 52.65845665280284,\r\n            seed: 634649185,\r\n            groupIds: [\"Z8SbsG4yz-KuGZYaPkqJA\"],\r\n            strokeSharpness: \"sharp\",\r\n            boundElementIds: [],\r\n            startBinding: null,\r\n            endBinding: null,\r\n            points: [\r\n              [6.439293542825908e-15, -1.8869978926517579],\r\n              [2.6329228326401335, -51.03489076860089],\r\n              [36.86091965696167, -54.545454545454604],\r\n              [58.801943262296376, -4.519920725291943],\r\n              [6.439293542825908e-15, -1.8869978926517579],\r\n            ],\r\n            lastCommittedPoint: null,\r\n            startArrowhead: null,\r\n            endArrowhead: null,\r\n          },\r\n        ],\r\n        [\r\n          {\r\n            type: \"rectangle\",\r\n            version: 839,\r\n            versionNonce: 456383784,\r\n            isDeleted: false,\r\n            id: \"HYi6lqCh597E0AiEnQ9-X\",\r\n            fillStyle: \"hachure\",\r\n            strokeWidth: 1,\r\n            strokeStyle: \"solid\",\r\n            roughness: 1,\r\n            opacity: 100,\r\n            angle: 0.014568579661670356,\r\n            x: 644.3396703858152,\r\n            y: 444.25294387443466,\r\n            strokeColor: \"#000000\",\r\n            backgroundColor: \"#000000\",\r\n            width: 38.66867631909674,\r\n            height: 57.647654987761875,\r\n            seed: 1577227297,\r\n            groupIds: [\"rc9uGFrrgBqZEFKc9if20\", \"fxa8XBA4ETG8ng2ISwYc4\"],\r\n            strokeSharpness: \"sharp\",\r\n            boundElementIds: [],\r\n          },\r\n          {\r\n            type: \"rectangle\",\r\n            version: 1247,\r\n            versionNonce: 1214376280,\r\n            isDeleted: false,\r\n            id: \"ncTnDWCm5JN9ybxNDhazR\",\r\n            fillStyle: \"hachure\",\r\n            strokeWidth: 1,\r\n            strokeStyle: \"solid\",\r\n            roughness: 1,\r\n            opacity: 100,\r\n            angle: 0.0668427887355465,\r\n            x: 645.112152353377,\r\n            y: 386.77998684854623,\r\n            strokeColor: \"#000000\",\r\n            backgroundColor: \"#000000\",\r\n            width: 36.72105729863782,\r\n            height: 44.61740983709184,\r\n            seed: 1748564591,\r\n            groupIds: [\"rc9uGFrrgBqZEFKc9if20\", \"fxa8XBA4ETG8ng2ISwYc4\"],\r\n            strokeSharpness: \"sharp\",\r\n            boundElementIds: [],\r\n          },\r\n          {\r\n            type: \"ellipse\",\r\n            version: 714,\r\n            versionNonce: 1443756072,\r\n            isDeleted: false,\r\n            id: \"y1lILx4cmAn2ZVuON6w9G\",\r\n            fillStyle: \"solid\",\r\n            strokeWidth: 1,\r\n            strokeStyle: \"solid\",\r\n            roughness: 1,\r\n            opacity: 100,\r\n            angle: 6.165054667603804,\r\n            x: 668.1679324660117,\r\n            y: 399.83629535351236,\r\n            strokeColor: \"#000000\",\r\n            backgroundColor: \"#ffffff\",\r\n            width: 10.396669646835477,\r\n            height: 6.360124902644969,\r\n            seed: 1663947919,\r\n            groupIds: [\"rc9uGFrrgBqZEFKc9if20\", \"fxa8XBA4ETG8ng2ISwYc4\"],\r\n            strokeSharpness: \"sharp\",\r\n            boundElementIds: [],\r\n          },\r\n          {\r\n            type: \"ellipse\",\r\n            version: 759,\r\n            versionNonce: 1410006616,\r\n            isDeleted: false,\r\n            id: \"zrVoaMkMu-KF7wTdxojew\",\r\n            fillStyle: \"solid\",\r\n            strokeWidth: 1,\r\n            strokeStyle: \"solid\",\r\n            roughness: 1,\r\n            opacity: 100,\r\n            angle: 6.165054667603804,\r\n            x: 649.7398850211175,\r\n            y: 400.0124740835258,\r\n            strokeColor: \"#000000\",\r\n            backgroundColor: \"#ffffff\",\r\n            width: 10.396669646835477,\r\n            height: 6.252879334295419,\r\n            seed: 246595553,\r\n            groupIds: [\"rc9uGFrrgBqZEFKc9if20\", \"fxa8XBA4ETG8ng2ISwYc4\"],\r\n            strokeSharpness: \"sharp\",\r\n            boundElementIds: [],\r\n          },\r\n          {\r\n            type: \"ellipse\",\r\n            version: 784,\r\n            versionNonce: 82621224,\r\n            isDeleted: false,\r\n            id: \"hCROJqFJ-3gPQXXFCZ5V0\",\r\n            fillStyle: \"hachure\",\r\n            strokeWidth: 1,\r\n            strokeStyle: \"solid\",\r\n            roughness: 1,\r\n            opacity: 100,\r\n            angle: 6.277260558372609,\r\n            x: 659.2161497469867,\r\n            y: 352.6925919728596,\r\n            strokeColor: \"#000000\",\r\n            backgroundColor: \"#000000\",\r\n            width: 9.654050386347059,\r\n            height: 11.139288907323724,\r\n            seed: 1492261825,\r\n            groupIds: [\"rc9uGFrrgBqZEFKc9if20\", \"fxa8XBA4ETG8ng2ISwYc4\"],\r\n            strokeSharpness: \"sharp\",\r\n            boundElementIds: [],\r\n          },\r\n          {\r\n            type: \"line\",\r\n            version: 586,\r\n            versionNonce: 331969368,\r\n            isDeleted: false,\r\n            id: \"zGj8pI88NP_fwR72zx-Ck\",\r\n            fillStyle: \"solid\",\r\n            strokeWidth: 1,\r\n            strokeStyle: \"solid\",\r\n            roughness: 1,\r\n            opacity: 100,\r\n            angle: 0.10819877806948064,\r\n            x: 689.2230624187562,\r\n            y: 456.3879911350568,\r\n            strokeColor: \"#000000\",\r\n            backgroundColor: \"#000000\",\r\n            width: 20.080815058259102,\r\n            height: 54.449032901179656,\r\n            seed: 1624893409,\r\n            groupIds: [\"rc9uGFrrgBqZEFKc9if20\", \"fxa8XBA4ETG8ng2ISwYc4\"],\r\n            strokeSharpness: \"round\",\r\n            boundElementIds: [],\r\n            startBinding: null,\r\n            endBinding: null,\r\n            points: [\r\n              [-0.6036608530029228, -9.550967098820346],\r\n              [17.28081505825903, -37.11579000504263],\r\n              [-2.800000000000068, -64],\r\n            ],\r\n            lastCommittedPoint: null,\r\n            startArrowhead: null,\r\n            endArrowhead: null,\r\n          },\r\n          {\r\n            type: \"line\",\r\n            version: 670,\r\n            versionNonce: 2117865000,\r\n            isDeleted: false,\r\n            id: \"uXUoX4Sle80g6N9oudEAN\",\r\n            fillStyle: \"solid\",\r\n            strokeWidth: 1,\r\n            strokeStyle: \"solid\",\r\n            roughness: 1,\r\n            opacity: 100,\r\n            angle: 6.166243390806045,\r\n            x: 635.8642124159935,\r\n            y: 462.1929272596362,\r\n            strokeColor: \"#000000\",\r\n            backgroundColor: \"#000000\",\r\n            width: 8.294093674613084,\r\n            height: 49.04257596264366,\r\n            seed: 2077357679,\r\n            groupIds: [\"rc9uGFrrgBqZEFKc9if20\", \"fxa8XBA4ETG8ng2ISwYc4\"],\r\n            strokeSharpness: \"round\",\r\n            boundElementIds: [],\r\n            startBinding: null,\r\n            endBinding: null,\r\n            points: [\r\n              [4.586927178952186, -14.957424037356342],\r\n              [-2.800000000000068, -39.78522811844476],\r\n              [5.494093674613016, -64],\r\n            ],\r\n            lastCommittedPoint: null,\r\n            startArrowhead: null,\r\n            endArrowhead: null,\r\n          },\r\n          {\r\n            type: \"line\",\r\n            version: 532,\r\n            versionNonce: 502351960,\r\n            isDeleted: false,\r\n            id: \"IZzczUYbmUfUPXDQGErhD\",\r\n            fillStyle: \"solid\",\r\n            strokeWidth: 1,\r\n            strokeStyle: \"solid\",\r\n            roughness: 1,\r\n            opacity: 100,\r\n            angle: 0,\r\n            x: 650.8283149263683,\r\n            y: 417.46207399123745,\r\n            strokeColor: \"#000000\",\r\n            backgroundColor: \"#ffffff\",\r\n            width: 22.687018407916085,\r\n            height: 8.302483332258584,\r\n            seed: 577268161,\r\n            groupIds: [\"rc9uGFrrgBqZEFKc9if20\", \"fxa8XBA4ETG8ng2ISwYc4\"],\r\n            strokeSharpness: \"sharp\",\r\n            boundElementIds: [],\r\n            startBinding: null,\r\n            endBinding: null,\r\n            points: [\r\n              [0, -0.02075697681917438],\r\n              [22.687018407916085, -0.6000000000001364],\r\n              [22.01123488087173, 7.7024833322584465],\r\n              [0, -0.02075697681917438],\r\n            ],\r\n            lastCommittedPoint: null,\r\n            startArrowhead: null,\r\n            endArrowhead: null,\r\n          },\r\n          {\r\n            type: \"line\",\r\n            version: 457,\r\n            versionNonce: 1793591592,\r\n            isDeleted: false,\r\n            id: \"xqT37zQLky2bw1fCD9ZMD\",\r\n            fillStyle: \"hachure\",\r\n            strokeWidth: 1,\r\n            strokeStyle: \"solid\",\r\n            roughness: 1,\r\n            opacity: 100,\r\n            angle: 0,\r\n            x: 661.0359859197184,\r\n            y: 387.37051575653123,\r\n            strokeColor: \"#000000\",\r\n            backgroundColor: \"#000000\",\r\n            width: 7.530159301350863,\r\n            height: 23.26626143109672,\r\n            seed: 1905031503,\r\n            groupIds: [\"rc9uGFrrgBqZEFKc9if20\", \"fxa8XBA4ETG8ng2ISwYc4\"],\r\n            strokeSharpness: \"sharp\",\r\n            boundElementIds: [],\r\n            startBinding: null,\r\n            endBinding: null,\r\n            points: [\r\n              [-0.13146085318807582, -0.8337385689033033],\r\n              [-3.800000000000068, -15.314814148424059],\r\n              [3.730159301350794, -11.45319399388521],\r\n              [1.9924302318082365, -24.100000000000023],\r\n            ],\r\n            lastCommittedPoint: null,\r\n            startArrowhead: null,\r\n            endArrowhead: null,\r\n          },\r\n          {\r\n            type: \"ellipse\",\r\n            version: 889,\r\n            versionNonce: 508984664,\r\n            isDeleted: false,\r\n            id: \"CreJF9iBU2MtFu19OT9LB\",\r\n            fillStyle: \"solid\",\r\n            strokeWidth: 1,\r\n            strokeStyle: \"solid\",\r\n            roughness: 0,\r\n            opacity: 100,\r\n            angle: 0,\r\n            x: 672.2013770073286,\r\n            y: 401.11466798045694,\r\n            strokeColor: \"#000000\",\r\n            backgroundColor: \"#000000\",\r\n            width: 1.456031352953936,\r\n            height: 2.4738811226196695,\r\n            seed: 1173361967,\r\n            groupIds: [\r\n              \"vAtUfXcOytLcQhXJarDb2\",\r\n              \"vSleFlEW1Ua6A_EqHWLxS\",\r\n              \"fxa8XBA4ETG8ng2ISwYc4\",\r\n            ],\r\n            strokeSharpness: \"sharp\",\r\n            boundElementIds: [],\r\n          },\r\n          {\r\n            type: \"ellipse\",\r\n            version: 919,\r\n            versionNonce: 1985782824,\r\n            isDeleted: false,\r\n            id: \"nl6HW2liftoexyiD61qgV\",\r\n            fillStyle: \"solid\",\r\n            strokeWidth: 1,\r\n            strokeStyle: \"solid\",\r\n            roughness: 0,\r\n            opacity: 100,\r\n            angle: 0,\r\n            x: 654.6286794908563,\r\n            y: 400.22715800487777,\r\n            strokeColor: \"#000000\",\r\n            backgroundColor: \"#000000\",\r\n            width: 1.456031352953936,\r\n            height: 2.4738811226196695,\r\n            seed: 1948080495,\r\n            groupIds: [\r\n              \"NHdrxDLcQUFGmrHpB-ZU3\",\r\n              \"QEr2ViUz5sReBPJeXfxqU\",\r\n              \"fxa8XBA4ETG8ng2ISwYc4\",\r\n            ],\r\n            strokeSharpness: \"sharp\",\r\n            boundElementIds: [],\r\n          },\r\n        ],\r\n        [\r\n          {\r\n            type: \"rectangle\",\r\n            version: 869,\r\n            versionNonce: 562778920,\r\n            isDeleted: false,\r\n            id: \"yjtgyrSnBnPc6gC_9MEDO\",\r\n            fillStyle: \"hachure\",\r\n            strokeWidth: 1,\r\n            strokeStyle: \"solid\",\r\n            roughness: 1,\r\n            opacity: 100,\r\n            angle: 0.08816579050139062,\r\n            x: 740.872330546093,\r\n            y: 445.646685103804,\r\n            strokeColor: \"#000000\",\r\n            backgroundColor: \"#000000\",\r\n            width: 55.99349224081355,\r\n            height: 54.17256566387651,\r\n            seed: 1237580975,\r\n            groupIds: [\"Iag0JzYr9B_Wibv9i2G1U\"],\r\n            strokeSharpness: \"sharp\",\r\n            boundElementIds: [],\r\n          },\r\n          {\r\n            type: \"rectangle\",\r\n            version: 1184,\r\n            versionNonce: 233100120,\r\n            isDeleted: false,\r\n            id: \"ew5dwIV6AH7E2WHuWQjY9\",\r\n            fillStyle: \"hachure\",\r\n            strokeWidth: 1,\r\n            strokeStyle: \"solid\",\r\n            roughness: 1,\r\n            opacity: 100,\r\n            angle: 6.165054667603804,\r\n            x: 735.0745098974359,\r\n            y: 393.5198406047036,\r\n            strokeColor: \"#000000\",\r\n            backgroundColor: \"#000000\",\r\n            width: 65.64754262716068,\r\n            height: 38.72608504572105,\r\n            seed: 571124161,\r\n            groupIds: [\"Iag0JzYr9B_Wibv9i2G1U\"],\r\n            strokeSharpness: \"sharp\",\r\n            boundElementIds: [],\r\n          },\r\n          {\r\n            type: \"rectangle\",\r\n            version: 830,\r\n            versionNonce: 1309060648,\r\n            isDeleted: false,\r\n            id: \"tC4j7_ZOWTrPI4GSXmfJK\",\r\n            fillStyle: \"solid\",\r\n            strokeWidth: 1,\r\n            strokeStyle: \"solid\",\r\n            roughness: 1,\r\n            opacity: 100,\r\n            angle: 6.165054667603804,\r\n            x: 746.0781882258868,\r\n            y: 418.99491056231363,\r\n            strokeColor: \"#000000\",\r\n            backgroundColor: \"#ffffff\",\r\n            width: 37.1309630244122,\r\n            height: 7.426192604882432,\r\n            seed: 1486786255,\r\n            groupIds: [\r\n              \"Zg2ZSsUHx7EL4kELWxZ0D\",\r\n              \"TKXWYEzzzxjqRhyNe4gfV\",\r\n              \"Iag0JzYr9B_Wibv9i2G1U\",\r\n            ],\r\n            strokeSharpness: \"sharp\",\r\n            boundElementIds: [],\r\n          },\r\n          {\r\n            type: \"ellipse\",\r\n            version: 719,\r\n            versionNonce: 2107680856,\r\n            isDeleted: false,\r\n            id: \"mw6x9wu76GjrTYHGZ8sFT\",\r\n            fillStyle: \"solid\",\r\n            strokeWidth: 1,\r\n            strokeStyle: \"solid\",\r\n            roughness: 1,\r\n            opacity: 100,\r\n            angle: 6.165054667603804,\r\n            x: 771.675518302783,\r\n            y: 402.0527868403099,\r\n            strokeColor: \"#000000\",\r\n            backgroundColor: \"#ffffff\",\r\n            width: 10.396669646835477,\r\n            height: 5.1983348234177384,\r\n            seed: 1903282593,\r\n            groupIds: [\r\n              \"Zg2ZSsUHx7EL4kELWxZ0D\",\r\n              \"TKXWYEzzzxjqRhyNe4gfV\",\r\n              \"Iag0JzYr9B_Wibv9i2G1U\",\r\n            ],\r\n            strokeSharpness: \"sharp\",\r\n            boundElementIds: [],\r\n          },\r\n          {\r\n            type: \"ellipse\",\r\n            version: 785,\r\n            versionNonce: 677292328,\r\n            isDeleted: false,\r\n            id: \"gzaPiYIZdJ-TRNc0c_3F4\",\r\n            fillStyle: \"solid\",\r\n            strokeWidth: 1,\r\n            strokeStyle: \"solid\",\r\n            roughness: 1,\r\n            opacity: 100,\r\n            angle: 6.165054667603804,\r\n            x: 746.0894690266408,\r\n            y: 405.2416717926886,\r\n            strokeColor: \"#000000\",\r\n            backgroundColor: \"#ffffff\",\r\n            width: 10.396669646835477,\r\n            height: 5.1983348234177384,\r\n            seed: 1856101615,\r\n            groupIds: [\"TKXWYEzzzxjqRhyNe4gfV\", \"Iag0JzYr9B_Wibv9i2G1U\"],\r\n            strokeSharpness: \"sharp\",\r\n            boundElementIds: [],\r\n          },\r\n          {\r\n            type: \"line\",\r\n            version: 684,\r\n            versionNonce: 286907736,\r\n            isDeleted: false,\r\n            id: \"XRNSJSPWNLRqCqboYpzKF\",\r\n            fillStyle: \"hachure\",\r\n            strokeWidth: 1,\r\n            strokeStyle: \"solid\",\r\n            roughness: 1,\r\n            opacity: 100,\r\n            angle: 6.165054667603804,\r\n            x: 760.9965197426477,\r\n            y: 393.7436161849685,\r\n            strokeColor: \"#000000\",\r\n            backgroundColor: \"#868e96\",\r\n            width: 4.459288508946652,\r\n            height: 22.408583758848973,\r\n            seed: 715779457,\r\n            groupIds: [\"Iag0JzYr9B_Wibv9i2G1U\"],\r\n            strokeSharpness: \"sharp\",\r\n            boundElementIds: [],\r\n            startBinding: null,\r\n            endBinding: null,\r\n            points: [\r\n              [0, 0],\r\n              [-4.459288508946652, -22.408583758848973],\r\n            ],\r\n            lastCommittedPoint: null,\r\n            startArrowhead: null,\r\n            endArrowhead: null,\r\n          },\r\n          {\r\n            type: \"ellipse\",\r\n            version: 733,\r\n            versionNonce: 201278504,\r\n            isDeleted: false,\r\n            id: \"92rca6DBLCrg-HwhNwKXj\",\r\n            fillStyle: \"hachure\",\r\n            strokeWidth: 1,\r\n            strokeStyle: \"solid\",\r\n            roughness: 1,\r\n            opacity: 100,\r\n            angle: 6.165054667603804,\r\n            x: 748.097716693347,\r\n            y: 358.69043898717456,\r\n            strokeColor: \"#000000\",\r\n            backgroundColor: \"#000000\",\r\n            width: 9.654050386347059,\r\n            height: 11.139288907323724,\r\n            seed: 525756175,\r\n            groupIds: [\"Iag0JzYr9B_Wibv9i2G1U\"],\r\n            strokeSharpness: \"sharp\",\r\n            boundElementIds: [],\r\n          },\r\n          {\r\n            type: \"line\",\r\n            version: 611,\r\n            versionNonce: 698643032,\r\n            isDeleted: false,\r\n            id: \"W6imutdlKGNHvX8qkbMS2\",\r\n            fillStyle: \"cross-hatch\",\r\n            strokeWidth: 4,\r\n            strokeStyle: \"solid\",\r\n            roughness: 1,\r\n            opacity: 100,\r\n            angle: 0,\r\n            x: 765.8420846775126,\r\n            y: 401.8128937117839,\r\n            strokeColor: \"#000000\",\r\n            backgroundColor: \"#ffffff\",\r\n            width: 16.99112867997105,\r\n            height: 6.178592247262278,\r\n            seed: 1962055009,\r\n            groupIds: [\"Iag0JzYr9B_Wibv9i2G1U\"],\r\n            strokeSharpness: \"round\",\r\n            boundElementIds: [],\r\n            startBinding: null,\r\n            endBinding: null,\r\n            points: [\r\n              [0, 0],\r\n              [16.99112867997105, -6.178592247262278],\r\n            ],\r\n            lastCommittedPoint: null,\r\n            startArrowhead: null,\r\n            endArrowhead: null,\r\n          },\r\n          {\r\n            type: \"line\",\r\n            version: 615,\r\n            versionNonce: 114589480,\r\n            isDeleted: false,\r\n            id: \"5mQdUy-5piWUxT9qqxCF2\",\r\n            fillStyle: \"cross-hatch\",\r\n            strokeWidth: 4,\r\n            strokeStyle: \"solid\",\r\n            roughness: 1,\r\n            opacity: 100,\r\n            angle: 0,\r\n            x: 742.6784595486769,\r\n            y: 399.13535245276864,\r\n            strokeColor: \"#000000\",\r\n            backgroundColor: \"#ffffff\",\r\n            width: 15.83264263360934,\r\n            height: 4.247782169992625,\r\n            seed: 2033495343,\r\n            groupIds: [\"Iag0JzYr9B_Wibv9i2G1U\"],\r\n            strokeSharpness: \"round\",\r\n            boundElementIds: [],\r\n            startBinding: null,\r\n            endBinding: null,\r\n            points: [\r\n              [0, 0],\r\n              [15.83264263360934, 4.247782169992625],\r\n            ],\r\n            lastCommittedPoint: null,\r\n            startArrowhead: null,\r\n            endArrowhead: null,\r\n          },\r\n        ],\r\n        [\r\n          {\r\n            type: \"line\",\r\n            version: 1139,\r\n            versionNonce: 1577411037,\r\n            isDeleted: false,\r\n            id: \"DEGz_mFiOQ8bXVkxUUdhf\",\r\n            fillStyle: \"hachure\",\r\n            strokeWidth: 1,\r\n            strokeStyle: \"solid\",\r\n            roughness: 1,\r\n            opacity: 100,\r\n            angle: 0,\r\n            x: 839.5374984587603,\r\n            y: 436.5663856264034,\r\n            strokeColor: \"#000000\",\r\n            backgroundColor: \"#000000\",\r\n            width: 38.700134526939216,\r\n            height: 41.09804445825503,\r\n            seed: 30553839,\r\n            groupIds: [\"FfCIwDz1faTyiGRIf4d24\"],\r\n            strokeSharpness: \"sharp\",\r\n            boundElementIds: [],\r\n            startBinding: null,\r\n            endBinding: null,\r\n            points: [\r\n              [-1.0547118733938987e-14, -1.3304501113604008],\r\n              [30.527151848505653, 2.6401286562272457],\r\n              [38.70013452693921, -37.409098410551046],\r\n              [12.040147130871471, -38.45791580202779],\r\n              [16.694898806561174, -34.28591854060036],\r\n              [12.070754208201851, -30.052006973213672],\r\n              [13.092131701001364, -23.854965496129527],\r\n              [5.545750015708212, -22.104163985801055],\r\n              [7.141903424318434, -15.60798787478241],\r\n              [0.09654050386358382, -12.336067551796397],\r\n              [-1.0547118733938987e-14, -1.3304501113604008],\r\n            ],\r\n            lastCommittedPoint: null,\r\n            startArrowhead: null,\r\n            endArrowhead: null,\r\n          },\r\n          {\r\n            type: \"ellipse\",\r\n            version: 896,\r\n            versionNonce: 2027943539,\r\n            isDeleted: false,\r\n            id: \"gRHCmVjDWx0qbLBWPHQ68\",\r\n            fillStyle: \"hachure\",\r\n            strokeWidth: 1,\r\n            strokeStyle: \"solid\",\r\n            roughness: 1,\r\n            opacity: 100,\r\n            angle: 6.277260558372609,\r\n            x: 868.916756448169,\r\n            y: 368.4257820337684,\r\n            strokeColor: \"#000000\",\r\n            backgroundColor: \"#000000\",\r\n            width: 11.117511358158096,\r\n            height: 12.827897720951864,\r\n            seed: 1444274383,\r\n            groupIds: [\"FfCIwDz1faTyiGRIf4d24\"],\r\n            strokeSharpness: \"sharp\",\r\n            boundElementIds: [],\r\n          },\r\n          {\r\n            type: \"line\",\r\n            version: 852,\r\n            versionNonce: 2115444285,\r\n            isDeleted: false,\r\n            id: \"xUsxJgi5vcv-YTek5lSKE\",\r\n            fillStyle: \"solid\",\r\n            strokeWidth: 1,\r\n            strokeStyle: \"solid\",\r\n            roughness: 1,\r\n            opacity: 100,\r\n            angle: 0.10819877806948064,\r\n            x: 872.8088154623009,\r\n            y: 442.12807674546195,\r\n            strokeColor: \"#000000\",\r\n            backgroundColor: \"#000000\",\r\n            width: 6.322930561396941,\r\n            height: 36.05183242751564,\r\n            seed: 659593121,\r\n            groupIds: [\"FfCIwDz1faTyiGRIf4d24\"],\r\n            strokeSharpness: \"round\",\r\n            boundElementIds: [],\r\n            startBinding: null,\r\n            endBinding: null,\r\n            points: [\r\n              [0, 0],\r\n              [6.322930561396941, 17.368716333943812],\r\n              [5.617089575862162, 36.05183242751564],\r\n            ],\r\n            lastCommittedPoint: null,\r\n            startArrowhead: null,\r\n            endArrowhead: null,\r\n          },\r\n          {\r\n            type: \"line\",\r\n            version: 828,\r\n            versionNonce: 1763618835,\r\n            isDeleted: false,\r\n            id: \"-360UZzCo3Jl1R8lxknyH\",\r\n            fillStyle: \"solid\",\r\n            strokeWidth: 1,\r\n            strokeStyle: \"solid\",\r\n            roughness: 1,\r\n            opacity: 100,\r\n            angle: 6.166243390806045,\r\n            x: 826.5813426835809,\r\n            y: 480.9156988112269,\r\n            strokeColor: \"#000000\",\r\n            backgroundColor: \"#000000\",\r\n            width: 12.746462961131993,\r\n            height: 40.91175341949343,\r\n            seed: 626978543,\r\n            groupIds: [\"FfCIwDz1faTyiGRIf4d24\"],\r\n            strokeSharpness: \"round\",\r\n            boundElementIds: [],\r\n            startBinding: null,\r\n            endBinding: null,\r\n            points: [\r\n              [0, 4.112372603505656],\r\n              [2.9136934016410403, -19.443432933568978],\r\n              [12.746462961131993, -36.799380815987774],\r\n            ],\r\n            lastCommittedPoint: null,\r\n            startArrowhead: null,\r\n            endArrowhead: null,\r\n          },\r\n          {\r\n            type: \"line\",\r\n            version: 816,\r\n            versionNonce: 1098010269,\r\n            isDeleted: false,\r\n            id: \"l9BU4kq8G1eQsLIYu1RcM\",\r\n            fillStyle: \"solid\",\r\n            strokeWidth: 1,\r\n            strokeStyle: \"solid\",\r\n            roughness: 1,\r\n            opacity: 100,\r\n            angle: 0,\r\n            x: 844.0807019241851,\r\n            y: 428.809226790325,\r\n            strokeColor: \"#000000\",\r\n            backgroundColor: \"#ffffff\",\r\n            width: 22.986018316823586,\r\n            height: 7.29174385229854,\r\n            seed: 394197889,\r\n            groupIds: [\"FfCIwDz1faTyiGRIf4d24\"],\r\n            strokeSharpness: \"sharp\",\r\n            boundElementIds: [],\r\n            startBinding: null,\r\n            endBinding: null,\r\n            points: [\r\n              [0, -0.2161389497264186],\r\n              [4.976525147627398, -6.247700277628326],\r\n              [22.986018316823586, -5.81104784667765],\r\n              [22.232312219517866, 1.0440435746702137],\r\n              [11.985020644530067, -2.5788033072956984],\r\n              [0, -0.2161389497264186],\r\n            ],\r\n            lastCommittedPoint: null,\r\n            startArrowhead: null,\r\n            endArrowhead: null,\r\n          },\r\n          {\r\n            type: \"line\",\r\n            version: 609,\r\n            versionNonce: 9778611,\r\n            isDeleted: false,\r\n            id: \"HiGlT3l6RjpDndaxRn_CL\",\r\n            fillStyle: \"hachure\",\r\n            strokeWidth: 1,\r\n            strokeStyle: \"solid\",\r\n            roughness: 1,\r\n            opacity: 100,\r\n            angle: 0,\r\n            x: 839.9127602172,\r\n            y: 443.49507080910695,\r\n            strokeColor: \"#000000\",\r\n            backgroundColor: \"#000000\",\r\n            width: 37.91356437525757,\r\n            height: 57.8680719411826,\r\n            seed: 1327066639,\r\n            groupIds: [\"FfCIwDz1faTyiGRIf4d24\"],\r\n            strokeSharpness: \"sharp\",\r\n            boundElementIds: [],\r\n            startBinding: null,\r\n            endBinding: null,\r\n            points: [\r\n              [-0.13279741335563172, 4.996003610813204e-16],\r\n              [5.080670138686129, 27.3661818046972],\r\n              [-3.83863453274191, 57.868071941182606],\r\n              [31.412318681049904, 56.307579352095814],\r\n              [26.093126816145904, 26.225924229501388],\r\n              [34.07492984251567, 0.28506439379895454],\r\n              [-2.128248169948171, 1.4253219689946346],\r\n            ],\r\n            lastCommittedPoint: null,\r\n            startArrowhead: null,\r\n            endArrowhead: null,\r\n          },\r\n          {\r\n            type: \"line\",\r\n            version: 543,\r\n            versionNonce: 1724412669,\r\n            isDeleted: false,\r\n            id: \"IZ38hs83M2dVCi8o1geHM\",\r\n            fillStyle: \"hachure\",\r\n            strokeWidth: 1,\r\n            strokeStyle: \"solid\",\r\n            roughness: 1,\r\n            opacity: 100,\r\n            angle: 0,\r\n            x: 863.7828914967383,\r\n            y: 393.86436308845964,\r\n            strokeColor: \"#000000\",\r\n            backgroundColor: \"#000000\",\r\n            width: 9.122060601565927,\r\n            height: 19.38437877832716,\r\n            seed: 202689711,\r\n            groupIds: [\"FfCIwDz1faTyiGRIf4d24\"],\r\n            strokeSharpness: \"sharp\",\r\n            boundElementIds: [],\r\n            startBinding: null,\r\n            endBinding: null,\r\n            points: [\r\n              [0.171924824332047, 1.9484813424297018],\r\n              [-1.538461538461661, -17.43589743589746],\r\n              [7.583599063104267, -14.015124710310321],\r\n            ],\r\n            lastCommittedPoint: null,\r\n            startArrowhead: null,\r\n            endArrowhead: null,\r\n          },\r\n          {\r\n            type: \"line\",\r\n            version: 260,\r\n            versionNonce: 510265171,\r\n            isDeleted: false,\r\n            id: \"Oj05lJIbDbGTzt8O49XQI\",\r\n            fillStyle: \"hachure\",\r\n            strokeWidth: 2,\r\n            strokeStyle: \"solid\",\r\n            roughness: 1,\r\n            opacity: 100,\r\n            angle: 0.01308272954904588,\r\n            x: 860.0969832980525,\r\n            y: 404.7434821550822,\r\n            strokeColor: \"#000000\",\r\n            backgroundColor: \"#000000\",\r\n            width: 8.180078289956866,\r\n            height: 8.589394453634425,\r\n            seed: 197179087,\r\n            groupIds: [\"0J7yS00va_10KpHmmG1CO\", \"FfCIwDz1faTyiGRIf4d24\"],\r\n            strokeSharpness: \"sharp\",\r\n            boundElementIds: [],\r\n            startBinding: null,\r\n            endBinding: null,\r\n            points: [\r\n              [0, 0],\r\n              [8.180078289956866, 8.589394453634425],\r\n            ],\r\n            lastCommittedPoint: null,\r\n            startArrowhead: null,\r\n            endArrowhead: null,\r\n          },\r\n          {\r\n            type: \"line\",\r\n            version: 299,\r\n            versionNonce: 1520110429,\r\n            isDeleted: false,\r\n            id: \"ttLnnoTVijdTn3u6OPYcA\",\r\n            fillStyle: \"hachure\",\r\n            strokeWidth: 2,\r\n            strokeStyle: \"solid\",\r\n            roughness: 1,\r\n            opacity: 100,\r\n            angle: 0,\r\n            x: 861.000180107874,\r\n            y: 414.701904870445,\r\n            strokeColor: \"#000000\",\r\n            backgroundColor: \"#000000\",\r\n            width: 7.076176466002194,\r\n            height: 6.203610018742806,\r\n            seed: 1122310511,\r\n            groupIds: [\"0J7yS00va_10KpHmmG1CO\", \"FfCIwDz1faTyiGRIf4d24\"],\r\n            strokeSharpness: \"sharp\",\r\n            boundElementIds: [],\r\n            startBinding: null,\r\n            endBinding: null,\r\n            points: [\r\n              [0, 0],\r\n              [7.076176466002194, -6.203610018742806],\r\n            ],\r\n            lastCommittedPoint: null,\r\n            startArrowhead: null,\r\n            endArrowhead: null,\r\n          },\r\n        ],\r\n      ],\r\n    };\r\n  }\r\n  if (data === \"shapes\") {\r\n    return {\r\n      library: [\r\n        [\r\n          {\r\n            angle: 0,\r\n            backgroundColor: \"#fa5252\",\r\n            fillStyle: \"solid\",\r\n            height: 120.0,\r\n            id: \"8f1332969db0f22d8896b0f6c8054993\",\r\n            opacity: 100,\r\n            points: [\r\n              [-0.0, -80.0],\r\n              [69.282, 40.0],\r\n              [-69.282, 40.0],\r\n              [-0.0, -80.0],\r\n            ],\r\n            roughness: 1,\r\n            seed: 91057222,\r\n            strokeColor: \"#000000\",\r\n            strokeSharpness: \"sharp\",\r\n            strokeWidth: 1,\r\n            type: \"line\",\r\n            width: 138.5641,\r\n            x: 0.0,\r\n            y: 0.0,\r\n          },\r\n        ],\r\n        [\r\n          {\r\n            angle: 0,\r\n            backgroundColor: \"#e64980\",\r\n            fillStyle: \"solid\",\r\n            height: 144.7214,\r\n            id: \"c496d055eea0c36bdc83c183c0f3ef57\",\r\n            opacity: 100,\r\n            points: [\r\n              [-0.0, -80.0],\r\n              [76.0845, -24.7214],\r\n              [47.0228, 64.7214],\r\n              [-47.0228, 64.7214],\r\n              [-76.0845, -24.7214],\r\n              [-0.0, -80.0],\r\n            ],\r\n            roughness: 1,\r\n            seed: 17345929,\r\n            strokeColor: \"#000000\",\r\n            strokeSharpness: \"sharp\",\r\n            strokeWidth: 1,\r\n            type: \"line\",\r\n            width: 152.169,\r\n            x: 200.0,\r\n            y: 0.0,\r\n          },\r\n        ],\r\n        [\r\n          {\r\n            angle: 0,\r\n            backgroundColor: \"#be4bdb\",\r\n            fillStyle: \"solid\",\r\n            height: 160.0,\r\n            id: \"4767e3c0a2df8803195354c7e30ea962\",\r\n            opacity: 100,\r\n            points: [\r\n              [-0.0, -80.0],\r\n              [69.282, -40.0],\r\n              [69.282, 40.0],\r\n              [0.0, 80.0],\r\n              [-69.282, 40.0],\r\n              [-69.282, -40.0],\r\n              [-0.0, -80.0],\r\n            ],\r\n            roughness: 1,\r\n            seed: 24012311,\r\n            strokeColor: \"#000000\",\r\n            strokeSharpness: \"sharp\",\r\n            strokeWidth: 1,\r\n            type: \"line\",\r\n            width: 138.5641,\r\n            x: 400.0,\r\n            y: 0.0,\r\n          },\r\n        ],\r\n        [\r\n          {\r\n            angle: 0,\r\n            backgroundColor: \"#7950f2\",\r\n            fillStyle: \"solid\",\r\n            height: 160.0,\r\n            id: \"db9ab5cbffd211a81bae1d2e905c7d13\",\r\n            opacity: 100,\r\n            points: [\r\n              [-0.0, -80.0],\r\n              [56.5685, -56.5685],\r\n              [80.0, -0.0],\r\n              [56.5685, 56.5685],\r\n              [0.0, 80.0],\r\n              [-56.5685, 56.5685],\r\n              [-80.0, 0.0],\r\n              [-56.5685, -56.5685],\r\n              [-0.0, -80.0],\r\n            ],\r\n            roughness: 1,\r\n            seed: 11962164,\r\n            strokeColor: \"#000000\",\r\n            strokeSharpness: \"sharp\",\r\n            strokeWidth: 1,\r\n            type: \"line\",\r\n            width: 160.0,\r\n            x: 0.0,\r\n            y: 200.0,\r\n          },\r\n        ],\r\n        [\r\n          {\r\n            angle: 0,\r\n            backgroundColor: \"#4c6ef5\",\r\n            fillStyle: \"solid\",\r\n            height: 160.0,\r\n            id: \"62e21884bb277d4483371396a869b831\",\r\n            opacity: 100,\r\n            points: [\r\n              [-0.0, -80.0],\r\n              [47.0228, -64.7214],\r\n              [76.0845, -24.7214],\r\n              [76.0845, 24.7214],\r\n              [47.0228, 64.7214],\r\n              [0.0, 80.0],\r\n              [-47.0228, 64.7214],\r\n              [-76.0845, 24.7214],\r\n              [-76.0845, -24.7214],\r\n              [-47.0228, -64.7214],\r\n              [-0.0, -80.0],\r\n            ],\r\n            roughness: 1,\r\n            seed: 11225442,\r\n            strokeColor: \"#000000\",\r\n            strokeSharpness: \"sharp\",\r\n            strokeWidth: 1,\r\n            type: \"line\",\r\n            width: 152.169,\r\n            x: 200.0,\r\n            y: 200.0,\r\n          },\r\n        ],\r\n        [\r\n          {\r\n            angle: 0,\r\n            backgroundColor: \"#228be6\",\r\n            fillStyle: \"solid\",\r\n            height: 160.0,\r\n            id: \"edec070a7cd97053161e589af07f04e1\",\r\n            opacity: 100,\r\n            points: [\r\n              [-0.0, -80.0],\r\n              [40.0, -69.282],\r\n              [69.282, -40.0],\r\n              [80.0, -0.0],\r\n              [69.282, 40.0],\r\n              [40.0, 69.282],\r\n              [0.0, 80.0],\r\n              [-40.0, 69.282],\r\n              [-69.282, 40.0],\r\n              [-80.0, 0.0],\r\n              [-69.282, -40.0],\r\n              [-40.0, -69.282],\r\n              [-0.0, -80.0],\r\n            ],\r\n            roughness: 1,\r\n            seed: 74592834,\r\n            strokeColor: \"#000000\",\r\n            strokeSharpness: \"sharp\",\r\n            strokeWidth: 1,\r\n            type: \"line\",\r\n            width: 160.0,\r\n            x: 400.0,\r\n            y: 200.0,\r\n          },\r\n        ],\r\n      ],\r\n      type: \"excalidrawlib\",\r\n      version: 1,\r\n    };\r\n  }\r\n  if (data === \"stars\") {\r\n    return {\r\n      library: [\r\n        [\r\n          {\r\n            angle: 0,\r\n            backgroundColor: \"#fa5252\",\r\n            fillStyle: \"solid\",\r\n            height: 120.0,\r\n            id: \"0fe51e592ee32afbd20154eaf80518c8\",\r\n            opacity: 100,\r\n            points: [\r\n              [25.9808, -15.0],\r\n              [69.282, 40.0],\r\n              [0.0, 30.0],\r\n              [-69.282, 40.0],\r\n              [-25.9808, -15.0],\r\n              [-0.0, -80.0],\r\n              [25.9808, -15.0],\r\n            ],\r\n            roughness: 1,\r\n            seed: 33945122,\r\n            strokeColor: \"#000000\",\r\n            strokeSharpness: \"sharp\",\r\n            strokeWidth: 1,\r\n            type: \"line\",\r\n            width: 138.5641,\r\n            x: 0.0,\r\n            y: 0.0,\r\n          },\r\n        ],\r\n        [\r\n          {\r\n            angle: 0,\r\n            backgroundColor: \"#e64980\",\r\n            fillStyle: \"solid\",\r\n            height: 160.0,\r\n            id: \"5ae50b149b13e2339c974a9c8d580848\",\r\n            opacity: 100,\r\n            points: [\r\n              [21.2132, 21.2132],\r\n              [0.0, 80.0],\r\n              [-21.2132, 21.2132],\r\n              [-80.0, 0.0],\r\n              [-21.2132, -21.2132],\r\n              [-0.0, -80.0],\r\n              [21.2132, -21.2132],\r\n              [80.0, -0.0],\r\n              [21.2132, 21.2132],\r\n            ],\r\n            roughness: 1,\r\n            seed: 94731548,\r\n            strokeColor: \"#000000\",\r\n            strokeSharpness: \"sharp\",\r\n            strokeWidth: 1,\r\n            type: \"line\",\r\n            width: 160.0,\r\n            x: 200.0,\r\n            y: 0.0,\r\n          },\r\n        ],\r\n        [\r\n          {\r\n            angle: 0,\r\n            backgroundColor: \"#be4bdb\",\r\n            fillStyle: \"solid\",\r\n            height: 144.7214,\r\n            id: \"b123c4fbc5b7e76d333216ba14edb1cb\",\r\n            opacity: 100,\r\n            points: [\r\n              [28.5317, 9.2705],\r\n              [47.0228, 64.7214],\r\n              [0.0, 30.0],\r\n              [-47.0228, 64.7214],\r\n              [-28.5317, 9.2705],\r\n              [-76.0845, -24.7214],\r\n              [-17.6336, -24.2705],\r\n              [-0.0, -80.0],\r\n              [17.6336, -24.2705],\r\n              [76.0845, -24.7214],\r\n              [28.5317, 9.2705],\r\n            ],\r\n            roughness: 1,\r\n            seed: 57882669,\r\n            strokeColor: \"#000000\",\r\n            strokeSharpness: \"sharp\",\r\n            strokeWidth: 1,\r\n            type: \"line\",\r\n            width: 152.169,\r\n            x: 400.0,\r\n            y: 0.0,\r\n          },\r\n        ],\r\n        [\r\n          {\r\n            angle: 0,\r\n            backgroundColor: \"#7950f2\",\r\n            fillStyle: \"solid\",\r\n            height: 160.0,\r\n            id: \"00daf88f327aadad417c4f03bee67fe5\",\r\n            opacity: 100,\r\n            points: [\r\n              [30.0, 0.0],\r\n              [69.282, 40.0],\r\n              [15.0, 25.9808],\r\n              [0.0, 80.0],\r\n              [-15.0, 25.9808],\r\n              [-69.282, 40.0],\r\n              [-30.0, 0.0],\r\n              [-69.282, -40.0],\r\n              [-15.0, -25.9808],\r\n              [-0.0, -80.0],\r\n              [15.0, -25.9808],\r\n              [69.282, -40.0],\r\n              [30.0, -0.0],\r\n            ],\r\n            roughness: 1,\r\n            seed: 49490600,\r\n            strokeColor: \"#000000\",\r\n            strokeSharpness: \"sharp\",\r\n            strokeWidth: 1,\r\n            type: \"line\",\r\n            width: 138.5641,\r\n            x: 600.0,\r\n            y: 0.0,\r\n          },\r\n        ],\r\n        [\r\n          {\r\n            angle: 0,\r\n            backgroundColor: \"#4c6ef5\",\r\n            fillStyle: \"solid\",\r\n            height: 152.0775,\r\n            id: \"4e0f0c3bd8beefebc158ac9ec9f6804b\",\r\n            opacity: 100,\r\n            points: [\r\n              [29.2478, -6.6756],\r\n              [77.9942, 17.8017],\r\n              [23.4549, 18.7047],\r\n              [34.7107, 72.0775],\r\n              [0.0, 30.0],\r\n              [-34.7107, 72.0775],\r\n              [-23.4549, 18.7047],\r\n              [-77.9942, 17.8017],\r\n              [-29.2478, -6.6756],\r\n              [-62.5465, -49.8792],\r\n              [-13.0165, -27.0291],\r\n              [-0.0, -80.0],\r\n              [13.0165, -27.0291],\r\n              [62.5465, -49.8792],\r\n              [29.2478, -6.6756],\r\n            ],\r\n            roughness: 1,\r\n            seed: 22527050,\r\n            strokeColor: \"#000000\",\r\n            strokeSharpness: \"sharp\",\r\n            strokeWidth: 1,\r\n            type: \"line\",\r\n            width: 155.9885,\r\n            x: 0.0,\r\n            y: 200.0,\r\n          },\r\n        ],\r\n        [\r\n          {\r\n            angle: 0,\r\n            backgroundColor: \"#228be6\",\r\n            fillStyle: \"solid\",\r\n            height: 160.0,\r\n            id: \"a5882e39faf3e884d03674bb609d3f3a\",\r\n            opacity: 100,\r\n            points: [\r\n              [27.7164, 11.4805],\r\n              [56.5685, 56.5685],\r\n              [11.4805, 27.7164],\r\n              [0.0, 80.0],\r\n              [-11.4805, 27.7164],\r\n              [-56.5685, 56.5685],\r\n              [-27.7164, 11.4805],\r\n              [-80.0, 0.0],\r\n              [-27.7164, -11.4805],\r\n              [-56.5685, -56.5685],\r\n              [-11.4805, -27.7164],\r\n              [-0.0, -80.0],\r\n              [11.4805, -27.7164],\r\n              [56.5685, -56.5685],\r\n              [27.7164, -11.4805],\r\n              [80.0, -0.0],\r\n              [27.7164, 11.4805],\r\n            ],\r\n            roughness: 1,\r\n            seed: 95517090,\r\n            strokeColor: \"#000000\",\r\n            strokeSharpness: \"sharp\",\r\n            strokeWidth: 1,\r\n            type: \"line\",\r\n            width: 160.0,\r\n            x: 200.0,\r\n            y: 200.0,\r\n          },\r\n        ],\r\n        [\r\n          {\r\n            angle: 0,\r\n            backgroundColor: \"#15aabf\",\r\n            fillStyle: \"solid\",\r\n            height: 155.1754,\r\n            id: \"e90ff07cb3956cade23061cb98474f7f\",\r\n            opacity: 100,\r\n            points: [\r\n              [29.5442, 5.2094],\r\n              [69.282, 40.0],\r\n              [19.2836, 22.9813],\r\n              [27.3616, 75.1754],\r\n              [0.0, 30.0],\r\n              [-27.3616, 75.1754],\r\n              [-19.2836, 22.9813],\r\n              [-69.282, 40.0],\r\n              [-29.5442, 5.2094],\r\n              [-78.7846, -13.8919],\r\n              [-25.9808, -15.0],\r\n              [-51.423, -61.2836],\r\n              [-10.2606, -28.1908],\r\n              [-0.0, -80.0],\r\n              [10.2606, -28.1908],\r\n              [51.423, -61.2836],\r\n              [25.9808, -15.0],\r\n              [78.7846, -13.8919],\r\n              [29.5442, 5.2094],\r\n            ],\r\n            roughness: 1,\r\n            seed: 92346747,\r\n            strokeColor: \"#000000\",\r\n            strokeSharpness: \"sharp\",\r\n            strokeWidth: 1,\r\n            type: \"line\",\r\n            width: 157.5692,\r\n            x: 400.0,\r\n            y: 200.0,\r\n          },\r\n        ],\r\n        [\r\n          {\r\n            angle: 0,\r\n            backgroundColor: \"#12b886\",\r\n            fillStyle: \"solid\",\r\n            height: 160.0,\r\n            id: \"e6bd8ecb501dd14bbeef49e3145415cc\",\r\n            opacity: 100,\r\n            points: [\r\n              [30.0, 0.0],\r\n              [76.0845, 24.7214],\r\n              [24.2705, 17.6336],\r\n              [47.0228, 64.7214],\r\n              [9.2705, 28.5317],\r\n              [0.0, 80.0],\r\n              [-9.2705, 28.5317],\r\n              [-47.0228, 64.7214],\r\n              [-24.2705, 17.6336],\r\n              [-76.0845, 24.7214],\r\n              [-30.0, 0.0],\r\n              [-76.0845, -24.7214],\r\n              [-24.2705, -17.6336],\r\n              [-47.0228, -64.7214],\r\n              [-9.2705, -28.5317],\r\n              [-0.0, -80.0],\r\n              [9.2705, -28.5317],\r\n              [47.0228, -64.7214],\r\n              [24.2705, -17.6336],\r\n              [76.0845, -24.7214],\r\n              [30.0, -0.0],\r\n            ],\r\n            roughness: 1,\r\n            seed: 20014366,\r\n            strokeColor: \"#000000\",\r\n            strokeSharpness: \"sharp\",\r\n            strokeWidth: 1,\r\n            type: \"line\",\r\n            width: 152.169,\r\n            x: 600.0,\r\n            y: 200.0,\r\n          },\r\n        ],\r\n        [\r\n          {\r\n            angle: 0,\r\n            backgroundColor: \"#40c057\",\r\n            fillStyle: \"solid\",\r\n            height: 156.7594,\r\n            id: \"14d412d836731d78e8aa87f5aee32c80\",\r\n            opacity: 100,\r\n            points: [\r\n              [29.6946, -4.2694],\r\n              [79.1857, 11.3852],\r\n              [27.289, 12.4625],\r\n              [60.46, 52.3889],\r\n              [16.2192, 25.2376],\r\n              [22.5386, 76.7594],\r\n              [0.0, 30.0],\r\n              [-22.5386, 76.7594],\r\n              [-16.2192, 25.2376],\r\n              [-60.46, 52.3889],\r\n              [-27.289, 12.4625],\r\n              [-79.1857, 11.3852],\r\n              [-29.6946, -4.2694],\r\n              [-72.7706, -33.2332],\r\n              [-22.6725, -19.6458],\r\n              [-43.2513, -67.3003],\r\n              [-8.452, -28.7848],\r\n              [-0.0, -80.0],\r\n              [8.452, -28.7848],\r\n              [43.2513, -67.3003],\r\n              [22.6725, -19.6458],\r\n              [72.7706, -33.2332],\r\n              [29.6946, -4.2694],\r\n            ],\r\n            roughness: 1,\r\n            seed: 30329855,\r\n            strokeColor: \"#000000\",\r\n            strokeSharpness: \"sharp\",\r\n            strokeWidth: 1,\r\n            type: \"line\",\r\n            width: 158.3714,\r\n            x: 0.0,\r\n            y: 400.0,\r\n          },\r\n        ],\r\n        [\r\n          {\r\n            angle: 0,\r\n            backgroundColor: \"#82c91e\",\r\n            fillStyle: \"solid\",\r\n            height: 160.0,\r\n            id: \"74ccdaf0fa17979c48dfa76797d2e4d1\",\r\n            opacity: 100,\r\n            points: [\r\n              [28.9778, 7.7646],\r\n              [69.282, 40.0],\r\n              [21.2132, 21.2132],\r\n              [40.0, 69.282],\r\n              [7.7646, 28.9778],\r\n              [0.0, 80.0],\r\n              [-7.7646, 28.9778],\r\n              [-40.0, 69.282],\r\n              [-21.2132, 21.2132],\r\n              [-69.282, 40.0],\r\n              [-28.9778, 7.7646],\r\n              [-80.0, 0.0],\r\n              [-28.9778, -7.7646],\r\n              [-69.282, -40.0],\r\n              [-21.2132, -21.2132],\r\n              [-40.0, -69.282],\r\n              [-7.7646, -28.9778],\r\n              [-0.0, -80.0],\r\n              [7.7646, -28.9778],\r\n              [40.0, -69.282],\r\n              [21.2132, -21.2132],\r\n              [69.282, -40.0],\r\n              [28.9778, -7.7646],\r\n              [80.0, -0.0],\r\n              [28.9778, 7.7646],\r\n            ],\r\n            roughness: 1,\r\n            seed: 1384629,\r\n            strokeColor: \"#000000\",\r\n            strokeSharpness: \"sharp\",\r\n            strokeWidth: 1,\r\n            type: \"line\",\r\n            width: 160.0,\r\n            x: 200.0,\r\n            y: 400.0,\r\n          },\r\n        ],\r\n        [\r\n          {\r\n            angle: 0,\r\n            backgroundColor: \"#fab005\",\r\n            fillStyle: \"solid\",\r\n            height: 160.0,\r\n            id: \"002ffd7441b9c9f031778db62981643d\",\r\n            opacity: 100,\r\n            points: [\r\n              [29.7433, 3.9158],\r\n              [77.2741, 20.7055],\r\n              [27.7164, 11.4805],\r\n              [69.282, 40.0],\r\n              [23.8006, 18.2628],\r\n              [56.5685, 56.5685],\r\n              [18.2628, 23.8006],\r\n              [40.0, 69.282],\r\n              [11.4805, 27.7164],\r\n              [20.7055, 77.2741],\r\n              [3.9158, 29.7433],\r\n              [0.0, 80.0],\r\n              [-3.9158, 29.7433],\r\n              [-20.7055, 77.2741],\r\n              [-11.4805, 27.7164],\r\n              [-40.0, 69.282],\r\n              [-18.2628, 23.8006],\r\n              [-56.5685, 56.5685],\r\n              [-23.8006, 18.2628],\r\n              [-69.282, 40.0],\r\n              [-27.7164, 11.4805],\r\n              [-77.2741, 20.7055],\r\n              [-29.7433, 3.9158],\r\n              [-80.0, 0.0],\r\n              [-29.7433, -3.9158],\r\n              [-77.2741, -20.7055],\r\n              [-27.7164, -11.4805],\r\n              [-69.282, -40.0],\r\n              [-23.8006, -18.2628],\r\n              [-56.5685, -56.5685],\r\n              [-18.2628, -23.8006],\r\n              [-40.0, -69.282],\r\n              [-11.4805, -27.7164],\r\n              [-20.7055, -77.2741],\r\n              [-3.9158, -29.7433],\r\n              [-0.0, -80.0],\r\n              [3.9158, -29.7433],\r\n              [20.7055, -77.2741],\r\n              [11.4805, -27.7164],\r\n              [40.0, -69.282],\r\n              [18.2628, -23.8006],\r\n              [56.5685, -56.5685],\r\n              [23.8006, -18.2628],\r\n              [69.282, -40.0],\r\n              [27.7164, -11.4805],\r\n              [77.2741, -20.7055],\r\n              [29.7433, -3.9158],\r\n              [80.0, -0.0],\r\n              [29.7433, 3.9158],\r\n            ],\r\n            roughness: 1,\r\n            seed: 94396149,\r\n            strokeColor: \"#000000\",\r\n            strokeSharpness: \"sharp\",\r\n            strokeWidth: 1,\r\n            type: \"line\",\r\n            width: 160.0,\r\n            x: 400.0,\r\n            y: 400.0,\r\n          },\r\n        ],\r\n        [\r\n          {\r\n            angle: 0,\r\n            backgroundColor: \"#fd7e14\",\r\n            fillStyle: \"solid\",\r\n            height: 160.0,\r\n            id: \"bfb3cec8cf8720592eab75a5cf69fc0f\",\r\n            opacity: 100,\r\n            points: [\r\n              [29.8555, 2.9405],\r\n              [78.4628, 15.6072],\r\n              [28.7082, 8.7085],\r\n              [73.9104, 30.6147],\r\n              [26.4576, 14.1419],\r\n              [66.5176, 44.4456],\r\n              [23.1903, 19.0318],\r\n              [56.5685, 56.5685],\r\n              [19.0318, 23.1903],\r\n              [44.4456, 66.5176],\r\n              [14.1419, 26.4576],\r\n              [30.6147, 73.9104],\r\n              [8.7085, 28.7082],\r\n              [15.6072, 78.4628],\r\n              [2.9405, 29.8555],\r\n              [0.0, 80.0],\r\n              [-2.9405, 29.8555],\r\n              [-15.6072, 78.4628],\r\n              [-8.7085, 28.7082],\r\n              [-30.6147, 73.9104],\r\n              [-14.1419, 26.4576],\r\n              [-44.4456, 66.5176],\r\n              [-19.0318, 23.1903],\r\n              [-56.5685, 56.5685],\r\n              [-23.1903, 19.0318],\r\n              [-66.5176, 44.4456],\r\n              [-26.4576, 14.1419],\r\n              [-73.9104, 30.6147],\r\n              [-28.7082, 8.7085],\r\n              [-78.4628, 15.6072],\r\n              [-29.8555, 2.9405],\r\n              [-80.0, 0.0],\r\n              [-29.8555, -2.9405],\r\n              [-78.4628, -15.6072],\r\n              [-28.7082, -8.7085],\r\n              [-73.9104, -30.6147],\r\n              [-26.4576, -14.1419],\r\n              [-66.5176, -44.4456],\r\n              [-23.1903, -19.0318],\r\n              [-56.5685, -56.5685],\r\n              [-19.0318, -23.1903],\r\n              [-44.4456, -66.5176],\r\n              [-14.1419, -26.4576],\r\n              [-30.6147, -73.9104],\r\n              [-8.7085, -28.7082],\r\n              [-15.6072, -78.4628],\r\n              [-2.9405, -29.8555],\r\n              [-0.0, -80.0],\r\n              [2.9405, -29.8555],\r\n              [15.6072, -78.4628],\r\n              [8.7085, -28.7082],\r\n              [30.6147, -73.9104],\r\n              [14.1419, -26.4576],\r\n              [44.4456, -66.5176],\r\n              [19.0318, -23.1903],\r\n              [56.5685, -56.5685],\r\n              [23.1903, -19.0318],\r\n              [66.5176, -44.4456],\r\n              [26.4576, -14.1419],\r\n              [73.9104, -30.6147],\r\n              [28.7082, -8.7085],\r\n              [78.4628, -15.6072],\r\n              [29.8555, -2.9405],\r\n              [80.0, -0.0],\r\n              [29.8555, 2.9405],\r\n            ],\r\n            roughness: 1,\r\n            seed: 80983684,\r\n            strokeColor: \"#000000\",\r\n            strokeSharpness: \"sharp\",\r\n            strokeWidth: 1,\r\n            type: \"line\",\r\n            width: 160.0,\r\n            x: 600.0,\r\n            y: 400.0,\r\n          },\r\n        ],\r\n      ],\r\n      type: \"excalidrawlib\",\r\n      version: 1,\r\n    };\r\n  } else {\r\n    return {\r\n      type: \"excalidrawlib\",\r\n      version: 1,\r\n      source: \"https://excalidraw.com\",\r\n      library: [\r\n        [\r\n          {\r\n            type: \"ellipse\",\r\n            version: 84,\r\n            versionNonce: 251589692,\r\n            isDeleted: false,\r\n            id: \"0xfJdypfY7YGVzvUnr1Q9\",\r\n            fillStyle: \"hachure\",\r\n            strokeWidth: 4,\r\n            strokeStyle: \"solid\",\r\n            roughness: 1,\r\n            opacity: 100,\r\n            angle: 0,\r\n            x: 517.2976190476185,\r\n            y: -697.5128066378072,\r\n            strokeColor: \"#000000\",\r\n            backgroundColor: \"transparent\",\r\n            width: 137,\r\n            height: 137,\r\n            seed: 1143209818,\r\n            groupIds: [\"oNorZayWm-WVzF0J2mwig\", \"9Yjrxm6_ECZzFWxGlVH6V\"],\r\n            strokeSharpness: \"sharp\",\r\n            boundElementIds: [],\r\n          },\r\n          {\r\n            type: \"ellipse\",\r\n            version: 197,\r\n            versionNonce: 465993092,\r\n            isDeleted: false,\r\n            id: \"5LbXYTCFjezAVwzUIgAr9\",\r\n            fillStyle: \"hachure\",\r\n            strokeWidth: 4,\r\n            strokeStyle: \"solid\",\r\n            roughness: 1,\r\n            opacity: 100,\r\n            angle: 0,\r\n            x: 514.1158008658002,\r\n            y: -420.6946248196255,\r\n            strokeColor: \"#000000\",\r\n            backgroundColor: \"transparent\",\r\n            width: 137,\r\n            height: 137,\r\n            seed: 2141305670,\r\n            groupIds: [\"oNorZayWm-WVzF0J2mwig\", \"9Yjrxm6_ECZzFWxGlVH6V\"],\r\n            strokeSharpness: \"sharp\",\r\n            boundElementIds: [],\r\n          },\r\n          {\r\n            type: \"ellipse\",\r\n            version: 195,\r\n            versionNonce: 1208814780,\r\n            isDeleted: false,\r\n            id: \"-4tS7DtvNoeBbRq4jmKQk\",\r\n            fillStyle: \"hachure\",\r\n            strokeWidth: 4,\r\n            strokeStyle: \"solid\",\r\n            roughness: 1,\r\n            opacity: 100,\r\n            angle: 0,\r\n            x: 796.2976190476185,\r\n            y: -694.5128066378072,\r\n            strokeColor: \"#000000\",\r\n            backgroundColor: \"transparent\",\r\n            width: 137,\r\n            height: 137,\r\n            seed: 283051034,\r\n            groupIds: [\"oNorZayWm-WVzF0J2mwig\", \"9Yjrxm6_ECZzFWxGlVH6V\"],\r\n            strokeSharpness: \"sharp\",\r\n            boundElementIds: [],\r\n          },\r\n          {\r\n            type: \"line\",\r\n            version: 322,\r\n            versionNonce: 1420045572,\r\n            isDeleted: false,\r\n            id: \"0afInka2A1TrX0MIksYJ9\",\r\n            fillStyle: \"hachure\",\r\n            strokeWidth: 4,\r\n            strokeStyle: \"solid\",\r\n            roughness: 1,\r\n            opacity: 100,\r\n            angle: 0,\r\n            x: 584.2976190476185,\r\n            y: -488.1034995645251,\r\n            strokeColor: \"#000000\",\r\n            backgroundColor: \"transparent\",\r\n            width: 284,\r\n            height: 68.40930707328215,\r\n            seed: 865493638,\r\n            groupIds: [\"oNorZayWm-WVzF0J2mwig\", \"9Yjrxm6_ECZzFWxGlVH6V\"],\r\n            strokeSharpness: \"round\",\r\n            boundElementIds: [],\r\n            startBinding: null,\r\n            endBinding: null,\r\n            lastCommittedPoint: null,\r\n            startArrowhead: null,\r\n            endArrowhead: null,\r\n            points: [\r\n              [0, 0],\r\n              [248, -2.942351241227822],\r\n              [284, -68.40930707328215],\r\n            ],\r\n          },\r\n          {\r\n            type: \"line\",\r\n            version: 533,\r\n            versionNonce: 1489245500,\r\n            isDeleted: false,\r\n            id: \"wTCf737n2hOE0gJqUIXZX\",\r\n            fillStyle: \"hachure\",\r\n            strokeWidth: 4,\r\n            strokeStyle: \"solid\",\r\n            roughness: 1,\r\n            opacity: 100,\r\n            angle: 3.141592653589793,\r\n            x: 583.6775511147639,\r\n            y: -558.2058904321354,\r\n            strokeColor: \"#000000\",\r\n            backgroundColor: \"transparent\",\r\n            width: 0.33104495661814326,\r\n            height: 134.32123252372182,\r\n            seed: 1096511706,\r\n            groupIds: [\r\n              \"7v2Fuf6rI5bRsz6pOAq-G\",\r\n              \"oNorZayWm-WVzF0J2mwig\",\r\n              \"9Yjrxm6_ECZzFWxGlVH6V\",\r\n            ],\r\n            strokeSharpness: \"round\",\r\n            boundElementIds: [],\r\n            startBinding: null,\r\n            endBinding: null,\r\n            lastCommittedPoint: null,\r\n            startArrowhead: null,\r\n            endArrowhead: null,\r\n            points: [\r\n              [0, 0],\r\n              [0.33104495661814326, 134.32123252372182],\r\n            ],\r\n          },\r\n          {\r\n            type: \"text\",\r\n            version: 103,\r\n            versionNonce: 354413700,\r\n            isDeleted: false,\r\n            id: \"0CQLrOH8SeqQZMgczk-8u\",\r\n            fillStyle: \"hachure\",\r\n            strokeWidth: 4,\r\n            strokeStyle: \"solid\",\r\n            roughness: 1,\r\n            opacity: 100,\r\n            angle: 0,\r\n            x: 637.1114718614714,\r\n            y: -785.6188672438677,\r\n            strokeColor: \"#000000\",\r\n            backgroundColor: \"transparent\",\r\n            width: 175,\r\n            height: 45,\r\n            seed: 687088070,\r\n            groupIds: [\"9Yjrxm6_ECZzFWxGlVH6V\"],\r\n            strokeSharpness: \"sharp\",\r\n            boundElementIds: [],\r\n            fontSize: 36,\r\n            fontFamily: 1,\r\n            text: \"git branch\",\r\n            baseline: 32,\r\n            textAlign: \"left\",\r\n            verticalAlign: \"top\",\r\n          },\r\n        ],\r\n        [\r\n          {\r\n            type: \"line\",\r\n            version: 445,\r\n            versionNonce: 1284375612,\r\n            isDeleted: false,\r\n            id: \"KDtSI07FtbKq8m21wFf8p\",\r\n            fillStyle: \"hachure\",\r\n            strokeWidth: 4,\r\n            strokeStyle: \"solid\",\r\n            roughness: 1,\r\n            opacity: 100,\r\n            angle: 4.710094851969913,\r\n            x: 1133.4611901629655,\r\n            y: -694.3228656588794,\r\n            strokeColor: \"#000000\",\r\n            backgroundColor: \"transparent\",\r\n            width: 0.33104495661814326,\r\n            height: 134.32123252372182,\r\n            seed: 690767258,\r\n            groupIds: [\"Uyj5GoFcaLGk5MGir3Xqi\", \"G2F1CxlrsY-XG_JAG2N3b\"],\r\n            strokeSharpness: \"round\",\r\n            boundElementIds: [],\r\n            startBinding: null,\r\n            endBinding: null,\r\n            lastCommittedPoint: null,\r\n            startArrowhead: null,\r\n            endArrowhead: null,\r\n            points: [\r\n              [0, 0],\r\n              [0.33104495661814326, 134.32123252372182],\r\n            ],\r\n          },\r\n          {\r\n            type: \"ellipse\",\r\n            version: 181,\r\n            versionNonce: 242249092,\r\n            isDeleted: false,\r\n            id: \"vVuNgnt5wnVQN32okAQ2-\",\r\n            fillStyle: \"hachure\",\r\n            strokeWidth: 4,\r\n            strokeStyle: \"solid\",\r\n            roughness: 1,\r\n            opacity: 100,\r\n            angle: 0,\r\n            x: 1203.0119047619041,\r\n            y: -694.6556637806643,\r\n            strokeColor: \"#000000\",\r\n            backgroundColor: \"transparent\",\r\n            width: 137,\r\n            height: 137,\r\n            seed: 47708422,\r\n            groupIds: [\"Uyj5GoFcaLGk5MGir3Xqi\", \"G2F1CxlrsY-XG_JAG2N3b\"],\r\n            strokeSharpness: \"sharp\",\r\n            boundElementIds: [],\r\n          },\r\n          {\r\n            type: \"line\",\r\n            version: 496,\r\n            versionNonce: 557456572,\r\n            isDeleted: false,\r\n            id: \"goadH-eT6y7MAITUmJAMM\",\r\n            fillStyle: \"hachure\",\r\n            strokeWidth: 4,\r\n            strokeStyle: \"solid\",\r\n            roughness: 1,\r\n            opacity: 100,\r\n            angle: 4.710094851969913,\r\n            x: 1408.00664470842,\r\n            y: -693.4137747497886,\r\n            strokeColor: \"#000000\",\r\n            backgroundColor: \"transparent\",\r\n            width: 0.33104495661814326,\r\n            height: 134.32123252372182,\r\n            seed: 830767706,\r\n            groupIds: [\"Uyj5GoFcaLGk5MGir3Xqi\", \"G2F1CxlrsY-XG_JAG2N3b\"],\r\n            strokeSharpness: \"round\",\r\n            boundElementIds: [],\r\n            startBinding: null,\r\n            endBinding: null,\r\n            lastCommittedPoint: null,\r\n            startArrowhead: null,\r\n            endArrowhead: null,\r\n            points: [\r\n              [0, 0],\r\n              [0.33104495661814326, 134.32123252372182],\r\n            ],\r\n          },\r\n          {\r\n            type: \"text\",\r\n            version: 150,\r\n            versionNonce: 1016077572,\r\n            isDeleted: false,\r\n            id: \"6F3PO8mzYQMieT37Tlul_\",\r\n            fillStyle: \"hachure\",\r\n            strokeWidth: 4,\r\n            strokeStyle: \"solid\",\r\n            roughness: 1,\r\n            opacity: 100,\r\n            angle: 0,\r\n            x: 1180.4448051948048,\r\n            y: -785.6188672438677,\r\n            strokeColor: \"#000000\",\r\n            backgroundColor: \"transparent\",\r\n            width: 176,\r\n            height: 45,\r\n            seed: 2025777222,\r\n            groupIds: [\"G2F1CxlrsY-XG_JAG2N3b\"],\r\n            strokeSharpness: \"sharp\",\r\n            boundElementIds: [],\r\n            fontSize: 36,\r\n            fontFamily: 1,\r\n            text: \"git commit\",\r\n            baseline: 32,\r\n            textAlign: \"left\",\r\n            verticalAlign: \"top\",\r\n          },\r\n        ],\r\n        [\r\n          {\r\n            type: \"ellipse\",\r\n            version: 148,\r\n            versionNonce: 549606588,\r\n            isDeleted: false,\r\n            id: \"Mwqy7JIWvHZEZzuGuCuhY\",\r\n            fillStyle: \"hachure\",\r\n            strokeWidth: 4,\r\n            strokeStyle: \"solid\",\r\n            roughness: 1,\r\n            opacity: 100,\r\n            angle: 0,\r\n            x: 509.6785714285709,\r\n            y: -80.84613997114063,\r\n            strokeColor: \"#000000\",\r\n            backgroundColor: \"transparent\",\r\n            width: 137,\r\n            height: 137,\r\n            seed: 624371482,\r\n            groupIds: [\"zGyku9Skt3tlaW4p69D9H\"],\r\n            strokeSharpness: \"sharp\",\r\n            boundElementIds: [],\r\n          },\r\n          {\r\n            type: \"line\",\r\n            version: 603,\r\n            versionNonce: 2073058620,\r\n            isDeleted: false,\r\n            id: \"IUVIV7CHX4qV3GC6DJvw-\",\r\n            fillStyle: \"hachure\",\r\n            strokeWidth: 4,\r\n            strokeStyle: \"solid\",\r\n            roughness: 1,\r\n            opacity: 100,\r\n            angle: 4.71238898038469,\r\n            x: 675.0123446352244,\r\n            y: 162.59264982476697,\r\n            strokeColor: \"#000000\",\r\n            backgroundColor: \"transparent\",\r\n            width: 213.17222351845425,\r\n            height: 150.77168325592038,\r\n            seed: 1250291590,\r\n            groupIds: [\"zGyku9Skt3tlaW4p69D9H\"],\r\n            strokeSharpness: \"round\",\r\n            boundElementIds: [],\r\n            startBinding: null,\r\n            endBinding: null,\r\n            lastCommittedPoint: null,\r\n            startArrowhead: null,\r\n            endArrowhead: null,\r\n            points: [\r\n              [0, 0],\r\n              [186.15039236822764, -6.48483763904877],\r\n              [213.17222351845425, -150.77168325592038],\r\n            ],\r\n          },\r\n          {\r\n            type: \"ellipse\",\r\n            version: 246,\r\n            versionNonce: 1351177660,\r\n            isDeleted: false,\r\n            id: \"CDyGSVADAT3804p_Y4cPa\",\r\n            fillStyle: \"hachure\",\r\n            strokeWidth: 4,\r\n            strokeStyle: \"solid\",\r\n            roughness: 1,\r\n            opacity: 100,\r\n            angle: 0,\r\n            x: 783.8452380952375,\r\n            y: 198.3205266955262,\r\n            strokeColor: \"#000000\",\r\n            backgroundColor: \"transparent\",\r\n            width: 137,\r\n            height: 137,\r\n            seed: 2092381146,\r\n            groupIds: [\"zGyku9Skt3tlaW4p69D9H\"],\r\n            strokeSharpness: \"sharp\",\r\n            boundElementIds: [],\r\n          },\r\n          {\r\n            type: \"line\",\r\n            version: 730,\r\n            versionNonce: 2093956668,\r\n            isDeleted: false,\r\n            id: \"V6hhVeasW1cIK2XBq17_h\",\r\n            fillStyle: \"hachure\",\r\n            strokeWidth: 4,\r\n            strokeStyle: \"solid\",\r\n            roughness: 1,\r\n            opacity: 100,\r\n            angle: 1.5707963267948957,\r\n            x: 540.8456779685579,\r\n            y: 237.59264982476697,\r\n            strokeColor: \"#000000\",\r\n            backgroundColor: \"transparent\",\r\n            width: 213.17222351845425,\r\n            height: 150.77168325592038,\r\n            seed: 879365830,\r\n            groupIds: [\"zGyku9Skt3tlaW4p69D9H\"],\r\n            strokeSharpness: \"round\",\r\n            boundElementIds: [],\r\n            startBinding: null,\r\n            endBinding: null,\r\n            lastCommittedPoint: null,\r\n            startArrowhead: null,\r\n            endArrowhead: null,\r\n            points: [\r\n              [0, 0],\r\n              [186.15039236822764, -6.48483763904877],\r\n              [213.17222351845425, -150.77168325592038],\r\n            ],\r\n          },\r\n          {\r\n            type: \"line\",\r\n            version: 104,\r\n            versionNonce: 1766069948,\r\n            isDeleted: false,\r\n            id: \"PF5nCDyWV1tJ70GIt8UyG\",\r\n            fillStyle: \"hachure\",\r\n            strokeWidth: 4,\r\n            strokeStyle: \"solid\",\r\n            roughness: 1,\r\n            opacity: 100,\r\n            angle: 0,\r\n            x: 722.7067099567095,\r\n            y: -43.166486291486805,\r\n            strokeColor: \"#000000\",\r\n            backgroundColor: \"transparent\",\r\n            width: 36.66666666666674,\r\n            height: 48.33333333333337,\r\n            seed: 706193562,\r\n            groupIds: [\"zGyku9Skt3tlaW4p69D9H\"],\r\n            strokeSharpness: \"round\",\r\n            boundElementIds: [],\r\n            startBinding: null,\r\n            endBinding: null,\r\n            lastCommittedPoint: null,\r\n            startArrowhead: null,\r\n            endArrowhead: null,\r\n            points: [\r\n              [0, 0],\r\n              [-36.66666666666674, 26.66666666666663],\r\n              [-1.6666666666667425, 48.33333333333337],\r\n            ],\r\n          },\r\n          {\r\n            type: \"line\",\r\n            version: 193,\r\n            versionNonce: 311025468,\r\n            isDeleted: false,\r\n            id: \"ar5-08XAgTJWxvuJalGru\",\r\n            fillStyle: \"hachure\",\r\n            strokeWidth: 4,\r\n            strokeStyle: \"solid\",\r\n            roughness: 1,\r\n            opacity: 100,\r\n            angle: 3.141592653589793,\r\n            x: 747.7067099567097,\r\n            y: 251.00018037517992,\r\n            strokeColor: \"#000000\",\r\n            backgroundColor: \"transparent\",\r\n            width: 36.66666666666674,\r\n            height: 48.33333333333337,\r\n            seed: 1661486598,\r\n            groupIds: [\"zGyku9Skt3tlaW4p69D9H\"],\r\n            strokeSharpness: \"round\",\r\n            boundElementIds: [],\r\n            startBinding: null,\r\n            endBinding: null,\r\n            lastCommittedPoint: null,\r\n            startArrowhead: null,\r\n            endArrowhead: null,\r\n            points: [\r\n              [0, 0],\r\n              [-36.66666666666674, 26.66666666666663],\r\n              [-1.6666666666667425, 48.33333333333337],\r\n            ],\r\n          },\r\n          {\r\n            type: \"text\",\r\n            version: 241,\r\n            versionNonce: 285382588,\r\n            isDeleted: false,\r\n            id: \"mwVprwrcljFfPmUoxudlV\",\r\n            fillStyle: \"hachure\",\r\n            strokeWidth: 4,\r\n            strokeStyle: \"solid\",\r\n            roughness: 1,\r\n            opacity: 100,\r\n            angle: 0,\r\n            x: 622.1114718614716,\r\n            y: -142.2855339105344,\r\n            strokeColor: \"#000000\",\r\n            backgroundColor: \"transparent\",\r\n            width: 202,\r\n            height: 45,\r\n            seed: 1695253850,\r\n            groupIds: [\"zGyku9Skt3tlaW4p69D9H\"],\r\n            strokeSharpness: \"sharp\",\r\n            boundElementIds: [],\r\n            fontSize: 36,\r\n            fontFamily: 1,\r\n            text: \"git compare\",\r\n            baseline: 32,\r\n            textAlign: \"left\",\r\n            verticalAlign: \"top\",\r\n          },\r\n        ],\r\n        [\r\n          {\r\n            type: \"ellipse\",\r\n            version: 140,\r\n            versionNonce: 904646844,\r\n            isDeleted: false,\r\n            id: \"aaG1rzr6IT4E0Bm_xKjW2\",\r\n            fillStyle: \"hachure\",\r\n            strokeWidth: 4,\r\n            strokeStyle: \"solid\",\r\n            roughness: 1,\r\n            opacity: 100,\r\n            angle: 0,\r\n            x: 1093.9642857142849,\r\n            y: -79.17947330447377,\r\n            strokeColor: \"#000000\",\r\n            backgroundColor: \"transparent\",\r\n            width: 137,\r\n            height: 137,\r\n            seed: 1734186310,\r\n            groupIds: [\"nmMjFKPzIm7hKXmHIEY-u\"],\r\n            strokeSharpness: \"sharp\",\r\n            boundElementIds: [],\r\n          },\r\n          {\r\n            type: \"ellipse\",\r\n            version: 253,\r\n            versionNonce: 1275308292,\r\n            isDeleted: false,\r\n            id: \"nS0Jt_3yYyWlgKB96sB0K\",\r\n            fillStyle: \"hachure\",\r\n            strokeWidth: 4,\r\n            strokeStyle: \"solid\",\r\n            roughness: 1,\r\n            opacity: 100,\r\n            angle: 0,\r\n            x: 1090.7824675324669,\r\n            y: 197.63870851370797,\r\n            strokeColor: \"#000000\",\r\n            backgroundColor: \"transparent\",\r\n            width: 137,\r\n            height: 137,\r\n            seed: 1994770970,\r\n            groupIds: [\"nmMjFKPzIm7hKXmHIEY-u\"],\r\n            strokeSharpness: \"sharp\",\r\n            boundElementIds: [],\r\n          },\r\n          {\r\n            type: \"line\",\r\n            version: 589,\r\n            versionNonce: 640309564,\r\n            isDeleted: false,\r\n            id: \"YGTnDlnUOp2-kXsUQEHdC\",\r\n            fillStyle: \"hachure\",\r\n            strokeWidth: 4,\r\n            strokeStyle: \"solid\",\r\n            roughness: 1,\r\n            opacity: 100,\r\n            angle: 3.141592653589793,\r\n            x: 1160.3442177814304,\r\n            y: 60.127442901197995,\r\n            strokeColor: \"#000000\",\r\n            backgroundColor: \"transparent\",\r\n            width: 0.33104495661814326,\r\n            height: 134.32123252372182,\r\n            seed: 717683846,\r\n            groupIds: [\"9_aqxv1DMrnlqFtjopR1w\", \"nmMjFKPzIm7hKXmHIEY-u\"],\r\n            strokeSharpness: \"round\",\r\n            boundElementIds: [],\r\n            startBinding: null,\r\n            endBinding: null,\r\n            lastCommittedPoint: null,\r\n            startArrowhead: null,\r\n            endArrowhead: null,\r\n            points: [\r\n              [0, 0],\r\n              [0.33104495661814326, 134.32123252372182],\r\n            ],\r\n          },\r\n          {\r\n            type: \"text\",\r\n            version: 165,\r\n            versionNonce: 1798301828,\r\n            isDeleted: false,\r\n            id: \"PZFe_a1i9YkrcR4iengKz\",\r\n            fillStyle: \"hachure\",\r\n            strokeWidth: 4,\r\n            strokeStyle: \"solid\",\r\n            roughness: 1,\r\n            opacity: 100,\r\n            angle: 0,\r\n            x: 1213.7781385281378,\r\n            y: -167.2855339105343,\r\n            strokeColor: \"#000000\",\r\n            backgroundColor: \"transparent\",\r\n            width: 160,\r\n            height: 45,\r\n            seed: 110720730,\r\n            groupIds: [\"nmMjFKPzIm7hKXmHIEY-u\"],\r\n            strokeSharpness: \"sharp\",\r\n            boundElementIds: [],\r\n            fontSize: 36,\r\n            fontFamily: 1,\r\n            text: \"git merge\",\r\n            baseline: 32,\r\n            textAlign: \"left\",\r\n            verticalAlign: \"top\",\r\n          },\r\n          {\r\n            type: \"ellipse\",\r\n            version: 295,\r\n            versionNonce: 243519932,\r\n            isDeleted: false,\r\n            id: \"bJfDjOGCtS8Ynu7KaRsz0\",\r\n            fillStyle: \"hachure\",\r\n            strokeWidth: 4,\r\n            strokeStyle: \"solid\",\r\n            roughness: 1,\r\n            opacity: 100,\r\n            angle: 0,\r\n            x: 1371.9642857142849,\r\n            y: 61.820526695526226,\r\n            strokeColor: \"#000000\",\r\n            backgroundColor: \"transparent\",\r\n            width: 137,\r\n            height: 137,\r\n            seed: 1661041606,\r\n            groupIds: [\"nmMjFKPzIm7hKXmHIEY-u\"],\r\n            strokeSharpness: \"sharp\",\r\n            boundElementIds: [],\r\n          },\r\n          {\r\n            type: \"line\",\r\n            version: 459,\r\n            versionNonce: 1772632068,\r\n            isDeleted: false,\r\n            id: \"0BOU4Omszvofv2m3-8U30\",\r\n            fillStyle: \"hachure\",\r\n            strokeWidth: 4,\r\n            strokeStyle: \"solid\",\r\n            roughness: 1,\r\n            opacity: 100,\r\n            angle: 0,\r\n            x: 1159.7781385281387,\r\n            y: 58.047799422798974,\r\n            strokeColor: \"#000000\",\r\n            backgroundColor: \"transparent\",\r\n            width: 211,\r\n            height: 78,\r\n            seed: 1689881498,\r\n            groupIds: [\"nmMjFKPzIm7hKXmHIEY-u\"],\r\n            strokeSharpness: \"round\",\r\n            boundElementIds: [],\r\n            startBinding: null,\r\n            endBinding: null,\r\n            lastCommittedPoint: null,\r\n            startArrowhead: null,\r\n            endArrowhead: null,\r\n            points: [\r\n              [0, 0],\r\n              [65.5454545454545, 70.27272727272725],\r\n              [211, 78],\r\n            ],\r\n          },\r\n        ],\r\n        [\r\n          {\r\n            type: \"line\",\r\n            version: 696,\r\n            versionNonce: 1264559748,\r\n            isDeleted: false,\r\n            id: \"SAUhQJvhNcUePhDQYn_84\",\r\n            fillStyle: \"hachure\",\r\n            strokeWidth: 4,\r\n            strokeStyle: \"solid\",\r\n            roughness: 1,\r\n            opacity: 100,\r\n            angle: 4.71238898038469,\r\n            x: 713.6234557463357,\r\n            y: 833.1482053803227,\r\n            strokeColor: \"#000000\",\r\n            backgroundColor: \"transparent\",\r\n            width: 213.17222351845425,\r\n            height: 150.77168325592038,\r\n            seed: 103420678,\r\n            groupIds: [\"VINBcgbWdYB7ugR9zj-wt\"],\r\n            strokeSharpness: \"round\",\r\n            boundElementIds: [],\r\n            startBinding: null,\r\n            endBinding: null,\r\n            lastCommittedPoint: null,\r\n            startArrowhead: null,\r\n            endArrowhead: null,\r\n            points: [\r\n              [0, 0],\r\n              [186.15039236822764, -6.48483763904877],\r\n              [213.17222351845425, -150.77168325592038],\r\n            ],\r\n          },\r\n          {\r\n            type: \"ellipse\",\r\n            version: 339,\r\n            versionNonce: 1488384956,\r\n            isDeleted: false,\r\n            id: \"xcIYKnPknmiGlSoECGuwB\",\r\n            fillStyle: \"hachure\",\r\n            strokeWidth: 4,\r\n            strokeStyle: \"solid\",\r\n            roughness: 1,\r\n            opacity: 100,\r\n            angle: 0,\r\n            x: 822.4563492063484,\r\n            y: 868.8760822510817,\r\n            strokeColor: \"#000000\",\r\n            backgroundColor: \"transparent\",\r\n            width: 137,\r\n            height: 137,\r\n            seed: 1467549786,\r\n            groupIds: [\"VINBcgbWdYB7ugR9zj-wt\"],\r\n            strokeSharpness: \"sharp\",\r\n            boundElementIds: [],\r\n          },\r\n          {\r\n            type: \"line\",\r\n            version: 197,\r\n            versionNonce: 1764767236,\r\n            isDeleted: false,\r\n            id: \"-yJHRV4RYPEWF8P3f8zmD\",\r\n            fillStyle: \"hachure\",\r\n            strokeWidth: 4,\r\n            strokeStyle: \"solid\",\r\n            roughness: 1,\r\n            opacity: 100,\r\n            angle: 0,\r\n            x: 761.3178210678205,\r\n            y: 627.3890692640689,\r\n            strokeColor: \"#000000\",\r\n            backgroundColor: \"transparent\",\r\n            width: 36.66666666666674,\r\n            height: 48.33333333333337,\r\n            seed: 1052623430,\r\n            groupIds: [\"VINBcgbWdYB7ugR9zj-wt\"],\r\n            strokeSharpness: \"round\",\r\n            boundElementIds: [],\r\n            startBinding: null,\r\n            endBinding: null,\r\n            lastCommittedPoint: null,\r\n            startArrowhead: null,\r\n            endArrowhead: null,\r\n            points: [\r\n              [0, 0],\r\n              [-36.66666666666674, 26.66666666666663],\r\n              [-1.6666666666667425, 48.33333333333337],\r\n            ],\r\n          },\r\n          {\r\n            type: \"text\",\r\n            version: 350,\r\n            versionNonce: 697900092,\r\n            isDeleted: false,\r\n            id: \"DuDWueLlXtq6w05r-Ze8a\",\r\n            fillStyle: \"hachure\",\r\n            strokeWidth: 4,\r\n            strokeStyle: \"solid\",\r\n            roughness: 1,\r\n            opacity: 100,\r\n            angle: 0,\r\n            x: 660.7225829725825,\r\n            y: 528.2700216450212,\r\n            strokeColor: \"#000000\",\r\n            backgroundColor: \"transparent\",\r\n            width: 268,\r\n            height: 45,\r\n            seed: 1722477850,\r\n            groupIds: [\"VINBcgbWdYB7ugR9zj-wt\"],\r\n            strokeSharpness: \"sharp\",\r\n            boundElementIds: [],\r\n            fontSize: 36,\r\n            fontFamily: 1,\r\n            text: \"git-pull-request\",\r\n            baseline: 32,\r\n            textAlign: \"left\",\r\n            verticalAlign: \"top\",\r\n          },\r\n          {\r\n            type: \"ellipse\",\r\n            version: 149,\r\n            versionNonce: 759354756,\r\n            isDeleted: false,\r\n            id: \"Dg69JJKby1F9IXJDuTg5g\",\r\n            fillStyle: \"hachure\",\r\n            strokeWidth: 4,\r\n            strokeStyle: \"solid\",\r\n            roughness: 1,\r\n            opacity: 100,\r\n            angle: 0,\r\n            x: 557.169913419914,\r\n            y: 593.8006854256857,\r\n            strokeColor: \"#000000\",\r\n            backgroundColor: \"transparent\",\r\n            width: 137,\r\n            height: 137,\r\n            seed: 1603897734,\r\n            groupIds: [\"VINBcgbWdYB7ugR9zj-wt\"],\r\n            strokeSharpness: \"sharp\",\r\n            boundElementIds: [],\r\n          },\r\n          {\r\n            type: \"ellipse\",\r\n            version: 262,\r\n            versionNonce: 1562522812,\r\n            isDeleted: false,\r\n            id: \"Yh8Z03YC9uzGCIRMerwQm\",\r\n            fillStyle: \"hachure\",\r\n            strokeWidth: 4,\r\n            strokeStyle: \"solid\",\r\n            roughness: 1,\r\n            opacity: 100,\r\n            angle: 0,\r\n            x: 553.9880952380958,\r\n            y: 870.6188672438675,\r\n            strokeColor: \"#000000\",\r\n            backgroundColor: \"transparent\",\r\n            width: 137,\r\n            height: 137,\r\n            seed: 667040218,\r\n            groupIds: [\"VINBcgbWdYB7ugR9zj-wt\"],\r\n            strokeSharpness: \"sharp\",\r\n            boundElementIds: [],\r\n          },\r\n          {\r\n            type: \"line\",\r\n            version: 598,\r\n            versionNonce: 617972996,\r\n            isDeleted: false,\r\n            id: \"hTRofwh-gvw8dmtD_uH-R\",\r\n            fillStyle: \"hachure\",\r\n            strokeWidth: 4,\r\n            strokeStyle: \"solid\",\r\n            roughness: 1,\r\n            opacity: 100,\r\n            angle: 3.141592653589793,\r\n            x: 623.5498454870593,\r\n            y: 733.1076016313575,\r\n            strokeColor: \"#000000\",\r\n            backgroundColor: \"transparent\",\r\n            width: 0.33104495661814326,\r\n            height: 134.32123252372182,\r\n            seed: 1476028614,\r\n            groupIds: [\"aPmo9V0_rSDPySYjFQxVE\", \"VINBcgbWdYB7ugR9zj-wt\"],\r\n            strokeSharpness: \"round\",\r\n            boundElementIds: [],\r\n            startBinding: null,\r\n            endBinding: null,\r\n            lastCommittedPoint: null,\r\n            startArrowhead: null,\r\n            endArrowhead: null,\r\n            points: [\r\n              [0, 0],\r\n              [0.33104495661814326, 134.32123252372182],\r\n            ],\r\n          },\r\n        ],\r\n        [\r\n          {\r\n            type: \"text\",\r\n            version: 488,\r\n            versionNonce: 593897532,\r\n            isDeleted: false,\r\n            id: \"DSLQqmOgs-fg6hkOAOZX1\",\r\n            fillStyle: \"hachure\",\r\n            strokeWidth: 4,\r\n            strokeStyle: \"solid\",\r\n            roughness: 1,\r\n            opacity: 100,\r\n            angle: 0,\r\n            x: 1149.0559163059156,\r\n            y: 529.9366883116877,\r\n            strokeColor: \"#000000\",\r\n            backgroundColor: \"transparent\",\r\n            width: 390,\r\n            height: 45,\r\n            seed: 164753050,\r\n            groupIds: [\"P_boO6h_4SJU8u0X-Y9aY\"],\r\n            strokeSharpness: \"sharp\",\r\n            boundElementIds: [],\r\n            fontSize: 36,\r\n            fontFamily: 1,\r\n            text: \"git-pull-request-closed\",\r\n            baseline: 32,\r\n            textAlign: \"left\",\r\n            verticalAlign: \"top\",\r\n          },\r\n          {\r\n            type: \"ellipse\",\r\n            version: 222,\r\n            versionNonce: 1268550020,\r\n            isDeleted: false,\r\n            id: \"BUc8xruYkNA7LY5daZdyO\",\r\n            fillStyle: \"hachure\",\r\n            strokeWidth: 4,\r\n            strokeStyle: \"solid\",\r\n            roughness: 1,\r\n            opacity: 100,\r\n            angle: 0,\r\n            x: 1140.5032467532474,\r\n            y: 600.4673520923523,\r\n            strokeColor: \"#000000\",\r\n            backgroundColor: \"transparent\",\r\n            width: 137,\r\n            height: 137,\r\n            seed: 662528006,\r\n            groupIds: [\"P_boO6h_4SJU8u0X-Y9aY\"],\r\n            strokeSharpness: \"sharp\",\r\n            boundElementIds: [],\r\n          },\r\n          {\r\n            type: \"ellipse\",\r\n            version: 335,\r\n            versionNonce: 829276348,\r\n            isDeleted: false,\r\n            id: \"nvTjbP5L4Vlp3rtryHpCG\",\r\n            fillStyle: \"hachure\",\r\n            strokeWidth: 4,\r\n            strokeStyle: \"solid\",\r\n            roughness: 1,\r\n            opacity: 100,\r\n            angle: 0,\r\n            x: 1137.321428571429,\r\n            y: 877.285533910534,\r\n            strokeColor: \"#000000\",\r\n            backgroundColor: \"transparent\",\r\n            width: 137,\r\n            height: 137,\r\n            seed: 562891610,\r\n            groupIds: [\"P_boO6h_4SJU8u0X-Y9aY\"],\r\n            strokeSharpness: \"sharp\",\r\n            boundElementIds: [],\r\n          },\r\n          {\r\n            type: \"line\",\r\n            version: 675,\r\n            versionNonce: 903395588,\r\n            isDeleted: false,\r\n            id: \"b_YpvtMUkW88OtyNmLliC\",\r\n            fillStyle: \"hachure\",\r\n            strokeWidth: 4,\r\n            strokeStyle: \"solid\",\r\n            roughness: 1,\r\n            opacity: 100,\r\n            angle: 3.141592653589793,\r\n            x: 1206.8831788203925,\r\n            y: 739.774268298024,\r\n            strokeColor: \"#000000\",\r\n            backgroundColor: \"transparent\",\r\n            width: 0.33104495661814326,\r\n            height: 134.32123252372182,\r\n            seed: 1377791814,\r\n            groupIds: [\"vS5-XJyttTYPAAImWm8BR\", \"P_boO6h_4SJU8u0X-Y9aY\"],\r\n            strokeSharpness: \"round\",\r\n            boundElementIds: [],\r\n            startBinding: null,\r\n            endBinding: null,\r\n            lastCommittedPoint: null,\r\n            startArrowhead: null,\r\n            endArrowhead: null,\r\n            points: [\r\n              [0, 0],\r\n              [0.33104495661814326, 134.32123252372182],\r\n            ],\r\n          },\r\n          {\r\n            type: \"ellipse\",\r\n            version: 451,\r\n            versionNonce: 1005472060,\r\n            isDeleted: false,\r\n            id: \"WL_m3-9VOIJ7ipdOG5beN\",\r\n            fillStyle: \"hachure\",\r\n            strokeWidth: 4,\r\n            strokeStyle: \"solid\",\r\n            roughness: 1,\r\n            opacity: 100,\r\n            angle: 0,\r\n            x: 1407.321428571429,\r\n            y: 877.285533910534,\r\n            strokeColor: \"#000000\",\r\n            backgroundColor: \"transparent\",\r\n            width: 137,\r\n            height: 137,\r\n            seed: 1967558682,\r\n            groupIds: [\"P_boO6h_4SJU8u0X-Y9aY\"],\r\n            strokeSharpness: \"sharp\",\r\n            boundElementIds: [],\r\n          },\r\n          {\r\n            type: \"line\",\r\n            version: 862,\r\n            versionNonce: 2011363460,\r\n            isDeleted: false,\r\n            id: \"N0csXBbWaAjYAmWFaeFbo\",\r\n            fillStyle: \"hachure\",\r\n            strokeWidth: 4,\r\n            strokeStyle: \"solid\",\r\n            roughness: 1,\r\n            opacity: 100,\r\n            angle: 2.356194490192344,\r\n            x: 1478.8831788203925,\r\n            y: 604.774268298024,\r\n            strokeColor: \"#000000\",\r\n            backgroundColor: \"transparent\",\r\n            width: 0.33104495661814326,\r\n            height: 134.32123252372182,\r\n            seed: 1413322374,\r\n            groupIds: [\"llYwgMozMd6DKWoAcBsYY\", \"P_boO6h_4SJU8u0X-Y9aY\"],\r\n            strokeSharpness: \"round\",\r\n            boundElementIds: [],\r\n            startBinding: null,\r\n            endBinding: null,\r\n            lastCommittedPoint: null,\r\n            startArrowhead: null,\r\n            endArrowhead: null,\r\n            points: [\r\n              [0, 0],\r\n              [0.33104495661814326, 134.32123252372182],\r\n            ],\r\n          },\r\n          {\r\n            type: \"line\",\r\n            version: 921,\r\n            versionNonce: 642367932,\r\n            isDeleted: false,\r\n            id: \"JfSlk7E5KCgQqC6Rg-snE\",\r\n            fillStyle: \"hachure\",\r\n            strokeWidth: 4,\r\n            strokeStyle: \"solid\",\r\n            roughness: 1,\r\n            opacity: 100,\r\n            angle: 3.9269908169872405,\r\n            x: 1475.8831788203925,\r\n            y: 600.774268298024,\r\n            strokeColor: \"#000000\",\r\n            backgroundColor: \"transparent\",\r\n            width: 0.33104495661814326,\r\n            height: 134.32123252372182,\r\n            seed: 1223785690,\r\n            groupIds: [\"-ETmvYtR3FbwNkJy_vO6F\", \"P_boO6h_4SJU8u0X-Y9aY\"],\r\n            strokeSharpness: \"round\",\r\n            boundElementIds: [],\r\n            startBinding: null,\r\n            endBinding: null,\r\n            lastCommittedPoint: null,\r\n            startArrowhead: null,\r\n            endArrowhead: null,\r\n            points: [\r\n              [0, 0],\r\n              [0.33104495661814326, 134.32123252372182],\r\n            ],\r\n          },\r\n          {\r\n            type: \"line\",\r\n            version: 738,\r\n            versionNonce: 226052100,\r\n            isDeleted: false,\r\n            id: \"VwK210JG379PJ8D0sOB6d\",\r\n            fillStyle: \"hachure\",\r\n            strokeWidth: 4,\r\n            strokeStyle: \"solid\",\r\n            roughness: 1,\r\n            opacity: 100,\r\n            angle: 3.141592653589793,\r\n            x: 1475.8831788203925,\r\n            y: 742.774268298024,\r\n            strokeColor: \"#000000\",\r\n            backgroundColor: \"transparent\",\r\n            width: 0.33104495661814326,\r\n            height: 134.32123252372182,\r\n            seed: 378852806,\r\n            groupIds: [\"ZN7W7xKsx_x3dwSjnYnEl\", \"P_boO6h_4SJU8u0X-Y9aY\"],\r\n            strokeSharpness: \"round\",\r\n            boundElementIds: [],\r\n            startBinding: null,\r\n            endBinding: null,\r\n            lastCommittedPoint: null,\r\n            startArrowhead: null,\r\n            endArrowhead: null,\r\n            points: [\r\n              [0, 0],\r\n              [0.33104495661814326, 134.32123252372182],\r\n            ],\r\n          },\r\n        ],\r\n        [\r\n          {\r\n            type: \"text\",\r\n            version: 583,\r\n            versionNonce: 1859128252,\r\n            isDeleted: false,\r\n            id: \"cPt_5eCBP0WD87f60PMgo\",\r\n            fillStyle: \"hachure\",\r\n            strokeWidth: 4,\r\n            strokeStyle: \"solid\",\r\n            roughness: 1,\r\n            opacity: 100,\r\n            angle: 0,\r\n            x: 1149.0559163059156,\r\n            y: 1103.2700216450212,\r\n            strokeColor: \"#000000\",\r\n            backgroundColor: \"transparent\",\r\n            width: 380,\r\n            height: 45,\r\n            seed: 1780535706,\r\n            groupIds: [\"HxQ1q1LlR2un3ESuUItxJ\"],\r\n            strokeSharpness: \"sharp\",\r\n            boundElementIds: [],\r\n            fontSize: 36,\r\n            fontFamily: 1,\r\n            text: \"git-pull-request-draft\",\r\n            baseline: 32,\r\n            textAlign: \"left\",\r\n            verticalAlign: \"top\",\r\n          },\r\n          {\r\n            type: \"ellipse\",\r\n            version: 312,\r\n            versionNonce: 785686020,\r\n            isDeleted: false,\r\n            id: \"75EoUTP73v348gFWkwl_H\",\r\n            fillStyle: \"hachure\",\r\n            strokeWidth: 4,\r\n            strokeStyle: \"solid\",\r\n            roughness: 1,\r\n            opacity: 100,\r\n            angle: 0,\r\n            x: 1140.5032467532474,\r\n            y: 1173.8006854256857,\r\n            strokeColor: \"#000000\",\r\n            backgroundColor: \"transparent\",\r\n            width: 137,\r\n            height: 137,\r\n            seed: 1648504070,\r\n            groupIds: [\"HxQ1q1LlR2un3ESuUItxJ\"],\r\n            strokeSharpness: \"sharp\",\r\n            boundElementIds: [],\r\n          },\r\n          {\r\n            type: \"ellipse\",\r\n            version: 425,\r\n            versionNonce: 1288647740,\r\n            isDeleted: false,\r\n            id: \"ukdwEQCy077BDLsYN_cCy\",\r\n            fillStyle: \"hachure\",\r\n            strokeWidth: 4,\r\n            strokeStyle: \"solid\",\r\n            roughness: 1,\r\n            opacity: 100,\r\n            angle: 0,\r\n            x: 1137.321428571429,\r\n            y: 1450.6188672438677,\r\n            strokeColor: \"#000000\",\r\n            backgroundColor: \"transparent\",\r\n            width: 137,\r\n            height: 137,\r\n            seed: 2080869978,\r\n            groupIds: [\"HxQ1q1LlR2un3ESuUItxJ\"],\r\n            strokeSharpness: \"sharp\",\r\n            boundElementIds: [],\r\n          },\r\n          {\r\n            type: \"line\",\r\n            version: 765,\r\n            versionNonce: 303709572,\r\n            isDeleted: false,\r\n            id: \"JxZlHjAngloyZUZn_aF10\",\r\n            fillStyle: \"hachure\",\r\n            strokeWidth: 4,\r\n            strokeStyle: \"solid\",\r\n            roughness: 1,\r\n            opacity: 100,\r\n            angle: 3.141592653589793,\r\n            x: 1206.8831788203925,\r\n            y: 1313.1076016313575,\r\n            strokeColor: \"#000000\",\r\n            backgroundColor: \"transparent\",\r\n            width: 0.33104495661814326,\r\n            height: 134.32123252372182,\r\n            seed: 1422040134,\r\n            groupIds: [\"cfPK-2NVLcmTlZZQt0ZkI\", \"HxQ1q1LlR2un3ESuUItxJ\"],\r\n            strokeSharpness: \"round\",\r\n            boundElementIds: [],\r\n            startBinding: null,\r\n            endBinding: null,\r\n            lastCommittedPoint: null,\r\n            startArrowhead: null,\r\n            endArrowhead: null,\r\n            points: [\r\n              [0, 0],\r\n              [0.33104495661814326, 134.32123252372182],\r\n            ],\r\n          },\r\n          {\r\n            type: \"ellipse\",\r\n            version: 543,\r\n            versionNonce: 1641368764,\r\n            isDeleted: false,\r\n            id: \"u9mVksBUCvaxjJitzy4x9\",\r\n            fillStyle: \"hachure\",\r\n            strokeWidth: 4,\r\n            strokeStyle: \"solid\",\r\n            roughness: 1,\r\n            opacity: 100,\r\n            angle: 0,\r\n            x: 1407.321428571429,\r\n            y: 1450.6188672438677,\r\n            strokeColor: \"#000000\",\r\n            backgroundColor: \"transparent\",\r\n            width: 137,\r\n            height: 137,\r\n            seed: 1131983642,\r\n            groupIds: [\"HxQ1q1LlR2un3ESuUItxJ\"],\r\n            strokeSharpness: \"sharp\",\r\n            boundElementIds: [],\r\n          },\r\n          {\r\n            type: \"ellipse\",\r\n            version: 722,\r\n            versionNonce: 1249897732,\r\n            isDeleted: false,\r\n            id: \"dm_xhYjUN2-eB3tWVQO1j\",\r\n            fillStyle: \"hachure\",\r\n            strokeWidth: 4,\r\n            strokeStyle: \"solid\",\r\n            roughness: 1,\r\n            opacity: 100,\r\n            angle: 0,\r\n            x: 1460.8279220779227,\r\n            y: 1345.034451659452,\r\n            strokeColor: \"#000000\",\r\n            backgroundColor: \"transparent\",\r\n            width: 37.90909090909078,\r\n            height: 37.90909090909078,\r\n            seed: 1408443270,\r\n            groupIds: [\"HxQ1q1LlR2un3ESuUItxJ\"],\r\n            strokeSharpness: \"sharp\",\r\n            boundElementIds: [],\r\n          },\r\n          {\r\n            type: \"ellipse\",\r\n            version: 768,\r\n            versionNonce: 260330812,\r\n            isDeleted: false,\r\n            id: \"xvVdHkoBCSC4P894nqNak\",\r\n            fillStyle: \"hachure\",\r\n            strokeWidth: 4,\r\n            strokeStyle: \"solid\",\r\n            roughness: 1,\r\n            opacity: 100,\r\n            angle: 0,\r\n            x: 1459.0097402597412,\r\n            y: 1226.0734126984132,\r\n            strokeColor: \"#000000\",\r\n            backgroundColor: \"transparent\",\r\n            width: 36.48051948051922,\r\n            height: 36.48051948051922,\r\n            seed: 1927757786,\r\n            groupIds: [\"HxQ1q1LlR2un3ESuUItxJ\"],\r\n            strokeSharpness: \"sharp\",\r\n            boundElementIds: [],\r\n          },\r\n        ],\r\n      ],\r\n    };\r\n  }\r\n};\r\n","import React, { useEffect, useRef, useState } from \"react\";\r\nimport { render, unmountComponentAtNode } from \"react-dom\";\r\nimport { probablySupportsClipboardBlob } from \"../clipboard\";\r\nimport { canvasToBlob } from \"../data/blob\";\r\nimport { CanvasError } from \"../errors\";\r\nimport { t } from \"../i18n\";\r\nimport { useIsMobile } from \"./App\";\r\nimport { getSelectedElements, isSomeElementSelected } from \"../scene\";\r\nimport { exportToCanvas } from \"../scene/export\";\r\nimport { Dialog } from \"./Dialog\";\r\nimport { clipboard, exportImage } from \"./icons\";\r\nimport Stack from \"./Stack\";\r\nimport { ToolButton } from \"./ToolButton\";\r\nimport \"./ExportDialog.scss\";\r\nimport OpenColor from \"open-color\";\r\nimport { CheckboxItem } from \"./CheckboxItem\";\r\nimport { DEFAULT_EXPORT_PADDING } from \"../constants\";\r\nimport { nativeFileSystemSupported } from \"../data/filesystem\";\r\nconst supportsContextFilters = \"filter\" in document.createElement(\"canvas\").getContext(\"2d\");\r\nexport const ErrorCanvasPreview = () => {\r\n    return (<div>\r\n      <h3>{t(\"canvasError.cannotShowPreview\")}</h3>\r\n      <p>\r\n        <span>{t(\"canvasError.canvasTooBig\")}</span>\r\n      </p>\r\n      <em>({t(\"canvasError.canvasTooBigTip\")})</em>\r\n    </div>);\r\n};\r\nconst renderPreview = (content, previewNode) => {\r\n    unmountComponentAtNode(previewNode);\r\n    previewNode.innerHTML = \"\";\r\n    if (content instanceof HTMLCanvasElement) {\r\n        previewNode.appendChild(content);\r\n    }\r\n    else {\r\n        render(<ErrorCanvasPreview />, previewNode);\r\n    }\r\n};\r\nconst ExportButton = ({ children, title, onClick, color, shade = 6 }) => {\r\n    return (<button className=\"ExportDialog-imageExportButton\" style={{\r\n            [\"--button-color\"]: OpenColor[color][shade],\r\n            [\"--button-color-darker\"]: OpenColor[color][shade + 1],\r\n            [\"--button-color-darkest\"]: OpenColor[color][shade + 2],\r\n        }} title={title} aria-label={title} onClick={onClick}>\r\n      {children}\r\n    </button>);\r\n};\r\nconst ImageExportModal = ({ elements, appState, files, exportPadding = DEFAULT_EXPORT_PADDING, actionManager, onExportToPng, onExportToSvg, onExportToClipboard, }) => {\r\n    const someElementIsSelected = isSomeElementSelected(elements, appState);\r\n    const [exportSelected, setExportSelected] = useState(someElementIsSelected);\r\n    const previewRef = useRef(null);\r\n    const { exportBackground, viewBackgroundColor } = appState;\r\n    const exportedElements = exportSelected\r\n        ? getSelectedElements(elements, appState)\r\n        : elements;\r\n    useEffect(() => {\r\n        setExportSelected(someElementIsSelected);\r\n    }, [someElementIsSelected]);\r\n    useEffect(() => {\r\n        const previewNode = previewRef.current;\r\n        if (!previewNode) {\r\n            return;\r\n        }\r\n        exportToCanvas(exportedElements, appState, files, {\r\n            exportBackground,\r\n            viewBackgroundColor,\r\n            exportPadding,\r\n        })\r\n            .then((canvas) => {\r\n            // if converting to blob fails, there's some problem that will\r\n            // likely prevent preview and export (e.g. canvas too big)\r\n            return canvasToBlob(canvas).then(() => {\r\n                renderPreview(canvas, previewNode);\r\n            });\r\n        })\r\n            .catch((error) => {\r\n            console.error(error);\r\n            renderPreview(new CanvasError(), previewNode);\r\n        });\r\n    }, [\r\n        appState,\r\n        files,\r\n        exportedElements,\r\n        exportBackground,\r\n        exportPadding,\r\n        viewBackgroundColor,\r\n    ]);\r\n    return (<div className=\"ExportDialog\">\r\n      <div className=\"ExportDialog__preview\" ref={previewRef}/>\r\n      {supportsContextFilters &&\r\n            actionManager.renderAction(\"exportWithDarkMode\")}\r\n      <div style={{ display: \"grid\", gridTemplateColumns: \"1fr\" }}>\r\n        <div style={{\r\n            display: \"grid\",\r\n            gridTemplateColumns: \"repeat(auto-fit, minmax(190px, 1fr))\",\r\n            // dunno why this is needed, but when the items wrap it creates\r\n            // an overflow\r\n            overflow: \"hidden\",\r\n        }}>\r\n          {actionManager.renderAction(\"changeExportBackground\")}\r\n          {someElementIsSelected && (<CheckboxItem checked={exportSelected} onChange={(checked) => setExportSelected(checked)}>\r\n              {t(\"labels.onlySelected\")}\r\n            </CheckboxItem>)}\r\n          {actionManager.renderAction(\"changeExportEmbedScene\")}\r\n        </div>\r\n      </div>\r\n      <div style={{ display: \"flex\", alignItems: \"center\", marginTop: \".6em\" }}>\r\n        <Stack.Row gap={2}>\r\n          {actionManager.renderAction(\"changeExportScale\")}\r\n        </Stack.Row>\r\n        <p style={{ marginLeft: \"1em\", userSelect: \"none\" }}>Scale</p>\r\n      </div>\r\n      <div style={{\r\n            display: \"flex\",\r\n            alignItems: \"center\",\r\n            justifyContent: \"center\",\r\n            margin: \".6em 0\",\r\n        }}>\r\n        {!nativeFileSystemSupported &&\r\n            actionManager.renderAction(\"changeProjectName\")}\r\n      </div>\r\n      <Stack.Row gap={2} justifyContent=\"center\" style={{ margin: \"2em 0\" }}>\r\n        <ExportButton color=\"indigo\" title={t(\"buttons.exportToPng\")} aria-label={t(\"buttons.exportToPng\")} onClick={() => onExportToPng(exportedElements)}>\r\n          PNG\r\n        </ExportButton>\r\n        <ExportButton color=\"red\" title={t(\"buttons.exportToSvg\")} aria-label={t(\"buttons.exportToSvg\")} onClick={() => onExportToSvg(exportedElements)}>\r\n          SVG\r\n        </ExportButton>\r\n        {probablySupportsClipboardBlob && (<ExportButton title={t(\"buttons.copyPngToClipboard\")} onClick={() => onExportToClipboard(exportedElements)} color=\"gray\" shade={7}>\r\n            {clipboard}\r\n          </ExportButton>)}\r\n      </Stack.Row>\r\n    </div>);\r\n};\r\nexport const ImageExportDialog = ({ elements, appState, files, exportPadding = DEFAULT_EXPORT_PADDING, actionManager, onExportToPng, onExportToSvg, onExportToClipboard, }) => {\r\n    const [modalIsShown, setModalIsShown] = useState(false);\r\n    const handleClose = React.useCallback(() => {\r\n        setModalIsShown(false);\r\n    }, []);\r\n    return (<>\r\n      <ToolButton onClick={() => {\r\n            setModalIsShown(true);\r\n        }} data-testid=\"image-export-button\" icon={exportImage} type=\"button\" aria-label={t(\"buttons.exportImage\")} showAriaLabel={useIsMobile()} title={t(\"buttons.exportImage\")}/>\r\n      {modalIsShown && (<Dialog onCloseRequest={handleClose} title={t(\"buttons.exportImage\")}>\r\n          <ImageExportModal elements={elements} appState={appState} files={files} exportPadding={exportPadding} actionManager={actionManager} onExportToPng={onExportToPng} onExportToSvg={onExportToSvg} onExportToClipboard={onExportToClipboard} onCloseRequest={handleClose}/>\r\n        </Dialog>)}\r\n    </>);\r\n};\r\n","import \"./FixedSideContainer.scss\";\r\nimport React from \"react\";\r\nimport clsx from \"clsx\";\r\nexport const FixedSideContainer = ({ children, side, className, }) => (<div className={clsx(\"FixedSideContainer\", `FixedSideContainer_side_${side}`, className)}>\r\n    {children}\r\n  </div>);\r\n","import { t } from \"../i18n\";\r\nimport { getSelectedElements } from \"../scene\";\r\nimport \"./HintViewer.scss\";\r\nimport {\r\n  isImageElement,\r\n  isLinearElement,\r\n  isTextElement,\r\n} from \"../element/typeChecks\";\r\nimport { getShortcutKey } from \"../utils\";\r\nconst getHints = ({ appState, elements, isMobile }) => {\r\n  const { elementType, isResizing, isRotating, lastPointerDownWith } = appState;\r\n  const multiMode = appState.multiElement !== null;\r\n  if (elementType === \"arrow\" || elementType === \"line\") {\r\n    if (!multiMode) {\r\n      return t(\"hints.linearElement\");\r\n    }\r\n    return t(\"hints.linearElementMulti\");\r\n  }\r\n  if (elementType === \"freedraw\") {\r\n    return t(\"hints.freeDraw\");\r\n  }\r\n  if (elementType === \"text\") {\r\n    return t(\"hints.text\");\r\n  }\r\n  if (appState.elementType === \"image\" && appState.pendingImageElement) {\r\n    return t(\"hints.placeImage\");\r\n  }\r\n  const selectedElements = getSelectedElements(elements, appState);\r\n  if (\r\n    isResizing &&\r\n    lastPointerDownWith === \"mouse\" &&\r\n    selectedElements.length === 1\r\n  ) {\r\n    const targetElement = selectedElements[0];\r\n    if (isLinearElement(targetElement) && targetElement.points.length === 2) {\r\n      return t(\"hints.lockAngle\");\r\n    }\r\n    return isImageElement(targetElement)\r\n      ? t(\"hints.resizeImage\")\r\n      : t(\"hints.resize\");\r\n  }\r\n  if (isRotating && lastPointerDownWith === \"mouse\") {\r\n    return t(\"hints.rotate\");\r\n  }\r\n  if (selectedElements.length === 1 && isLinearElement(selectedElements[0])) {\r\n    if (appState.editingLinearElement) {\r\n      return appState.editingLinearElement.activePointIndex\r\n        ? t(\"hints.lineEditor_pointSelected\")\r\n        : t(\"hints.lineEditor_nothingSelected\");\r\n    }\r\n    return t(\"hints.lineEditor_info\");\r\n  }\r\n  if (selectedElements.length === 1 && isTextElement(selectedElements[0])) {\r\n    return t(\"hints.text_selected\");\r\n  }\r\n  if (appState.editingElement && isTextElement(appState.editingElement)) {\r\n    return t(\"hints.text_editing\");\r\n  }\r\n  if (elementType === \"selection\" && !selectedElements.length && !isMobile) {\r\n    return t(\"hints.canvasPanning\");\r\n  }\r\n  return null;\r\n};\r\nexport const HintViewer = ({ appState, elements, isMobile }) => {\r\n  let hint = getHints({\r\n    appState,\r\n    elements,\r\n    isMobile,\r\n  });\r\n  if (!hint) {\r\n    return null;\r\n  }\r\n  hint = getShortcutKey(hint);\r\n  return (\r\n    <div className=\"HintViewer\">\r\n      <span>{hint}</span>\r\n    </div>\r\n  );\r\n};\r\n","import \"./Island.scss\";\r\nimport React from \"react\";\r\nimport clsx from \"clsx\";\r\nexport const Island = React.forwardRef(({ children, padding, className, style }, ref) => (<div className={clsx(\"Island\", className)} style={{ \"--padding\": padding, ...style }} ref={ref}>\r\n      {children}\r\n    </div>));\r\n","import clsx from \"clsx\";\r\nimport oc from \"open-color\";\r\nimport { useEffect, useRef, useState } from \"react\";\r\nimport { close } from \"../components/icons\";\r\nimport { MIME_TYPES } from \"../constants\";\r\nimport { t } from \"../i18n\";\r\nimport { useIsMobile } from \"../components/App\";\r\nimport { exportToSvg } from \"../scene/export\";\r\nimport \"./LibraryUnit.scss\";\r\n// fa-plus\r\nconst PLUS_ICON = (<svg viewBox=\"0 0 1792 1792\">\r\n    <path fill=\"currentColor\" d=\"M1600 736v192q0 40-28 68t-68 28h-416v416q0 40-28 68t-68 28h-192q-40 0-68-28t-28-68v-416h-416q-40 0-68-28t-28-68v-192q0-40 28-68t68-28h416v-416q0-40 28-68t68-28h192q40 0 68 28t28 68v416h416q40 0 68 28t28 68z\"/>\r\n  </svg>);\r\nexport const LibraryUnit = ({ elements, files, pendingElements, onRemoveFromLibrary, onClick, }) => {\r\n    const ref = useRef(null);\r\n    useEffect(() => {\r\n        const node = ref.current;\r\n        if (!node) {\r\n            return;\r\n        }\r\n        (async () => {\r\n            const elementsToRender = elements || pendingElements;\r\n            if (!elementsToRender) {\r\n                return;\r\n            }\r\n            const svg = await exportToSvg(elementsToRender, {\r\n                exportBackground: false,\r\n                viewBackgroundColor: oc.white,\r\n            }, files);\r\n            node.innerHTML = svg.outerHTML;\r\n        })();\r\n        return () => {\r\n            node.innerHTML = \"\";\r\n        };\r\n    }, [elements, pendingElements, files]);\r\n    const [isHovered, setIsHovered] = useState(false);\r\n    const isMobile = useIsMobile();\r\n    const adder = (isHovered || isMobile) && pendingElements && (<div className=\"library-unit__adder\">{PLUS_ICON}</div>);\r\n    return (<>\r\n        <div className={clsx(\"library-unit\", {\r\n            \"library-unit__active\": elements || pendingElements,\r\n        })} onMouseEnter={() => setIsHovered(true)} onMouseLeave={() => setIsHovered(false)}>\r\n      <div className={clsx(\"library-unit__dragger\", {\r\n            \"library-unit__pulse\": !!pendingElements,\r\n        })} ref={ref} draggable={!!elements} onClick={!!elements || !!pendingElements ? onClick : undefined} onDragStart={(event) => {\r\n            setIsHovered(false);\r\n            event.dataTransfer.setData(MIME_TYPES.excalidrawlib, JSON.stringify(elements));\r\n        }}/>\r\n      {adder}\r\n      {elements && (isHovered || isMobile) && (<button className=\"library-unit__removeFromLibrary\" aria-label={t(\"labels.removeFromLibrary\")} onClick={onRemoveFromLibrary}>\r\n          {close}\r\n        </button>)}\r\n    </div>\r\n    </>);\r\n};\r\n","import { t } from \"../i18n\";\r\nexport const LoadingMessage = () => {\r\n    // !! KEEP THIS IN SYNC WITH index.html !!\r\n    return (<div className=\"LoadingMessage\">\r\n      <span>{t(\"labels.loadingScene\")}</span>\r\n    </div>);\r\n};\r\n","import \"./ToolIcon.scss\";\r\nimport React from \"react\";\r\nimport clsx from \"clsx\";\r\nconst DEFAULT_SIZE = \"medium\";\r\nconst ICONS = {\r\n    CHECKED: (<svg width=\"1792\" height=\"1792\" viewBox=\"0 0 1792 1792\" xmlns=\"http://www.w3.org/2000/svg\">\r\n      <path d=\"M640 768h512v-192q0-106-75-181t-181-75-181 75-75 181v192zm832 96v576q0 40-28 68t-68 28h-960q-40 0-68-28t-28-68v-576q0-40 28-68t68-28h32v-192q0-184 132-316t316-132 316 132 132 316v192h32q40 0 68 28t28 68z\"/>\r\n    </svg>),\r\n    UNCHECKED: (<svg width=\"1792\" height=\"1792\" viewBox=\"0 0 1792 1792\" xmlns=\"http://www.w3.org/2000/svg\" className=\"unlocked-icon rtl-mirror\">\r\n      <path d=\"M1728 576v256q0 26-19 45t-45 19h-64q-26 0-45-19t-19-45v-256q0-106-75-181t-181-75-181 75-75 181v192h96q40 0 68 28t28 68v576q0 40-28 68t-68 28h-960q-40 0-68-28t-28-68v-576q0-40 28-68t68-28h672v-192q0-185 131.5-316.5t316.5-131.5 316.5 131.5 131.5 316.5z\"/>\r\n    </svg>),\r\n};\r\nexport const LockButton = (props) => {\r\n    return (<label className={clsx(\"ToolIcon ToolIcon__lock ToolIcon_type_floating zen-mode-visibility\", `ToolIcon_size_${DEFAULT_SIZE}`, {\r\n            \"zen-mode-visibility--hidden\": props.zenModeEnabled,\r\n        })} title={`${props.title}  Q`}>\r\n      <input className=\"ToolIcon_type_checkbox\" type=\"checkbox\" name={props.name} onChange={props.onChange} checked={props.checked} aria-label={props.title}/>\r\n      <div className=\"ToolIcon__icon\">\r\n        {props.checked ? ICONS.CHECKED : ICONS.UNCHECKED}\r\n      </div>\r\n    </label>);\r\n};\r\n","import React from \"react\";\r\nimport { t } from \"../i18n\";\r\nimport { useExcalidrawContainer } from \"./App\";\r\nexport const Section = ({ heading, children, ...props }) => {\r\n    const { id } = useExcalidrawContainer();\r\n    const header = (<h2 className=\"visually-hidden\" id={`${id}-${heading}-title`}>\r\n      {t(`headings.${heading}`)}\r\n    </h2>);\r\n    return (<section {...props} aria-labelledby={`${id}-${heading}-title`}>\r\n      {typeof children === \"function\" ? (children(header)) : (<>\r\n          {header}\r\n          {children}\r\n        </>)}\r\n    </section>);\r\n};\r\n","import \"./UserList.scss\";\r\nimport React from \"react\";\r\nimport clsx from \"clsx\";\r\nexport const UserList = ({ children, className, mobile }) => {\r\n    return (<div className={clsx(\"UserList\", className, { UserList_mobile: mobile })}>\r\n      {children}\r\n    </div>);\r\n};\r\n","import React from \"react\";\r\nimport clsx from \"clsx\";\r\nimport { t } from \"../i18n\";\r\nimport { capitalizeString } from \"../utils\";\r\nconst LIBRARY_ICON = (<svg viewBox=\"0 0 576 512\">\r\n    <path fill=\"currentColor\" d=\"M542.22 32.05c-54.8 3.11-163.72 14.43-230.96 55.59-4.64 2.84-7.27 7.89-7.27 13.17v363.87c0 11.55 12.63 18.85 23.28 13.49 69.18-34.82 169.23-44.32 218.7-46.92 16.89-.89 30.02-14.43 30.02-30.66V62.75c.01-17.71-15.35-31.74-33.77-30.7zM264.73 87.64C197.5 46.48 88.58 35.17 33.78 32.05 15.36 31.01 0 45.04 0 62.75V400.6c0 16.24 13.13 29.78 30.02 30.66 49.49 2.6 149.59 12.11 218.77 46.95 10.62 5.35 23.21-1.94 23.21-13.46V100.63c0-5.29-2.62-10.14-7.27-12.99z\"></path>\r\n  </svg>);\r\nexport const LibraryButton = ({ appState, setAppState }) => {\r\n    return (<label className={clsx(\"ToolIcon ToolIcon_type_floating ToolIcon__library zen-mode-visibility\", `ToolIcon_size_medium`, {\r\n            \"zen-mode-visibility--hidden\": appState.zenModeEnabled,\r\n        })} title={`${capitalizeString(t(\"toolBar.library\"))}  0`} style={{ marginInlineStart: \"var(--space-factor)\" }}>\r\n      <input className=\"ToolIcon_type_checkbox\" type=\"checkbox\" name=\"editor-library\" onChange={(event) => {\r\n            setAppState({ isLibraryOpen: event.target.checked });\r\n        }} checked={appState.isLibraryOpen} aria-label={capitalizeString(t(\"toolBar.library\"))} aria-keyshortcuts=\"0\"/>\r\n      <div className=\"ToolIcon__icon\">{LIBRARY_ICON}</div>\r\n    </label>);\r\n};\r\n","import React from \"react\";\r\nimport { t } from \"../i18n\";\r\nimport Stack from \"./Stack\";\r\nimport { showSelectedShapeActions } from \"../element\";\r\nimport { FixedSideContainer } from \"./FixedSideContainer\";\r\nimport { Island } from \"./Island\";\r\nimport { HintViewer } from \"./HintViewer\";\r\nimport { calculateScrollCenter } from \"../scene\";\r\nimport { SelectedShapeActions, ShapesSwitcher } from \"./Actions\";\r\nimport { Section } from \"./Section\";\r\nimport CollabButton from \"./CollabButton\";\r\nimport { SCROLLBAR_WIDTH, SCROLLBAR_MARGIN } from \"../scene/scrollbars\";\r\nimport { LockButton } from \"./LockButton\";\r\nimport { UserList } from \"./UserList\";\r\nimport { BackgroundPickerAndDarkModeToggle } from \"./BackgroundPickerAndDarkModeToggle\";\r\nimport { LibraryButton } from \"./LibraryButton\";\r\nexport const MobileMenu = ({\r\n  appState,\r\n  elements,\r\n  libraryMenu,\r\n  actionManager,\r\n  renderJSONExportDialog,\r\n  renderImageExportDialog,\r\n  setAppState,\r\n  onCollabButtonClick,\r\n  onLockToggle,\r\n  canvas,\r\n  isCollaborating,\r\n  renderCustomFooter,\r\n  viewModeEnabled,\r\n  showThemeBtn,\r\n  onImageAction,\r\n  renderTopRightUI,\r\n}) => {\r\n  const renderToolbar = () => {\r\n    return (\r\n      <FixedSideContainer side=\"top\" className=\"App-top-bar\">\r\n        <Section heading=\"shapes\">\r\n          {(heading) => (\r\n            <Stack.Col gap={4} align=\"center\">\r\n              <Stack.Row gap={1}>\r\n                <Island padding={1}>\r\n                  {heading}\r\n                  <Stack.Row gap={1}>\r\n                    <ShapesSwitcher\r\n                      canvas={canvas}\r\n                      elementType={appState.elementType}\r\n                      setAppState={setAppState}\r\n                      onImageAction={({ pointerType }) => {\r\n                        onImageAction({\r\n                          insertOnCanvasDirectly: pointerType !== \"mouse\",\r\n                        });\r\n                      }}\r\n                    />\r\n                  </Stack.Row>\r\n                </Island>\r\n                {renderTopRightUI && renderTopRightUI(true, appState)}\r\n                <LockButton\r\n                  checked={appState.elementLocked}\r\n                  onChange={onLockToggle}\r\n                  title={t(\"toolBar.lock\")}\r\n                />\r\n                <LibraryButton appState={appState} setAppState={setAppState} />\r\n              </Stack.Row>\r\n              {libraryMenu}\r\n            </Stack.Col>\r\n          )}\r\n        </Section>\r\n        <HintViewer appState={appState} elements={elements} isMobile={true} />\r\n      </FixedSideContainer>\r\n    );\r\n  };\r\n  const renderAppToolbar = () => {\r\n    if (viewModeEnabled) {\r\n      return (\r\n        <div className=\"App-toolbar-content\">\r\n          {actionManager.renderAction(\"toggleCanvasMenu\")}\r\n        </div>\r\n      );\r\n    }\r\n    return (\r\n      <div className=\"App-toolbar-content\">\r\n        {actionManager.renderAction(\"toggleCanvasMenu\")}\r\n        {actionManager.renderAction(\"toggleEditMenu\")}\r\n        {actionManager.renderAction(\"undo\")}\r\n        {actionManager.renderAction(\"redo\")}\r\n        {actionManager.renderAction(\r\n          appState.multiElement ? \"finalize\" : \"duplicateSelection\"\r\n        )}\r\n        {actionManager.renderAction(\"deleteSelectedElements\")}\r\n      </div>\r\n    );\r\n  };\r\n  const renderCanvasActions = () => {\r\n    if (viewModeEnabled) {\r\n      return (\r\n        <>\r\n          {renderJSONExportDialog()}\r\n          {renderImageExportDialog()}\r\n        </>\r\n      );\r\n    }\r\n    return (\r\n      <>\r\n        {actionManager.renderAction(\"clearCanvas\")}\r\n        {actionManager.renderAction(\"loadScene\")}\r\n        {renderJSONExportDialog()}\r\n        {renderImageExportDialog()}\r\n        {onCollabButtonClick && (\r\n          <CollabButton\r\n            isCollaborating={isCollaborating}\r\n            collaboratorCount={appState.collaborators.size}\r\n            onClick={onCollabButtonClick}\r\n          />\r\n        )}\r\n        {\r\n          <BackgroundPickerAndDarkModeToggle\r\n            actionManager={actionManager}\r\n            appState={appState}\r\n            setAppState={setAppState}\r\n            showThemeBtn={showThemeBtn}\r\n          />\r\n        }\r\n      </>\r\n    );\r\n  };\r\n  return (\r\n    <>\r\n      {!viewModeEnabled && renderToolbar()}\r\n      <div\r\n        className=\"App-bottom-bar\"\r\n        style={{\r\n          marginBottom: SCROLLBAR_WIDTH + SCROLLBAR_MARGIN * 2,\r\n          marginLeft: SCROLLBAR_WIDTH + SCROLLBAR_MARGIN * 2,\r\n          marginRight: SCROLLBAR_WIDTH + SCROLLBAR_MARGIN * 2,\r\n        }}\r\n      >\r\n        <Island padding={0}>\r\n          {appState.openMenu === \"canvas\" ? (\r\n            <Section className=\"App-mobile-menu\" heading=\"canvasActions\">\r\n              <div className=\"panelColumn\">\r\n                <Stack.Col gap={4}>\r\n                  {renderCanvasActions()}\r\n                  {renderCustomFooter?.(true, appState)}\r\n                  {appState.collaborators.size > 0 && (\r\n                    <fieldset>\r\n                      <legend>{t(\"labels.collaborators\")}</legend>\r\n                      <UserList mobile>\r\n                        {Array.from(appState.collaborators)\r\n                          // Collaborator is either not initialized or is actually the current user.\r\n                          .filter(\r\n                            ([_, client]) => Object.keys(client).length !== 0\r\n                          )\r\n                          .map(([clientId, client]) => (\r\n                            <React.Fragment key={clientId}>\r\n                              {actionManager.renderAction(\"goToCollaborator\", {\r\n                                id: clientId,\r\n                              })}\r\n                            </React.Fragment>\r\n                          ))}\r\n                      </UserList>\r\n                    </fieldset>\r\n                  )}\r\n                </Stack.Col>\r\n              </div>\r\n            </Section>\r\n          ) : appState.openMenu === \"shape\" &&\r\n            !viewModeEnabled &&\r\n            showSelectedShapeActions(appState, elements) ? (\r\n            <Section className=\"App-mobile-menu\" heading=\"selectedShapeActions\">\r\n              <SelectedShapeActions\r\n                appState={appState}\r\n                elements={elements}\r\n                renderAction={actionManager.renderAction}\r\n                elementType={appState.elementType}\r\n              />\r\n            </Section>\r\n          ) : null}\r\n          <footer className=\"App-toolbar\">\r\n            {renderAppToolbar()}\r\n            {appState.scrolledOutside && !appState.openMenu && (\r\n              <button\r\n                className=\"scroll-back-to-content\"\r\n                onClick={() => {\r\n                  setAppState({\r\n                    ...calculateScrollCenter(elements, appState, canvas),\r\n                  });\r\n                }}\r\n              >\r\n                {t(\"buttons.scrollBackToContent\")}\r\n              </button>\r\n            )}\r\n          </footer>\r\n        </Island>\r\n      </div>\r\n    </>\r\n  );\r\n};\r\n","import oc from \"open-color\";\r\nimport React, { useLayoutEffect, useRef, useState } from \"react\";\r\nimport { trackEvent } from \"../analytics\";\r\nimport { renderSpreadsheet } from \"../charts\";\r\nimport { t } from \"../i18n\";\r\nimport { exportToSvg } from \"../scene/export\";\r\nimport { Dialog } from \"./Dialog\";\r\nimport \"./PasteChartDialog.scss\";\r\nconst ChartPreviewBtn = (props) => {\r\n    const previewRef = useRef(null);\r\n    const [chartElements, setChartElements] = useState(null);\r\n    useLayoutEffect(() => {\r\n        if (!props.spreadsheet) {\r\n            return;\r\n        }\r\n        const elements = renderSpreadsheet(props.chartType, props.spreadsheet, 0, 0);\r\n        setChartElements(elements);\r\n        let svg;\r\n        const previewNode = previewRef.current;\r\n        (async () => {\r\n            svg = await exportToSvg(elements, {\r\n                exportBackground: false,\r\n                viewBackgroundColor: oc.white,\r\n            }, null);\r\n            previewNode.appendChild(svg);\r\n            if (props.selected) {\r\n                previewNode.parentNode.focus();\r\n            }\r\n        })();\r\n        return () => {\r\n            previewNode.removeChild(svg);\r\n        };\r\n    }, [props.spreadsheet, props.chartType, props.selected]);\r\n    return (<button className=\"ChartPreview\" onClick={() => {\r\n            if (chartElements) {\r\n                props.onClick(props.chartType, chartElements);\r\n            }\r\n        }}>\r\n      <div ref={previewRef}/>\r\n    </button>);\r\n};\r\nexport const PasteChartDialog = ({ setAppState, appState, onClose, onInsertChart, }) => {\r\n    const handleClose = React.useCallback(() => {\r\n        if (onClose) {\r\n            onClose();\r\n        }\r\n    }, [onClose]);\r\n    const handleChartClick = (chartType, elements) => {\r\n        onInsertChart(elements);\r\n        trackEvent(\"magic\", \"chart\", chartType);\r\n        setAppState({\r\n            currentChartType: chartType,\r\n            pasteDialog: {\r\n                shown: false,\r\n                data: null,\r\n            },\r\n        });\r\n    };\r\n    return (<Dialog small onCloseRequest={handleClose} title={t(\"labels.pasteCharts\")} className={\"PasteChartDialog\"} autofocus={false}>\r\n      <div className={\"container\"}>\r\n        <ChartPreviewBtn chartType=\"bar\" spreadsheet={appState.pasteDialog.data} selected={appState.currentChartType === \"bar\"} onClick={handleChartClick}/>\r\n        <ChartPreviewBtn chartType=\"line\" spreadsheet={appState.pasteDialog.data} selected={appState.currentChartType === \"line\"} onClick={handleChartClick}/>\r\n      </div>\r\n    </Dialog>);\r\n};\r\n","import React from \"react\";\r\nimport { t } from \"../i18n\";\r\nimport { isDarwin, isWindows } from \"../keys\";\r\nimport { Dialog } from \"./Dialog\";\r\nimport { getShortcutKey } from \"../utils\";\r\nimport \"./HelpDialog.scss\";\r\n\r\nconst Section = (props) => (<>\r\n    <h3>{props.title}</h3>\r\n    {props.children}\r\n  </>);\r\nconst Columns = (props) => (<div style={{\r\n        display: \"flex\",\r\n        flexDirection: \"row\",\r\n        flexWrap: \"wrap\",\r\n        justifyContent: \"space-between\",\r\n    }}>\r\n    {props.children}\r\n  </div>);\r\nconst Column = (props) => (<div style={{ width: \"49%\" }}>{props.children}</div>);\r\nconst ShortcutIsland = (props) => (<div className=\"HelpDialog--island\">\r\n    <h3 className=\"HelpDialog--island-title\">{props.caption}</h3>\r\n    {props.children}\r\n  </div>);\r\nconst Shortcut = (props) => {\r\n    return (<div className=\"HelpDialog--shortcut\">\r\n      <div style={{\r\n            display: \"flex\",\r\n            margin: \"0\",\r\n            padding: \"4px 8px\",\r\n            alignItems: \"center\",\r\n        }}>\r\n        <div style={{\r\n            lineHeight: 1.4,\r\n        }}>\r\n          {props.label}\r\n        </div>\r\n        <div style={{\r\n            display: \"flex\",\r\n            flex: \"0 0 auto\",\r\n            justifyContent: \"flex-end\",\r\n            marginInlineStart: \"auto\",\r\n            minWidth: \"30%\",\r\n        }}>\r\n          {props.shortcuts.map((shortcut, index) => (<React.Fragment key={index}>\r\n              <ShortcutKey>{shortcut}</ShortcutKey>\r\n              {props.isOr &&\r\n                index !== props.shortcuts.length - 1 &&\r\n                t(\"helpDialog.or\")}\r\n            </React.Fragment>))}\r\n        </div>\r\n      </div>\r\n    </div>);\r\n};\r\nShortcut.defaultProps = {\r\n    isOr: true,\r\n};\r\nconst ShortcutKey = (props) => (<kbd className=\"HelpDialog--key\" {...props}/>);\r\nexport const HelpDialog = ({ onClose }) => {\r\n    const handleClose = React.useCallback(() => {\r\n        if (onClose) {\r\n            onClose();\r\n        }\r\n    }, [onClose]);\r\n    return (<>\r\n      <Dialog onCloseRequest={handleClose} title={t(\"helpDialog.title\")} className={\"HelpDialog\"}>\r\n        <Section title={t(\"helpDialog.shortcuts\")}>\r\n          <Columns>\r\n            <Column>\r\n              <ShortcutIsland caption={t(\"helpDialog.shapes\")}>\r\n                <Shortcut label={t(\"toolBar.selection\")} shortcuts={[\"V\", \"1\"]}/>\r\n                <Shortcut label={t(\"toolBar.rectangle\")} shortcuts={[\"R\", \"2\"]}/>\r\n                <Shortcut label={t(\"toolBar.diamond\")} shortcuts={[\"D\", \"3\"]}/>\r\n                <Shortcut label={t(\"toolBar.ellipse\")} shortcuts={[\"E\", \"4\"]}/>\r\n                <Shortcut label={t(\"toolBar.arrow\")} shortcuts={[\"A\", \"5\"]}/>\r\n                <Shortcut label={t(\"toolBar.line\")} shortcuts={[\"P\", \"6\"]}/>\r\n                <Shortcut label={t(\"toolBar.freedraw\")} shortcuts={[\"Shift+P\", \"7\"]}/>\r\n                <Shortcut label={t(\"toolBar.text\")} shortcuts={[\"T\", \"8\"]}/>\r\n                <Shortcut label={t(\"toolBar.image\")} shortcuts={[\"9\"]}/>\r\n                <Shortcut label={t(\"toolBar.library\")} shortcuts={[\"0\"]}/>\r\n                <Shortcut label={t(\"helpDialog.editSelectedShape\")} shortcuts={[\r\n            getShortcutKey(\"Enter\"),\r\n            t(\"helpDialog.doubleClick\"),\r\n        ]}/>\r\n                <Shortcut label={t(\"helpDialog.textNewLine\")} shortcuts={[\r\n            getShortcutKey(\"Enter\"),\r\n            getShortcutKey(\"Shift+Enter\"),\r\n        ]}/>\r\n                <Shortcut label={t(\"helpDialog.textFinish\")} shortcuts={[\r\n            getShortcutKey(\"Esc\"),\r\n            getShortcutKey(\"CtrlOrCmd+Enter\"),\r\n        ]}/>\r\n                <Shortcut label={t(\"helpDialog.curvedArrow\")} shortcuts={[\r\n            \"A\",\r\n            t(\"helpDialog.click\"),\r\n            t(\"helpDialog.click\"),\r\n            t(\"helpDialog.click\"),\r\n        ]} isOr={false}/>\r\n                <Shortcut label={t(\"helpDialog.curvedLine\")} shortcuts={[\r\n            \"L\",\r\n            t(\"helpDialog.click\"),\r\n            t(\"helpDialog.click\"),\r\n            t(\"helpDialog.click\"),\r\n        ]} isOr={false}/>\r\n                <Shortcut label={t(\"toolBar.lock\")} shortcuts={[\"Q\"]}/>\r\n                <Shortcut label={t(\"helpDialog.preventBinding\")} shortcuts={[getShortcutKey(\"CtrlOrCmd\")]}/>\r\n              </ShortcutIsland>\r\n              <ShortcutIsland caption={t(\"helpDialog.view\")}>\r\n                <Shortcut label={t(\"buttons.zoomIn\")} shortcuts={[getShortcutKey(\"CtrlOrCmd++\")]}/>\r\n                <Shortcut label={t(\"buttons.zoomOut\")} shortcuts={[getShortcutKey(\"CtrlOrCmd+-\")]}/>\r\n                <Shortcut label={t(\"buttons.resetZoom\")} shortcuts={[getShortcutKey(\"CtrlOrCmd+0\")]}/>\r\n                <Shortcut label={t(\"helpDialog.zoomToFit\")} shortcuts={[\"Shift+1\"]}/>\r\n                <Shortcut label={t(\"helpDialog.zoomToSelection\")} shortcuts={[\"Shift+2\"]}/>\r\n                <Shortcut label={t(\"buttons.fullScreen\")} shortcuts={[\"F\"]}/>\r\n                <Shortcut label={t(\"buttons.zenMode\")} shortcuts={[getShortcutKey(\"Alt+Z\")]}/>\r\n                <Shortcut label={t(\"labels.showGrid\")} shortcuts={[getShortcutKey(\"CtrlOrCmd+'\")]}/>\r\n                <Shortcut label={t(\"labels.viewMode\")} shortcuts={[getShortcutKey(\"Alt+R\")]}/>\r\n                <Shortcut label={t(\"labels.toggleTheme\")} shortcuts={[getShortcutKey(\"Alt+Shift+D\")]}/>\r\n                <Shortcut label={t(\"stats.title\")} shortcuts={[getShortcutKey(\"Alt+/\")]}/>\r\n              </ShortcutIsland>\r\n            </Column>\r\n            <Column>\r\n              <ShortcutIsland caption={t(\"helpDialog.editor\")}>\r\n                <Shortcut label={t(\"labels.selectAll\")} shortcuts={[getShortcutKey(\"CtrlOrCmd+A\")]}/>\r\n                <Shortcut label={t(\"labels.multiSelect\")} shortcuts={[getShortcutKey(`Shift+${t(\"helpDialog.click\")}`)]}/>\r\n                <Shortcut label={t(\"labels.moveCanvas\")} shortcuts={[\r\n            getShortcutKey(`Space+${t(\"helpDialog.drag\")}`),\r\n            getShortcutKey(`Wheel+${t(\"helpDialog.drag\")}`),\r\n        ]} isOr={true}/>\r\n                <Shortcut label={t(\"labels.cut\")} shortcuts={[getShortcutKey(\"CtrlOrCmd+X\")]}/>\r\n                <Shortcut label={t(\"labels.copy\")} shortcuts={[getShortcutKey(\"CtrlOrCmd+C\")]}/>\r\n                <Shortcut label={t(\"labels.paste\")} shortcuts={[getShortcutKey(\"CtrlOrCmd+V\")]}/>\r\n                <Shortcut label={t(\"labels.copyAsPng\")} shortcuts={[getShortcutKey(\"Shift+Alt+C\")]}/>\r\n                <Shortcut label={t(\"labels.copyStyles\")} shortcuts={[getShortcutKey(\"CtrlOrCmd+Alt+C\")]}/>\r\n                <Shortcut label={t(\"labels.pasteStyles\")} shortcuts={[getShortcutKey(\"CtrlOrCmd+Alt+V\")]}/>\r\n                <Shortcut label={t(\"labels.delete\")} shortcuts={[getShortcutKey(\"Del\")]}/>\r\n                <Shortcut label={t(\"labels.sendToBack\")} shortcuts={[\r\n            isDarwin\r\n                ? getShortcutKey(\"CtrlOrCmd+Alt+[\")\r\n                : getShortcutKey(\"CtrlOrCmd+Shift+[\"),\r\n        ]}/>\r\n                <Shortcut label={t(\"labels.bringToFront\")} shortcuts={[\r\n            isDarwin\r\n                ? getShortcutKey(\"CtrlOrCmd+Alt+]\")\r\n                : getShortcutKey(\"CtrlOrCmd+Shift+]\"),\r\n        ]}/>\r\n                <Shortcut label={t(\"labels.sendBackward\")} shortcuts={[getShortcutKey(\"CtrlOrCmd+[\")]}/>\r\n                <Shortcut label={t(\"labels.bringForward\")} shortcuts={[getShortcutKey(\"CtrlOrCmd+]\")]}/>\r\n                <Shortcut label={t(\"labels.alignTop\")} shortcuts={[getShortcutKey(\"CtrlOrCmd+Shift+Up\")]}/>\r\n                <Shortcut label={t(\"labels.alignBottom\")} shortcuts={[getShortcutKey(\"CtrlOrCmd+Shift+Down\")]}/>\r\n                <Shortcut label={t(\"labels.alignLeft\")} shortcuts={[getShortcutKey(\"CtrlOrCmd+Shift+Left\")]}/>\r\n                <Shortcut label={t(\"labels.alignRight\")} shortcuts={[getShortcutKey(\"CtrlOrCmd+Shift+Right\")]}/>\r\n                <Shortcut label={t(\"labels.duplicateSelection\")} shortcuts={[\r\n            getShortcutKey(\"CtrlOrCmd+D\"),\r\n            getShortcutKey(`Alt+${t(\"helpDialog.drag\")}`),\r\n        ]}/>\r\n                <Shortcut label={t(\"buttons.undo\")} shortcuts={[getShortcutKey(\"CtrlOrCmd+Z\")]}/>\r\n                <Shortcut label={t(\"buttons.redo\")} shortcuts={isWindows\r\n            ? [\r\n                getShortcutKey(\"CtrlOrCmd+Y\"),\r\n                getShortcutKey(\"CtrlOrCmd+Shift+Z\"),\r\n            ]\r\n            : [getShortcutKey(\"CtrlOrCmd+Shift+Z\")]}/>\r\n                <Shortcut label={t(\"labels.group\")} shortcuts={[getShortcutKey(\"CtrlOrCmd+G\")]}/>\r\n                <Shortcut label={t(\"labels.ungroup\")} shortcuts={[getShortcutKey(\"CtrlOrCmd+Shift+G\")]}/>\r\n                <Shortcut label={t(\"labels.flipHorizontal\")} shortcuts={[getShortcutKey(\"Shift+H\")]}/>\r\n                <Shortcut label={t(\"labels.flipVertical\")} shortcuts={[getShortcutKey(\"Shift+V\")]}/>\r\n                <Shortcut label={t(\"labels.showStroke\")} shortcuts={[getShortcutKey(\"S\")]}/>\r\n                <Shortcut label={t(\"labels.showBackground\")} shortcuts={[getShortcutKey(\"G\")]}/>\r\n              </ShortcutIsland>\r\n            </Column>\r\n          </Columns>\r\n        </Section>\r\n      </Dialog>\r\n    </>);\r\n};\r\n","import OpenColor from \"open-color\";\r\nimport \"./Card.scss\";\r\nexport const Card = ({ children, color }) => {\r\n    return (<div className=\"Card\" style={{\r\n            [\"--card-color\"]: OpenColor[color][7],\r\n            [\"--card-color-darker\"]: OpenColor[color][8],\r\n            [\"--card-color-darkest\"]: OpenColor[color][9],\r\n        }}>\r\n      {children}\r\n    </div>);\r\n};\r\n","import React, { useState } from \"react\";\r\nimport { t } from \"../i18n\";\r\nimport { useIsMobile } from \"./App\";\r\nimport { Dialog } from \"./Dialog\";\r\nimport { exportFile, exportToFileIcon, link } from \"./icons\";\r\nimport { ToolButton } from \"./ToolButton\";\r\nimport { actionSaveFileToDisk } from \"../actions/actionExport\";\r\nimport { Card } from \"./Card\";\r\nimport \"./ExportDialog.scss\";\r\nimport { nativeFileSystemSupported } from \"../data/filesystem\";\r\nconst JSONExportModal = ({ elements, appState, files, actionManager, exportOpts, canvas, }) => {\r\n    const { onExportToBackend } = exportOpts;\r\n    return (<div className=\"ExportDialog ExportDialog--json\">\r\n      <div className=\"ExportDialog-cards\">\r\n        {exportOpts.saveFileToDisk && (<Card color=\"lime\">\r\n            <div className=\"Card-icon\">{exportToFileIcon}</div>\r\n            <h2>{t(\"exportDialog.disk_title\")}</h2>\r\n            <div className=\"Card-details\">\r\n              {t(\"exportDialog.disk_details\")}\r\n              {!nativeFileSystemSupported &&\r\n                actionManager.renderAction(\"changeProjectName\")}\r\n            </div>\r\n            <ToolButton className=\"Card-button\" type=\"button\" title={t(\"exportDialog.disk_button\")} aria-label={t(\"exportDialog.disk_button\")} showAriaLabel={true} onClick={() => {\r\n                actionManager.executeAction(actionSaveFileToDisk);\r\n            }}/>\r\n          </Card>)}\r\n        {onExportToBackend && (<Card color=\"pink\">\r\n            <div className=\"Card-icon\">{link}</div>\r\n            <h2>{t(\"exportDialog.link_title\")}</h2>\r\n            <div className=\"Card-details\">{t(\"exportDialog.link_details\")}</div>\r\n            <ToolButton className=\"Card-button\" type=\"button\" title={t(\"exportDialog.link_button\")} aria-label={t(\"exportDialog.link_button\")} showAriaLabel={true} onClick={() => onExportToBackend(elements, appState, files, canvas)}/>\r\n          </Card>)}\r\n        {exportOpts.renderCustomUI &&\r\n            exportOpts.renderCustomUI(elements, appState, files, canvas)}\r\n      </div>\r\n    </div>);\r\n};\r\nexport const JSONExportDialog = ({ elements, appState, files, actionManager, exportOpts, canvas, }) => {\r\n    const [modalIsShown, setModalIsShown] = useState(false);\r\n    const handleClose = React.useCallback(() => {\r\n        setModalIsShown(false);\r\n    }, []);\r\n    return (<>\r\n      <ToolButton onClick={() => {\r\n            setModalIsShown(true);\r\n        }} data-testid=\"json-export-button\" icon={exportFile} type=\"button\" aria-label={t(\"buttons.export\")} showAriaLabel={useIsMobile()} title={t(\"buttons.export\")}/>\r\n      {modalIsShown && (<Dialog onCloseRequest={handleClose} title={t(\"buttons.export\")}>\r\n          <JSONExportModal elements={elements} appState={appState} files={files} actionManager={actionManager} onCloseRequest={handleClose} exportOpts={exportOpts} canvas={canvas}/>\r\n        </Dialog>)}\r\n    </>);\r\n};\r\n","import clsx from \"clsx\";\r\nimport React, { useCallback, useEffect, useRef, useState } from \"react\";\r\nimport { CLASSES } from \"../constants\";\r\nimport { exportCanvas } from \"../data\";\r\nimport { importLibraryFromJSON, saveLibraryAsJSON } from \"../data/json\";\r\nimport { isTextElement, showSelectedShapeActions } from \"../element\";\r\nimport { t } from \"../i18n\";\r\nimport { useIsMobile } from \"../components/App\";\r\nimport { calculateScrollCenter, getSelectedElements } from \"../scene\";\r\nimport { muteFSAbortError } from \"../utils\";\r\nimport { SelectedShapeActions, ShapesSwitcher, ZoomActions } from \"./Actions\";\r\nimport { BackgroundPickerAndDarkModeToggle } from \"./BackgroundPickerAndDarkModeToggle\";\r\nimport CollabButton from \"./CollabButton\";\r\nimport { libraries } from \"../data/Libraries\";\r\nimport { ErrorDialog } from \"./ErrorDialog\";\r\nimport { ImageExportDialog } from \"./ImageExportDialog\";\r\nimport { FixedSideContainer } from \"./FixedSideContainer\";\r\nimport { HintViewer } from \"./HintViewer\";\r\nimport { exportFile, load, trash } from \"./icons\";\r\nimport { Island } from \"./Island\";\r\nimport \"./LayerUI.scss\";\r\nimport { LibraryUnit } from \"./LibraryUnit\";\r\nimport { LoadingMessage } from \"./LoadingMessage\";\r\nimport { LockButton } from \"./LockButton\";\r\nimport { MobileMenu } from \"./MobileMenu\";\r\nimport { PasteChartDialog } from \"./PasteChartDialog\";\r\nimport { Section } from \"./Section\";\r\nimport { HelpDialog } from \"./HelpDialog\";\r\nimport Stack from \"./Stack\";\r\nimport { ToolButton } from \"./ToolButton\";\r\nimport { Tooltip } from \"./Tooltip\";\r\nimport { UserList } from \"./UserList\";\r\nimport { JSONExportDialog } from \"./JSONExportDialog\";\r\nimport { LibraryButton } from \"./LibraryButton\";\r\nimport { isImageFileHandle } from \"../data/blob\";\r\nconst useOnClickOutside = (ref, cb) => {\r\n  useEffect(() => {\r\n    const listener = (event) => {\r\n      if (!ref.current) {\r\n        return;\r\n      }\r\n      if (\r\n        event.target instanceof Element &&\r\n        (ref.current.contains(event.target) ||\r\n          !document.body.contains(event.target))\r\n      ) {\r\n        return;\r\n      }\r\n      cb(event);\r\n    };\r\n    document.addEventListener(\"pointerdown\", listener, false);\r\n    return () => {\r\n      document.removeEventListener(\"pointerdown\", listener);\r\n    };\r\n  }, [ref, cb]);\r\n};\r\nconst LibraryMenuItems = ({\r\n  libraryItems,\r\n  onRemoveFromLibrary,\r\n  onAddToLibrary,\r\n  onInsertShape,\r\n  pendingElements,\r\n  theme,\r\n  setAppState,\r\n  setLibraryItems,\r\n  libraryReturnUrl,\r\n  focusContainer,\r\n  library,\r\n  files,\r\n  id,\r\n}) => {\r\n  const isMobile = useIsMobile();\r\n  const numCells = libraryItems.length + (pendingElements.length > 0 ? 1 : 0);\r\n  const CELLS_PER_ROW = isMobile ? 4 : 6;\r\n  const numRows = Math.max(1, Math.ceil(numCells / CELLS_PER_ROW));\r\n  const rows = [];\r\n  let addedPendingElements = false;\r\n  const referrer =\r\n    libraryReturnUrl || window.location.origin + window.location.pathname;\r\n  rows.push(\r\n    <div className=\"layer-ui__library-header\" key=\"library-header\">\r\n      {/* <input type=\"text\" onChange={changeLibraryParma} /> */}\r\n      <ToolButton\r\n        key=\"import\"\r\n        type=\"button\"\r\n        title={t(\"buttons.load\")}\r\n        aria-label={t(\"buttons.load\")}\r\n        icon={load}\r\n        onClick={() => {\r\n          importLibraryFromJSON(library)\r\n            .then(() => {\r\n              // Close and then open to get the libraries updated\r\n              setAppState({ isLibraryOpen: false });\r\n              setAppState({ isLibraryOpen: true });\r\n            })\r\n            .catch(muteFSAbortError)\r\n            .catch((error) => {\r\n              setAppState({ errorMessage: error.message });\r\n            });\r\n        }}\r\n      />\r\n      {!!libraryItems.length && (\r\n        <>\r\n          <ToolButton\r\n            key=\"export\"\r\n            type=\"button\"\r\n            title={t(\"buttons.export\")}\r\n            aria-label={t(\"buttons.export\")}\r\n            icon={exportFile}\r\n            onClick={() => {\r\n              saveLibraryAsJSON(library)\r\n                .catch(muteFSAbortError)\r\n                .catch((error) => {\r\n                  setAppState({ errorMessage: error.message });\r\n                });\r\n            }}\r\n          />\r\n          <ToolButton\r\n            key=\"reset\"\r\n            type=\"button\"\r\n            title={t(\"buttons.resetLibrary\")}\r\n            aria-label={t(\"buttons.resetLibrary\")}\r\n            icon={trash}\r\n            onClick={() => {\r\n              if (window.confirm(t(\"alerts.resetLibrary\"))) {\r\n                library.resetLibrary();\r\n                setLibraryItems([]);\r\n                focusContainer();\r\n              }\r\n            }}\r\n          />\r\n        </>\r\n      )}\r\n      {/* <a\r\n        href={`https://libraries.excalidraw.com?target=${\r\n          window.name || \"_blank\"\r\n        }&referrer=${referrer}&useHash=true&token=${id}&theme=${theme}`}\r\n        target=\"_excalidraw_libraries\"\r\n      >\r\n        {t(\"labels.libraries\")}\r\n      </a> */}\r\n    </div>\r\n  );\r\n  for (let row = 0; row < numRows; row++) {\r\n    const y = CELLS_PER_ROW * row;\r\n    const children = [];\r\n    // console.log(numRows)\r\n    // console.log(CELLS_PER_ROW)\r\n    for (let x = 0; x < CELLS_PER_ROW; x++) {\r\n      const shouldAddPendingElements =\r\n        pendingElements.length > 0 &&\r\n        !addedPendingElements &&\r\n        y + x >= libraryItems.length;\r\n      addedPendingElements = addedPendingElements || shouldAddPendingElements;\r\n      children.push(\r\n        <Stack.Col key={x}>\r\n          <LibraryUnit\r\n            elements={libraryItems[y + x]}\r\n            files={files}\r\n            pendingElements={\r\n              shouldAddPendingElements ? pendingElements : undefined\r\n            }\r\n            onRemoveFromLibrary={onRemoveFromLibrary.bind(null, y + x)}\r\n            onClick={\r\n              shouldAddPendingElements\r\n                ? onAddToLibrary.bind(null, pendingElements)\r\n                : onInsertShape.bind(null, libraryItems[y + x])\r\n            }\r\n          />\r\n        </Stack.Col>\r\n      );\r\n    }\r\n    rows.push(\r\n      <Stack.Row align=\"center\" gap={1} key={row}>\r\n        {children}\r\n      </Stack.Row>\r\n    );\r\n  }\r\n  return (\r\n    <Stack.Col align=\"start\" gap={1} className=\"layer-ui__library-items\">\r\n      {rows}\r\n    </Stack.Col>\r\n  );\r\n};\r\nconst LibraryMenu = ({\r\n  onClickOutside,\r\n  onInsertShape,\r\n  pendingElements,\r\n  onAddToLibrary,\r\n  theme,\r\n  setAppState,\r\n  files,\r\n  libraryReturnUrl,\r\n  focusContainer,\r\n  library,\r\n  id,\r\n}) => {\r\n  const ref = useRef(null);\r\n  useOnClickOutside(ref, (event) => {\r\n    // If click on the library icon, do nothing.\r\n    if (event.target.closest(\".ToolIcon_type_button__library\")) {\r\n      return;\r\n    }\r\n    onClickOutside(event);\r\n  });\r\n  const [libraryItems, setLibraryItems] = useState([]);\r\n  const [loadingState, setIsLoading] = useState(\"preloading\");\r\n  const [libraryParam, setLibraryParam] = useState(\"\");\r\n  const loadingTimerRef = useRef(null);\r\n  useEffect(() => {\r\n    //console.log(libraryParam)\r\n    Promise.race([\r\n      new Promise((resolve) => {\r\n        loadingTimerRef.current = window.setTimeout(() => {\r\n          resolve(\"loading\");\r\n        }, 100);\r\n      }),\r\n      console.log(libraries(libraryParam).library.length),\r\n      setLibraryItems(libraries(libraryParam).library),\r\n      setIsLoading(\"ready\"),\r\n      // library.loadLibrary().then((items) => {\r\n      //   console.log(items)\r\n      //   console.log(Libraries.library)\r\n      //   setLibraryItems(Libraries.library);\r\n      //   setIsLoading(\"ready\");\r\n      // }),\r\n    ]).then((data) => {\r\n      if (data === \"loading\") {\r\n        setIsLoading(\"loading\");\r\n      }\r\n    });\r\n    return () => {\r\n      clearTimeout(loadingTimerRef.current);\r\n    };\r\n  }, [library, libraryParam]);\r\n  const removeFromLibrary = useCallback(\r\n    async (indexToRemove) => {\r\n      const items = await library.loadLibrary();\r\n      const nextItems = items.filter((_, index) => index !== indexToRemove);\r\n      library.saveLibrary(nextItems).catch((error) => {\r\n        setLibraryItems(items);\r\n        setAppState({ errorMessage: t(\"alerts.errorRemovingFromLibrary\") });\r\n      });\r\n      setLibraryItems(nextItems);\r\n    },\r\n    [library, setAppState]\r\n  );\r\n  const changeLibraryParma = (e) => {\r\n    console.log(e.target.value);\r\n    setLibraryParam(e.target.value);\r\n  };\r\n  const addToLibrary = useCallback(\r\n    async (elements) => {\r\n      if (elements.some((element) => element.type === \"image\")) {\r\n        return setAppState({\r\n          errorMessage: \"Support for adding images to the library coming soon!\",\r\n        });\r\n      }\r\n      const items = await library.loadLibrary();\r\n      const nextItems = [...items, elements];\r\n      onAddToLibrary();\r\n      library.saveLibrary(nextItems).catch((error) => {\r\n        setLibraryItems(items);\r\n        setAppState({ errorMessage: t(\"alerts.errorAddingToLibrary\") });\r\n      });\r\n      setLibraryItems(nextItems);\r\n    },\r\n    [onAddToLibrary, library, setAppState]\r\n  );\r\n  return loadingState === \"preloading\" ? null : (\r\n    <Island padding={1} ref={ref} className=\"layer-ui__library\">\r\n      {loadingState === \"loading\" ? (\r\n        <div className=\"layer-ui__library-message\">\r\n          {t(\"labels.libraryLoadingMessage\")}\r\n        </div>\r\n      ) : (\r\n        <LibraryMenuItems\r\n          libraryItems={libraryItems}\r\n          onRemoveFromLibrary={removeFromLibrary}\r\n          onAddToLibrary={addToLibrary}\r\n          onInsertShape={onInsertShape}\r\n          pendingElements={pendingElements}\r\n          setAppState={setAppState}\r\n          setLibraryItems={setLibraryItems}\r\n          libraryReturnUrl={libraryReturnUrl}\r\n          focusContainer={focusContainer}\r\n          library={library}\r\n          theme={theme}\r\n          files={files}\r\n          id={id}\r\n        />\r\n      )}\r\n      <input type=\"text\" onChange={changeLibraryParma} />\r\n    </Island>\r\n  );\r\n};\r\nconst LayerUI = ({\r\n  actionManager,\r\n  appState,\r\n  files,\r\n  setAppState,\r\n  canvas,\r\n  elements,\r\n  onCollabButtonClick,\r\n  onLockToggle,\r\n  onInsertElements,\r\n  zenModeEnabled,\r\n  showExitZenModeBtn,\r\n  showThemeBtn,\r\n  toggleZenMode,\r\n  isCollaborating,\r\n  renderTopRightUI,\r\n  renderCustomFooter,\r\n  viewModeEnabled,\r\n  libraryReturnUrl,\r\n  UIOptions,\r\n  focusContainer,\r\n  library,\r\n  id,\r\n  onImageAction,\r\n}) => {\r\n  const isMobile = useIsMobile();\r\n  const renderJSONExportDialog = () => {\r\n    if (!UIOptions.canvasActions.export) {\r\n      return null;\r\n    }\r\n    return (\r\n      <JSONExportDialog\r\n        elements={elements}\r\n        appState={appState}\r\n        files={files}\r\n        actionManager={actionManager}\r\n        exportOpts={UIOptions.canvasActions.export}\r\n        canvas={canvas}\r\n      />\r\n    );\r\n  };\r\n  const renderImageExportDialog = () => {\r\n    if (!UIOptions.canvasActions.saveAsImage) {\r\n      return null;\r\n    }\r\n    const createExporter = (type) => async (exportedElements) => {\r\n      const fileHandle = await exportCanvas(\r\n        type,\r\n        exportedElements,\r\n        appState,\r\n        files,\r\n        {\r\n          exportBackground: appState.exportBackground,\r\n          name: appState.name,\r\n          viewBackgroundColor: appState.viewBackgroundColor,\r\n        }\r\n      )\r\n        .catch(muteFSAbortError)\r\n        .catch((error) => {\r\n          console.error(error);\r\n          setAppState({ errorMessage: error.message });\r\n        });\r\n      if (\r\n        appState.exportEmbedScene &&\r\n        fileHandle &&\r\n        isImageFileHandle(fileHandle)\r\n      ) {\r\n        setAppState({ fileHandle });\r\n      }\r\n    };\r\n    return (\r\n      <ImageExportDialog\r\n        elements={elements}\r\n        appState={appState}\r\n        files={files}\r\n        actionManager={actionManager}\r\n        onExportToPng={createExporter(\"png\")}\r\n        onExportToSvg={createExporter(\"svg\")}\r\n        onExportToClipboard={createExporter(\"clipboard\")}\r\n      />\r\n    );\r\n  };\r\n  const Separator = () => {\r\n    return <div style={{ width: \".625em\" }} />;\r\n  };\r\n  const renderViewModeCanvasActions = () => {\r\n    return (\r\n      <Section\r\n        heading=\"canvasActions\"\r\n        className={clsx(\"zen-mode-transition\", {\r\n          \"transition-left\": zenModeEnabled,\r\n        })}\r\n      >\r\n        {/* the zIndex ensures this menu has higher stacking order,\r\n             see https://github.com/excalidraw/excalidraw/pull/1445 */}\r\n        <Island padding={2} style={{ zIndex: 1 }}>\r\n          <Stack.Col gap={4}>\r\n            <Stack.Row gap={1} justifyContent=\"space-between\">\r\n              {renderJSONExportDialog()}\r\n              {renderImageExportDialog()}\r\n            </Stack.Row>\r\n          </Stack.Col>\r\n        </Island>\r\n      </Section>\r\n    );\r\n  };\r\n  const renderCanvasActions = () => (\r\n    <Section\r\n      heading=\"canvasActions\"\r\n      className={clsx(\"zen-mode-transition\", {\r\n        \"transition-left\": zenModeEnabled,\r\n      })}\r\n    >\r\n      {/* the zIndex ensures this menu has higher stacking order,\r\n           see https://github.com/excalidraw/excalidraw/pull/1445 */}\r\n      <Island padding={2} style={{ zIndex: 1 }}>\r\n        <Stack.Col gap={4}>\r\n          <Stack.Row gap={1} justifyContent=\"space-between\">\r\n            {actionManager.renderAction(\"clearCanvas\")}\r\n            <Separator />\r\n            {actionManager.renderAction(\"loadScene\")}\r\n            {renderJSONExportDialog()}\r\n            {renderImageExportDialog()}\r\n            <Separator />\r\n            {onCollabButtonClick && (\r\n              <CollabButton\r\n                isCollaborating={isCollaborating}\r\n                collaboratorCount={appState.collaborators.size}\r\n                onClick={onCollabButtonClick}\r\n              />\r\n            )}\r\n          </Stack.Row>\r\n          <BackgroundPickerAndDarkModeToggle\r\n            actionManager={actionManager}\r\n            appState={appState}\r\n            setAppState={setAppState}\r\n            showThemeBtn={showThemeBtn}\r\n          />\r\n          {appState.fileHandle && (\r\n            <>{actionManager.renderAction(\"saveToActiveFile\")}</>\r\n          )}\r\n        </Stack.Col>\r\n      </Island>\r\n    </Section>\r\n  );\r\n  const renderSelectedShapeActions = () => (\r\n    <Section\r\n      heading=\"selectedShapeActions\"\r\n      className={clsx(\"zen-mode-transition\", {\r\n        \"transition-left\": zenModeEnabled,\r\n      })}\r\n    >\r\n      <Island\r\n        className={CLASSES.SHAPE_ACTIONS_MENU}\r\n        padding={2}\r\n        style={{\r\n          // we want to make sure this doesn't overflow so substracting 200\r\n          // which is approximately height of zoom footer and top left menu items with some buffer\r\n          // if active file name is displayed, subtracting 248 to account for its height\r\n          maxHeight: `${appState.height - (appState.fileHandle ? 248 : 200)}px`,\r\n        }}\r\n      >\r\n        <SelectedShapeActions\r\n          appState={appState}\r\n          elements={elements}\r\n          renderAction={actionManager.renderAction}\r\n          elementType={appState.elementType}\r\n        />\r\n      </Island>\r\n    </Section>\r\n  );\r\n  const closeLibrary = useCallback(\r\n    (event) => {\r\n      setAppState({ isLibraryOpen: false });\r\n    },\r\n    [setAppState]\r\n  );\r\n  const deselectItems = useCallback(() => {\r\n    setAppState({\r\n      selectedElementIds: {},\r\n      selectedGroupIds: {},\r\n    });\r\n  }, [setAppState]);\r\n  const libraryMenu = appState.isLibraryOpen ? (\r\n    <LibraryMenu\r\n      pendingElements={getSelectedElements(elements, appState)}\r\n      onClickOutside={closeLibrary}\r\n      onInsertShape={onInsertElements}\r\n      onAddToLibrary={deselectItems}\r\n      setAppState={setAppState}\r\n      libraryReturnUrl={libraryReturnUrl}\r\n      focusContainer={focusContainer}\r\n      library={library}\r\n      theme={appState.theme}\r\n      files={files}\r\n      id={id}\r\n    />\r\n  ) : null;\r\n\r\n  const renderSideContainer = () => {\r\n    const shouldRenderSelectedShapeActions = showSelectedShapeActions(\r\n      appState,\r\n      elements\r\n    );\r\n\r\n    return (\r\n      <>\r\n        <FixedSideContainer side=\"top\">\r\n          <HintViewer\r\n            appState={appState}\r\n            elements={elements}\r\n            isMobile={isMobile}\r\n          />\r\n        </FixedSideContainer>\r\n        <FixedSideContainer side=\"right\" className={clsx(\r\n            \"zen-mode-transition\",\r\n            {\r\n              \"transition-right disable-pointerEvents\": zenModeEnabled,\r\n            })}>\r\n            <Stack.Row>\r\n          <Section heading=\"shapes\">\r\n            {(heading) => (\r\n              <Stack.Row gap={4} align=\"start\">\r\n                <Stack.Col gap={1}>\r\n                  <LockButton\r\n                    zenModeEnabled={zenModeEnabled}\r\n                    checked={appState.elementLocked}\r\n                    onChange={onLockToggle}\r\n                    title={t(\"toolBar.lock\")}\r\n                  />\r\n                  <Island\r\n                    padding={1}\r\n                    className={clsx({ \"zen-mode\": zenModeEnabled })}\r\n                  >\r\n                    {heading}\r\n                    <Stack.Col gap={1}>\r\n                      <ShapesSwitcher\r\n                        canvas={canvas}\r\n                        elementType={appState.elementType}\r\n                        setAppState={setAppState}\r\n                        onImageAction={({ pointerType }) => {\r\n                          onImageAction({\r\n                            insertOnCanvasDirectly: pointerType !== \"mouse\",\r\n                          });\r\n                        }}\r\n                      />\r\n                    </Stack.Col>\r\n                  </Island>\r\n                  <LibraryButton\r\n                    appState={appState}\r\n                    setAppState={setAppState}\r\n                  />\r\n                </Stack.Col>\r\n                {libraryMenu}\r\n              </Stack.Row>\r\n            )}\r\n          </Section>\r\n          <Stack.Col\r\n            gap={4}\r\n            className={clsx({ \"disable-pointerEvents\": zenModeEnabled })}\r\n            >\r\n            {/* {viewModeEnabled\r\n              ? renderViewModeCanvasActions()\r\n              : renderCanvasActions()} */}\r\n            {shouldRenderSelectedShapeActions && renderSelectedShapeActions()}\r\n          </Stack.Col>\r\n          </Stack.Row>\r\n        </FixedSideContainer>\r\n      </>\r\n    );\r\n  };\r\n  const renderFixedSideContainer = () => {\r\n    const shouldRenderSelectedShapeActions = showSelectedShapeActions(\r\n      appState,\r\n      elements\r\n    );\r\n    return (\r\n      <FixedSideContainer side=\"top\">\r\n        <div className=\"App-menu App-menu_top\">\r\n          <Stack.Col\r\n            gap={4}\r\n            className={clsx({ \"disable-pointerEvents\": zenModeEnabled })}\r\n          >\r\n            {viewModeEnabled\r\n              ? renderViewModeCanvasActions()\r\n              : renderCanvasActions()}\r\n            {shouldRenderSelectedShapeActions && renderSelectedShapeActions()}\r\n          </Stack.Col>\r\n          {!viewModeEnabled && (\r\n            <Section heading=\"shapes\">\r\n              {(heading) => (\r\n                <Stack.Col gap={4} align=\"start\">\r\n                  <Stack.Row gap={1}>\r\n                    <LockButton\r\n                      zenModeEnabled={zenModeEnabled}\r\n                      checked={appState.elementLocked}\r\n                      onChange={onLockToggle}\r\n                      title={t(\"toolBar.lock\")}\r\n                    />\r\n                    <Island\r\n                      padding={1}\r\n                      className={clsx({ \"zen-mode\": zenModeEnabled })}\r\n                    >\r\n                      <HintViewer\r\n                        appState={appState}\r\n                        elements={elements}\r\n                        isMobile={isMobile}\r\n                      />\r\n                      {heading}\r\n                      <Stack.Row gap={1}>\r\n                        <ShapesSwitcher\r\n                          canvas={canvas}\r\n                          elementType={appState.elementType}\r\n                          setAppState={setAppState}\r\n                          onImageAction={({ pointerType }) => {\r\n                            onImageAction({\r\n                              insertOnCanvasDirectly: pointerType !== \"mouse\",\r\n                            });\r\n                          }}\r\n                        />\r\n                      </Stack.Row>\r\n                    </Island>\r\n                    <LibraryButton\r\n                      appState={appState}\r\n                      setAppState={setAppState}\r\n                    />\r\n                  </Stack.Row>\r\n                  {libraryMenu}\r\n                </Stack.Col>\r\n              )}\r\n            </Section>\r\n          )}\r\n          <div\r\n            className={clsx(\r\n              \"layer-ui__wrapper__top-right zen-mode-transition\",\r\n              {\r\n                \"transition-right\": zenModeEnabled,\r\n              }\r\n            )}\r\n          >\r\n            <UserList>\r\n              {appState.collaborators.size > 0 &&\r\n                Array.from(appState.collaborators)\r\n                  // Collaborator is either not initialized or is actually the current user.\r\n                  .filter(([_, client]) => Object.keys(client).length !== 0)\r\n                  .map(([clientId, client]) => (\r\n                    <Tooltip\r\n                      label={client.username || \"Unknown user\"}\r\n                      key={clientId}\r\n                    >\r\n                      {actionManager.renderAction(\"goToCollaborator\", {\r\n                        id: clientId,\r\n                      })}\r\n                    </Tooltip>\r\n                  ))}\r\n            </UserList>\r\n            {renderTopRightUI?.(isMobile, appState)}\r\n          </div>\r\n        </div>\r\n      </FixedSideContainer>\r\n    );\r\n  };\r\n  const renderBottomAppMenu = () => {\r\n    return (\r\n      <footer\r\n        role=\"contentinfo\"\r\n        className=\"layer-ui__wrapper__footer App-menu App-menu_bottom\"\r\n      >\r\n        <div\r\n          className={clsx(\r\n            \"layer-ui__wrapper__footer-left zen-mode-transition\",\r\n            {\r\n              \"layer-ui__wrapper__footer-left--transition-left\": zenModeEnabled,\r\n            }\r\n          )}\r\n        >\r\n          <Stack.Col gap={2}>\r\n            <Section heading=\"canvasActions\">\r\n              <Island padding={1}>\r\n                <ZoomActions\r\n                  renderAction={actionManager.renderAction}\r\n                  zoom={appState.zoom}\r\n                />\r\n              </Island>\r\n              {!viewModeEnabled && (\r\n                <div\r\n                  className={clsx(\"undo-redo-buttons zen-mode-transition\", {\r\n                    \"layer-ui__wrapper__footer-left--transition-bottom\":\r\n                      zenModeEnabled,\r\n                  })}\r\n                >\r\n                  {actionManager.renderAction(\"undo\", { size: \"small\" })}\r\n                  {actionManager.renderAction(\"redo\", { size: \"small\" })}\r\n                </div>\r\n              )}\r\n            </Section>\r\n          </Stack.Col>\r\n        </div>\r\n        <div\r\n          className={clsx(\r\n            \"layer-ui__wrapper__footer-center zen-mode-transition\",\r\n            {\r\n              \"layer-ui__wrapper__footer-left--transition-bottom\":\r\n                zenModeEnabled,\r\n            }\r\n          )}\r\n        >\r\n          {renderCustomFooter?.(false, appState)}\r\n        </div>\r\n        <div\r\n          className={clsx(\r\n            \"layer-ui__wrapper__footer-right zen-mode-transition\",\r\n            {\r\n              \"transition-right disable-pointerEvents\": zenModeEnabled,\r\n            }\r\n          )}\r\n        >\r\n          {actionManager.renderAction(\"toggleShortcuts\")}\r\n        </div>\r\n        <button\r\n          className={clsx(\"disable-zen-mode\", {\r\n            \"disable-zen-mode--visible\": showExitZenModeBtn,\r\n          })}\r\n          onClick={toggleZenMode}\r\n        >\r\n          {t(\"buttons.exitZenMode\")}\r\n        </button>\r\n      </footer>\r\n    );\r\n  };\r\n  const dialogs = (\r\n    <>\r\n      {appState.isLoading && <LoadingMessage />}\r\n      {appState.errorMessage && (\r\n        <ErrorDialog\r\n          message={appState.errorMessage}\r\n          onClose={() => setAppState({ errorMessage: null })}\r\n        />\r\n      )}\r\n      {appState.showHelpDialog && (\r\n        <HelpDialog\r\n          onClose={() => {\r\n            setAppState({ showHelpDialog: false });\r\n          }}\r\n        />\r\n      )}\r\n      {appState.pasteDialog.shown && (\r\n        <PasteChartDialog\r\n          setAppState={setAppState}\r\n          appState={appState}\r\n          onInsertChart={onInsertElements}\r\n          onClose={() =>\r\n            setAppState({\r\n              pasteDialog: { shown: false, data: null },\r\n            })\r\n          }\r\n        />\r\n      )}\r\n    </>\r\n  );\r\n  return isMobile ? (\r\n    <>\r\n      {dialogs}\r\n      <MobileMenu\r\n        appState={appState}\r\n        elements={elements}\r\n        actionManager={actionManager}\r\n        libraryMenu={libraryMenu}\r\n        renderJSONExportDialog={renderJSONExportDialog}\r\n        renderImageExportDialog={renderImageExportDialog}\r\n        setAppState={setAppState}\r\n        onCollabButtonClick={onCollabButtonClick}\r\n        onLockToggle={onLockToggle}\r\n        canvas={canvas}\r\n        isCollaborating={isCollaborating}\r\n        renderCustomFooter={renderCustomFooter}\r\n        viewModeEnabled={viewModeEnabled}\r\n        showThemeBtn={showThemeBtn}\r\n        onImageAction={onImageAction}\r\n        renderTopRightUI={renderTopRightUI}\r\n      />\r\n    </>\r\n  ) : (\r\n    <div\r\n      className={clsx(\"layer-ui__wrapper\", {\r\n        \"disable-pointerEvents\":\r\n          appState.draggingElement ||\r\n          appState.resizingElement ||\r\n          (appState.editingElement && !isTextElement(appState.editingElement)),\r\n      })}\r\n    >\r\n      {dialogs}\r\n      {renderSideContainer()}\r\n      {renderBottomAppMenu()}\r\n      {appState.scrolledOutside && (\r\n        <button\r\n          className=\"scroll-back-to-content\"\r\n          onClick={() => {\r\n            setAppState({\r\n              ...calculateScrollCenter(elements, appState, canvas),\r\n            });\r\n          }}\r\n        >\r\n          {t(\"buttons.scrollBackToContent\")}\r\n        </button>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\nconst areEqual = (prev, next) => {\r\n  const getNecessaryObj = (appState) => {\r\n    const {\r\n      suggestedBindings,\r\n      startBoundElement: boundElement,\r\n      ...ret\r\n    } = appState;\r\n    return ret;\r\n  };\r\n  const prevAppState = getNecessaryObj(prev.appState);\r\n  const nextAppState = getNecessaryObj(next.appState);\r\n  const keys = Object.keys(prevAppState);\r\n  return (\r\n    prev.renderCustomFooter === next.renderCustomFooter &&\r\n    prev.langCode === next.langCode &&\r\n    prev.elements === next.elements &&\r\n    prev.files === next.files &&\r\n    keys.every((key) => prevAppState[key] === nextAppState[key])\r\n  );\r\n};\r\nexport default React.memo(LayerUI, areEqual);\r\n","import React from \"react\";\r\nimport { getCommonBounds } from \"../element/bounds\";\r\nimport { t } from \"../i18n\";\r\nimport { useIsMobile } from \"../components/App\";\r\nimport { getTargetElements } from \"../scene\";\r\nimport { close } from \"./icons\";\r\nimport { Island } from \"./Island\";\r\nimport \"./Stats.scss\";\r\nexport const Stats = (props) => {\r\n    const isMobile = useIsMobile();\r\n    const boundingBox = getCommonBounds(props.elements);\r\n    const selectedElements = getTargetElements(props.elements, props.appState);\r\n    const selectedBoundingBox = getCommonBounds(selectedElements);\r\n    if (isMobile && props.appState.openMenu) {\r\n        return null;\r\n    }\r\n    return (<div className=\"Stats\">\r\n      <Island padding={2}>\r\n        <div className=\"close\" onClick={props.onClose}>\r\n          {close}\r\n        </div>\r\n        <h3>{t(\"stats.title\")}</h3>\r\n        <table>\r\n          <tbody>\r\n            <tr>\r\n              <th colSpan={2}>{t(\"stats.scene\")}</th>\r\n            </tr>\r\n            <tr>\r\n              <td>{t(\"stats.elements\")}</td>\r\n              <td>{props.elements.length}</td>\r\n            </tr>\r\n            <tr>\r\n              <td>{t(\"stats.width\")}</td>\r\n              <td>{Math.round(boundingBox[2]) - Math.round(boundingBox[0])}</td>\r\n            </tr>\r\n            <tr>\r\n              <td>{t(\"stats.height\")}</td>\r\n              <td>{Math.round(boundingBox[3]) - Math.round(boundingBox[1])}</td>\r\n            </tr>\r\n\r\n            {selectedElements.length === 1 && (<tr>\r\n                <th colSpan={2}>{t(\"stats.element\")}</th>\r\n              </tr>)}\r\n\r\n            {selectedElements.length > 1 && (<>\r\n                <tr>\r\n                  <th colSpan={2}>{t(\"stats.selected\")}</th>\r\n                </tr>\r\n                <tr>\r\n                  <td>{t(\"stats.elements\")}</td>\r\n                  <td>{selectedElements.length}</td>\r\n                </tr>\r\n              </>)}\r\n            {selectedElements.length > 0 && (<>\r\n                <tr>\r\n                  <td>{\"x\"}</td>\r\n                  <td>{Math.round(selectedBoundingBox[0])}</td>\r\n                </tr>\r\n                <tr>\r\n                  <td>{\"y\"}</td>\r\n                  <td>{Math.round(selectedBoundingBox[1])}</td>\r\n                </tr>\r\n                <tr>\r\n                  <td>{t(\"stats.width\")}</td>\r\n                  <td>\r\n                    {Math.round(selectedBoundingBox[2] - selectedBoundingBox[0])}\r\n                  </td>\r\n                </tr>\r\n                <tr>\r\n                  <td>{t(\"stats.height\")}</td>\r\n                  <td>\r\n                    {Math.round(selectedBoundingBox[3] - selectedBoundingBox[1])}\r\n                  </td>\r\n                </tr>\r\n              </>)}\r\n            {selectedElements.length === 1 && (<tr>\r\n                <td>{t(\"stats.angle\")}</td>\r\n                <td>\r\n                  {`${Math.round((selectedElements[0].angle * 180) / Math.PI)}`}\r\n                </td>\r\n              </tr>)}\r\n            {props.renderCustomStats?.(props.elements, props.appState)}\r\n          </tbody>\r\n        </table>\r\n      </Island>\r\n    </div>);\r\n};\r\n","import { useCallback, useEffect, useRef } from \"react\";\r\nimport { TOAST_TIMEOUT } from \"../constants\";\r\nimport \"./Toast.scss\";\r\nexport const Toast = ({ message, clearToast, }) => {\r\n    const timerRef = useRef(0);\r\n    const scheduleTimeout = useCallback(() => (timerRef.current = window.setTimeout(() => clearToast(), TOAST_TIMEOUT)), [clearToast]);\r\n    useEffect(() => {\r\n        scheduleTimeout();\r\n        return () => clearTimeout(timerRef.current);\r\n    }, [scheduleTimeout, message]);\r\n    return (<div className=\"Toast\" onMouseEnter={() => clearTimeout(timerRef?.current)} onMouseLeave={scheduleTimeout}>\r\n      <p className=\"Toast__message\">{message}</p>\r\n    </div>);\r\n};\r\n","import { CODES, KEYS } from \"../keys\";\r\nimport { register } from \"./register\";\r\nimport { trackEvent } from \"../analytics\";\r\nexport const actionToggleViewMode = register({\r\n    name: \"viewMode\",\r\n    perform(elements, appState) {\r\n        trackEvent(\"view\", \"mode\", \"view\");\r\n        return {\r\n            appState: {\r\n                ...appState,\r\n                viewModeEnabled: !this.checked(appState),\r\n            },\r\n            commitToHistory: false,\r\n        };\r\n    },\r\n    checked: (appState) => appState.viewModeEnabled,\r\n    contextItemLabel: \"labels.viewMode\",\r\n    keyTest: (event) => !event[KEYS.CTRL_OR_CMD] && event.altKey && event.code === CODES.R,\r\n});\r\n","import React, { useContext } from \"react\";\r\nimport rough from \"roughjs/bin/rough\";\r\nimport clsx from \"clsx\";\r\nimport { nanoid } from \"nanoid\";\r\nimport {\r\n  actionAddToLibrary,\r\n  actionBringForward,\r\n  actionBringToFront,\r\n  actionCopy,\r\n  actionCopyAsPng,\r\n  actionCopyAsSvg,\r\n  actionCopyStyles,\r\n  actionCut,\r\n  actionDeleteSelected,\r\n  actionDuplicateSelection,\r\n  actionFinalize,\r\n  actionFlipHorizontal,\r\n  actionFlipVertical,\r\n  actionGroup,\r\n  actionPasteStyles,\r\n  actionSelectAll,\r\n  actionSendBackward,\r\n  actionSendToBack,\r\n  actionToggleGridMode,\r\n  actionToggleStats,\r\n  actionToggleZenMode,\r\n  actionUngroup,\r\n} from \"../actions\";\r\nimport { createRedoAction, createUndoAction } from \"../actions/actionHistory\";\r\nimport { ActionManager } from \"../actions/manager\";\r\nimport { actions } from \"../actions/register\";\r\nimport { trackEvent } from \"../analytics\";\r\nimport { getDefaultAppState } from \"../appState\";\r\nimport {\r\n  copyToClipboard,\r\n  parseClipboard,\r\n  probablySupportsClipboardBlob,\r\n  probablySupportsClipboardWriteText,\r\n} from \"../clipboard\";\r\nimport {\r\n  APP_NAME,\r\n  CURSOR_TYPE,\r\n  DEFAULT_MAX_IMAGE_WIDTH_OR_HEIGHT,\r\n  DEFAULT_UI_OPTIONS,\r\n  DEFAULT_VERTICAL_ALIGN,\r\n  DRAGGING_THRESHOLD,\r\n  ELEMENT_SHIFT_TRANSLATE_AMOUNT,\r\n  ELEMENT_TRANSLATE_AMOUNT,\r\n  ENV,\r\n  EVENT,\r\n  GRID_SIZE,\r\n  IMAGE_RENDER_TIMEOUT,\r\n  LINE_CONFIRM_THRESHOLD,\r\n  MAX_ALLOWED_FILE_BYTES,\r\n  MIME_TYPES,\r\n  MQ_MAX_HEIGHT_LANDSCAPE,\r\n  MQ_MAX_WIDTH_LANDSCAPE,\r\n  MQ_MAX_WIDTH_PORTRAIT,\r\n  POINTER_BUTTON,\r\n  SCROLL_TIMEOUT,\r\n  TAP_TWICE_TIMEOUT,\r\n  TEXT_TO_CENTER_SNAP_THRESHOLD,\r\n  THEME,\r\n  TOUCH_CTX_MENU_TIMEOUT,\r\n  URL_HASH_KEYS,\r\n  URL_QUERY_KEYS,\r\n  ZOOM_STEP,\r\n} from \"../constants\";\r\nimport { loadFromBlob } from \"../data\";\r\nimport { isValidLibrary } from \"../data/json\";\r\nimport Library from \"../data/library\";\r\nimport { restore, restoreElements } from \"../data/restore\";\r\nimport {\r\n  dragNewElement,\r\n  dragSelectedElements,\r\n  duplicateElement,\r\n  getCommonBounds,\r\n  getCursorForResizingElement,\r\n  getDragOffsetXY,\r\n  getElementWithTransformHandleType,\r\n  getNormalizedDimensions,\r\n  getPerfectElementSize,\r\n  getResizeArrowDirection,\r\n  getResizeOffsetXY,\r\n  getTransformHandleTypeFromCoords,\r\n  hitTest,\r\n  isHittingElementBoundingBoxWithoutHittingElement,\r\n  isInvisiblySmallElement,\r\n  isNonDeletedElement,\r\n  isTextElement,\r\n  newElement,\r\n  newLinearElement,\r\n  newTextElement,\r\n  newImageElement,\r\n  textWysiwyg,\r\n  transformElements,\r\n  updateTextElement,\r\n} from \"../element\";\r\nimport {\r\n  bindOrUnbindSelectedElements,\r\n  fixBindingsAfterDeletion,\r\n  fixBindingsAfterDuplication,\r\n  getEligibleElementsForBinding,\r\n  getHoveredElementForBinding,\r\n  isBindingEnabled,\r\n  isLinearElementSimpleAndAlreadyBound,\r\n  maybeBindLinearElement,\r\n  shouldEnableBindingForPointerEvent,\r\n  unbindLinearElements,\r\n  updateBoundElements,\r\n} from \"../element/binding\";\r\nimport { LinearElementEditor } from \"../element/linearElementEditor\";\r\nimport {\r\n  bumpVersion,\r\n  mutateElement,\r\n  newElementWith,\r\n} from \"../element/mutateElement\";\r\nimport { deepCopyElement, newFreeDrawElement } from \"../element/newElement\";\r\nimport {\r\n  isBindingElement,\r\n  isBindingElementType,\r\n  isImageElement,\r\n  isInitializedImageElement,\r\n  isLinearElement,\r\n  isLinearElementType,\r\n} from \"../element/typeChecks\";\r\nimport { getCenter, getDistance } from \"../gesture\";\r\nimport {\r\n  editGroupForSelectedElement,\r\n  getElementsInGroup,\r\n  getSelectedGroupIdForElement,\r\n  getSelectedGroupIds,\r\n  isElementInGroup,\r\n  isSelectedViaGroup,\r\n  selectGroupsForSelectedElements,\r\n} from \"../groups\";\r\nimport History from \"../history\";\r\nimport { defaultLang, getLanguage, languages, setLanguage, t } from \"../i18n\";\r\nimport {\r\n  CODES,\r\n  shouldResizeFromCenter,\r\n  shouldMaintainAspectRatio,\r\n  shouldRotateWithDiscreteAngle,\r\n  isArrowKey,\r\n  KEYS,\r\n} from \"../keys\";\r\nimport { distance2d, getGridPoint, isPathALoop } from \"../math\";\r\nimport { renderScene } from \"../renderer\";\r\nimport { invalidateShapeForElement } from \"../renderer/renderElement\";\r\nimport {\r\n  calculateScrollCenter,\r\n  getElementContainingPosition,\r\n  getElementsAtPosition,\r\n  getElementsWithinSelection,\r\n  getNormalizedZoom,\r\n  getSelectedElements,\r\n  hasBackground,\r\n  isOverScrollBars,\r\n  isSomeElementSelected,\r\n} from \"../scene\";\r\nimport Scene from \"../scene/Scene\";\r\nimport { getNewZoom } from \"../scene/zoom\";\r\nimport { findShapeByKey } from \"../shapes\";\r\nimport {\r\n  debounce,\r\n  distance,\r\n  getNearestScrollableContainer,\r\n  isInputLike,\r\n  isToolIcon,\r\n  isWritableElement,\r\n  resetCursor,\r\n  resolvablePromise,\r\n  sceneCoordsToViewportCoords,\r\n  setCursor,\r\n  setCursorForShape,\r\n  tupleToCoors,\r\n  viewportCoordsToSceneCoords,\r\n  withBatchedUpdates,\r\n} from \"../utils\";\r\nimport ContextMenu from \"./ContextMenu\";\r\nimport LayerUI from \"./LayerUI\";\r\nimport { Stats } from \"./Stats\";\r\nimport { Toast } from \"./Toast\";\r\nimport { actionToggleViewMode } from \"../actions/actionToggleViewMode\";\r\nimport {\r\n  dataURLToFile,\r\n  generateIdFromFile,\r\n  getDataURL,\r\n  isSupportedImageFile,\r\n  resizeImageFile,\r\n  SVGStringToFile,\r\n} from \"../data/blob\";\r\nimport {\r\n  getInitializedImageElements,\r\n  loadHTMLImageElement,\r\n  normalizeSVG,\r\n  updateImageCache as _updateImageCache,\r\n} from \"../element/image\";\r\nimport throttle from \"lodash.throttle\";\r\nimport { fileOpen, nativeFileSystemSupported } from \"../data/filesystem\";\r\nconst IsMobileContext = React.createContext(false);\r\nexport const useIsMobile = () => useContext(IsMobileContext);\r\n\r\nconst ExcalidrawContainerContext = React.createContext({\r\n  container: null,\r\n  id: null,\r\n});\r\n\r\nexport const useExcalidrawContainer = () =>\r\n  useContext(ExcalidrawContainerContext);\r\n\r\nlet didTapTwice = false;\r\nlet tappedTwiceTimer = 0;\r\nlet cursorX = 0;\r\nlet cursorY = 0;\r\nlet isHoldingSpace = false;\r\nlet isPanning = false;\r\nlet isDraggingScrollBar = false;\r\nlet currentScrollBars = { horizontal: null, vertical: null };\r\nlet touchTimeout = 0;\r\nlet invalidateContextMenu = false;\r\nlet lastPointerUp = null;\r\n\r\nconst gesture = {\r\n  pointers: new Map(),\r\n  lastCenter: null,\r\n  initialDistance: null,\r\n  initialScale: null,\r\n};\r\n\r\nclass App extends React.Component {\r\n\r\n  constructor(props) {\r\n\r\n    super(props);\r\n    this.canvas = null;\r\n    this.rc = null;\r\n    this.unmounted = false;\r\n    this.isMobile = false;\r\n    this.trusted = false\r\n    this.excalidrawContainerRef = React.createRef();\r\n    this.files = {};\r\n    this.imageCache = new Map();\r\n    \r\n\r\n    //why do we need to focus the excali container?\r\n    this.focusContainer = () => {\r\n      if (this.props.autoFocus) {\r\n        this.excalidrawContainerRef.current?.focus();\r\n      }\r\n    };\r\n    \r\n    //class scene\r\n    this.getSceneElementsIncludingDeleted = () => {\r\n      return this.scene.getElementsIncludingDeleted();\r\n    };\r\n    \r\n    this.getSceneElements = () => {\r\n      return this.scene.getElements();\r\n    };\r\n\r\n    this.syncActionResult = withBatchedUpdates((actionResult) => {\r\n      if (this.unmounted || actionResult === false) {\r\n        return;\r\n      }\r\n      let editingElement = null;\r\n      if (actionResult.elements) {\r\n        actionResult.elements.forEach((element) => {\r\n          if (\r\n            this.state.editingElement?.id === element.id &&\r\n            this.state.editingElement !== element &&\r\n            isNonDeletedElement(element)\r\n          ) {\r\n            editingElement = element;\r\n          }\r\n        });\r\n        this.scene.replaceAllElements(actionResult.elements);\r\n        if (actionResult.commitToHistory) {\r\n          this.history.resumeRecording();\r\n        }\r\n      }\r\n      if (actionResult.files) {\r\n        this.files = actionResult.replaceFiles\r\n          ? actionResult.files\r\n          : { ...this.files, ...actionResult.files };\r\n        this.addNewImagesToImageCache();\r\n      }\r\n      if (actionResult.appState || editingElement) {\r\n        if (actionResult.commitToHistory) {\r\n          this.history.resumeRecording();\r\n        }\r\n        let viewModeEnabled = actionResult?.appState?.viewModeEnabled || false;\r\n        let zenModeEnabled = actionResult?.appState?.zenModeEnabled || false;\r\n        let gridSize = actionResult?.appState?.gridSize || null;\r\n        let theme = actionResult?.appState?.theme || THEME.LIGHT;\r\n        let name = actionResult?.appState?.name ?? this.state.name;\r\n        if (typeof this.props.viewModeEnabled !== \"undefined\") {\r\n          viewModeEnabled = this.props.viewModeEnabled;\r\n        }\r\n        if (typeof this.props.zenModeEnabled !== \"undefined\") {\r\n          zenModeEnabled = this.props.zenModeEnabled;\r\n        }\r\n        if (typeof this.props.gridModeEnabled !== \"undefined\") {\r\n          gridSize = this.props.gridModeEnabled ? GRID_SIZE : null;\r\n        }\r\n        if (typeof this.props.theme !== \"undefined\") {\r\n          theme = this.props.theme;\r\n        }\r\n        if (typeof this.props.name !== \"undefined\") {\r\n          name = this.props.name;\r\n        }\r\n        this.setState(\r\n          (state) => {\r\n            // using Object.assign instead of spread to fool TS 4.2.2+ into\r\n            // regarding the resulting type as not containing undefined\r\n            // (which the following expression will never contain)\r\n            return Object.assign(actionResult.appState || {}, {\r\n              editingElement:\r\n                editingElement || actionResult.appState?.editingElement || null,\r\n              viewModeEnabled,\r\n              zenModeEnabled,\r\n              gridSize,\r\n              theme,\r\n              name,\r\n            });\r\n          },\r\n          () => {\r\n            if (actionResult.syncHistory) {\r\n              this.history.setCurrentState(\r\n                this.state,\r\n                this.scene.getElementsIncludingDeleted()\r\n              );\r\n            }\r\n          }\r\n        );\r\n      }\r\n    });\r\n\r\n    // Lifecycle\r\n    this.onBlur = withBatchedUpdates(() => {\r\n      isHoldingSpace = false;\r\n      this.setState({ isBindingEnabled: true });\r\n    });\r\n\r\n    this.onUnload = () => {\r\n      this.onBlur();\r\n    };\r\n\r\n    this.disableEvent = (event) => {\r\n      event.preventDefault();\r\n    };\r\n\r\n    this.onFontLoaded = () => {\r\n      this.scene.getElementsIncludingDeleted().forEach((element) => {\r\n        if (isTextElement(element)) {\r\n          invalidateShapeForElement(element);\r\n        }\r\n      });\r\n      this.onSceneUpdated();\r\n    };\r\n\r\n    this.importLibraryFromUrl = async (url, token) => {\r\n      if (window.location.hash.includes(URL_HASH_KEYS.addLibrary)) {\r\n        const hash = new URLSearchParams(window.location.hash.slice(1));\r\n        hash.delete(URL_HASH_KEYS.addLibrary);\r\n        window.history.replaceState({}, APP_NAME, `#${hash.toString()}`);\r\n      } else if (window.location.search.includes(URL_QUERY_KEYS.addLibrary)) {\r\n        const query = new URLSearchParams(window.location.search);\r\n        query.delete(URL_QUERY_KEYS.addLibrary);\r\n        window.history.replaceState({}, APP_NAME, `?${query.toString()}`);\r\n      }\r\n      try {\r\n        const request = await fetch(decodeURIComponent(url));\r\n        const blob = await request.blob();\r\n        const json = JSON.parse(await blob.text());\r\n        if (!isValidLibrary(json)) {\r\n          throw new Error();\r\n        }\r\n        if (\r\n          token === this.id ||\r\n          window.confirm(\r\n            t(\"alerts.confirmAddLibrary\", { numShapes: json.library.length })\r\n          )\r\n        ) {\r\n          await this.library.importLibrary(blob);\r\n          // hack to rerender the library items after import\r\n          if (this.state.isLibraryOpen) {\r\n            this.setState({ isLibraryOpen: false });\r\n          }\r\n          this.setState({ isLibraryOpen: true });\r\n        }\r\n      } catch (error) {\r\n        window.alert(t(\"alerts.errorLoadingLibrary\"));\r\n        console.error(error);\r\n      } finally {\r\n        this.focusContainer();\r\n      }\r\n    };\r\n\r\n    this.resetHistory = () => {\r\n      this.history.clear();\r\n    };\r\n    /**\r\n     * Resets scene & history.\r\n     * ! Do not use to clear scene user action !\r\n     */\r\n    this.resetScene = withBatchedUpdates((opts) => {\r\n      this.scene.replaceAllElements([]);\r\n      this.setState((state) => ({\r\n        ...getDefaultAppState(),\r\n        isLoading: opts?.resetLoadingState ? false : state.isLoading,\r\n        theme: this.state.theme,\r\n      }));\r\n      this.resetHistory();\r\n    });\r\n    this.initializeScene = async () => {\r\n      if (\"launchQueue\" in window && \"LaunchParams\" in window) {\r\n        window.launchQueue.setConsumer(async (launchParams) => {\r\n          if (!launchParams.files.length) {\r\n            return;\r\n          }\r\n          const fileHandle = launchParams.files[0];\r\n          const blob = await fileHandle.getFile();\r\n          blob.handle = fileHandle;\r\n          loadFromBlob(\r\n            blob,\r\n            this.state,\r\n            this.scene.getElementsIncludingDeleted()\r\n          )\r\n            .then((scene) => {\r\n              this.syncActionResult({\r\n                ...scene,\r\n                appState: {\r\n                  ...(scene.appState || this.state),\r\n                  isLoading: false,\r\n                },\r\n                commitToHistory: true,\r\n              });\r\n            })\r\n            .catch((error) => {\r\n              this.setState({ isLoading: false, errorMessage: error.message });\r\n            });\r\n        });\r\n      }\r\n      if (!this.state.isLoading) {\r\n        this.setState({ isLoading: true });\r\n      }\r\n      let initialData = null;\r\n      try {\r\n        initialData = (await this.props.initialData) || null;\r\n        if (initialData?.libraryItems) {\r\n          this.libraryItemsFromStorage = initialData.libraryItems;\r\n        }\r\n      } catch (error) {\r\n        console.error(error);\r\n        initialData = {\r\n          appState: {\r\n            errorMessage:\r\n              error.message ||\r\n              \"Encountered an error during importing or restoring scene data\",\r\n          },\r\n        };\r\n      }\r\n      const scene = restore(initialData, null, null);\r\n      scene.appState = {\r\n        ...scene.appState,\r\n        elementType:\r\n          scene.appState.elementType === \"image\"\r\n            ? \"selection\"\r\n            : scene.appState.elementType,\r\n        isLoading: false,\r\n      };\r\n      if (initialData?.scrollToContent) {\r\n        scene.appState = {\r\n          ...scene.appState,\r\n          ...calculateScrollCenter(\r\n            scene.elements,\r\n            {\r\n              ...scene.appState,\r\n              width: this.state.width,\r\n              height: this.state.height,\r\n              offsetTop: this.state.offsetTop,\r\n              offsetLeft: this.state.offsetLeft,\r\n            },\r\n            null\r\n          ),\r\n        };\r\n      }\r\n      this.resetHistory();\r\n      this.syncActionResult({\r\n        ...scene,\r\n        commitToHistory: true,\r\n      });\r\n      const libraryUrl =\r\n        // current\r\n        new URLSearchParams(window.location.hash.slice(1)).get(\r\n          URL_HASH_KEYS.addLibrary\r\n        ) ||\r\n        // legacy, kept for compat reasons\r\n        new URLSearchParams(window.location.search).get(\r\n          URL_QUERY_KEYS.addLibrary\r\n        );\r\n      if (libraryUrl) {\r\n        await this.importLibraryFromUrl(libraryUrl);\r\n      }\r\n    };\r\n    this.onResize = withBatchedUpdates(() => {\r\n      this.scene\r\n        .getElementsIncludingDeleted()\r\n        .forEach((element) => invalidateShapeForElement(element));\r\n      this.setState({});\r\n    });\r\n    this.onScroll = debounce(() => {\r\n      const { offsetTop, offsetLeft } = this.getCanvasOffsets();\r\n      this.setState((state) => {\r\n        if (state.offsetLeft === offsetLeft && state.offsetTop === offsetTop) {\r\n          return null;\r\n        }\r\n        return { offsetTop, offsetLeft };\r\n      });\r\n    }, SCROLL_TIMEOUT);\r\n    // Copy/paste\r\n    this.onCut = withBatchedUpdates((event) => {\r\n      const isExcalidrawActive = this.excalidrawContainerRef.current?.contains(\r\n        document.activeElement\r\n      );\r\n      if (!isExcalidrawActive || isWritableElement(event.target)) {\r\n        return;\r\n      }\r\n      this.cutAll();\r\n      event.preventDefault();\r\n    });\r\n    this.onCopy = withBatchedUpdates((event) => {\r\n      const isExcalidrawActive = this.excalidrawContainerRef.current?.contains(\r\n        document.activeElement\r\n      );\r\n      if (!isExcalidrawActive || isWritableElement(event.target)) {\r\n        return;\r\n      }\r\n      this.copyAll();\r\n      event.preventDefault();\r\n    });\r\n    this.cutAll = () => {\r\n      this.copyAll();\r\n      this.actionManager.executeAction(actionDeleteSelected);\r\n    };\r\n    this.copyAll = () => {\r\n      copyToClipboard(this.scene.getElements(), this.state, this.files);\r\n    };\r\n    this.onTapStart = (event) => {\r\n      if (!didTapTwice) {\r\n        didTapTwice = true;\r\n        clearTimeout(tappedTwiceTimer);\r\n        tappedTwiceTimer = window.setTimeout(\r\n          App.resetTapTwice,\r\n          TAP_TWICE_TIMEOUT\r\n        );\r\n        return;\r\n      }\r\n      // insert text only if we tapped twice with a single finger\r\n      // event.touches.length === 1 will also prevent inserting text when user's zooming\r\n      if (didTapTwice && event.touches.length === 1) {\r\n        const [touch] = event.touches;\r\n        // @ts-ignore\r\n        this.handleCanvasDoubleClick({\r\n          clientX: touch.clientX,\r\n          clientY: touch.clientY,\r\n        });\r\n        didTapTwice = false;\r\n        clearTimeout(tappedTwiceTimer);\r\n      }\r\n      event.preventDefault();\r\n      if (event.touches.length === 2) {\r\n        this.setState({\r\n          selectedElementIds: {},\r\n        });\r\n      }\r\n    };\r\n    this.onTapEnd = (event) => {\r\n      if (event.touches.length > 0) {\r\n        this.setState({\r\n          previousSelectedElementIds: {},\r\n          selectedElementIds: this.state.previousSelectedElementIds,\r\n        });\r\n      }\r\n    };\r\n    this.pasteFromClipboard = withBatchedUpdates(async (event) => {\r\n      // #686\r\n      const target = document.activeElement;\r\n      const isExcalidrawActive =\r\n        this.excalidrawContainerRef.current?.contains(target);\r\n      if (!isExcalidrawActive) {\r\n        return;\r\n      }\r\n      const elementUnderCursor = document.elementFromPoint(cursorX, cursorY);\r\n      if (\r\n        // if no ClipboardEvent supplied, assume we're pasting via contextMenu\r\n        // thus these checks don't make sense\r\n        event &&\r\n        (!(elementUnderCursor instanceof HTMLCanvasElement) ||\r\n          isWritableElement(target))\r\n      ) {\r\n        return;\r\n      }\r\n      // must be called in the same frame (thus before any awaits) as the paste\r\n      // event else some browsers (FF...) will clear the clipboardData\r\n      // (something something security)\r\n      let file = event?.clipboardData?.files[0];\r\n      const data = await parseClipboard(event);\r\n      if (!file && data.text) {\r\n        const string = data.text.trim();\r\n        if (string.startsWith(\"<svg\") && string.endsWith(\"</svg>\")) {\r\n          // ignore SVG validation/normalization which will be done during image\r\n          // initialization\r\n          file = SVGStringToFile(string);\r\n        }\r\n      }\r\n      if (isSupportedImageFile(file)) {\r\n        const { x: sceneX, y: sceneY } = viewportCoordsToSceneCoords(\r\n          { clientX: cursorX, clientY: cursorY },\r\n          this.state\r\n        );\r\n        const imageElement = this.createImageElement({ sceneX, sceneY });\r\n        this.insertImageElement(imageElement, file);\r\n        this.initializeImageDimensions(imageElement);\r\n        this.setState({ selectedElementIds: { [imageElement.id]: true } });\r\n        return;\r\n      }\r\n      if (this.props.onPaste) {\r\n        try {\r\n          if ((await this.props.onPaste(data, event)) === false) {\r\n            return;\r\n          }\r\n        } catch (error) {\r\n          console.error(error);\r\n        }\r\n      }\r\n      if (data.errorMessage) {\r\n        this.setState({ errorMessage: data.errorMessage });\r\n      } else if (data.spreadsheet) {\r\n        this.setState({\r\n          pasteDialog: {\r\n            data: data.spreadsheet,\r\n            shown: true,\r\n          },\r\n        });\r\n      } else if (data.elements) {\r\n        this.addElementsFromPasteOrLibrary({\r\n          elements: data.elements,\r\n          files: data.files || null,\r\n          position: \"cursor\",\r\n        });\r\n      } else if (data.text) {\r\n        this.addTextFromPaste(data.text);\r\n      }\r\n      this.selectShapeTool(\"selection\");\r\n      event?.preventDefault();\r\n    });\r\n    this.addElementsFromPasteOrLibrary = (opts) => {\r\n      const elements = restoreElements(opts.elements, null);\r\n      const [minX, minY, maxX, maxY] = getCommonBounds(elements);\r\n      const elementsCenterX = distance(minX, maxX) / 2;\r\n      const elementsCenterY = distance(minY, maxY) / 2;\r\n      const clientX =\r\n        typeof opts.position === \"object\"\r\n          ? opts.position.clientX\r\n          : opts.position === \"cursor\"\r\n          ? cursorX\r\n          : this.state.width / 2 + this.state.offsetLeft;\r\n      const clientY =\r\n        typeof opts.position === \"object\"\r\n          ? opts.position.clientY\r\n          : opts.position === \"cursor\"\r\n          ? cursorY\r\n          : this.state.height / 2 + this.state.offsetTop;\r\n      const { x, y } = viewportCoordsToSceneCoords(\r\n        { clientX, clientY },\r\n        this.state\r\n      );\r\n      const dx = x - elementsCenterX;\r\n      const dy = y - elementsCenterY;\r\n      const groupIdMap = new Map();\r\n      const [gridX, gridY] = getGridPoint(dx, dy, this.state.gridSize);\r\n      const oldIdToDuplicatedId = new Map();\r\n      const newElements = elements.map((element) => {\r\n        const newElement = duplicateElement(\r\n          this.state.editingGroupId,\r\n          groupIdMap,\r\n          element,\r\n          {\r\n            x: element.x + gridX - minX,\r\n            y: element.y + gridY - minY,\r\n          }\r\n        );\r\n        oldIdToDuplicatedId.set(element.id, newElement.id);\r\n        return newElement;\r\n      });\r\n      const nextElements = [\r\n        ...this.scene.getElementsIncludingDeleted(),\r\n        ...newElements,\r\n      ];\r\n      fixBindingsAfterDuplication(nextElements, elements, oldIdToDuplicatedId);\r\n      if (opts.files) {\r\n        this.files = { ...this.files, ...opts.files };\r\n      }\r\n      this.scene.replaceAllElements(nextElements);\r\n      this.history.resumeRecording();\r\n      this.setState(\r\n        selectGroupsForSelectedElements(\r\n          {\r\n            ...this.state,\r\n            isLibraryOpen: false,\r\n            selectedElementIds: newElements.reduce((map, element) => {\r\n              map[element.id] = true;\r\n              return map;\r\n            }, {}),\r\n            selectedGroupIds: {},\r\n          },\r\n          this.scene.getElements()\r\n        ),\r\n        () => {\r\n          if (opts.files) {\r\n            this.addNewImagesToImageCache();\r\n          }\r\n        }\r\n      );\r\n      this.selectShapeTool(\"selection\");\r\n    };\r\n    // Collaboration\r\n    this.setAppState = (obj) => {\r\n      this.setState(obj);\r\n    };\r\n    this.removePointer = (event) => {\r\n      // remove touch handler for context menu on touch devices\r\n      if (event.pointerType === \"touch\" && touchTimeout) {\r\n        clearTimeout(touchTimeout);\r\n        touchTimeout = 0;\r\n        invalidateContextMenu = false;\r\n      }\r\n      gesture.pointers.delete(event.pointerId);\r\n    };\r\n    this.toggleLock = () => {\r\n      this.setState((prevState) => {\r\n        return {\r\n          elementLocked: !prevState.elementLocked,\r\n          elementType: prevState.elementLocked\r\n            ? \"selection\"\r\n            : prevState.elementType,\r\n        };\r\n      });\r\n    };\r\n    this.toggleZenMode = () => {\r\n      this.actionManager.executeAction(actionToggleZenMode);\r\n    };\r\n    this.toggleStats = () => {\r\n      if (!this.state.showStats) {\r\n        trackEvent(\"dialog\", \"stats\");\r\n      }\r\n      this.actionManager.executeAction(actionToggleStats);\r\n    };\r\n    this.scrollToContent = (target = this.scene.getElements()) => {\r\n      this.setState({\r\n        ...calculateScrollCenter(\r\n          Array.isArray(target) ? target : [target],\r\n          this.state,\r\n          this.canvas\r\n        ),\r\n      });\r\n    };\r\n    this.clearToast = () => {\r\n      this.setState({ toastMessage: null });\r\n    };\r\n    this.setToastMessage = (toastMessage) => {\r\n      this.setState({ toastMessage });\r\n    };\r\n    this.restoreFileFromShare = async () => {\r\n      try {\r\n        const webShareTargetCache = await caches.open(\"web-share-target\");\r\n        const file = await webShareTargetCache.match(\"shared-file\");\r\n        if (file) {\r\n          const blob = await file.blob();\r\n          this.loadFileToCanvas(blob);\r\n          await webShareTargetCache.delete(\"shared-file\");\r\n          window.history.replaceState(null, APP_NAME, window.location.pathname);\r\n        }\r\n      } catch (error) {\r\n        this.setState({ errorMessage: error.message });\r\n      }\r\n    };\r\n    /** adds supplied files to existing files in the appState */\r\n    this.addFiles = withBatchedUpdates((files) => {\r\n      const filesMap = files.reduce((acc, fileData) => {\r\n        acc.set(fileData.id, fileData);\r\n        return acc;\r\n      }, new Map());\r\n      this.files = { ...this.files, ...Object.fromEntries(filesMap) };\r\n      // bump versions for elements that reference added files so that\r\n      // we/host apps can detect the change, and invalidate the image & shape\r\n      // cache\r\n      this.scene.getElements().forEach((element) => {\r\n        if (\r\n          isInitializedImageElement(element) &&\r\n          filesMap.has(element.fileId)\r\n        ) {\r\n          this.imageCache.delete(element.fileId);\r\n          invalidateShapeForElement(element);\r\n          bumpVersion(element);\r\n        }\r\n      });\r\n      this.scene.informMutation();\r\n      this.addNewImagesToImageCache();\r\n    });\r\n    this.updateScene = withBatchedUpdates((sceneData) => {\r\n      if (sceneData.commitToHistory) {\r\n        this.history.resumeRecording();\r\n      }\r\n      if (sceneData.appState) {\r\n        this.setState(sceneData.appState);\r\n      }\r\n      if (sceneData.elements) {\r\n        this.scene.replaceAllElements(sceneData.elements);\r\n      }\r\n      if (sceneData.collaborators) {\r\n        this.setState({ collaborators: sceneData.collaborators });\r\n      }\r\n    });\r\n    this.onSceneUpdated = () => {\r\n      this.setState({});\r\n    };\r\n    this.updateCurrentCursorPosition = withBatchedUpdates((event) => {\r\n      cursorX = event.clientX;\r\n      cursorY = event.clientY;\r\n    });\r\n    // Input handling\r\n    this.onKeyDown = withBatchedUpdates((event) => {\r\n      // normalize `event.key` when CapsLock is pressed #2372\r\n      if (\r\n        \"Proxy\" in window &&\r\n        ((!event.shiftKey && /^[A-Z]$/.test(event.key)) ||\r\n          (event.shiftKey && /^[a-z]$/.test(event.key)))\r\n      ) {\r\n        event = new Proxy(event, {\r\n          get(ev, prop) {\r\n            const value = ev[prop];\r\n            if (typeof value === \"function\") {\r\n              // fix for Proxies hijacking `this`\r\n              return value.bind(ev);\r\n            }\r\n            return prop === \"key\"\r\n              ? // CapsLock inverts capitalization based on ShiftKey, so invert\r\n                // it back\r\n                event.shiftKey\r\n                ? ev.key.toUpperCase()\r\n                : ev.key.toLowerCase()\r\n              : value;\r\n          },\r\n        });\r\n      }\r\n      if (\r\n        (isWritableElement(event.target) && event.key !== KEYS.ESCAPE) ||\r\n        // case: using arrows to move between buttons\r\n        (isArrowKey(event.key) && isInputLike(event.target))\r\n      ) {\r\n        return;\r\n      }\r\n      if (event.key === KEYS.QUESTION_MARK) {\r\n        this.setState({\r\n          showHelpDialog: true,\r\n        });\r\n      }\r\n      if (this.actionManager.handleKeyDown(event)) {\r\n        return;\r\n      }\r\n      if (this.state.viewModeEnabled) {\r\n        return;\r\n      }\r\n      if (event[KEYS.CTRL_OR_CMD] && this.state.isBindingEnabled) {\r\n        this.setState({ isBindingEnabled: false });\r\n      }\r\n      if (event.code === CODES.ZERO) {\r\n        this.setState({ isLibraryOpen: !this.state.isLibraryOpen });\r\n      }\r\n      if (isArrowKey(event.key)) {\r\n        const step =\r\n          (this.state.gridSize &&\r\n            (event.shiftKey\r\n              ? ELEMENT_TRANSLATE_AMOUNT\r\n              : this.state.gridSize)) ||\r\n          (event.shiftKey\r\n            ? ELEMENT_SHIFT_TRANSLATE_AMOUNT\r\n            : ELEMENT_TRANSLATE_AMOUNT);\r\n        const selectedElements = this.scene\r\n          .getElements()\r\n          .filter((element) => this.state.selectedElementIds[element.id]);\r\n        let offsetX = 0;\r\n        let offsetY = 0;\r\n        if (event.key === KEYS.ARROW_LEFT) {\r\n          offsetX = -step;\r\n        } else if (event.key === KEYS.ARROW_RIGHT) {\r\n          offsetX = step;\r\n        } else if (event.key === KEYS.ARROW_UP) {\r\n          offsetY = -step;\r\n        } else if (event.key === KEYS.ARROW_DOWN) {\r\n          offsetY = step;\r\n        }\r\n        selectedElements.forEach((element) => {\r\n          mutateElement(element, {\r\n            x: element.x + offsetX,\r\n            y: element.y + offsetY,\r\n          });\r\n          updateBoundElements(element, {\r\n            simultaneouslyUpdated: selectedElements,\r\n          });\r\n        });\r\n        this.maybeSuggestBindingForAll(selectedElements);\r\n        event.preventDefault();\r\n      } else if (event.key === KEYS.ENTER) {\r\n        const selectedElements = getSelectedElements(\r\n          this.scene.getElements(),\r\n          this.state\r\n        );\r\n        if (\r\n          selectedElements.length === 1 &&\r\n          isLinearElement(selectedElements[0])\r\n        ) {\r\n          if (\r\n            !this.state.editingLinearElement ||\r\n            this.state.editingLinearElement.elementId !== selectedElements[0].id\r\n          ) {\r\n            this.history.resumeRecording();\r\n            this.setState({\r\n              editingLinearElement: new LinearElementEditor(\r\n                selectedElements[0],\r\n                this.scene\r\n              ),\r\n            });\r\n          }\r\n        } else if (\r\n          selectedElements.length === 1 &&\r\n          !isLinearElement(selectedElements[0])\r\n        ) {\r\n          const selectedElement = selectedElements[0];\r\n          this.startTextEditing({\r\n            sceneX: selectedElement.x + selectedElement.width / 2,\r\n            sceneY: selectedElement.y + selectedElement.height / 2,\r\n          });\r\n          event.preventDefault();\r\n          return;\r\n        }\r\n      } else if (\r\n        !event.ctrlKey &&\r\n        !event.altKey &&\r\n        !event.metaKey &&\r\n        this.state.draggingElement === null\r\n      ) {\r\n        const shape = findShapeByKey(event.key);\r\n        if (shape) {\r\n          this.selectShapeTool(shape);\r\n        } else if (event.key === KEYS.Q) {\r\n          this.toggleLock();\r\n        }\r\n      }\r\n      if (event.key === KEYS.SPACE && gesture.pointers.size === 0) {\r\n        isHoldingSpace = true;\r\n        setCursor(this.canvas, CURSOR_TYPE.GRABBING);\r\n      }\r\n      if (event.key === KEYS.G || event.key === KEYS.S) {\r\n        const selectedElements = getSelectedElements(\r\n          this.scene.getElements(),\r\n          this.state\r\n        );\r\n        if (\r\n          this.state.elementType === \"selection\" &&\r\n          !selectedElements.length\r\n        ) {\r\n          return;\r\n        }\r\n        if (\r\n          event.key === KEYS.G &&\r\n          (hasBackground(this.state.elementType) ||\r\n            selectedElements.some((element) => hasBackground(element.type)))\r\n        ) {\r\n          this.setState({ openPopup: \"backgroundColorPicker\" });\r\n        }\r\n        if (event.key === KEYS.S) {\r\n          this.setState({ openPopup: \"strokeColorPicker\" });\r\n        }\r\n      }\r\n    });\r\n    this.onKeyUp = withBatchedUpdates((event) => {\r\n      if (event.key === KEYS.SPACE) {\r\n        if (this.state.viewModeEnabled) {\r\n          setCursor(this.canvas, CURSOR_TYPE.GRAB);\r\n        } else if (this.state.elementType === \"selection\") {\r\n          resetCursor(this.canvas);\r\n        } else {\r\n          setCursorForShape(this.canvas, this.state.elementType);\r\n          this.setState({\r\n            selectedElementIds: {},\r\n            selectedGroupIds: {},\r\n            editingGroupId: null,\r\n          });\r\n        }\r\n        isHoldingSpace = false;\r\n      }\r\n      if (!event[KEYS.CTRL_OR_CMD] && !this.state.isBindingEnabled) {\r\n        this.setState({ isBindingEnabled: true });\r\n      }\r\n      if (isArrowKey(event.key)) {\r\n        const selectedElements = getSelectedElements(\r\n          this.scene.getElements(),\r\n          this.state\r\n        );\r\n        isBindingEnabled(this.state)\r\n          ? bindOrUnbindSelectedElements(selectedElements)\r\n          : unbindLinearElements(selectedElements);\r\n        this.setState({ suggestedBindings: [] });\r\n      }\r\n    });\r\n    this.onGestureStart = withBatchedUpdates((event) => {\r\n      event.preventDefault();\r\n      this.setState({\r\n        selectedElementIds: {},\r\n      });\r\n      gesture.initialScale = this.state.zoom.value;\r\n    });\r\n    this.onGestureChange = withBatchedUpdates((event) => {\r\n      event.preventDefault();\r\n      // onGestureChange only has zoom factor but not the center.\r\n      // If we're on iPad or iPhone, then we recognize multi-touch and will\r\n      // zoom in at the right location on the touchMove handler already.\r\n      // On Macbook, we don't have those events so will zoom in at the\r\n      // current location instead.\r\n      if (gesture.pointers.size === 2) {\r\n        return;\r\n      }\r\n      const initialScale = gesture.initialScale;\r\n      if (initialScale) {\r\n        this.setState(({ zoom, offsetLeft, offsetTop }) => ({\r\n          zoom: getNewZoom(\r\n            getNormalizedZoom(initialScale * event.scale),\r\n            zoom,\r\n            { left: offsetLeft, top: offsetTop },\r\n            { x: cursorX, y: cursorY }\r\n          ),\r\n        }));\r\n      }\r\n    });\r\n    this.onGestureEnd = withBatchedUpdates((event) => {\r\n      event.preventDefault();\r\n      this.setState({\r\n        previousSelectedElementIds: {},\r\n        selectedElementIds: this.state.previousSelectedElementIds,\r\n      });\r\n      gesture.initialScale = null;\r\n    });\r\n    this.startTextEditing = ({\r\n      sceneX,\r\n      sceneY,\r\n      insertAtParentCenter = true,\r\n    }) => {\r\n      const existingTextElement = this.getTextElementAtPosition(sceneX, sceneY);\r\n      const parentCenterPosition =\r\n        insertAtParentCenter &&\r\n        this.getTextWysiwygSnappedToCenterPosition(\r\n          sceneX,\r\n          sceneY,\r\n          this.state,\r\n          this.canvas,\r\n          window.devicePixelRatio\r\n        );\r\n      const element = existingTextElement\r\n        ? existingTextElement\r\n        : newTextElement({\r\n            x: parentCenterPosition\r\n              ? parentCenterPosition.elementCenterX\r\n              : sceneX,\r\n            y: parentCenterPosition\r\n              ? parentCenterPosition.elementCenterY\r\n              : sceneY,\r\n            strokeColor: this.state.currentItemStrokeColor,\r\n            backgroundColor: this.state.currentItemBackgroundColor,\r\n            fillStyle: this.state.currentItemFillStyle,\r\n            strokeWidth: this.state.currentItemStrokeWidth,\r\n            strokeStyle: this.state.currentItemStrokeStyle,\r\n            roughness: this.state.currentItemRoughness,\r\n            opacity: this.state.currentItemOpacity,\r\n            strokeSharpness: this.state.currentItemStrokeSharpness,\r\n            text: \"\",\r\n            fontSize: this.state.currentItemFontSize,\r\n            fontFamily: this.state.currentItemFontFamily,\r\n            textAlign: parentCenterPosition\r\n              ? \"center\"\r\n              : this.state.currentItemTextAlign,\r\n            verticalAlign: parentCenterPosition\r\n              ? \"middle\"\r\n              : DEFAULT_VERTICAL_ALIGN,\r\n          });\r\n      this.setState({ editingElement: element });\r\n      if (existingTextElement) {\r\n        // if text element is no longer centered to a container, reset\r\n        // verticalAlign to default because it's currently internal-only\r\n        if (!parentCenterPosition || element.textAlign !== \"center\") {\r\n          mutateElement(element, { verticalAlign: DEFAULT_VERTICAL_ALIGN });\r\n        }\r\n      } else {\r\n        this.scene.replaceAllElements([\r\n          ...this.scene.getElementsIncludingDeleted(),\r\n          element,\r\n        ]);\r\n        // case: creating new text not centered to parent elemenent  offset Y\r\n        // so that the text is centered to cursor position\r\n        if (!parentCenterPosition) {\r\n          mutateElement(element, {\r\n            y: element.y - element.baseline / 2,\r\n          });\r\n        }\r\n      }\r\n      this.setState({\r\n        editingElement: element,\r\n      });\r\n      this.handleTextWysiwyg(element, {\r\n        isExistingElement: !!existingTextElement,\r\n      });\r\n    };\r\n    this.handleCanvasDoubleClick = (event) => {\r\n      // case: double-clicking with arrow/line tool selected would both create\r\n      // text and enter multiElement mode\r\n      if (this.state.multiElement) {\r\n        return;\r\n      }\r\n      // we should only be able to double click when mode is selection\r\n      if (this.state.elementType !== \"selection\") {\r\n        return;\r\n      }\r\n      const selectedElements = getSelectedElements(\r\n        this.scene.getElements(),\r\n        this.state\r\n      );\r\n      if (\r\n        selectedElements.length === 1 &&\r\n        isLinearElement(selectedElements[0])\r\n      ) {\r\n        if (\r\n          !this.state.editingLinearElement ||\r\n          this.state.editingLinearElement.elementId !== selectedElements[0].id\r\n        ) {\r\n          this.history.resumeRecording();\r\n          this.setState({\r\n            editingLinearElement: new LinearElementEditor(\r\n              selectedElements[0],\r\n              this.scene\r\n            ),\r\n          });\r\n        }\r\n        return;\r\n      }\r\n      resetCursor(this.canvas);\r\n      const { x: sceneX, y: sceneY } = viewportCoordsToSceneCoords(\r\n        event,\r\n        this.state\r\n      );\r\n      const selectedGroupIds = getSelectedGroupIds(this.state);\r\n      if (selectedGroupIds.length > 0) {\r\n        const hitElement = this.getElementAtPosition(sceneX, sceneY);\r\n        const selectedGroupId =\r\n          hitElement &&\r\n          getSelectedGroupIdForElement(hitElement, this.state.selectedGroupIds);\r\n        if (selectedGroupId) {\r\n          this.setState((prevState) =>\r\n            selectGroupsForSelectedElements(\r\n              {\r\n                ...prevState,\r\n                editingGroupId: selectedGroupId,\r\n                selectedElementIds: { [hitElement.id]: true },\r\n                selectedGroupIds: {},\r\n              },\r\n              this.scene.getElements()\r\n            )\r\n          );\r\n          return;\r\n        }\r\n      }\r\n      resetCursor(this.canvas);\r\n      if (!event[KEYS.CTRL_OR_CMD] && !this.state.viewModeEnabled) {\r\n        this.startTextEditing({\r\n          sceneX,\r\n          sceneY,\r\n          insertAtParentCenter: !event.altKey,\r\n        });\r\n      }\r\n    };\r\n    this.handleCanvasPointerMove = (event) => {\r\n      this.savePointer(event.clientX, event.clientY, this.state.cursorButton);\r\n      if (gesture.pointers.has(event.pointerId)) {\r\n        gesture.pointers.set(event.pointerId, {\r\n          x: event.clientX,\r\n          y: event.clientY,\r\n        });\r\n      }\r\n      const initialScale = gesture.initialScale;\r\n      if (\r\n        gesture.pointers.size === 2 &&\r\n        gesture.lastCenter &&\r\n        initialScale &&\r\n        gesture.initialDistance\r\n      ) {\r\n        const center = getCenter(gesture.pointers);\r\n        const deltaX = center.x - gesture.lastCenter.x;\r\n        const deltaY = center.y - gesture.lastCenter.y;\r\n        gesture.lastCenter = center;\r\n        const distance = getDistance(Array.from(gesture.pointers.values()));\r\n        const scaleFactor = distance / gesture.initialDistance;\r\n        this.setState(({ zoom, scrollX, scrollY, offsetLeft, offsetTop }) => ({\r\n          scrollX: scrollX + deltaX / zoom.value,\r\n          scrollY: scrollY + deltaY / zoom.value,\r\n          zoom: getNewZoom(\r\n            getNormalizedZoom(initialScale * scaleFactor),\r\n            zoom,\r\n            { left: offsetLeft, top: offsetTop },\r\n            center\r\n          ),\r\n          shouldCacheIgnoreZoom: true,\r\n        }));\r\n        this.resetShouldCacheIgnoreZoomDebounced();\r\n      } else {\r\n        gesture.lastCenter =\r\n          gesture.initialDistance =\r\n          gesture.initialScale =\r\n            null;\r\n      }\r\n      if (isHoldingSpace || isPanning || isDraggingScrollBar) {\r\n        return;\r\n      }\r\n      const isPointerOverScrollBars = isOverScrollBars(\r\n        currentScrollBars,\r\n        event.clientX - this.state.offsetLeft,\r\n        event.clientY - this.state.offsetTop\r\n      );\r\n      const isOverScrollBar = isPointerOverScrollBars.isOverEither;\r\n      if (!this.state.draggingElement && !this.state.multiElement) {\r\n        if (isOverScrollBar) {\r\n          resetCursor(this.canvas);\r\n        } else {\r\n          setCursorForShape(this.canvas, this.state.elementType);\r\n        }\r\n      }\r\n      const scenePointer = viewportCoordsToSceneCoords(event, this.state);\r\n      const { x: scenePointerX, y: scenePointerY } = scenePointer;\r\n      if (\r\n        this.state.editingLinearElement &&\r\n        !this.state.editingLinearElement.isDragging\r\n      ) {\r\n        const editingLinearElement = LinearElementEditor.handlePointerMove(\r\n          event,\r\n          scenePointerX,\r\n          scenePointerY,\r\n          this.state.editingLinearElement,\r\n          this.state.gridSize\r\n        );\r\n        if (editingLinearElement !== this.state.editingLinearElement) {\r\n          this.setState({ editingLinearElement });\r\n        }\r\n        if (editingLinearElement.lastUncommittedPoint != null) {\r\n          this.maybeSuggestBindingAtCursor(scenePointer);\r\n        } else {\r\n          this.setState({ suggestedBindings: [] });\r\n        }\r\n      }\r\n      if (isBindingElementType(this.state.elementType)) {\r\n        // Hovering with a selected tool or creating new linear element via click\r\n        // and point\r\n        const { draggingElement } = this.state;\r\n        if (isBindingElement(draggingElement)) {\r\n          this.maybeSuggestBindingForLinearElementAtCursor(\r\n            draggingElement,\r\n            \"end\",\r\n            scenePointer,\r\n            this.state.startBoundElement\r\n          );\r\n        } else {\r\n          this.maybeSuggestBindingAtCursor(scenePointer);\r\n        }\r\n      }\r\n      if (this.state.multiElement) {\r\n        const { multiElement } = this.state;\r\n        const { x: rx, y: ry } = multiElement;\r\n        const { points, lastCommittedPoint } = multiElement;\r\n        const lastPoint = points[points.length - 1];\r\n        setCursorForShape(this.canvas, this.state.elementType);\r\n        if (lastPoint === lastCommittedPoint) {\r\n          // if we haven't yet created a temp point and we're beyond commit-zone\r\n          // threshold, add a point\r\n          if (\r\n            distance2d(\r\n              scenePointerX - rx,\r\n              scenePointerY - ry,\r\n              lastPoint[0],\r\n              lastPoint[1]\r\n            ) >= LINE_CONFIRM_THRESHOLD\r\n          ) {\r\n            mutateElement(multiElement, {\r\n              points: [...points, [scenePointerX - rx, scenePointerY - ry]],\r\n            });\r\n          } else {\r\n            setCursor(this.canvas, CURSOR_TYPE.POINTER);\r\n            // in this branch, we're inside the commit zone, and no uncommitted\r\n            // point exists. Thus do nothing (don't add/remove points).\r\n          }\r\n        } else if (\r\n          points.length > 2 &&\r\n          lastCommittedPoint &&\r\n          distance2d(\r\n            scenePointerX - rx,\r\n            scenePointerY - ry,\r\n            lastCommittedPoint[0],\r\n            lastCommittedPoint[1]\r\n          ) < LINE_CONFIRM_THRESHOLD\r\n        ) {\r\n          setCursor(this.canvas, CURSOR_TYPE.POINTER);\r\n          mutateElement(multiElement, {\r\n            points: points.slice(0, -1),\r\n          });\r\n        } else {\r\n          if (isPathALoop(points, this.state.zoom.value)) {\r\n            setCursor(this.canvas, CURSOR_TYPE.POINTER);\r\n          }\r\n          // update last uncommitted point\r\n          mutateElement(multiElement, {\r\n            points: [\r\n              ...points.slice(0, -1),\r\n              [scenePointerX - rx, scenePointerY - ry],\r\n            ],\r\n          });\r\n        }\r\n        return;\r\n      }\r\n      const hasDeselectedButton = Boolean(event.buttons);\r\n      if (\r\n        hasDeselectedButton ||\r\n        (this.state.elementType !== \"selection\" &&\r\n          this.state.elementType !== \"text\")\r\n      ) {\r\n        return;\r\n      }\r\n      const elements = this.scene.getElements();\r\n      const selectedElements = getSelectedElements(elements, this.state);\r\n      if (\r\n        selectedElements.length === 1 &&\r\n        !isOverScrollBar &&\r\n        !this.state.editingLinearElement\r\n      ) {\r\n        const elementWithTransformHandleType =\r\n          getElementWithTransformHandleType(\r\n            elements,\r\n            this.state,\r\n            scenePointerX,\r\n            scenePointerY,\r\n            this.state.zoom,\r\n            event.pointerType\r\n          );\r\n        if (\r\n          elementWithTransformHandleType &&\r\n          elementWithTransformHandleType.transformHandleType\r\n        ) {\r\n          setCursor(\r\n            this.canvas,\r\n            getCursorForResizingElement(elementWithTransformHandleType)\r\n          );\r\n          return;\r\n        }\r\n      } else if (selectedElements.length > 1 && !isOverScrollBar) {\r\n        const transformHandleType = getTransformHandleTypeFromCoords(\r\n          getCommonBounds(selectedElements),\r\n          scenePointerX,\r\n          scenePointerY,\r\n          this.state.zoom,\r\n          event.pointerType\r\n        );\r\n        if (transformHandleType) {\r\n          setCursor(\r\n            this.canvas,\r\n            getCursorForResizingElement({\r\n              transformHandleType,\r\n            })\r\n          );\r\n          return;\r\n        }\r\n      }\r\n      const hitElement = this.getElementAtPosition(\r\n        scenePointer.x,\r\n        scenePointer.y\r\n      );\r\n      if (this.state.elementType === \"text\") {\r\n        setCursor(\r\n          this.canvas,\r\n          isTextElement(hitElement) ? CURSOR_TYPE.TEXT : CURSOR_TYPE.CROSSHAIR\r\n        );\r\n      } else if (this.state.viewModeEnabled) {\r\n        setCursor(this.canvas, CURSOR_TYPE.GRAB);\r\n      } else if (isOverScrollBar) {\r\n        setCursor(this.canvas, CURSOR_TYPE.AUTO);\r\n      } else if (\r\n        // if using cmd/ctrl, we're not dragging\r\n        !event[KEYS.CTRL_OR_CMD] &&\r\n        (hitElement ||\r\n          this.isHittingCommonBoundingBoxOfSelectedElements(\r\n            scenePointer,\r\n            selectedElements\r\n          ))\r\n      ) {\r\n        setCursor(this.canvas, CURSOR_TYPE.MOVE);\r\n      } else {\r\n        setCursor(this.canvas, CURSOR_TYPE.AUTO);\r\n      }\r\n    };\r\n    // set touch moving for mobile context menu\r\n    this.handleTouchMove = (event) => {\r\n      invalidateContextMenu = true;\r\n    };\r\n    this.handleCanvasPointerDown = (event) => {\r\n      if(event.isTrusted === this.state.trusted){\r\n        console.log(this.state.trusted)\r\n              // remove any active selection when we start to interact with canvas\r\n      // (mainly, we care about removing selection outside the component which\r\n      //  would prevent our copy handling otherwise)\r\n      const selection = document.getSelection();\r\n      if (selection?.anchorNode) {\r\n        selection.removeAllRanges();\r\n      }\r\n      this.maybeOpenContextMenuAfterPointerDownOnTouchDevices(event);\r\n      this.maybeCleanupAfterMissingPointerUp(event);\r\n      if (isPanning) {\r\n        return;\r\n      }\r\n      this.setState({\r\n        lastPointerDownWith: event.pointerType,\r\n        cursorButton: \"down\",\r\n      });\r\n      this.savePointer(event.clientX, event.clientY, \"down\");\r\n      if (this.handleCanvasPanUsingWheelOrSpaceDrag(event)) {\r\n        return;\r\n      }\r\n      // only handle left mouse button or touch\r\n      if (\r\n        event.button !== POINTER_BUTTON.MAIN &&\r\n        event.button !== POINTER_BUTTON.TOUCH\r\n      ) {\r\n        return;\r\n      }\r\n      this.updateGestureOnPointerDown(event);\r\n      // don't select while panning\r\n      if (gesture.pointers.size > 1) {\r\n        return;\r\n      }\r\n      // State for the duration of a pointer interaction, which starts with a\r\n      // pointerDown event, ends with a pointerUp event (or another pointerDown)\r\n      const pointerDownState = this.initialPointerDownState(event);\r\n      if (this.handleDraggingScrollBar(event, pointerDownState)) {\r\n        return;\r\n      }\r\n      this.clearSelectionIfNotUsingSelection();\r\n      this.updateBindingEnabledOnPointerMove(event);\r\n      if (this.handleSelectionOnPointerDown(event, pointerDownState)) {\r\n        return;\r\n      }\r\n      if (this.state.elementType === \"text\") {\r\n        this.handleTextOnPointerDown(event, pointerDownState);\r\n        return;\r\n      } else if (\r\n        this.state.elementType === \"arrow\" ||\r\n        this.state.elementType === \"line\"\r\n      ) {\r\n        this.handleLinearElementOnPointerDown(\r\n          event,\r\n          this.state.elementType,\r\n          pointerDownState\r\n        );\r\n      } else if (this.state.elementType === \"image\") {\r\n        // reset image preview on pointerdown\r\n        setCursor(this.canvas, CURSOR_TYPE.CROSSHAIR);\r\n        if (!this.state.pendingImageElement) {\r\n          return;\r\n        }\r\n        this.setState({\r\n          draggingElement: this.state.pendingImageElement,\r\n          editingElement: this.state.pendingImageElement,\r\n          pendingImageElement: null,\r\n          multiElement: null,\r\n        });\r\n        const { x, y } = viewportCoordsToSceneCoords(event, this.state);\r\n        mutateElement(this.state.pendingImageElement, {\r\n          x,\r\n          y,\r\n        });\r\n      } else if (this.state.elementType === \"freedraw\") {\r\n        this.handleFreeDrawElementOnPointerDown(\r\n          event,\r\n          this.state.elementType,\r\n          pointerDownState\r\n        );\r\n      } else {\r\n        this.createGenericElementOnPointerDown(\r\n          this.state.elementType,\r\n          pointerDownState\r\n        );\r\n      }\r\n      const onPointerMove =\r\n        this.onPointerMoveFromPointerDownHandler(pointerDownState);\r\n      const onPointerUp =\r\n        this.onPointerUpFromPointerDownHandler(pointerDownState);\r\n      const onKeyDown = this.onKeyDownFromPointerDownHandler(pointerDownState);\r\n      const onKeyUp = this.onKeyUpFromPointerDownHandler(pointerDownState);\r\n      lastPointerUp = onPointerUp;\r\n      if (!this.state.viewModeEnabled) {\r\n        window.addEventListener(EVENT.POINTER_MOVE, onPointerMove);\r\n        window.addEventListener(EVENT.POINTER_UP, onPointerUp);\r\n        window.addEventListener(EVENT.KEYDOWN, onKeyDown);\r\n        window.addEventListener(EVENT.KEYUP, onKeyUp);\r\n        pointerDownState.eventListeners.onMove = onPointerMove;\r\n        pointerDownState.eventListeners.onUp = onPointerUp;\r\n        pointerDownState.eventListeners.onKeyUp = onKeyUp;\r\n        pointerDownState.eventListeners.onKeyDown = onKeyDown;\r\n      }\r\n      }\r\n    };\r\n    this.maybeOpenContextMenuAfterPointerDownOnTouchDevices = (event) => {\r\n      // deal with opening context menu on touch devices\r\n      if (event.pointerType === \"touch\") {\r\n        invalidateContextMenu = false;\r\n        if (touchTimeout) {\r\n          // If there's already a touchTimeout, this means that there's another\r\n          // touch down and we are doing another touch, so we shouldn't open the\r\n          // context menu.\r\n          invalidateContextMenu = true;\r\n        } else {\r\n          // open the context menu with the first touch's clientX and clientY\r\n          // if the touch is not moving\r\n          touchTimeout = window.setTimeout(() => {\r\n            touchTimeout = 0;\r\n            if (!invalidateContextMenu) {\r\n              this.handleCanvasContextMenu(event);\r\n            }\r\n          }, TOUCH_CTX_MENU_TIMEOUT);\r\n        }\r\n      }\r\n    };\r\n    // Returns whether the event is a panning\r\n    this.handleCanvasPanUsingWheelOrSpaceDrag = (event) => {\r\n      if (\r\n        !(\r\n          gesture.pointers.size === 0 &&\r\n          (event.button === POINTER_BUTTON.WHEEL ||\r\n            (event.button === POINTER_BUTTON.MAIN && isHoldingSpace) ||\r\n            this.state.viewModeEnabled)\r\n        )\r\n      ) {\r\n        return false;\r\n      }\r\n      isPanning = true;\r\n      let nextPastePrevented = false;\r\n      const isLinux = /Linux/.test(window.navigator.platform);\r\n      setCursor(this.canvas, CURSOR_TYPE.GRABBING);\r\n      let { clientX: lastX, clientY: lastY } = event;\r\n      const onPointerMove = withBatchedUpdates((event) => {\r\n        const deltaX = lastX - event.clientX;\r\n        const deltaY = lastY - event.clientY;\r\n        lastX = event.clientX;\r\n        lastY = event.clientY;\r\n        /*\r\n         * Prevent paste event if we move while middle clicking on Linux.\r\n         * See issue #1383.\r\n         */\r\n        if (\r\n          isLinux &&\r\n          !nextPastePrevented &&\r\n          (Math.abs(deltaX) > 1 || Math.abs(deltaY) > 1)\r\n        ) {\r\n          nextPastePrevented = true;\r\n          /* Prevent the next paste event */\r\n          const preventNextPaste = (event) => {\r\n            document.body.removeEventListener(EVENT.PASTE, preventNextPaste);\r\n            event.stopPropagation();\r\n          };\r\n          /*\r\n           * Reenable next paste in case of disabled middle click paste for\r\n           * any reason:\r\n           * - rigth click paste\r\n           * - empty clipboard\r\n           */\r\n          const enableNextPaste = () => {\r\n            setTimeout(() => {\r\n              document.body.removeEventListener(EVENT.PASTE, preventNextPaste);\r\n              window.removeEventListener(EVENT.POINTER_UP, enableNextPaste);\r\n            }, 100);\r\n          };\r\n          document.body.addEventListener(EVENT.PASTE, preventNextPaste);\r\n          window.addEventListener(EVENT.POINTER_UP, enableNextPaste);\r\n        }\r\n        this.setState({\r\n          scrollX: this.state.scrollX - deltaX / this.state.zoom.value,\r\n          scrollY: this.state.scrollY - deltaY / this.state.zoom.value,\r\n        });\r\n      });\r\n      const teardown = withBatchedUpdates(\r\n        (lastPointerUp = () => {\r\n          lastPointerUp = null;\r\n          isPanning = false;\r\n          if (!isHoldingSpace) {\r\n            if (this.state.viewModeEnabled) {\r\n              setCursor(this.canvas, CURSOR_TYPE.GRAB);\r\n            } else {\r\n              setCursorForShape(this.canvas, this.state.elementType);\r\n            }\r\n          }\r\n          this.setState({\r\n            cursorButton: \"up\",\r\n          });\r\n          this.savePointer(event.clientX, event.clientY, \"up\");\r\n          window.removeEventListener(EVENT.POINTER_MOVE, onPointerMove);\r\n          window.removeEventListener(EVENT.POINTER_UP, teardown);\r\n          window.removeEventListener(EVENT.BLUR, teardown);\r\n        })\r\n      );\r\n      window.addEventListener(EVENT.BLUR, teardown);\r\n      window.addEventListener(EVENT.POINTER_MOVE, onPointerMove, {\r\n        passive: true,\r\n      });\r\n      window.addEventListener(EVENT.POINTER_UP, teardown);\r\n      return true;\r\n    };\r\n    this.clearSelectionIfNotUsingSelection = () => {\r\n      if (this.state.elementType !== \"selection\") {\r\n        this.setState({\r\n          selectedElementIds: {},\r\n          selectedGroupIds: {},\r\n          editingGroupId: null,\r\n        });\r\n      }\r\n    };\r\n    /**\r\n     * @returns whether the pointer event has been completely handled\r\n     */\r\n    this.handleSelectionOnPointerDown = (event, pointerDownState) => {\r\n      if (this.state.elementType === \"selection\") {\r\n        const elements = this.scene.getElements();\r\n        const selectedElements = getSelectedElements(elements, this.state);\r\n        if (selectedElements.length === 1 && !this.state.editingLinearElement) {\r\n          const elementWithTransformHandleType =\r\n            getElementWithTransformHandleType(\r\n              elements,\r\n              this.state,\r\n              pointerDownState.origin.x,\r\n              pointerDownState.origin.y,\r\n              this.state.zoom,\r\n              event.pointerType\r\n            );\r\n          if (elementWithTransformHandleType != null) {\r\n            this.setState({\r\n              resizingElement: elementWithTransformHandleType.element,\r\n            });\r\n            pointerDownState.resize.handleType =\r\n              elementWithTransformHandleType.transformHandleType;\r\n          }\r\n        } else if (selectedElements.length > 1) {\r\n          pointerDownState.resize.handleType = getTransformHandleTypeFromCoords(\r\n            getCommonBounds(selectedElements),\r\n            pointerDownState.origin.x,\r\n            pointerDownState.origin.y,\r\n            this.state.zoom,\r\n            event.pointerType\r\n          );\r\n        }\r\n        if (pointerDownState.resize.handleType) {\r\n          setCursor(\r\n            this.canvas,\r\n            getCursorForResizingElement({\r\n              transformHandleType: pointerDownState.resize.handleType,\r\n            })\r\n          );\r\n          pointerDownState.resize.isResizing = true;\r\n          pointerDownState.resize.offset = tupleToCoors(\r\n            getResizeOffsetXY(\r\n              pointerDownState.resize.handleType,\r\n              selectedElements,\r\n              pointerDownState.origin.x,\r\n              pointerDownState.origin.y\r\n            )\r\n          );\r\n          if (\r\n            selectedElements.length === 1 &&\r\n            isLinearElement(selectedElements[0]) &&\r\n            selectedElements[0].points.length === 2\r\n          ) {\r\n            pointerDownState.resize.arrowDirection = getResizeArrowDirection(\r\n              pointerDownState.resize.handleType,\r\n              selectedElements[0]\r\n            );\r\n          }\r\n        } else {\r\n          if (this.state.editingLinearElement) {\r\n            const ret = LinearElementEditor.handlePointerDown(\r\n              event,\r\n              this.state,\r\n              (appState) => this.setState(appState),\r\n              this.history,\r\n              pointerDownState.origin\r\n            );\r\n            if (ret.hitElement) {\r\n              pointerDownState.hit.element = ret.hitElement;\r\n            }\r\n            if (ret.didAddPoint) {\r\n              return true;\r\n            }\r\n          }\r\n          // hitElement may already be set above, so check first\r\n          pointerDownState.hit.element =\r\n            pointerDownState.hit.element ??\r\n            this.getElementAtPosition(\r\n              pointerDownState.origin.x,\r\n              pointerDownState.origin.y\r\n            );\r\n          // For overlapped elements one position may hit\r\n          // multiple elements\r\n          pointerDownState.hit.allHitElements = this.getElementsAtPosition(\r\n            pointerDownState.origin.x,\r\n            pointerDownState.origin.y\r\n          );\r\n          const hitElement = pointerDownState.hit.element;\r\n          const someHitElementIsSelected =\r\n            pointerDownState.hit.allHitElements.some((element) =>\r\n              this.isASelectedElement(element)\r\n            );\r\n          if (\r\n            (hitElement === null || !someHitElementIsSelected) &&\r\n            !event.shiftKey &&\r\n            !pointerDownState.hit.hasHitCommonBoundingBoxOfSelectedElements\r\n          ) {\r\n            this.clearSelection(hitElement);\r\n          }\r\n          // If we click on something\r\n          if (hitElement != null) {\r\n            // on CMD/CTRL, drill down to hit element regardless of groups etc.\r\n            if (event[KEYS.CTRL_OR_CMD]) {\r\n              if (!this.state.selectedElementIds[hitElement.id]) {\r\n                pointerDownState.hit.wasAddedToSelection = true;\r\n              }\r\n              this.setState((prevState) => ({\r\n                ...editGroupForSelectedElement(prevState, hitElement),\r\n                previousSelectedElementIds: this.state.selectedElementIds,\r\n              }));\r\n              // mark as not completely handled so as to allow dragging etc.\r\n              return false;\r\n            }\r\n            // deselect if item is selected\r\n            // if shift is not clicked, this will always return true\r\n            // otherwise, it will trigger selection based on current\r\n            // state of the box\r\n            if (!this.state.selectedElementIds[hitElement.id]) {\r\n              // if we are currently editing a group, exiting editing mode and deselect the group.\r\n              if (\r\n                this.state.editingGroupId &&\r\n                !isElementInGroup(hitElement, this.state.editingGroupId)\r\n              ) {\r\n                this.setState({\r\n                  selectedElementIds: {},\r\n                  selectedGroupIds: {},\r\n                  editingGroupId: null,\r\n                });\r\n              }\r\n              // Add hit element to selection. At this point if we're not holding\r\n              // SHIFT the previously selected element(s) were deselected above\r\n              // (make sure you use setState updater to use latest state)\r\n              if (\r\n                !someHitElementIsSelected &&\r\n                !pointerDownState.hit.hasHitCommonBoundingBoxOfSelectedElements\r\n              ) {\r\n                this.setState((prevState) => {\r\n                  return selectGroupsForSelectedElements(\r\n                    {\r\n                      ...prevState,\r\n                      selectedElementIds: {\r\n                        ...prevState.selectedElementIds,\r\n                        [hitElement.id]: true,\r\n                      },\r\n                    },\r\n                    this.scene.getElements()\r\n                  );\r\n                });\r\n                pointerDownState.hit.wasAddedToSelection = true;\r\n              }\r\n            }\r\n          }\r\n          this.setState({\r\n            previousSelectedElementIds: this.state.selectedElementIds,\r\n          });\r\n        }\r\n      }\r\n      return false;\r\n    };\r\n\r\n    this.handleTextOnPointerDown = (event, pointerDownState) => {\r\n      // if we're currently still editing text, clicking outside\r\n      // should only finalize it, not create another (irrespective\r\n      // of state.elementLocked)\r\n      if (this.state.editingElement?.type === \"text\") {\r\n        return;\r\n      }\r\n      this.startTextEditing({\r\n        sceneX: pointerDownState.origin.x,\r\n        sceneY: pointerDownState.origin.y,\r\n        insertAtParentCenter: !event.altKey,\r\n      });\r\n      resetCursor(this.canvas);\r\n      if (!this.state.elementLocked) {\r\n        this.setState({\r\n          elementType: \"selection\",\r\n        });\r\n      }\r\n    };\r\n\r\n    this.handleFreeDrawElementOnPointerDown = (\r\n      event,\r\n      elementType,\r\n      pointerDownState\r\n    ) => {\r\n      // Begin a mark capture. This does not have to update state yet.\r\n      const [gridX, gridY] = getGridPoint(\r\n        pointerDownState.origin.x,\r\n        pointerDownState.origin.y,\r\n        null\r\n      );\r\n      const element = newFreeDrawElement({\r\n        type: elementType,\r\n        x: gridX,\r\n        y: gridY,\r\n        strokeColor: this.state.currentItemStrokeColor,\r\n        backgroundColor: this.state.currentItemBackgroundColor,\r\n        fillStyle: this.state.currentItemFillStyle,\r\n        strokeWidth: this.state.currentItemStrokeWidth,\r\n        strokeStyle: this.state.currentItemStrokeStyle,\r\n        roughness: this.state.currentItemRoughness,\r\n        opacity: this.state.currentItemOpacity,\r\n        strokeSharpness: this.state.currentItemLinearStrokeSharpness,\r\n        simulatePressure: event.pressure === 0.5,\r\n      });\r\n      this.setState((prevState) => ({\r\n        selectedElementIds: {\r\n          ...prevState.selectedElementIds,\r\n          [element.id]: false,\r\n        },\r\n      }));\r\n      const pressures = element.simulatePressure\r\n        ? element.pressures\r\n        : [...element.pressures, event.pressure];\r\n      mutateElement(element, {\r\n        points: [[0, 0]],\r\n        pressures,\r\n      });\r\n      const boundElement = getHoveredElementForBinding(\r\n        pointerDownState.origin,\r\n        this.scene\r\n      );\r\n      this.scene.replaceAllElements([\r\n        ...this.scene.getElementsIncludingDeleted(),\r\n        element,\r\n      ]);\r\n      this.setState({\r\n        draggingElement: element,\r\n        editingElement: element,\r\n        startBoundElement: boundElement,\r\n        suggestedBindings: [],\r\n      });\r\n    };\r\n\r\n    this.createImageElement = ({ sceneX, sceneY }) => {\r\n      const [gridX, gridY] = getGridPoint(sceneX, sceneY, this.state.gridSize);\r\n      const element = newImageElement({\r\n        type: \"image\",\r\n        x: gridX,\r\n        y: gridY,\r\n        strokeColor: this.state.currentItemStrokeColor,\r\n        backgroundColor: this.state.currentItemBackgroundColor,\r\n        fillStyle: this.state.currentItemFillStyle,\r\n        strokeWidth: this.state.currentItemStrokeWidth,\r\n        strokeStyle: this.state.currentItemStrokeStyle,\r\n        roughness: this.state.currentItemRoughness,\r\n        opacity: this.state.currentItemOpacity,\r\n        strokeSharpness: this.state.currentItemLinearStrokeSharpness,\r\n      });\r\n      return element;\r\n    };\r\n\r\n    this.handleLinearElementOnPointerDown = (\r\n      event,\r\n      elementType,\r\n      pointerDownState\r\n    ) => {\r\n      if (this.state.multiElement) {\r\n        const { multiElement } = this.state;\r\n        // finalize if completing a loop\r\n        if (\r\n          multiElement.type === \"line\" &&\r\n          isPathALoop(multiElement.points, this.state.zoom.value)\r\n        ) {\r\n          mutateElement(multiElement, {\r\n            lastCommittedPoint:\r\n              multiElement.points[multiElement.points.length - 1],\r\n          });\r\n          this.actionManager.executeAction(actionFinalize);\r\n          return;\r\n        }\r\n        const { x: rx, y: ry, lastCommittedPoint } = multiElement;\r\n        // clicking inside commit zone  finalize arrow\r\n        if (\r\n          multiElement.points.length > 1 &&\r\n          lastCommittedPoint &&\r\n          distance2d(\r\n            pointerDownState.origin.x - rx,\r\n            pointerDownState.origin.y - ry,\r\n            lastCommittedPoint[0],\r\n            lastCommittedPoint[1]\r\n          ) < LINE_CONFIRM_THRESHOLD\r\n        ) {\r\n          this.actionManager.executeAction(actionFinalize);\r\n          return;\r\n        }\r\n        this.setState((prevState) => ({\r\n          selectedElementIds: {\r\n            ...prevState.selectedElementIds,\r\n            [multiElement.id]: true,\r\n          },\r\n        }));\r\n        // clicking outside commit zone  update reference for last committed\r\n        // point\r\n        mutateElement(multiElement, {\r\n          lastCommittedPoint:\r\n            multiElement.points[multiElement.points.length - 1],\r\n        });\r\n        setCursor(this.canvas, CURSOR_TYPE.POINTER);\r\n      } else {\r\n        const [gridX, gridY] = getGridPoint(\r\n          pointerDownState.origin.x,\r\n          pointerDownState.origin.y,\r\n          this.state.gridSize\r\n        );\r\n        /* If arrow is pre-arrowheads, it will have undefined for both start and end arrowheads.\r\n                If so, we want it to be null for start and \"arrow\" for end. If the linear item is not\r\n                an arrow, we want it to be null for both. Otherwise, we want it to use the\r\n                values from appState. */\r\n        const { currentItemStartArrowhead, currentItemEndArrowhead } =\r\n          this.state;\r\n        const [startArrowhead, endArrowhead] =\r\n          elementType === \"arrow\"\r\n            ? [currentItemStartArrowhead, currentItemEndArrowhead]\r\n            : [null, null];\r\n        const element = newLinearElement({\r\n          type: elementType,\r\n          x: gridX,\r\n          y: gridY,\r\n          strokeColor: this.state.currentItemStrokeColor,\r\n          backgroundColor: this.state.currentItemBackgroundColor,\r\n          fillStyle: this.state.currentItemFillStyle,\r\n          strokeWidth: this.state.currentItemStrokeWidth,\r\n          strokeStyle: this.state.currentItemStrokeStyle,\r\n          roughness: this.state.currentItemRoughness,\r\n          opacity: this.state.currentItemOpacity,\r\n          strokeSharpness: this.state.currentItemLinearStrokeSharpness,\r\n          startArrowhead,\r\n          endArrowhead,\r\n        });\r\n        this.setState((prevState) => ({\r\n          selectedElementIds: {\r\n            ...prevState.selectedElementIds,\r\n            [element.id]: false,\r\n          },\r\n        }));\r\n        mutateElement(element, {\r\n          points: [...element.points, [0, 0]],\r\n        });\r\n        const boundElement = getHoveredElementForBinding(\r\n          pointerDownState.origin,\r\n          this.scene\r\n        );\r\n        this.scene.replaceAllElements([\r\n          ...this.scene.getElementsIncludingDeleted(),\r\n          element,\r\n        ]);\r\n        this.setState({\r\n          draggingElement: element,\r\n          editingElement: element,\r\n          startBoundElement: boundElement,\r\n          suggestedBindings: [],\r\n        });\r\n      }\r\n    };\r\n\r\n    this.createGenericElementOnPointerDown = (\r\n      elementType,\r\n      pointerDownState\r\n    ) => {\r\n      const [gridX, gridY] = getGridPoint(\r\n        pointerDownState.origin.x,\r\n        pointerDownState.origin.y,\r\n        this.state.gridSize\r\n      );\r\n      const element = newElement({\r\n        type: elementType,\r\n        x: gridX,\r\n        y: gridY,\r\n        strokeColor: this.state.currentItemStrokeColor,\r\n        backgroundColor: this.state.currentItemBackgroundColor,\r\n        fillStyle: this.state.currentItemFillStyle,\r\n        strokeWidth: this.state.currentItemStrokeWidth,\r\n        strokeStyle: this.state.currentItemStrokeStyle,\r\n        roughness: this.state.currentItemRoughness,\r\n        opacity: this.state.currentItemOpacity,\r\n        strokeSharpness: this.state.currentItemStrokeSharpness,\r\n      });\r\n      if (element.type === \"selection\") {\r\n        this.setState({\r\n          selectionElement: element,\r\n          draggingElement: element,\r\n        });\r\n      } else {\r\n        this.scene.replaceAllElements([\r\n          ...this.scene.getElementsIncludingDeleted(),\r\n          element,\r\n        ]);\r\n        this.setState({\r\n          multiElement: null,\r\n          draggingElement: element,\r\n          editingElement: element,\r\n        });\r\n      }\r\n    };\r\n\r\n    this.initializeImage = async ({\r\n      imageFile,\r\n      imageElement: _imageElement,\r\n      showCursorImagePreview = false,\r\n    }) => {\r\n      // at this point this should be guaranteed image file, but we do this check\r\n      // to satisfy TS down the line\r\n      if (!isSupportedImageFile(imageFile)) {\r\n        throw new Error(t(\"errors.unsupportedFileType\"));\r\n      }\r\n      const mimeType = imageFile.type;\r\n      setCursor(this.canvas, \"wait\");\r\n      if (mimeType === MIME_TYPES.svg) {\r\n        try {\r\n          imageFile = SVGStringToFile(\r\n            await normalizeSVG(await imageFile.text()),\r\n            imageFile.name\r\n          );\r\n        } catch (error) {\r\n          console.warn(error);\r\n          throw new Error(t(\"errors.svgImageInsertError\"));\r\n        }\r\n      }\r\n      // generate image id (by default the file digest) before any\r\n      // resizing/compression takes place to keep it more portable\r\n      const fileId = await (this.props.generateIdForFile?.(imageFile) ||\r\n        generateIdFromFile(imageFile));\r\n      if (!fileId) {\r\n        console.warn(\r\n          \"Couldn't generate file id or the supplied `generateIdForFile` didn't resolve to one.\"\r\n        );\r\n        throw new Error(t(\"errors.imageInsertError\"));\r\n      }\r\n      const existingFileData = this.files[fileId];\r\n      if (!existingFileData?.dataURL) {\r\n        try {\r\n          imageFile = await resizeImageFile(\r\n            imageFile,\r\n            DEFAULT_MAX_IMAGE_WIDTH_OR_HEIGHT\r\n          );\r\n        } catch (error) {\r\n          console.error(\r\n            \"error trying to resing image file on insertion\",\r\n            error\r\n          );\r\n        }\r\n        if (imageFile.size > MAX_ALLOWED_FILE_BYTES) {\r\n          throw new Error(\r\n            t(\"errors.fileTooBig\", {\r\n              maxSize: `${Math.trunc(MAX_ALLOWED_FILE_BYTES / 1024 / 1024)}MB`,\r\n            })\r\n          );\r\n        }\r\n      }\r\n      if (showCursorImagePreview) {\r\n        const dataURL = this.files[fileId]?.dataURL;\r\n        // optimization so that we don't unnecessarily resize the original\r\n        // full-size file for cursor preview\r\n        // (it's much faster to convert the resized dataURL to File)\r\n        const resizedFile = dataURL && dataURLToFile(dataURL);\r\n        this.setImagePreviewCursor(resizedFile || imageFile);\r\n      }\r\n      const dataURL =\r\n        this.files[fileId]?.dataURL || (await getDataURL(imageFile));\r\n      const imageElement = mutateElement(\r\n        _imageElement,\r\n        {\r\n          fileId,\r\n        },\r\n        false\r\n      );\r\n      return new Promise(async (resolve, reject) => {\r\n        try {\r\n          this.files = {\r\n            ...this.files,\r\n            [fileId]: {\r\n              mimeType,\r\n              id: fileId,\r\n              dataURL,\r\n              created: Date.now(),\r\n            },\r\n          };\r\n          const cachedImageData = this.imageCache.get(fileId);\r\n          if (!cachedImageData) {\r\n            this.addNewImagesToImageCache();\r\n            await this.updateImageCache([imageElement]);\r\n          }\r\n          if (cachedImageData?.image instanceof Promise) {\r\n            await cachedImageData.image;\r\n          }\r\n          if (\r\n            this.state.pendingImageElement?.id !== imageElement.id &&\r\n            this.state.draggingElement?.id !== imageElement.id\r\n          ) {\r\n            this.initializeImageDimensions(imageElement, true);\r\n          }\r\n          resolve(imageElement);\r\n        } catch (error) {\r\n          console.error(error);\r\n          reject(new Error(t(\"errors.imageInsertError\")));\r\n        } finally {\r\n          if (!showCursorImagePreview) {\r\n            resetCursor(this.canvas);\r\n          }\r\n        }\r\n      });\r\n    };\r\n    /**\r\n     * inserts image into elements array and rerenders\r\n     */\r\n    this.insertImageElement = async (\r\n      imageElement,\r\n      imageFile,\r\n      showCursorImagePreview\r\n    ) => {\r\n      this.scene.replaceAllElements([\r\n        ...this.scene.getElementsIncludingDeleted(),\r\n        imageElement,\r\n      ]);\r\n      try {\r\n        await this.initializeImage({\r\n          imageFile,\r\n          imageElement,\r\n          showCursorImagePreview,\r\n        });\r\n      } catch (error) {\r\n        mutateElement(imageElement, {\r\n          isDeleted: true,\r\n        });\r\n        this.actionManager.executeAction(actionFinalize);\r\n        this.setState({\r\n          errorMessage: error.message || t(\"errors.imageInsertError\"),\r\n        });\r\n      }\r\n    };\r\n    this.setImagePreviewCursor = async (imageFile) => {\r\n      // mustn't be larger than 128 px\r\n      // https://developer.mozilla.org/en-US/docs/Web/CSS/CSS_Basic_User_Interface/Using_URL_values_for_the_cursor_property\r\n      const cursorImageSizePx = 96;\r\n      const imagePreview = await resizeImageFile(imageFile, cursorImageSizePx);\r\n      let previewDataURL = await getDataURL(imagePreview);\r\n      // SVG cannot be resized via `resizeImageFile` so we resize by rendering to\r\n      // a small canvas\r\n      if (imageFile.type === MIME_TYPES.svg) {\r\n        const img = await loadHTMLImageElement(previewDataURL);\r\n        let height = Math.min(img.height, cursorImageSizePx);\r\n        let width = height * (img.width / img.height);\r\n        if (width > cursorImageSizePx) {\r\n          width = cursorImageSizePx;\r\n          height = width * (img.height / img.width);\r\n        }\r\n        const canvas = document.createElement(\"canvas\");\r\n        canvas.height = height;\r\n        canvas.width = width;\r\n        const context = canvas.getContext(\"2d\");\r\n        context.drawImage(img, 0, 0, width, height);\r\n        previewDataURL = canvas.toDataURL(MIME_TYPES.svg);\r\n      }\r\n      if (this.state.pendingImageElement) {\r\n        setCursor(this.canvas, `url(${previewDataURL}) 4 4, auto`);\r\n      }\r\n    };\r\n    this.onImageAction = async (\r\n      { insertOnCanvasDirectly } = { insertOnCanvasDirectly: false }\r\n    ) => {\r\n      try {\r\n        const clientX = this.state.width / 2 + this.state.offsetLeft;\r\n        const clientY = this.state.height / 2 + this.state.offsetTop;\r\n        const { x, y } = viewportCoordsToSceneCoords(\r\n          { clientX, clientY },\r\n          this.state\r\n        );\r\n        const imageFile = await fileOpen({\r\n          description: \"Image\",\r\n          extensions: [\"jpg\", \"png\", \"svg\", \"gif\"],\r\n        });\r\n        const imageElement = this.createImageElement({\r\n          sceneX: x,\r\n          sceneY: y,\r\n        });\r\n        if (insertOnCanvasDirectly) {\r\n          this.insertImageElement(imageElement, imageFile);\r\n          this.initializeImageDimensions(imageElement);\r\n          this.setState(\r\n            {\r\n              selectedElementIds: { [imageElement.id]: true },\r\n            },\r\n            () => {\r\n              this.actionManager.executeAction(actionFinalize);\r\n            }\r\n          );\r\n        } else {\r\n          this.setState(\r\n            {\r\n              pendingImageElement: imageElement,\r\n            },\r\n            () => {\r\n              this.insertImageElement(\r\n                imageElement,\r\n                imageFile,\r\n                /* showCursorImagePreview */ true\r\n              );\r\n            }\r\n          );\r\n        }\r\n      } catch (error) {\r\n        if (error.name !== \"AbortError\") {\r\n          console.error(error);\r\n        }\r\n        this.setState(\r\n          {\r\n            pendingImageElement: null,\r\n            editingElement: null,\r\n            elementType: \"selection\",\r\n          },\r\n          () => {\r\n            this.actionManager.executeAction(actionFinalize);\r\n          }\r\n        );\r\n      }\r\n    };\r\n    this.initializeImageDimensions = (\r\n      imageElement,\r\n      forceNaturalSize = false\r\n    ) => {\r\n      const image =\r\n        isInitializedImageElement(imageElement) &&\r\n        this.imageCache.get(imageElement.fileId)?.image;\r\n      if (!image || image instanceof Promise) {\r\n        if (\r\n          imageElement.width < DRAGGING_THRESHOLD / this.state.zoom.value &&\r\n          imageElement.height < DRAGGING_THRESHOLD / this.state.zoom.value\r\n        ) {\r\n          const placeholderSize = 100 / this.state.zoom.value;\r\n          mutateElement(imageElement, {\r\n            x: imageElement.x - placeholderSize / 2,\r\n            y: imageElement.y - placeholderSize / 2,\r\n            width: placeholderSize,\r\n            height: placeholderSize,\r\n          });\r\n        }\r\n        return;\r\n      }\r\n      if (\r\n        forceNaturalSize ||\r\n        // if user-created bounding box is below threshold, assume the\r\n        // intention was to click instead of drag, and use the image's\r\n        // intrinsic size\r\n        (imageElement.width < DRAGGING_THRESHOLD / this.state.zoom.value &&\r\n          imageElement.height < DRAGGING_THRESHOLD / this.state.zoom.value)\r\n      ) {\r\n        const minHeight = Math.max(this.state.height - 120, 160);\r\n        // max 65% of canvas height, clamped to <300px, vh - 120px>\r\n        const maxHeight = Math.min(\r\n          minHeight,\r\n          Math.floor(this.state.height * 0.5) / this.state.zoom.value\r\n        );\r\n        const height = Math.min(image.naturalHeight, maxHeight);\r\n        const width = height * (image.naturalWidth / image.naturalHeight);\r\n        // add current imageElement width/height to account for previous centering\r\n        // of the placholder image\r\n        const x = imageElement.x + imageElement.width / 2 - width / 2;\r\n        const y = imageElement.y + imageElement.height / 2 - height / 2;\r\n        mutateElement(imageElement, { x, y, width, height });\r\n      }\r\n    };\r\n    /** updates image cache, refreshing updated elements and/or setting status\r\n            to error for images that fail during <img> element creation */\r\n    this.updateImageCache = async (elements, files = this.files) => {\r\n      const { updatedFiles, erroredFiles } = await _updateImageCache({\r\n        imageCache: this.imageCache,\r\n        fileIds: elements.map((element) => element.fileId),\r\n        files,\r\n      });\r\n      if (updatedFiles.size || erroredFiles.size) {\r\n        for (const element of elements) {\r\n          if (updatedFiles.has(element.fileId)) {\r\n            invalidateShapeForElement(element);\r\n          }\r\n        }\r\n      }\r\n      if (erroredFiles.size) {\r\n        this.scene.replaceAllElements(\r\n          this.scene.getElementsIncludingDeleted().map((element) => {\r\n            if (\r\n              isInitializedImageElement(element) &&\r\n              erroredFiles.has(element.fileId)\r\n            ) {\r\n              return newElementWith(element, {\r\n                status: \"error\",\r\n              });\r\n            }\r\n            return element;\r\n          })\r\n        );\r\n      }\r\n      return { updatedFiles, erroredFiles };\r\n    };\r\n    /** adds new images to imageCache and re-renders if needed */\r\n    this.addNewImagesToImageCache = async (\r\n      imageElements = getInitializedImageElements(this.scene.getElements()),\r\n      files = this.files\r\n    ) => {\r\n      const uncachedImageElements = imageElements.filter(\r\n        (element) => !element.isDeleted && !this.imageCache.has(element.fileId)\r\n      );\r\n      if (uncachedImageElements.length) {\r\n        const { updatedFiles } = await this.updateImageCache(\r\n          uncachedImageElements,\r\n          files\r\n        );\r\n        if (updatedFiles.size) {\r\n          this.scene.informMutation();\r\n        }\r\n      }\r\n    };\r\n    /** generally you should use `addNewImagesToImageCache()` directly if you need\r\n     *  to render new images. This is just a failsafe  */\r\n    this.scheduleImageRefresh = throttle(() => {\r\n      this.addNewImagesToImageCache();\r\n    }, IMAGE_RENDER_TIMEOUT);\r\n    this.updateBindingEnabledOnPointerMove = (event) => {\r\n      const shouldEnableBinding = shouldEnableBindingForPointerEvent(event);\r\n      if (this.state.isBindingEnabled !== shouldEnableBinding) {\r\n        this.setState({ isBindingEnabled: shouldEnableBinding });\r\n      }\r\n    };\r\n    this.maybeSuggestBindingAtCursor = (pointerCoords) => {\r\n      const hoveredBindableElement = getHoveredElementForBinding(\r\n        pointerCoords,\r\n        this.scene\r\n      );\r\n      this.setState({\r\n        suggestedBindings:\r\n          hoveredBindableElement != null ? [hoveredBindableElement] : [],\r\n      });\r\n    };\r\n    this.maybeSuggestBindingForLinearElementAtCursor = (\r\n      linearElement,\r\n      startOrEnd,\r\n      pointerCoords,\r\n      // During line creation the start binding hasn't been written yet\r\n      // into `linearElement`\r\n      oppositeBindingBoundElement\r\n    ) => {\r\n      const hoveredBindableElement = getHoveredElementForBinding(\r\n        pointerCoords,\r\n        this.scene\r\n      );\r\n      this.setState({\r\n        suggestedBindings:\r\n          hoveredBindableElement != null &&\r\n          !isLinearElementSimpleAndAlreadyBound(\r\n            linearElement,\r\n            oppositeBindingBoundElement?.id,\r\n            hoveredBindableElement\r\n          )\r\n            ? [hoveredBindableElement]\r\n            : [],\r\n      });\r\n    };\r\n    this.handleCanvasRef = (canvas) => {\r\n      // canvas is null when unmounting\r\n      if (canvas !== null) {\r\n        this.canvas = canvas;\r\n        this.rc = rough.canvas(this.canvas);\r\n        this.canvas.addEventListener(EVENT.WHEEL, this.handleWheel, {\r\n          passive: false,\r\n        });\r\n        this.canvas.addEventListener(EVENT.TOUCH_START, this.onTapStart);\r\n        this.canvas.addEventListener(EVENT.TOUCH_END, this.onTapEnd);\r\n      } else {\r\n        this.canvas?.removeEventListener(EVENT.WHEEL, this.handleWheel);\r\n        this.canvas?.removeEventListener(EVENT.TOUCH_START, this.onTapStart);\r\n        this.canvas?.removeEventListener(EVENT.TOUCH_END, this.onTapEnd);\r\n      }\r\n    };\r\n    this.handleAppOnDrop = async (event) => {\r\n      try {\r\n        const file = event.dataTransfer.files[0];\r\n        if (isSupportedImageFile(file)) {\r\n          // first attempt to decode scene from the image if it's embedded\r\n          // ---------------------------------------------------------------------\r\n          if (file?.type === MIME_TYPES.png || file?.type === MIME_TYPES.svg) {\r\n            try {\r\n              if (nativeFileSystemSupported) {\r\n                try {\r\n                  // This will only work as of Chrome 86,\r\n                  // but can be safely ignored on older releases.\r\n                  const item = event.dataTransfer.items[0];\r\n                  file.handle = await item.getAsFileSystemHandle();\r\n                } catch (error) {\r\n                  console.warn(error.name, error.message);\r\n                }\r\n              }\r\n              const scene = await loadFromBlob(\r\n                file,\r\n                this.state,\r\n                this.scene.getElementsIncludingDeleted()\r\n              );\r\n              this.syncActionResult({\r\n                ...scene,\r\n                appState: {\r\n                  ...(scene.appState || this.state),\r\n                  isLoading: false,\r\n                },\r\n                replaceFiles: true,\r\n                commitToHistory: true,\r\n              });\r\n              return;\r\n            } catch (error) {\r\n              if (error.name !== \"EncodingError\") {\r\n                throw error;\r\n              }\r\n            }\r\n          }\r\n          // if no scene is embedded or we fail for whatever reason, fall back\r\n          // to importing as regular image\r\n          // ---------------------------------------------------------------------\r\n          const { x: sceneX, y: sceneY } = viewportCoordsToSceneCoords(\r\n            event,\r\n            this.state\r\n          );\r\n          const imageElement = this.createImageElement({ sceneX, sceneY });\r\n          this.insertImageElement(imageElement, file);\r\n          this.initializeImageDimensions(imageElement);\r\n          this.setState({ selectedElementIds: { [imageElement.id]: true } });\r\n          return;\r\n        }\r\n      } catch (error) {\r\n        return this.setState({\r\n          isLoading: false,\r\n          errorMessage: error.message,\r\n        });\r\n      }\r\n      const libraryShapes = event.dataTransfer.getData(\r\n        MIME_TYPES.excalidrawlib\r\n      );\r\n      if (libraryShapes !== \"\") {\r\n        this.addElementsFromPasteOrLibrary({\r\n          elements: JSON.parse(libraryShapes),\r\n          position: event,\r\n          files: null,\r\n        });\r\n        return;\r\n      }\r\n      const file = event.dataTransfer?.files[0];\r\n      if (\r\n        file?.type === MIME_TYPES.excalidrawlib ||\r\n        file?.name?.endsWith(\".excalidrawlib\")\r\n      ) {\r\n        this.library\r\n          .importLibrary(file)\r\n          .then(() => {\r\n            // Close and then open to get the libraries updated\r\n            this.setState({ isLibraryOpen: false });\r\n            this.setState({ isLibraryOpen: true });\r\n          })\r\n          .catch((error) =>\r\n            this.setState({ isLoading: false, errorMessage: error.message })\r\n          );\r\n        // default: assume an Excalidraw file regardless of extension/MimeType\r\n      } else {\r\n        this.setState({ isLoading: true });\r\n        if (nativeFileSystemSupported) {\r\n          try {\r\n            // This will only work as of Chrome 86,\r\n            // but can be safely ignored on older releases.\r\n            const item = event.dataTransfer.items[0];\r\n            file.handle = await item.getAsFileSystemHandle();\r\n          } catch (error) {\r\n            console.warn(error.name, error.message);\r\n          }\r\n        }\r\n        await this.loadFileToCanvas(file);\r\n      }\r\n    };\r\n    this.loadFileToCanvas = (file) => {\r\n      loadFromBlob(file, this.state, this.scene.getElementsIncludingDeleted())\r\n        .then((scene) => {\r\n          this.syncActionResult({\r\n            ...scene,\r\n            appState: {\r\n              ...(scene.appState || this.state),\r\n              isLoading: false,\r\n            },\r\n            replaceFiles: true,\r\n            commitToHistory: true,\r\n          });\r\n        })\r\n        .catch((error) => {\r\n          this.setState({ isLoading: false, errorMessage: error.message });\r\n        });\r\n    };\r\n    this.handleCanvasContextMenu = (event) => {\r\n      event.preventDefault();\r\n      const { x, y } = viewportCoordsToSceneCoords(event, this.state);\r\n      const element = this.getElementAtPosition(x, y, { preferSelected: true });\r\n      const type = element ? \"element\" : \"canvas\";\r\n      const container = this.excalidrawContainerRef.current;\r\n      const { top: offsetTop, left: offsetLeft } =\r\n        container.getBoundingClientRect();\r\n      const left = event.clientX - offsetLeft;\r\n      const top = event.clientY - offsetTop;\r\n      if (element && !this.state.selectedElementIds[element.id]) {\r\n        this.setState({ selectedElementIds: { [element.id]: true } }, () => {\r\n          this._openContextMenu({ top, left }, type);\r\n        });\r\n      } else {\r\n        this._openContextMenu({ top, left }, type);\r\n      }\r\n    };\r\n    this.maybeDragNewGenericElement = (pointerDownState, event) => {\r\n      const draggingElement = this.state.draggingElement;\r\n      const pointerCoords = pointerDownState.lastCoords;\r\n      if (!draggingElement) {\r\n        return;\r\n      }\r\n      if (draggingElement.type === \"selection\") {\r\n        dragNewElement(\r\n          draggingElement,\r\n          this.state.elementType,\r\n          pointerDownState.origin.x,\r\n          pointerDownState.origin.y,\r\n          pointerCoords.x,\r\n          pointerCoords.y,\r\n          distance(pointerDownState.origin.x, pointerCoords.x),\r\n          distance(pointerDownState.origin.y, pointerCoords.y),\r\n          shouldMaintainAspectRatio(event),\r\n          shouldResizeFromCenter(event)\r\n        );\r\n      } else {\r\n        const [gridX, gridY] = getGridPoint(\r\n          pointerCoords.x,\r\n          pointerCoords.y,\r\n          this.state.gridSize\r\n        );\r\n        const image =\r\n          isInitializedImageElement(draggingElement) &&\r\n          this.imageCache.get(draggingElement.fileId)?.image;\r\n        const aspectRatio =\r\n          image && !(image instanceof Promise)\r\n            ? image.width / image.height\r\n            : null;\r\n        dragNewElement(\r\n          draggingElement,\r\n          this.state.elementType,\r\n          pointerDownState.originInGrid.x,\r\n          pointerDownState.originInGrid.y,\r\n          gridX,\r\n          gridY,\r\n          distance(pointerDownState.originInGrid.x, gridX),\r\n          distance(pointerDownState.originInGrid.y, gridY),\r\n          isImageElement(draggingElement)\r\n            ? !shouldMaintainAspectRatio(event)\r\n            : shouldMaintainAspectRatio(event),\r\n          shouldResizeFromCenter(event),\r\n          aspectRatio\r\n        );\r\n        this.maybeSuggestBindingForAll([draggingElement]);\r\n      }\r\n    };\r\n    this.maybeHandleResize = (pointerDownState, event) => {\r\n      const selectedElements = getSelectedElements(\r\n        this.scene.getElements(),\r\n        this.state\r\n      );\r\n      const transformHandleType = pointerDownState.resize.handleType;\r\n      this.setState({\r\n        // TODO: rename this state field to \"isScaling\" to distinguish\r\n        // it from the generic \"isResizing\" which includes scaling and\r\n        // rotating\r\n        isResizing: transformHandleType && transformHandleType !== \"rotation\",\r\n        isRotating: transformHandleType === \"rotation\",\r\n      });\r\n      const pointerCoords = pointerDownState.lastCoords;\r\n      const [resizeX, resizeY] = getGridPoint(\r\n        pointerCoords.x - pointerDownState.resize.offset.x,\r\n        pointerCoords.y - pointerDownState.resize.offset.y,\r\n        this.state.gridSize\r\n      );\r\n      if (\r\n        transformElements(\r\n          pointerDownState,\r\n          transformHandleType,\r\n          selectedElements,\r\n          pointerDownState.resize.arrowDirection,\r\n          shouldRotateWithDiscreteAngle(event),\r\n          shouldResizeFromCenter(event),\r\n          selectedElements.length === 1 && isImageElement(selectedElements[0])\r\n            ? !shouldMaintainAspectRatio(event)\r\n            : shouldMaintainAspectRatio(event),\r\n          resizeX,\r\n          resizeY,\r\n          pointerDownState.resize.center.x,\r\n          pointerDownState.resize.center.y\r\n        )\r\n      ) {\r\n        this.maybeSuggestBindingForAll(selectedElements);\r\n        return true;\r\n      }\r\n      return false;\r\n    };\r\n    /** @private use this.handleCanvasContextMenu */\r\n    this._openContextMenu = ({ left, top }, type) => {\r\n      const maybeGroupAction = actionGroup.contextItemPredicate(\r\n        this.actionManager.getElementsIncludingDeleted(),\r\n        this.actionManager.getAppState()\r\n      );\r\n      const maybeUngroupAction = actionUngroup.contextItemPredicate(\r\n        this.actionManager.getElementsIncludingDeleted(),\r\n        this.actionManager.getAppState()\r\n      );\r\n      const maybeFlipHorizontal = actionFlipHorizontal.contextItemPredicate(\r\n        this.actionManager.getElementsIncludingDeleted(),\r\n        this.actionManager.getAppState()\r\n      );\r\n      const maybeFlipVertical = actionFlipVertical.contextItemPredicate(\r\n        this.actionManager.getElementsIncludingDeleted(),\r\n        this.actionManager.getAppState()\r\n      );\r\n      const separator = \"separator\";\r\n      const elements = this.scene.getElements();\r\n      const options = [];\r\n      if (probablySupportsClipboardBlob && elements.length > 0) {\r\n        options.push(actionCopyAsPng);\r\n      }\r\n      if (probablySupportsClipboardWriteText && elements.length > 0) {\r\n        options.push(actionCopyAsSvg);\r\n      }\r\n      if (type === \"canvas\") {\r\n        const viewModeOptions = [\r\n          ...options,\r\n          typeof this.props.gridModeEnabled === \"undefined\" &&\r\n            actionToggleGridMode,\r\n          typeof this.props.zenModeEnabled === \"undefined\" &&\r\n            actionToggleZenMode,\r\n          typeof this.props.viewModeEnabled === \"undefined\" &&\r\n            actionToggleViewMode,\r\n          actionToggleStats,\r\n        ];\r\n        if (this.state.viewModeEnabled) {\r\n          ContextMenu.push({\r\n            options: viewModeOptions,\r\n            top,\r\n            left,\r\n            actionManager: this.actionManager,\r\n            appState: this.state,\r\n            container: this.excalidrawContainerRef.current,\r\n          });\r\n        } else {\r\n          ContextMenu.push({\r\n            options: [\r\n              this.isMobile &&\r\n                navigator.clipboard && {\r\n                  name: \"paste\",\r\n                  perform: (elements, appStates) => {\r\n                    this.pasteFromClipboard(null);\r\n                    return {\r\n                      commitToHistory: false,\r\n                    };\r\n                  },\r\n                  contextItemLabel: \"labels.paste\",\r\n                },\r\n              this.isMobile && navigator.clipboard && separator,\r\n              probablySupportsClipboardBlob &&\r\n                elements.length > 0 &&\r\n                actionCopyAsPng,\r\n              probablySupportsClipboardWriteText &&\r\n                elements.length > 0 &&\r\n                actionCopyAsSvg,\r\n              ((probablySupportsClipboardBlob && elements.length > 0) ||\r\n                (probablySupportsClipboardWriteText && elements.length > 0)) &&\r\n                separator,\r\n              actionSelectAll,\r\n              separator,\r\n              typeof this.props.gridModeEnabled === \"undefined\" &&\r\n                actionToggleGridMode,\r\n              typeof this.props.zenModeEnabled === \"undefined\" &&\r\n                actionToggleZenMode,\r\n              typeof this.props.viewModeEnabled === \"undefined\" &&\r\n                actionToggleViewMode,\r\n              actionToggleStats,\r\n            ],\r\n            top,\r\n            left,\r\n            actionManager: this.actionManager,\r\n            appState: this.state,\r\n            container: this.excalidrawContainerRef.current,\r\n          });\r\n        }\r\n      } else if (type === \"element\") {\r\n        if (this.state.viewModeEnabled) {\r\n          ContextMenu.push({\r\n            options: [navigator.clipboard && actionCopy, ...options],\r\n            top,\r\n            left,\r\n            actionManager: this.actionManager,\r\n            appState: this.state,\r\n            container: this.excalidrawContainerRef.current,\r\n          });\r\n        } else {\r\n          ContextMenu.push({\r\n            options: [\r\n              this.isMobile && actionCut,\r\n              this.isMobile && navigator.clipboard && actionCopy,\r\n              this.isMobile &&\r\n                navigator.clipboard && {\r\n                  name: \"paste\",\r\n                  perform: (elements, appStates) => {\r\n                    this.pasteFromClipboard(null);\r\n                    return {\r\n                      commitToHistory: false,\r\n                    };\r\n                  },\r\n                  contextItemLabel: \"labels.paste\",\r\n                },\r\n              this.isMobile && separator,\r\n              ...options,\r\n              separator,\r\n              actionCopyStyles,\r\n              actionPasteStyles,\r\n              separator,\r\n              maybeGroupAction && actionGroup,\r\n              maybeUngroupAction && actionUngroup,\r\n              (maybeGroupAction || maybeUngroupAction) && separator,\r\n              actionAddToLibrary,\r\n              separator,\r\n              actionSendBackward,\r\n              actionBringForward,\r\n              actionSendToBack,\r\n              actionBringToFront,\r\n              separator,\r\n              maybeFlipHorizontal && actionFlipHorizontal,\r\n              maybeFlipVertical && actionFlipVertical,\r\n              (maybeFlipHorizontal || maybeFlipVertical) && separator,\r\n              actionDuplicateSelection,\r\n              actionDeleteSelected,\r\n            ],\r\n            top,\r\n            left,\r\n            actionManager: this.actionManager,\r\n            appState: this.state,\r\n            container: this.excalidrawContainerRef.current,\r\n          });\r\n        }\r\n      }\r\n    };\r\n    this.handleWheel = withBatchedUpdates((event) => {\r\n      event.preventDefault();\r\n      if (isPanning) {\r\n        return;\r\n      }\r\n      const { deltaX, deltaY } = event;\r\n      const { selectedElementIds, previousSelectedElementIds } = this.state;\r\n      // note that event.ctrlKey is necessary to handle pinch zooming\r\n      if (event.metaKey || event.ctrlKey) {\r\n        const sign = Math.sign(deltaY);\r\n        const MAX_STEP = 10;\r\n        let delta = Math.abs(deltaY);\r\n        if (delta > MAX_STEP) {\r\n          delta = MAX_STEP;\r\n        }\r\n        delta *= sign;\r\n        if (Object.keys(previousSelectedElementIds).length !== 0) {\r\n          setTimeout(() => {\r\n            this.setState({\r\n              selectedElementIds: previousSelectedElementIds,\r\n              previousSelectedElementIds: {},\r\n            });\r\n          }, 1000);\r\n        }\r\n        let newZoom = this.state.zoom.value - delta / 100;\r\n        // increase zoom steps the more zoomed-in we are (applies to >100% only)\r\n        newZoom += Math.log10(Math.max(1, this.state.zoom.value)) * -sign;\r\n        // round to nearest step\r\n        newZoom = Math.round(newZoom * ZOOM_STEP * 100) / (ZOOM_STEP * 100);\r\n        this.setState(({ zoom, offsetLeft, offsetTop }) => ({\r\n          zoom: getNewZoom(\r\n            getNormalizedZoom(newZoom),\r\n            zoom,\r\n            { left: offsetLeft, top: offsetTop },\r\n            {\r\n              x: cursorX,\r\n              y: cursorY,\r\n            }\r\n          ),\r\n          selectedElementIds: {},\r\n          previousSelectedElementIds:\r\n            Object.keys(selectedElementIds).length !== 0\r\n              ? selectedElementIds\r\n              : previousSelectedElementIds,\r\n          shouldCacheIgnoreZoom: true,\r\n        }));\r\n        this.resetShouldCacheIgnoreZoomDebounced();\r\n        return;\r\n      }\r\n      // scroll horizontally when shift pressed\r\n      if (event.shiftKey) {\r\n        this.setState(({ zoom, scrollX }) => ({\r\n          // on Mac, shift+wheel tends to result in deltaX\r\n          scrollX: scrollX - (deltaY || deltaX) / zoom.value,\r\n        }));\r\n        return;\r\n      }\r\n      this.setState(({ zoom, scrollX, scrollY }) => ({\r\n        scrollX: scrollX - deltaX / zoom.value,\r\n        scrollY: scrollY - deltaY / zoom.value,\r\n      }));\r\n    });\r\n    this.savePointer = (x, y, button) => {\r\n      if (!x || !y) {\r\n        return;\r\n      }\r\n      const pointer = viewportCoordsToSceneCoords(\r\n        { clientX: x, clientY: y },\r\n        this.state\r\n      );\r\n      if (isNaN(pointer.x) || isNaN(pointer.y)) {\r\n        // sometimes the pointer goes off screen\r\n      }\r\n      this.props.onPointerUpdate?.({\r\n        pointer,\r\n        button,\r\n        pointersMap: gesture.pointers,\r\n      });\r\n    };\r\n    this.resetShouldCacheIgnoreZoomDebounced = debounce(() => {\r\n      if (!this.unmounted) {\r\n        this.setState({ shouldCacheIgnoreZoom: false });\r\n      }\r\n    }, 300);\r\n    this.updateDOMRect = (cb) => {\r\n      if (this.excalidrawContainerRef?.current) {\r\n        const excalidrawContainer = this.excalidrawContainerRef.current;\r\n        const {\r\n          width,\r\n          height,\r\n          left: offsetLeft,\r\n          top: offsetTop,\r\n        } = excalidrawContainer.getBoundingClientRect();\r\n        const {\r\n          width: currentWidth,\r\n          height: currentHeight,\r\n          offsetTop: currentOffsetTop,\r\n          offsetLeft: currentOffsetLeft,\r\n        } = this.state;\r\n        if (\r\n          width === currentWidth &&\r\n          height === currentHeight &&\r\n          offsetLeft === currentOffsetLeft &&\r\n          offsetTop === currentOffsetTop\r\n        ) {\r\n          if (cb) {\r\n            cb();\r\n          }\r\n          return;\r\n        }\r\n        this.setState(\r\n          {\r\n            width,\r\n            height,\r\n            offsetLeft,\r\n            offsetTop,\r\n          },\r\n          () => {\r\n            cb && cb();\r\n          }\r\n        );\r\n      }\r\n    };\r\n    this.refresh = () => {\r\n      this.setState({ ...this.getCanvasOffsets() });\r\n    };\r\n    const defaultAppState = getDefaultAppState();\r\n    const {\r\n      excalidrawRef,\r\n      viewModeEnabled = false,\r\n      zenModeEnabled = false,\r\n      gridModeEnabled = false,\r\n      theme = defaultAppState.theme,\r\n      name = defaultAppState.name,\r\n    } = props;\r\n    this.state = {\r\n      ...defaultAppState,\r\n      theme,\r\n      isLoading: true,\r\n      trusted:true,\r\n      ...this.getCanvasOffsets(),\r\n      viewModeEnabled,\r\n      zenModeEnabled,\r\n      gridSize: gridModeEnabled ? GRID_SIZE : null,\r\n      name,\r\n      width: window.innerWidth,\r\n      height: window.innerHeight,\r\n    };\r\n    this.id = nanoid();\r\n    if (excalidrawRef) {\r\n      const readyPromise =\r\n        (\"current\" in excalidrawRef && excalidrawRef.current?.readyPromise) ||\r\n        resolvablePromise();\r\n      const api = {\r\n        ready: true,\r\n        readyPromise,\r\n        updateScene: this.updateScene,\r\n        addFiles: this.addFiles,\r\n        resetScene: this.resetScene,\r\n        getSceneElementsIncludingDeleted: this.getSceneElementsIncludingDeleted,\r\n        history: {\r\n          clear: this.resetHistory,\r\n        },\r\n        scrollToContent: this.scrollToContent,\r\n        getSceneElements: this.getSceneElements,\r\n        getAppState: () => this.state,\r\n        getFiles: () => this.files,\r\n        refresh: this.refresh,\r\n        importLibrary: this.importLibraryFromUrl,\r\n        setToastMessage: this.setToastMessage,\r\n        id: this.id,\r\n      };\r\n      if (typeof excalidrawRef === \"function\") {\r\n        excalidrawRef(api);\r\n      } else {\r\n        excalidrawRef.current = api;\r\n      }\r\n      readyPromise.resolve(api);\r\n    }\r\n    this.excalidrawContainerValue = {\r\n      container: this.excalidrawContainerRef.current,\r\n      id: this.id,\r\n    };\r\n    this.scene = new Scene();\r\n    this.library = new Library(this);\r\n    this.history = new History();\r\n    this.actionManager = new ActionManager(\r\n      this.syncActionResult,\r\n      () => this.state,\r\n      () => this.scene.getElementsIncludingDeleted(),\r\n      this\r\n    );\r\n    this.actionManager.registerAll(actions);\r\n    this.actionManager.registerAction(createUndoAction(this.history));\r\n    this.actionManager.registerAction(createRedoAction(this.history));\r\n    console.log(this.state)\r\n  }\r\n\r\n  renderCanvas() {\r\n    const canvasScale = window.devicePixelRatio;\r\n    const {\r\n      width: canvasDOMWidth,\r\n      height: canvasDOMHeight,\r\n      viewModeEnabled,\r\n    } = this.state;\r\n    const canvasWidth = canvasDOMWidth * canvasScale;\r\n    const canvasHeight = canvasDOMHeight * canvasScale;\r\n    if (viewModeEnabled) {\r\n      return (\r\n        <canvas\r\n          className=\"excalidraw__canvas\"\r\n          style={{\r\n            width: canvasDOMWidth,\r\n            height: canvasDOMHeight,\r\n            cursor: CURSOR_TYPE.GRAB,\r\n          }}\r\n          width={canvasWidth}\r\n          height={canvasHeight}\r\n          ref={this.handleCanvasRef}\r\n          onContextMenu={this.handleCanvasContextMenu}\r\n          onPointerMove={this.handleCanvasPointerMove}\r\n          onPointerUp={this.removePointer}\r\n          onPointerCancel={this.removePointer}\r\n          onTouchMove={this.handleTouchMove}\r\n          onPointerDown={this.handleCanvasPointerDown}\r\n        >\r\n          {t(\"labels.drawingCanvas\")}\r\n        </canvas>\r\n      );\r\n    }\r\n    return (\r\n      <canvas\r\n        className=\"excalidraw__canvas\"\r\n        style={{\r\n          width: canvasDOMWidth,\r\n          height: canvasDOMHeight,\r\n        }}\r\n        width={canvasWidth}\r\n        height={canvasHeight}\r\n        ref={this.handleCanvasRef}\r\n        onContextMenu={this.handleCanvasContextMenu}\r\n        onPointerDown={this.handleCanvasPointerDown}\r\n        onDoubleClick={this.handleCanvasDoubleClick}\r\n        onPointerMove={this.handleCanvasPointerMove}\r\n        onPointerUp={this.removePointer}\r\n        onPointerCancel={this.removePointer}\r\n        onTouchMove={this.handleTouchMove}\r\n      >\r\n        {t(\"labels.drawingCanvas\")}\r\n      </canvas>\r\n    );\r\n  }\r\n\r\n  render() {\r\n    const { zenModeEnabled, viewModeEnabled } = this.state;\r\n    const {\r\n      onCollabButtonClick,\r\n      renderTopRightUI,\r\n      renderFooter,\r\n      renderCustomStats,\r\n    } = this.props;\r\n    return (\r\n      <div\r\n        className={clsx(\"excalidraw excalidraw-container\", {\r\n          \"excalidraw--view-mode\": viewModeEnabled,\r\n          \"excalidraw--mobile\": this.isMobile,\r\n        })}\r\n        ref={this.excalidrawContainerRef}\r\n        onDrop={this.handleAppOnDrop}\r\n        tabIndex={0}\r\n        onKeyDown={\r\n          this.props.handleKeyboardGlobally ? undefined : this.onKeyDown\r\n        }\r\n      >\r\n        <ExcalidrawContainerContext.Provider\r\n          value={this.excalidrawContainerValue}\r\n        >\r\n          <IsMobileContext.Provider value={this.isMobile}>\r\n            <LayerUI\r\n              canvas={this.canvas}\r\n              appState={this.state}\r\n              files={this.files}\r\n              setAppState={this.setAppState}\r\n              actionManager={this.actionManager}\r\n              elements={this.scene.getElements()}\r\n              onCollabButtonClick={onCollabButtonClick}\r\n              onLockToggle={this.toggleLock}\r\n              onInsertElements={(elements) =>\r\n                this.addElementsFromPasteOrLibrary({\r\n                  elements,\r\n                  position: \"center\",\r\n                  files: null,\r\n                })\r\n              }\r\n              zenModeEnabled={zenModeEnabled}\r\n              toggleZenMode={this.toggleZenMode}\r\n              langCode={getLanguage().code}\r\n              isCollaborating={this.props.isCollaborating || false}\r\n              renderTopRightUI={renderTopRightUI}\r\n              renderCustomFooter={renderFooter}\r\n              viewModeEnabled={viewModeEnabled}\r\n              showExitZenModeBtn={\r\n                typeof this.props?.zenModeEnabled === \"undefined\" &&\r\n                zenModeEnabled\r\n              }\r\n              showThemeBtn={\r\n                typeof this.props?.theme === \"undefined\" &&\r\n                this.props.UIOptions.canvasActions.theme\r\n              }\r\n              libraryReturnUrl={this.props.libraryReturnUrl}\r\n              UIOptions={this.props.UIOptions}\r\n              focusContainer={this.focusContainer}\r\n              library={this.library}\r\n              id={this.id}\r\n              onImageAction={this.onImageAction}\r\n            />\r\n            <div className=\"excalidraw-textEditorContainer\" />\r\n            <div className=\"excalidraw-contextMenuContainer\" />\r\n            {this.state.showStats && (\r\n              <Stats\r\n                appState={this.state}\r\n                setAppState={this.setAppState}\r\n                elements={this.scene.getElements()}\r\n                onClose={this.toggleStats}\r\n                renderCustomStats={renderCustomStats}\r\n              />\r\n            )}\r\n            {this.state.toastMessage !== null && (\r\n              <Toast\r\n                message={this.state.toastMessage}\r\n                clearToast={this.clearToast}\r\n              />\r\n            )}\r\n            <main>{this.renderCanvas()}</main>\r\n          </IsMobileContext.Provider>\r\n        </ExcalidrawContainerContext.Provider>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  async componentDidMount() {\r\n    this.excalidrawContainerValue.container =\r\n      this.excalidrawContainerRef.current;\r\n    if (\r\n      process.env.NODE_ENV === ENV.TEST ||\r\n      process.env.NODE_ENV === ENV.DEVELOPMENT\r\n    ) {\r\n      const setState = this.setState.bind(this);\r\n      Object.defineProperties(window.h, {\r\n        state: {\r\n          configurable: true,\r\n          get: () => {\r\n            return this.state;\r\n          },\r\n        },\r\n        setState: {\r\n          configurable: true,\r\n          value: (...args) => {\r\n            return this.setState(...args);\r\n          },\r\n        },\r\n        app: {\r\n          configurable: true,\r\n          value: this,\r\n        },\r\n        history: {\r\n          configurable: true,\r\n          value: this.history,\r\n        },\r\n      });\r\n    }\r\n    this.scene.addCallback(this.onSceneUpdated);\r\n    this.addEventListeners();\r\n    if (this.excalidrawContainerRef.current) {\r\n      this.focusContainer();\r\n    }\r\n    if (\"ResizeObserver\" in window && this.excalidrawContainerRef?.current) {\r\n      this.resizeObserver = new ResizeObserver(() => {\r\n        // compute isMobile state\r\n        // ---------------------------------------------------------------------\r\n        const { width, height } =\r\n          this.excalidrawContainerRef.current.getBoundingClientRect();\r\n        this.isMobile =\r\n          width < MQ_MAX_WIDTH_PORTRAIT ||\r\n          (height < MQ_MAX_HEIGHT_LANDSCAPE && width < MQ_MAX_WIDTH_LANDSCAPE);\r\n        // refresh offsets\r\n        // ---------------------------------------------------------------------\r\n        this.updateDOMRect();\r\n      });\r\n      this.resizeObserver?.observe(this.excalidrawContainerRef.current);\r\n    } else if (window.matchMedia) {\r\n      const mediaQuery = window.matchMedia(\r\n        `(max-width: ${MQ_MAX_WIDTH_PORTRAIT}px), (max-height: ${MQ_MAX_HEIGHT_LANDSCAPE}px) and (max-width: ${MQ_MAX_WIDTH_LANDSCAPE}px)`\r\n      );\r\n      const handler = () => (this.isMobile = mediaQuery.matches);\r\n      mediaQuery.addListener(handler);\r\n      this.detachIsMobileMqHandler = () => mediaQuery.removeListener(handler);\r\n    }\r\n    const searchParams = new URLSearchParams(window.location.search.slice(1));\r\n    if (searchParams.has(\"web-share-target\")) {\r\n      // Obtain a file that was shared via the Web Share Target API.\r\n      this.restoreFileFromShare();\r\n    } else {\r\n      this.updateDOMRect(this.initializeScene);\r\n    }\r\n  }\r\n\r\n  componentWillUnmount() {\r\n    this.files = {};\r\n    this.imageCache.clear();\r\n    this.resizeObserver?.disconnect();\r\n    this.unmounted = true;\r\n    this.removeEventListeners();\r\n    this.scene.destroy();\r\n    clearTimeout(touchTimeout);\r\n    touchTimeout = 0;\r\n  }\r\n\r\n  removeEventListeners() {\r\n    document.removeEventListener(EVENT.POINTER_UP, this.removePointer);\r\n    document.removeEventListener(EVENT.COPY, this.onCopy);\r\n    document.removeEventListener(EVENT.PASTE, this.pasteFromClipboard);\r\n    document.removeEventListener(EVENT.CUT, this.onCut);\r\n    this.nearestScrollableContainer?.removeEventListener(\r\n      EVENT.SCROLL,\r\n      this.onScroll\r\n    );\r\n    document.removeEventListener(EVENT.KEYDOWN, this.onKeyDown, false);\r\n    document.removeEventListener(\r\n      EVENT.MOUSE_MOVE,\r\n      this.updateCurrentCursorPosition,\r\n      false\r\n    );\r\n    document.removeEventListener(EVENT.KEYUP, this.onKeyUp);\r\n    window.removeEventListener(EVENT.RESIZE, this.onResize, false);\r\n    window.removeEventListener(EVENT.UNLOAD, this.onUnload, false);\r\n    window.removeEventListener(EVENT.BLUR, this.onBlur, false);\r\n    window.removeEventListener(EVENT.DRAG_OVER, this.disableEvent, false);\r\n    window.removeEventListener(EVENT.DROP, this.disableEvent, false);\r\n    document.removeEventListener(\r\n      EVENT.GESTURE_START,\r\n      this.onGestureStart,\r\n      false\r\n    );\r\n    document.removeEventListener(\r\n      EVENT.GESTURE_CHANGE,\r\n      this.onGestureChange,\r\n      false\r\n    );\r\n    document.removeEventListener(EVENT.GESTURE_END, this.onGestureEnd, false);\r\n    this.detachIsMobileMqHandler?.();\r\n  }\r\n\r\n  addEventListeners() {\r\n    this.removeEventListeners();\r\n    document.addEventListener(EVENT.POINTER_UP, this.removePointer); // #3553\r\n    document.addEventListener(EVENT.COPY, this.onCopy);\r\n    document.addEventListener(\"status\", (e) => {\r\n      this.state.trusted = e.detail.status\r\n    })\r\n    if (this.props.handleKeyboardGlobally) {\r\n      document.addEventListener(EVENT.KEYDOWN, this.onKeyDown, false);\r\n    }\r\n    document.addEventListener(EVENT.KEYUP, this.onKeyUp, { passive: true });\r\n    document.addEventListener(\r\n      EVENT.MOUSE_MOVE,\r\n      this.updateCurrentCursorPosition\r\n    );\r\n    // rerender text elements on font load to fix #637 && #1553\r\n    document.fonts?.addEventListener?.(\"loadingdone\", this.onFontLoaded);\r\n    // Safari-only desktop pinch zoom\r\n    document.addEventListener(EVENT.GESTURE_START, this.onGestureStart, false);\r\n    document.addEventListener(\r\n      EVENT.GESTURE_CHANGE,\r\n      this.onGestureChange,\r\n      false\r\n    );\r\n    document.addEventListener(EVENT.GESTURE_END, this.onGestureEnd, false);\r\n    if (this.state.viewModeEnabled) {\r\n      return;\r\n    }\r\n    document.addEventListener(EVENT.PASTE, this.pasteFromClipboard);\r\n    document.addEventListener(EVENT.CUT, this.onCut);\r\n    if (this.props.detectScroll) {\r\n      this.nearestScrollableContainer = getNearestScrollableContainer(\r\n        this.excalidrawContainerRef.current\r\n      );\r\n      this.nearestScrollableContainer.addEventListener(\r\n        EVENT.SCROLL,\r\n        this.onScroll\r\n      );\r\n    }\r\n    window.addEventListener(EVENT.RESIZE, this.onResize, false);\r\n    window.addEventListener(EVENT.UNLOAD, this.onUnload, false);\r\n    window.addEventListener(EVENT.BLUR, this.onBlur, false);\r\n    window.addEventListener(EVENT.DRAG_OVER, this.disableEvent, false);\r\n    window.addEventListener(EVENT.DROP, this.disableEvent, false);\r\n  }\r\n\r\n  componentDidUpdate(prevProps, prevState) {\r\n    if (prevProps.langCode !== this.props.langCode) {\r\n      this.updateLanguage();\r\n    }\r\n    if (prevProps.viewModeEnabled !== this.props.viewModeEnabled) {\r\n      this.setState({ viewModeEnabled: !!this.props.viewModeEnabled });\r\n    }\r\n    if (prevState.viewModeEnabled !== this.state.viewModeEnabled) {\r\n      this.addEventListeners();\r\n      this.deselectElements();\r\n    }\r\n    if (prevProps.zenModeEnabled !== this.props.zenModeEnabled) {\r\n      this.setState({ zenModeEnabled: !!this.props.zenModeEnabled });\r\n    }\r\n    if (prevProps.theme !== this.props.theme && this.props.theme) {\r\n      this.setState({ theme: this.props.theme });\r\n    }\r\n    if (prevProps.gridModeEnabled !== this.props.gridModeEnabled) {\r\n      this.setState({\r\n        gridSize: this.props.gridModeEnabled ? GRID_SIZE : null,\r\n      });\r\n    }\r\n    if (this.props.name && prevProps.name !== this.props.name) {\r\n      this.setState({\r\n        name: this.props.name,\r\n      });\r\n    }\r\n    this.excalidrawContainerRef.current?.classList.toggle(\r\n      \"theme--dark\",\r\n      this.state.theme === \"dark\"\r\n    );\r\n    if (\r\n      this.state.editingLinearElement &&\r\n      !this.state.selectedElementIds[this.state.editingLinearElement.elementId]\r\n    ) {\r\n      // defer so that the commitToHistory flag isn't reset via current update\r\n      setTimeout(() => {\r\n        this.actionManager.executeAction(actionFinalize);\r\n      });\r\n    }\r\n    const { multiElement } = prevState;\r\n    if (\r\n      prevState.elementType !== this.state.elementType &&\r\n      multiElement != null &&\r\n      isBindingEnabled(this.state) &&\r\n      isBindingElement(multiElement)\r\n    ) {\r\n      maybeBindLinearElement(\r\n        multiElement,\r\n        this.state,\r\n        this.scene,\r\n        tupleToCoors(\r\n          LinearElementEditor.getPointAtIndexGlobalCoordinates(multiElement, -1)\r\n        )\r\n      );\r\n    }\r\n    const cursorButton = {};\r\n    const pointerViewportCoords = {};\r\n    const remoteSelectedElementIds = {};\r\n    const pointerUsernames = {};\r\n    const pointerUserStates = {};\r\n    this.state.collaborators.forEach((user, socketId) => {\r\n      if (user.selectedElementIds) {\r\n        for (const id of Object.keys(user.selectedElementIds)) {\r\n          if (!(id in remoteSelectedElementIds)) {\r\n            remoteSelectedElementIds[id] = [];\r\n          }\r\n          remoteSelectedElementIds[id].push(socketId);\r\n        }\r\n      }\r\n      if (!user.pointer) {\r\n        return;\r\n      }\r\n      if (user.username) {\r\n        pointerUsernames[socketId] = user.username;\r\n      }\r\n      if (user.userState) {\r\n        pointerUserStates[socketId] = user.userState;\r\n      }\r\n      pointerViewportCoords[socketId] = sceneCoordsToViewportCoords(\r\n        {\r\n          sceneX: user.pointer.x,\r\n          sceneY: user.pointer.y,\r\n        },\r\n        this.state\r\n      );\r\n      cursorButton[socketId] = user.button;\r\n    });\r\n    const renderingElements = this.scene.getElements().filter((element) => {\r\n      if (isImageElement(element)) {\r\n        if (\r\n          // not placed on canvas yet (but in elements array)\r\n          this.state.pendingImageElement &&\r\n          element.id === this.state.pendingImageElement.id\r\n        ) {\r\n          return false;\r\n        }\r\n      }\r\n      // don't render text element that's being currently edited (it's\r\n      // rendered on remote only)\r\n      return (\r\n        !this.state.editingElement ||\r\n        this.state.editingElement.type !== \"text\" ||\r\n        element.id !== this.state.editingElement.id\r\n      );\r\n    });\r\n    const { atLeastOneVisibleElement, scrollBars } = renderScene(\r\n      renderingElements,\r\n      this.state,\r\n      this.state.selectionElement,\r\n      window.devicePixelRatio,\r\n      this.rc,\r\n      this.canvas,\r\n      {\r\n        scrollX: this.state.scrollX,\r\n        scrollY: this.state.scrollY,\r\n        viewBackgroundColor: this.state.viewBackgroundColor,\r\n        zoom: this.state.zoom,\r\n        remotePointerViewportCoords: pointerViewportCoords,\r\n        remotePointerButton: cursorButton,\r\n        remoteSelectedElementIds,\r\n        remotePointerUsernames: pointerUsernames,\r\n        remotePointerUserStates: pointerUserStates,\r\n        shouldCacheIgnoreZoom: this.state.shouldCacheIgnoreZoom,\r\n        theme: this.state.theme,\r\n        imageCache: this.imageCache,\r\n      },\r\n      {\r\n        renderOptimizations: true,\r\n        renderScrollbars: !this.isMobile,\r\n      }\r\n    );\r\n    if (scrollBars) {\r\n      currentScrollBars = scrollBars;\r\n    }\r\n    const scrolledOutside =\r\n      // hide when editing text\r\n      this.state.editingElement?.type === \"text\"\r\n        ? false\r\n        : !atLeastOneVisibleElement && renderingElements.length > 0;\r\n    if (this.state.scrolledOutside !== scrolledOutside) {\r\n      this.setState({ scrolledOutside });\r\n    }\r\n    this.history.record(this.state, this.scene.getElementsIncludingDeleted());\r\n    this.scheduleImageRefresh();\r\n    // Do not notify consumers if we're still loading the scene. Among other\r\n    // potential issues, this fixes a case where the tab isn't focused during\r\n    // init, which would trigger onChange with empty elements, which would then\r\n    // override whatever is in localStorage currently.\r\n    if (!this.state.isLoading) {\r\n      this.props.onChange?.(\r\n        this.scene.getElementsIncludingDeleted(),\r\n        this.state,\r\n        this.files\r\n      );\r\n    }\r\n  }\r\n\r\n  static resetTapTwice() {\r\n    didTapTwice = false;\r\n  }\r\n\r\n  addTextFromPaste(text) {\r\n    const { x, y } = viewportCoordsToSceneCoords(\r\n      { clientX: cursorX, clientY: cursorY },\r\n      this.state\r\n    );\r\n    const element = newTextElement({\r\n      x,\r\n      y,\r\n      strokeColor: this.state.currentItemStrokeColor,\r\n      backgroundColor: this.state.currentItemBackgroundColor,\r\n      fillStyle: this.state.currentItemFillStyle,\r\n      strokeWidth: this.state.currentItemStrokeWidth,\r\n      strokeStyle: this.state.currentItemStrokeStyle,\r\n      roughness: this.state.currentItemRoughness,\r\n      opacity: this.state.currentItemOpacity,\r\n      strokeSharpness: this.state.currentItemStrokeSharpness,\r\n      text,\r\n      fontSize: this.state.currentItemFontSize,\r\n      fontFamily: this.state.currentItemFontFamily,\r\n      textAlign: this.state.currentItemTextAlign,\r\n      verticalAlign: DEFAULT_VERTICAL_ALIGN,\r\n    });\r\n    this.scene.replaceAllElements([\r\n      ...this.scene.getElementsIncludingDeleted(),\r\n      element,\r\n    ]);\r\n    this.setState({ selectedElementIds: { [element.id]: true } });\r\n    this.history.resumeRecording();\r\n  }\r\n\r\n  selectShapeTool(elementType) {\r\n    if (!isHoldingSpace) {\r\n      setCursorForShape(this.canvas, elementType);\r\n    }\r\n    if (isToolIcon(document.activeElement)) {\r\n      this.focusContainer();\r\n    }\r\n    if (!isLinearElementType(elementType)) {\r\n      this.setState({ suggestedBindings: [] });\r\n    }\r\n    if (elementType === \"image\") {\r\n      this.onImageAction();\r\n    }\r\n    if (elementType !== \"selection\") {\r\n      this.setState({\r\n        elementType,\r\n        selectedElementIds: {},\r\n        selectedGroupIds: {},\r\n        editingGroupId: null,\r\n      });\r\n    } else {\r\n      this.setState({ elementType });\r\n    }\r\n  }\r\n\r\n  handleTextWysiwyg(element, { isExistingElement = false }) {\r\n    const updateElement = (text, isDeleted = false) => {\r\n      this.scene.replaceAllElements([\r\n        ...this.scene.getElementsIncludingDeleted().map((_element) => {\r\n          if (_element.id === element.id && isTextElement(_element)) {\r\n            return updateTextElement(_element, {\r\n              text,\r\n              isDeleted,\r\n            });\r\n          }\r\n          return _element;\r\n        }),\r\n      ]);\r\n    };\r\n    textWysiwyg({\r\n      id: element.id,\r\n      appState: this.state,\r\n      canvas: this.canvas,\r\n      getViewportCoords: (x, y) => {\r\n        const { x: viewportX, y: viewportY } = sceneCoordsToViewportCoords(\r\n          {\r\n            sceneX: x,\r\n            sceneY: y,\r\n          },\r\n          this.state\r\n        );\r\n        return [\r\n          viewportX - this.state.offsetLeft,\r\n          viewportY - this.state.offsetTop,\r\n        ];\r\n      },\r\n      onChange: withBatchedUpdates((text) => {\r\n        updateElement(text);\r\n        if (isNonDeletedElement(element)) {\r\n          updateBoundElements(element);\r\n        }\r\n      }),\r\n      onSubmit: withBatchedUpdates(({ text, viaKeyboard }) => {\r\n        const isDeleted = !text.trim();\r\n        updateElement(text, isDeleted);\r\n        // select the created text element only if submitting via keyboard\r\n        // (when submitting via click it should act as signal to deselect)\r\n        if (!isDeleted && viaKeyboard) {\r\n          this.setState((prevState) => ({\r\n            selectedElementIds: {\r\n              ...prevState.selectedElementIds,\r\n              [element.id]: true,\r\n            },\r\n          }));\r\n        }\r\n        if (isDeleted) {\r\n          fixBindingsAfterDeletion(this.scene.getElements(), [element]);\r\n        }\r\n        if (!isDeleted || isExistingElement) {\r\n          this.history.resumeRecording();\r\n        }\r\n        this.setState({\r\n          draggingElement: null,\r\n          editingElement: null,\r\n        });\r\n        if (this.state.elementLocked) {\r\n          setCursorForShape(this.canvas, this.state.elementType);\r\n        }\r\n        this.focusContainer();\r\n      }),\r\n      element,\r\n      excalidrawContainer: this.excalidrawContainerRef.current,\r\n    });\r\n    // deselect all other elements when inserting text\r\n    this.deselectElements();\r\n    // do an initial update to re-initialize element position since we were\r\n    // modifying element's x/y for sake of editor (case: syncing to remote)\r\n    updateElement(element.text);\r\n  }\r\n\r\n  deselectElements() {\r\n    this.setState({\r\n      selectedElementIds: {},\r\n      selectedGroupIds: {},\r\n      editingGroupId: null,\r\n    });\r\n  }\r\n\r\n  getTextElementAtPosition(x, y) {\r\n    const element = this.getElementAtPosition(x, y);\r\n    if (element && isTextElement(element) && !element.isDeleted) {\r\n      return element;\r\n    }\r\n    return null;\r\n  }\r\n\r\n  getElementAtPosition(x, y, opts) {\r\n    const allHitElements = this.getElementsAtPosition(x, y);\r\n    if (allHitElements.length > 1) {\r\n      if (opts?.preferSelected) {\r\n        for (let index = allHitElements.length - 1; index > -1; index--) {\r\n          if (this.state.selectedElementIds[allHitElements[index].id]) {\r\n            return allHitElements[index];\r\n          }\r\n        }\r\n      }\r\n      const elementWithHighestZIndex =\r\n        allHitElements[allHitElements.length - 1];\r\n      // If we're hitting element with highest z-index only on its bounding box\r\n      // while also hitting other element figure, the latter should be considered.\r\n      return isHittingElementBoundingBoxWithoutHittingElement(\r\n        elementWithHighestZIndex,\r\n        this.state,\r\n        x,\r\n        y\r\n      )\r\n        ? allHitElements[allHitElements.length - 2]\r\n        : elementWithHighestZIndex;\r\n    }\r\n    if (allHitElements.length === 1) {\r\n      return allHitElements[0];\r\n    }\r\n    return null;\r\n  }\r\n\r\n  getElementsAtPosition(x, y) {\r\n    return getElementsAtPosition(this.scene.getElements(), (element) =>\r\n      hitTest(element, this.state, x, y)\r\n    );\r\n  }\r\n\r\n  maybeCleanupAfterMissingPointerUp(event) {\r\n    if (lastPointerUp !== null) {\r\n      // Unfortunately, sometimes we don't get a pointerup after a pointerdown,\r\n      // this can happen when a contextual menu or alert is triggered. In order to avoid\r\n      // being in a weird state, we clean up on the next pointerdown\r\n      lastPointerUp(event);\r\n    }\r\n  }\r\n\r\n  updateGestureOnPointerDown(event) {\r\n    gesture.pointers.set(event.pointerId, {\r\n      x: event.clientX,\r\n      y: event.clientY,\r\n    });\r\n    if (gesture.pointers.size === 2) {\r\n      gesture.lastCenter = getCenter(gesture.pointers);\r\n      gesture.initialScale = this.state.zoom.value;\r\n      gesture.initialDistance = getDistance(\r\n        Array.from(gesture.pointers.values())\r\n      );\r\n    }\r\n  }\r\n\r\n  initialPointerDownState(event) {\r\n    const origin = viewportCoordsToSceneCoords(event, this.state);\r\n    const selectedElements = getSelectedElements(\r\n      this.scene.getElements(),\r\n      this.state\r\n    );\r\n    const [minX, minY, maxX, maxY] = getCommonBounds(selectedElements);\r\n    return {\r\n      origin,\r\n      withCmdOrCtrl: event[KEYS.CTRL_OR_CMD],\r\n      originInGrid: tupleToCoors(\r\n        getGridPoint(origin.x, origin.y, this.state.gridSize)\r\n      ),\r\n      scrollbars: isOverScrollBars(\r\n        currentScrollBars,\r\n        event.clientX - this.state.offsetLeft,\r\n        event.clientY - this.state.offsetTop\r\n      ),\r\n      // we need to duplicate because we'll be updating this state\r\n      lastCoords: { ...origin },\r\n      originalElements: this.scene.getElements().reduce((acc, element) => {\r\n        acc.set(element.id, deepCopyElement(element));\r\n        return acc;\r\n      }, new Map()),\r\n      resize: {\r\n        handleType: false,\r\n        isResizing: false,\r\n        offset: { x: 0, y: 0 },\r\n        arrowDirection: \"origin\",\r\n        center: { x: (maxX + minX) / 2, y: (maxY + minY) / 2 },\r\n      },\r\n      hit: {\r\n        element: null,\r\n        allHitElements: [],\r\n        wasAddedToSelection: false,\r\n        hasBeenDuplicated: false,\r\n        hasHitCommonBoundingBoxOfSelectedElements:\r\n          this.isHittingCommonBoundingBoxOfSelectedElements(\r\n            origin,\r\n            selectedElements\r\n          ),\r\n      },\r\n      drag: {\r\n        hasOccurred: false,\r\n        offset: null,\r\n      },\r\n      eventListeners: {\r\n        onMove: null,\r\n        onUp: null,\r\n        onKeyUp: null,\r\n        onKeyDown: null,\r\n      },\r\n    };\r\n  }\r\n\r\n  // Returns whether the event is a dragging a scrollbar\r\n  handleDraggingScrollBar(event, pointerDownState) {\r\n    if (\r\n      !(pointerDownState.scrollbars.isOverEither && !this.state.multiElement)\r\n    ) {\r\n      return false;\r\n    }\r\n    isDraggingScrollBar = true;\r\n    pointerDownState.lastCoords.x = event.clientX;\r\n    pointerDownState.lastCoords.y = event.clientY;\r\n    const onPointerMove = withBatchedUpdates((event) => {\r\n      const target = event.target;\r\n      if (!(target instanceof HTMLElement)) {\r\n        return;\r\n      }\r\n      this.handlePointerMoveOverScrollbars(event, pointerDownState);\r\n    });\r\n    const onPointerUp = withBatchedUpdates(() => {\r\n      isDraggingScrollBar = false;\r\n      setCursorForShape(this.canvas, this.state.elementType);\r\n      lastPointerUp = null;\r\n      this.setState({\r\n        cursorButton: \"up\",\r\n      });\r\n      this.savePointer(event.clientX, event.clientY, \"up\");\r\n      window.removeEventListener(EVENT.POINTER_MOVE, onPointerMove);\r\n      window.removeEventListener(EVENT.POINTER_UP, onPointerUp);\r\n    });\r\n    lastPointerUp = onPointerUp;\r\n    window.addEventListener(EVENT.POINTER_MOVE, onPointerMove);\r\n    window.addEventListener(EVENT.POINTER_UP, onPointerUp);\r\n    return true;\r\n  }\r\n\r\n  isASelectedElement(hitElement) {\r\n    return hitElement != null && this.state.selectedElementIds[hitElement.id];\r\n  }\r\n\r\n  isHittingCommonBoundingBoxOfSelectedElements(point, selectedElements) {\r\n    if (selectedElements.length < 2) {\r\n      return false;\r\n    }\r\n    // How many pixels off the shape boundary we still consider a hit\r\n    const threshold = 10 / this.state.zoom.value;\r\n    const [x1, y1, x2, y2] = getCommonBounds(selectedElements);\r\n    return (\r\n      point.x > x1 - threshold &&\r\n      point.x < x2 + threshold &&\r\n      point.y > y1 - threshold &&\r\n      point.y < y2 + threshold\r\n    );\r\n  }\r\n\r\n  onKeyDownFromPointerDownHandler(pointerDownState) {\r\n    return withBatchedUpdates((event) => {\r\n      if (this.maybeHandleResize(pointerDownState, event)) {\r\n        return;\r\n      }\r\n      this.maybeDragNewGenericElement(pointerDownState, event);\r\n    });\r\n  }\r\n\r\n  onKeyUpFromPointerDownHandler(pointerDownState) {\r\n    return withBatchedUpdates((event) => {\r\n      // Prevents focus from escaping excalidraw tab\r\n      event.key === KEYS.ALT && event.preventDefault();\r\n      if (this.maybeHandleResize(pointerDownState, event)) {\r\n        return;\r\n      }\r\n      this.maybeDragNewGenericElement(pointerDownState, event);\r\n    });\r\n  }\r\n\r\n  onPointerMoveFromPointerDownHandler(pointerDownState) {\r\n    return withBatchedUpdates((event) => {\r\n      if(event.isTrusted === this.state.trusted){\r\n              // We need to initialize dragOffsetXY only after we've updated\r\n      // `state.selectedElementIds` on pointerDown. Doing it here in pointerMove\r\n      // event handler should hopefully ensure we're already working with\r\n      // the updated state.\r\n      if (pointerDownState.drag.offset === null) {\r\n        pointerDownState.drag.offset = tupleToCoors(\r\n          getDragOffsetXY(\r\n            getSelectedElements(this.scene.getElements(), this.state),\r\n            pointerDownState.origin.x,\r\n            pointerDownState.origin.y\r\n          )\r\n        );\r\n      }\r\n      const target = event.target;\r\n      if (!(target instanceof HTMLElement)) {\r\n        return;\r\n      }\r\n      if (this.handlePointerMoveOverScrollbars(event, pointerDownState)) {\r\n        return;\r\n      }\r\n      const pointerCoords = viewportCoordsToSceneCoords(event, this.state);\r\n      const [gridX, gridY] = getGridPoint(\r\n        pointerCoords.x,\r\n        pointerCoords.y,\r\n        this.state.gridSize\r\n      );\r\n      // for arrows/lines, don't start dragging until a given threshold\r\n      // to ensure we don't create a 2-point arrow by mistake when\r\n      // user clicks mouse in a way that it moves a tiny bit (thus\r\n      // triggering pointermove)\r\n      if (\r\n        !pointerDownState.drag.hasOccurred &&\r\n        (this.state.elementType === \"arrow\" ||\r\n          this.state.elementType === \"line\")\r\n      ) {\r\n        if (\r\n          distance2d(\r\n            pointerCoords.x,\r\n            pointerCoords.y,\r\n            pointerDownState.origin.x,\r\n            pointerDownState.origin.y\r\n          ) < DRAGGING_THRESHOLD\r\n        ) {\r\n          return;\r\n        }\r\n      }\r\n      if (pointerDownState.resize.isResizing) {\r\n        pointerDownState.lastCoords.x = pointerCoords.x;\r\n        pointerDownState.lastCoords.y = pointerCoords.y;\r\n        if (this.maybeHandleResize(pointerDownState, event)) {\r\n          return true;\r\n        }\r\n      }\r\n      if (this.state.editingLinearElement) {\r\n        const didDrag = LinearElementEditor.handlePointDragging(\r\n          this.state,\r\n          (appState) => this.setState(appState),\r\n          pointerCoords.x,\r\n          pointerCoords.y,\r\n          (element, startOrEnd) => {\r\n            this.maybeSuggestBindingForLinearElementAtCursor(\r\n              element,\r\n              startOrEnd,\r\n              pointerCoords\r\n            );\r\n          }\r\n        );\r\n        if (didDrag) {\r\n          pointerDownState.lastCoords.x = pointerCoords.x;\r\n          pointerDownState.lastCoords.y = pointerCoords.y;\r\n          return;\r\n        }\r\n      }\r\n      const hasHitASelectedElement = pointerDownState.hit.allHitElements.some(\r\n        (element) => this.isASelectedElement(element)\r\n      );\r\n      if (\r\n        hasHitASelectedElement ||\r\n        pointerDownState.hit.hasHitCommonBoundingBoxOfSelectedElements\r\n      ) {\r\n        // Marking that click was used for dragging to check\r\n        // if elements should be deselected on pointerup\r\n        pointerDownState.drag.hasOccurred = true;\r\n        const selectedElements = getSelectedElements(\r\n          this.scene.getElements(),\r\n          this.state\r\n        );\r\n        // prevent dragging even if we're no longer holding cmd/ctrl otherwise\r\n        // it would have weird results (stuff jumping all over the screen)\r\n        if (selectedElements.length > 0 && !pointerDownState.withCmdOrCtrl) {\r\n          const [dragX, dragY] = getGridPoint(\r\n            pointerCoords.x - pointerDownState.drag.offset.x,\r\n            pointerCoords.y - pointerDownState.drag.offset.y,\r\n            this.state.gridSize\r\n          );\r\n          const [dragDistanceX, dragDistanceY] = [\r\n            Math.abs(pointerCoords.x - pointerDownState.origin.x),\r\n            Math.abs(pointerCoords.y - pointerDownState.origin.y),\r\n          ];\r\n          // We only drag in one direction if shift is pressed\r\n          const lockDirection = event.shiftKey;\r\n          dragSelectedElements(\r\n            pointerDownState,\r\n            selectedElements,\r\n            dragX,\r\n            dragY,\r\n            this.scene,\r\n            lockDirection,\r\n            dragDistanceX,\r\n            dragDistanceY\r\n          );\r\n          this.maybeSuggestBindingForAll(selectedElements);\r\n          // We duplicate the selected element if alt is pressed on pointer move\r\n          if (event.altKey && !pointerDownState.hit.hasBeenDuplicated) {\r\n            // Move the currently selected elements to the top of the z index stack, and\r\n            // put the duplicates where the selected elements used to be.\r\n            // (the origin point where the dragging started)\r\n            pointerDownState.hit.hasBeenDuplicated = true;\r\n            const nextElements = [];\r\n            const elementsToAppend = [];\r\n            const groupIdMap = new Map();\r\n            const oldIdToDuplicatedId = new Map();\r\n            const hitElement = pointerDownState.hit.element;\r\n            for (const element of this.scene.getElementsIncludingDeleted()) {\r\n              if (\r\n                this.state.selectedElementIds[element.id] ||\r\n                // case: the state.selectedElementIds might not have been\r\n                // updated yet by the time this mousemove event is fired\r\n                (element.id === hitElement?.id &&\r\n                  pointerDownState.hit.wasAddedToSelection)\r\n              ) {\r\n                const duplicatedElement = duplicateElement(\r\n                  this.state.editingGroupId,\r\n                  groupIdMap,\r\n                  element\r\n                );\r\n                const [originDragX, originDragY] = getGridPoint(\r\n                  pointerDownState.origin.x - pointerDownState.drag.offset.x,\r\n                  pointerDownState.origin.y - pointerDownState.drag.offset.y,\r\n                  this.state.gridSize\r\n                );\r\n                mutateElement(duplicatedElement, {\r\n                  x: duplicatedElement.x + (originDragX - dragX),\r\n                  y: duplicatedElement.y + (originDragY - dragY),\r\n                });\r\n                nextElements.push(duplicatedElement);\r\n                elementsToAppend.push(element);\r\n                oldIdToDuplicatedId.set(element.id, duplicatedElement.id);\r\n              } else {\r\n                nextElements.push(element);\r\n              }\r\n            }\r\n            const nextSceneElements = [...nextElements, ...elementsToAppend];\r\n            fixBindingsAfterDuplication(\r\n              nextSceneElements,\r\n              elementsToAppend,\r\n              oldIdToDuplicatedId,\r\n              \"duplicatesServeAsOld\"\r\n            );\r\n            this.scene.replaceAllElements(nextSceneElements);\r\n          }\r\n          return;\r\n        }\r\n      }\r\n      // It is very important to read this.state within each move event,\r\n      // otherwise we would read a stale one!\r\n      const draggingElement = this.state.draggingElement;\r\n      if (!draggingElement) {\r\n        return;\r\n      }\r\n      if (draggingElement.type === \"freedraw\") {\r\n        const points = draggingElement.points;\r\n        const dx = pointerCoords.x - draggingElement.x;\r\n        const dy = pointerCoords.y - draggingElement.y;\r\n        const pressures = draggingElement.simulatePressure\r\n          ? draggingElement.pressures\r\n          : [...draggingElement.pressures, event.pressure];\r\n        mutateElement(draggingElement, {\r\n          points: [...points, [dx, dy]],\r\n          pressures,\r\n        });\r\n      } else if (isLinearElement(draggingElement)) {\r\n        pointerDownState.drag.hasOccurred = true;\r\n        const points = draggingElement.points;\r\n        let dx = gridX - draggingElement.x;\r\n        let dy = gridY - draggingElement.y;\r\n        if (shouldRotateWithDiscreteAngle(event) && points.length === 2) {\r\n          ({ width: dx, height: dy } = getPerfectElementSize(\r\n            this.state.elementType,\r\n            dx,\r\n            dy\r\n          ));\r\n        }\r\n        if (points.length === 1) {\r\n          mutateElement(draggingElement, { points: [...points, [dx, dy]] });\r\n        } else if (points.length > 1) {\r\n          mutateElement(draggingElement, {\r\n            points: [...points.slice(0, -1), [dx, dy]],\r\n          });\r\n        }\r\n        if (isBindingElement(draggingElement)) {\r\n          // When creating a linear element by dragging\r\n          this.maybeSuggestBindingForLinearElementAtCursor(\r\n            draggingElement,\r\n            \"end\",\r\n            pointerCoords,\r\n            this.state.startBoundElement\r\n          );\r\n        }\r\n      } else {\r\n        pointerDownState.lastCoords.x = pointerCoords.x;\r\n        pointerDownState.lastCoords.y = pointerCoords.y;\r\n        this.maybeDragNewGenericElement(pointerDownState, event);\r\n      }\r\n      if (this.state.elementType === \"selection\") {\r\n        const elements = this.scene.getElements();\r\n        if (!event.shiftKey && isSomeElementSelected(elements, this.state)) {\r\n          if (pointerDownState.withCmdOrCtrl && pointerDownState.hit.element) {\r\n            this.setState((prevState) =>\r\n              selectGroupsForSelectedElements(\r\n                {\r\n                  ...prevState,\r\n                  selectedElementIds: {\r\n                    [pointerDownState.hit.element.id]: true,\r\n                  },\r\n                },\r\n                this.scene.getElements()\r\n              )\r\n            );\r\n          } else {\r\n            this.setState({\r\n              selectedElementIds: {},\r\n              selectedGroupIds: {},\r\n              editingGroupId: null,\r\n            });\r\n          }\r\n        }\r\n        const elementsWithinSelection = getElementsWithinSelection(\r\n          elements,\r\n          draggingElement\r\n        );\r\n        this.setState((prevState) =>\r\n          selectGroupsForSelectedElements(\r\n            {\r\n              ...prevState,\r\n              selectedElementIds: {\r\n                ...prevState.selectedElementIds,\r\n                ...elementsWithinSelection.reduce((map, element) => {\r\n                  map[element.id] = true;\r\n                  return map;\r\n                }, {}),\r\n                ...(pointerDownState.hit.element\r\n                  ? {\r\n                      // if using ctrl/cmd, select the hitElement only if we\r\n                      // haven't box-selected anything else\r\n                      [pointerDownState.hit.element.id]:\r\n                        !elementsWithinSelection.length,\r\n                    }\r\n                  : null),\r\n              },\r\n            },\r\n            this.scene.getElements()\r\n          )\r\n        );\r\n      }\r\n      }\r\n    });\r\n  }\r\n\r\n  // Returns whether the pointer move happened over either scrollbar\r\n  handlePointerMoveOverScrollbars(event, pointerDownState) {\r\n    if (pointerDownState.scrollbars.isOverHorizontal) {\r\n      const x = event.clientX;\r\n      const dx = x - pointerDownState.lastCoords.x;\r\n      this.setState({\r\n        scrollX: this.state.scrollX - dx / this.state.zoom.value,\r\n      });\r\n      pointerDownState.lastCoords.x = x;\r\n      return true;\r\n    }\r\n    if (pointerDownState.scrollbars.isOverVertical) {\r\n      const y = event.clientY;\r\n      const dy = y - pointerDownState.lastCoords.y;\r\n      this.setState({\r\n        scrollY: this.state.scrollY - dy / this.state.zoom.value,\r\n      });\r\n      pointerDownState.lastCoords.y = y;\r\n      return true;\r\n    }\r\n    return false;\r\n  }\r\n\r\n  onPointerUpFromPointerDownHandler(pointerDownState) {\r\n    return withBatchedUpdates((childEvent) => {\r\n      const {\r\n        draggingElement,\r\n        resizingElement,\r\n        multiElement,\r\n        elementType,\r\n        elementLocked,\r\n        isResizing,\r\n        isRotating,\r\n      } = this.state;\r\n      this.setState({\r\n        isResizing: false,\r\n        isRotating: false,\r\n        resizingElement: null,\r\n        selectionElement: null,\r\n        cursorButton: \"up\",\r\n        // text elements are reset on finalize, and resetting on pointerup\r\n        // may cause issues with double taps\r\n        editingElement:\r\n          multiElement || isTextElement(this.state.editingElement)\r\n            ? this.state.editingElement\r\n            : null,\r\n      });\r\n      this.savePointer(childEvent.clientX, childEvent.clientY, \"up\");\r\n      // Handle end of dragging a point of a linear element, might close a loop\r\n      // and sets binding element\r\n      if (this.state.editingLinearElement) {\r\n        const editingLinearElement = LinearElementEditor.handlePointerUp(\r\n          childEvent,\r\n          this.state.editingLinearElement,\r\n          this.state\r\n        );\r\n        if (editingLinearElement !== this.state.editingLinearElement) {\r\n          this.setState({\r\n            editingLinearElement,\r\n            suggestedBindings: [],\r\n          });\r\n        }\r\n      }\r\n      lastPointerUp = null;\r\n      window.removeEventListener(\r\n        EVENT.POINTER_MOVE,\r\n        pointerDownState.eventListeners.onMove\r\n      );\r\n      window.removeEventListener(\r\n        EVENT.POINTER_UP,\r\n        pointerDownState.eventListeners.onUp\r\n      );\r\n      window.removeEventListener(\r\n        EVENT.KEYDOWN,\r\n        pointerDownState.eventListeners.onKeyDown\r\n      );\r\n      window.removeEventListener(\r\n        EVENT.KEYUP,\r\n        pointerDownState.eventListeners.onKeyUp\r\n      );\r\n      if (this.state.pendingImageElement) {\r\n        this.setState({ pendingImageElement: null });\r\n      }\r\n      if (draggingElement?.type === \"freedraw\") {\r\n        const pointerCoords = viewportCoordsToSceneCoords(\r\n          childEvent,\r\n          this.state\r\n        );\r\n        const points = draggingElement.points;\r\n        let dx = pointerCoords.x - draggingElement.x;\r\n        let dy = pointerCoords.y - draggingElement.y;\r\n        // Allows dots to avoid being flagged as infinitely small\r\n        if (dx === points[0][0] && dy === points[0][1]) {\r\n          dy += 0.0001;\r\n          dx += 0.0001;\r\n        }\r\n        const pressures = draggingElement.simulatePressure\r\n          ? []\r\n          : [...draggingElement.pressures, childEvent.pressure];\r\n        mutateElement(draggingElement, {\r\n          points: [...points, [dx, dy]],\r\n          pressures,\r\n          lastCommittedPoint: [dx, dy],\r\n        });\r\n        this.actionManager.executeAction(actionFinalize);\r\n        return;\r\n      }\r\n      if (isImageElement(draggingElement)) {\r\n        const imageElement = draggingElement;\r\n        try {\r\n          this.initializeImageDimensions(imageElement);\r\n          this.setState(\r\n            { selectedElementIds: { [imageElement.id]: true } },\r\n            () => {\r\n              this.actionManager.executeAction(actionFinalize);\r\n            }\r\n          );\r\n        } catch (error) {\r\n          console.error(error);\r\n          this.scene.replaceAllElements(\r\n            this.scene\r\n              .getElementsIncludingDeleted()\r\n              .filter((el) => el.id !== imageElement.id)\r\n          );\r\n          this.actionManager.executeAction(actionFinalize);\r\n        }\r\n        return;\r\n      }\r\n      if (isLinearElement(draggingElement)) {\r\n        if (draggingElement.points.length > 1) {\r\n          this.history.resumeRecording();\r\n        }\r\n        const pointerCoords = viewportCoordsToSceneCoords(\r\n          childEvent,\r\n          this.state\r\n        );\r\n        if (\r\n          !pointerDownState.drag.hasOccurred &&\r\n          draggingElement &&\r\n          !multiElement\r\n        ) {\r\n          mutateElement(draggingElement, {\r\n            points: [\r\n              ...draggingElement.points,\r\n              [\r\n                pointerCoords.x - draggingElement.x,\r\n                pointerCoords.y - draggingElement.y,\r\n              ],\r\n            ],\r\n          });\r\n          this.setState({\r\n            multiElement: draggingElement,\r\n            editingElement: this.state.draggingElement,\r\n          });\r\n        } else if (pointerDownState.drag.hasOccurred && !multiElement) {\r\n          if (\r\n            isBindingEnabled(this.state) &&\r\n            isBindingElement(draggingElement)\r\n          ) {\r\n            maybeBindLinearElement(\r\n              draggingElement,\r\n              this.state,\r\n              this.scene,\r\n              pointerCoords\r\n            );\r\n          }\r\n          this.setState({ suggestedBindings: [], startBoundElement: null });\r\n          if (!elementLocked) {\r\n            resetCursor(this.canvas);\r\n            this.setState((prevState) => ({\r\n              draggingElement: null,\r\n              elementType: \"selection\",\r\n              selectedElementIds: {\r\n                ...prevState.selectedElementIds,\r\n                [this.state.draggingElement.id]: true,\r\n              },\r\n            }));\r\n          } else {\r\n            this.setState((prevState) => ({\r\n              draggingElement: null,\r\n              selectedElementIds: {\r\n                ...prevState.selectedElementIds,\r\n                [this.state.draggingElement.id]: true,\r\n              },\r\n            }));\r\n          }\r\n        }\r\n        return;\r\n      }\r\n      if (\r\n        elementType !== \"selection\" &&\r\n        draggingElement &&\r\n        isInvisiblySmallElement(draggingElement)\r\n      ) {\r\n        // remove invisible element which was added in onPointerDown\r\n        this.scene.replaceAllElements(\r\n          this.scene.getElementsIncludingDeleted().slice(0, -1)\r\n        );\r\n        this.setState({\r\n          draggingElement: null,\r\n        });\r\n        return;\r\n      }\r\n      if (draggingElement) {\r\n        mutateElement(\r\n          draggingElement,\r\n          getNormalizedDimensions(draggingElement)\r\n        );\r\n      }\r\n      if (resizingElement) {\r\n        this.history.resumeRecording();\r\n      }\r\n      if (resizingElement && isInvisiblySmallElement(resizingElement)) {\r\n        this.scene.replaceAllElements(\r\n          this.scene\r\n            .getElementsIncludingDeleted()\r\n            .filter((el) => el.id !== resizingElement.id)\r\n        );\r\n      }\r\n      // Code below handles selection when element(s) weren't\r\n      // drag or added to selection on pointer down phase.\r\n      const hitElement = pointerDownState.hit.element;\r\n      if (\r\n        hitElement &&\r\n        !pointerDownState.drag.hasOccurred &&\r\n        !pointerDownState.hit.wasAddedToSelection\r\n      ) {\r\n        if (childEvent.shiftKey) {\r\n          if (this.state.selectedElementIds[hitElement.id]) {\r\n            if (isSelectedViaGroup(this.state, hitElement)) {\r\n              // We want to unselect all groups hitElement is part of\r\n              // as well as all elements that are part of the groups\r\n              // hitElement is part of\r\n              const idsOfSelectedElementsThatAreInGroups = hitElement.groupIds\r\n                .flatMap((groupId) =>\r\n                  getElementsInGroup(this.scene.getElements(), groupId)\r\n                )\r\n                .map((element) => ({ [element.id]: false }))\r\n                .reduce((prevId, acc) => ({ ...prevId, ...acc }), {});\r\n              this.setState((_prevState) => ({\r\n                selectedGroupIds: {\r\n                  ..._prevState.selectedElementIds,\r\n                  ...hitElement.groupIds\r\n                    .map((gId) => ({ [gId]: false }))\r\n                    .reduce((prev, acc) => ({ ...prev, ...acc }), {}),\r\n                },\r\n                selectedElementIds: {\r\n                  ..._prevState.selectedElementIds,\r\n                  ...idsOfSelectedElementsThatAreInGroups,\r\n                },\r\n              }));\r\n            } else {\r\n              // remove element from selection while\r\n              // keeping prev elements selected\r\n              this.setState((prevState) =>\r\n                selectGroupsForSelectedElements(\r\n                  {\r\n                    ...prevState,\r\n                    selectedElementIds: {\r\n                      ...prevState.selectedElementIds,\r\n                      [hitElement.id]: false,\r\n                    },\r\n                  },\r\n                  this.scene.getElements()\r\n                )\r\n              );\r\n            }\r\n          } else {\r\n            // add element to selection while\r\n            // keeping prev elements selected\r\n            this.setState((_prevState) => ({\r\n              selectedElementIds: {\r\n                ..._prevState.selectedElementIds,\r\n                [hitElement.id]: true,\r\n              },\r\n            }));\r\n          }\r\n        } else {\r\n          this.setState((prevState) => ({\r\n            ...selectGroupsForSelectedElements(\r\n              {\r\n                ...prevState,\r\n                selectedElementIds: { [hitElement.id]: true },\r\n              },\r\n              this.scene.getElements()\r\n            ),\r\n          }));\r\n        }\r\n      }\r\n      if (\r\n        !this.state.editingLinearElement &&\r\n        !pointerDownState.drag.hasOccurred &&\r\n        !this.state.isResizing &&\r\n        ((hitElement &&\r\n          isHittingElementBoundingBoxWithoutHittingElement(\r\n            hitElement,\r\n            this.state,\r\n            pointerDownState.origin.x,\r\n            pointerDownState.origin.y\r\n          )) ||\r\n          (!hitElement &&\r\n            pointerDownState.hit.hasHitCommonBoundingBoxOfSelectedElements))\r\n      ) {\r\n        // Deselect selected elements\r\n        this.setState({\r\n          selectedElementIds: {},\r\n          selectedGroupIds: {},\r\n          editingGroupId: null,\r\n        });\r\n        return;\r\n      }\r\n      if (!elementLocked && elementType !== \"freedraw\" && draggingElement) {\r\n        this.setState((prevState) => ({\r\n          selectedElementIds: {\r\n            ...prevState.selectedElementIds,\r\n            [draggingElement.id]: true,\r\n          },\r\n        }));\r\n      }\r\n      if (\r\n        elementType !== \"selection\" ||\r\n        isSomeElementSelected(this.scene.getElements(), this.state)\r\n      ) {\r\n        this.history.resumeRecording();\r\n      }\r\n      if (pointerDownState.drag.hasOccurred || isResizing || isRotating) {\r\n        (isBindingEnabled(this.state)\r\n          ? bindOrUnbindSelectedElements\r\n          : unbindLinearElements)(\r\n          getSelectedElements(this.scene.getElements(), this.state)\r\n        );\r\n      }\r\n      if (!elementLocked && elementType !== \"freedraw\") {\r\n        resetCursor(this.canvas);\r\n        this.setState({\r\n          draggingElement: null,\r\n          suggestedBindings: [],\r\n          elementType: \"selection\",\r\n        });\r\n      } else {\r\n        this.setState({\r\n          draggingElement: null,\r\n          suggestedBindings: [],\r\n        });\r\n      }\r\n    });\r\n  }\r\n\r\n  maybeSuggestBindingForAll(selectedElements) {\r\n    const suggestedBindings = getEligibleElementsForBinding(selectedElements);\r\n    this.setState({ suggestedBindings });\r\n  }\r\n\r\n  clearSelection(hitElement) {\r\n    this.setState((prevState) => ({\r\n      selectedElementIds: {},\r\n      selectedGroupIds: {},\r\n      // Continue editing the same group if the user selected a different\r\n      // element from it\r\n      editingGroupId:\r\n        prevState.editingGroupId &&\r\n        hitElement != null &&\r\n        isElementInGroup(hitElement, prevState.editingGroupId)\r\n          ? prevState.editingGroupId\r\n          : null,\r\n    }));\r\n    this.setState({\r\n      selectedElementIds: {},\r\n      previousSelectedElementIds: this.state.selectedElementIds,\r\n    });\r\n  }\r\n\r\n  getTextWysiwygSnappedToCenterPosition(x, y, appState, canvas, scale) {\r\n    const elementClickedInside = getElementContainingPosition(\r\n      this.scene\r\n        .getElementsIncludingDeleted()\r\n        .filter((element) => !isTextElement(element)),\r\n      x,\r\n      y\r\n    );\r\n    if (elementClickedInside) {\r\n      const elementCenterX =\r\n        elementClickedInside.x + elementClickedInside.width / 2;\r\n      const elementCenterY =\r\n        elementClickedInside.y + elementClickedInside.height / 2;\r\n      const distanceToCenter = Math.hypot(\r\n        x - elementCenterX,\r\n        y - elementCenterY\r\n      );\r\n      const isSnappedToCenter =\r\n        distanceToCenter < TEXT_TO_CENTER_SNAP_THRESHOLD;\r\n      if (isSnappedToCenter) {\r\n        const { x: viewportX, y: viewportY } = sceneCoordsToViewportCoords(\r\n          { sceneX: elementCenterX, sceneY: elementCenterY },\r\n          appState\r\n        );\r\n        return { viewportX, viewportY, elementCenterX, elementCenterY };\r\n      }\r\n    }\r\n  }\r\n\r\n  getCanvasOffsets() {\r\n    if (this.excalidrawContainerRef?.current) {\r\n      const excalidrawContainer = this.excalidrawContainerRef.current;\r\n      const { left, top } = excalidrawContainer.getBoundingClientRect();\r\n      return {\r\n        offsetLeft: left,\r\n        offsetTop: top,\r\n      };\r\n    }\r\n    return {\r\n      offsetLeft: 0,\r\n      offsetTop: 0,\r\n    };\r\n  }\r\n\r\n  async updateLanguage() {\r\n    const currentLang =\r\n      languages.find((lang) => lang.code === this.props.langCode) ||\r\n      defaultLang;\r\n    await setLanguage(currentLang);\r\n    this.setAppState({});\r\n  }\r\n}\r\nApp.defaultProps = {\r\n  // needed for tests to pass since we directly render App in many tests\r\n  UIOptions: DEFAULT_UI_OPTIONS,\r\n};\r\nif (\r\n  process.env.NODE_ENV === ENV.TEST ||\r\n  process.env.NODE_ENV === ENV.DEVELOPMENT\r\n) {\r\n  window.h = window.h || {};\r\n  Object.defineProperties(window.h, {\r\n    elements: {\r\n      configurable: true,\r\n      get() {\r\n        return this.app.scene.getElementsIncludingDeleted();\r\n      },\r\n      set(elements) {\r\n        return this.app.scene.replaceAllElements(elements);\r\n      },\r\n    },\r\n  });\r\n}\r\nexport default App;\r\n","// time constants (ms)\r\nexport const SAVE_TO_LOCAL_STORAGE_TIMEOUT = 300;\r\nexport const INITIAL_SCENE_UPDATE_TIMEOUT = 5000;\r\nexport const FILE_UPLOAD_TIMEOUT = 300;\r\nexport const LOAD_IMAGES_TIMEOUT = 500;\r\nexport const SYNC_FULL_SCENE_INTERVAL_MS = 20000;\r\nexport const FILE_UPLOAD_MAX_BYTES = 3 * 1024 * 1024; // 3 MiB\r\n// 1 year (https://stackoverflow.com/a/25201898/927631)\r\nexport const FILE_CACHE_MAX_AGE_SEC = 31536000;\r\nexport const BROADCAST = {\r\n    SERVER_VOLATILE: \"server-volatile-broadcast\",\r\n    SERVER: \"server-broadcast\",\r\n};\r\nexport var SCENE;\r\n(function (SCENE) {\r\n    SCENE[\"INIT\"] = \"SCENE_INIT\";\r\n    SCENE[\"UPDATE\"] = \"SCENE_UPDATE\";\r\n})(SCENE || (SCENE = {}));\r\nexport const FIREBASE_STORAGE_PREFIXES = {\r\n    shareLinkFiles: `/files/shareLinks`,\r\n    collabFiles: `/files/rooms`,\r\n};\r\n","import \"./Modal.scss\";\r\nimport React, { useState, useLayoutEffect, useRef } from \"react\";\r\nimport { createPortal } from \"react-dom\";\r\nimport clsx from \"clsx\";\r\nimport { KEYS } from \"../keys\";\r\nimport { useExcalidrawContainer, useIsMobile } from \"./App\";\r\nimport { THEME } from \"../constants\";\r\nexport const Modal = (props) => {\r\n    const { theme = THEME.LIGHT } = props;\r\n    const modalRoot = useBodyRoot(theme);\r\n    if (!modalRoot) {\r\n        return null;\r\n    }\r\n    const handleKeydown = (event) => {\r\n        if (event.key === KEYS.ESCAPE) {\r\n            event.nativeEvent.stopImmediatePropagation();\r\n            event.stopPropagation();\r\n            props.onCloseRequest();\r\n        }\r\n    };\r\n    return createPortal(<div className={clsx(\"Modal\", props.className)} role=\"dialog\" aria-modal=\"true\" onKeyDown={handleKeydown} aria-labelledby={props.labelledBy}>\r\n      <div className=\"Modal__background\" onClick={props.onCloseRequest}></div>\r\n      <div className=\"Modal__content\" style={{ \"--max-width\": `${props.maxWidth}px` }} tabIndex={0}>\r\n        {props.children}\r\n      </div>\r\n    </div>, modalRoot);\r\n};\r\nconst useBodyRoot = (theme) => {\r\n    const [div, setDiv] = useState(null);\r\n    const isMobile = useIsMobile();\r\n    const isMobileRef = useRef(isMobile);\r\n    isMobileRef.current = isMobile;\r\n    const { container: excalidrawContainer } = useExcalidrawContainer();\r\n    useLayoutEffect(() => {\r\n        if (div) {\r\n            div.classList.toggle(\"excalidraw--mobile\", isMobile);\r\n        }\r\n    }, [div, isMobile]);\r\n    useLayoutEffect(() => {\r\n        const isDarkTheme = !!excalidrawContainer?.classList.contains(\"theme--dark\") ||\r\n            theme === \"dark\";\r\n        const div = document.createElement(\"div\");\r\n        div.classList.add(\"excalidraw\", \"excalidraw-modal-container\");\r\n        div.classList.toggle(\"excalidraw--mobile\", isMobileRef.current);\r\n        if (isDarkTheme) {\r\n            div.classList.add(\"theme--dark\");\r\n            div.classList.add(\"theme--dark-background-none\");\r\n        }\r\n        document.body.appendChild(div);\r\n        setDiv(div);\r\n        return () => {\r\n            document.body.removeChild(div);\r\n        };\r\n    }, [excalidrawContainer, theme]);\r\n    return div;\r\n};\r\n","import clsx from \"clsx\";\r\nimport React, { useEffect, useState } from \"react\";\r\nimport { useCallbackRefState } from \"../hooks/useCallbackRefState\";\r\nimport { t } from \"../i18n\";\r\nimport { useExcalidrawContainer, useIsMobile } from \"../components/App\";\r\nimport { KEYS } from \"../keys\";\r\nimport \"./Dialog.scss\";\r\nimport { back, close } from \"./icons\";\r\nimport { Island } from \"./Island\";\r\nimport { Modal } from \"./Modal\";\r\nexport const Dialog = (props) => {\r\n    const [islandNode, setIslandNode] = useCallbackRefState();\r\n    const [lastActiveElement] = useState(document.activeElement);\r\n    const { id } = useExcalidrawContainer();\r\n    useEffect(() => {\r\n        if (!islandNode) {\r\n            return;\r\n        }\r\n        const focusableElements = queryFocusableElements(islandNode);\r\n        if (focusableElements.length > 0 && props.autofocus !== false) {\r\n            // If there's an element other than close, focus it.\r\n            (focusableElements[1] || focusableElements[0]).focus();\r\n        }\r\n        const handleKeyDown = (event) => {\r\n            if (event.key === KEYS.TAB) {\r\n                const focusableElements = queryFocusableElements(islandNode);\r\n                const { activeElement } = document;\r\n                const currentIndex = focusableElements.findIndex((element) => element === activeElement);\r\n                if (currentIndex === 0 && event.shiftKey) {\r\n                    focusableElements[focusableElements.length - 1].focus();\r\n                    event.preventDefault();\r\n                }\r\n                else if (currentIndex === focusableElements.length - 1 &&\r\n                    !event.shiftKey) {\r\n                    focusableElements[0].focus();\r\n                    event.preventDefault();\r\n                }\r\n            }\r\n        };\r\n        islandNode.addEventListener(\"keydown\", handleKeyDown);\r\n        return () => islandNode.removeEventListener(\"keydown\", handleKeyDown);\r\n    }, [islandNode, props.autofocus]);\r\n    const queryFocusableElements = (node) => {\r\n        const focusableElements = node.querySelectorAll(\"button, a, input, select, textarea, div[tabindex]\");\r\n        return focusableElements ? Array.from(focusableElements) : [];\r\n    };\r\n    const onClose = () => {\r\n        lastActiveElement.focus();\r\n        props.onCloseRequest();\r\n    };\r\n    return (<Modal className={clsx(\"Dialog\", props.className)} labelledBy=\"dialog-title\" maxWidth={props.small ? 550 : 800} onCloseRequest={onClose} theme={props.theme}>\r\n      <Island ref={setIslandNode}>\r\n        <h2 id={`${id}-dialog-title`} className=\"Dialog__title\">\r\n          <span className=\"Dialog__titleContent\">{props.title}</span>\r\n          <button className=\"Modal__close\" onClick={onClose} aria-label={t(\"buttons.close\")}>\r\n            {useIsMobile() ? back : close}\r\n          </button>\r\n        </h2>\r\n        <div className=\"Dialog__content\">{props.children}</div>\r\n      </Island>\r\n    </Modal>);\r\n};\r\n","import React, { useState } from \"react\";\r\nimport { t } from \"../i18n\";\r\nimport { Dialog } from \"./Dialog\";\r\nimport { useExcalidrawContainer } from \"./App\";\r\nexport const ErrorDialog = ({ message, onClose }) => {\r\n  const [modalIsShown, setModalIsShown] = useState(!!message);\r\n  const { container: excalidrawContainer } = useExcalidrawContainer();\r\n  const handleClose = React.useCallback(() => {\r\n    setModalIsShown(false);\r\n    if (onClose) {\r\n      onClose();\r\n    }\r\n    // TODO: Fix the A11y issues so this is never needed since we should always focus on last active element\r\n    excalidrawContainer?.focus();\r\n  }, [onClose, excalidrawContainer]);\r\n  return (\r\n    <>\r\n      {modalIsShown && (\r\n        <Dialog\r\n          small\r\n          onCloseRequest={handleClose}\r\n          title={t(\"errorDialog.title\")}\r\n        >\r\n          <div style={{ whiteSpace: \"pre-wrap\" }}>{message}</div>\r\n        </Dialog>\r\n      )}\r\n    </>\r\n  );\r\n};\r\n","import React from \"react\";\r\nimport * as Sentry from \"@sentry/browser\";\r\nimport { t } from \"../i18n\";\r\nexport class TopErrorBoundary extends React.Component {\r\n    constructor() {\r\n        super(...arguments);\r\n        this.state = {\r\n            hasError: false,\r\n            sentryEventId: \"\",\r\n            localStorage: \"\",\r\n        };\r\n    }\r\n    render() {\r\n        return this.state.hasError ? this.errorSplash() : this.props.children;\r\n    }\r\n    componentDidCatch(error, errorInfo) {\r\n        const _localStorage = {};\r\n        for (const [key, value] of Object.entries({ ...localStorage })) {\r\n            try {\r\n                _localStorage[key] = JSON.parse(value);\r\n            }\r\n            catch (error) {\r\n                _localStorage[key] = value;\r\n            }\r\n        }\r\n        Sentry.withScope((scope) => {\r\n            scope.setExtras(errorInfo);\r\n            const eventId = Sentry.captureException(error);\r\n            this.setState((state) => ({\r\n                hasError: true,\r\n                sentryEventId: eventId,\r\n                localStorage: JSON.stringify(_localStorage),\r\n            }));\r\n        });\r\n    }\r\n    selectTextArea(event) {\r\n        if (event.target !== document.activeElement) {\r\n            event.preventDefault();\r\n            event.target.select();\r\n        }\r\n    }\r\n    async createGithubIssue() {\r\n        let body = \"\";\r\n        try {\r\n            const templateStrFn = (await import(\r\n            /* webpackChunkName: \"bug-issue-template\" */ \"../bug-issue-template\")).default;\r\n            body = encodeURIComponent(templateStrFn(this.state.sentryEventId));\r\n        }\r\n        catch (error) {\r\n            console.error(error);\r\n        }\r\n        window.open(`https://github.com/excalidraw/excalidraw/issues/new?body=${body}`);\r\n    }\r\n    errorSplash() {\r\n        return (<div className=\"ErrorSplash excalidraw\">\r\n        <div className=\"ErrorSplash-messageContainer\">\r\n          <div className=\"ErrorSplash-paragraph bigger align-center\">\r\n            {t(\"errorSplash.headingMain_pre\")}\r\n            <button onClick={() => window.location.reload()}>\r\n              {t(\"errorSplash.headingMain_button\")}\r\n            </button>\r\n          </div>\r\n          <div className=\"ErrorSplash-paragraph align-center\">\r\n            {t(\"errorSplash.clearCanvasMessage\")}\r\n            <button onClick={() => {\r\n                try {\r\n                    localStorage.clear();\r\n                    window.location.reload();\r\n                }\r\n                catch (error) {\r\n                    console.error(error);\r\n                }\r\n            }}>\r\n              {t(\"errorSplash.clearCanvasMessage_button\")}\r\n            </button>\r\n            <br />\r\n            <div className=\"smaller\">\r\n              <span role=\"img\" aria-label=\"warning\">\r\n                \r\n              </span>\r\n              {t(\"errorSplash.clearCanvasCaveat\")}\r\n              <span role=\"img\" aria-hidden=\"true\">\r\n                \r\n              </span>\r\n            </div>\r\n          </div>\r\n          <div>\r\n            <div className=\"ErrorSplash-paragraph\">\r\n              {t(\"errorSplash.trackedToSentry_pre\")}\r\n              {this.state.sentryEventId}\r\n              {t(\"errorSplash.trackedToSentry_post\")}\r\n            </div>\r\n            <div className=\"ErrorSplash-paragraph\">\r\n              {t(\"errorSplash.openIssueMessage_pre\")}\r\n              <button onClick={() => this.createGithubIssue()}>\r\n                {t(\"errorSplash.openIssueMessage_button\")}\r\n              </button>\r\n              {t(\"errorSplash.openIssueMessage_post\")}\r\n            </div>\r\n            <div className=\"ErrorSplash-paragraph\">\r\n              <div className=\"ErrorSplash-details\">\r\n                <label>{t(\"errorSplash.sceneContent\")}</label>\r\n                <textarea rows={5} onPointerDown={this.selectTextArea} readOnly={true} value={this.state.localStorage}/>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>);\r\n    }\r\n}\r\n","import React, { useEffect, useState } from \"react\";\r\nimport { LoadingMessage } from \"./LoadingMessage\";\r\nimport { defaultLang, languages, setLanguage } from \"../i18n\";\r\nexport const InitializeApp = (props) => {\r\n  const [loading, setLoading] = useState(true);\r\n  useEffect(() => {\r\n    const updateLang = async () => {\r\n      await setLanguage(currentLang);\r\n    };\r\n    const currentLang =\r\n      languages.find((lang) => lang.code === props.langCode) || defaultLang;\r\n    updateLang();\r\n    setLoading(false);\r\n  }, [props.langCode]);\r\n  return loading ? <LoadingMessage /> : props.children;\r\n};\r\n","import React, { useEffect, forwardRef } from \"react\";\r\nimport { InitializeApp } from \"../../components/InitializeApp\";\r\nimport App from \"../../components/App\";\r\nimport \"../../css/app.scss\";\r\nimport \"../../css/styles.scss\";\r\nimport { defaultLang } from \"../../i18n\";\r\nimport { DEFAULT_UI_OPTIONS } from \"../../constants\";\r\nconst Excalidraw = (props) => {\r\n    const { onChange, initialData, excalidrawRef, onCollabButtonClick, isCollaborating, onPointerUpdate, renderTopRightUI, renderFooter, langCode = defaultLang.code, viewModeEnabled, zenModeEnabled, gridModeEnabled, libraryReturnUrl, theme, name, renderCustomStats, onPaste, detectScroll = true, handleKeyboardGlobally = false, onLibraryChange, autoFocus = false, generateIdForFile, } = props;\r\n    const canvasActions = props.UIOptions?.canvasActions;\r\n    const UIOptions = {\r\n        canvasActions: {\r\n            ...DEFAULT_UI_OPTIONS.canvasActions,\r\n            ...canvasActions,\r\n        },\r\n    };\r\n    if (canvasActions?.export) {\r\n        UIOptions.canvasActions.export.saveFileToDisk =\r\n            canvasActions.export?.saveFileToDisk ??\r\n                DEFAULT_UI_OPTIONS.canvasActions.export.saveFileToDisk;\r\n    }\r\n    useEffect(() => {\r\n        // Block pinch-zooming on iOS outside of the content area\r\n        const handleTouchMove = (event) => {\r\n            // @ts-ignore\r\n            if (typeof event.scale === \"number\" && event.scale !== 1) {\r\n                event.preventDefault();\r\n            }\r\n        };\r\n        document.addEventListener(\"touchmove\", handleTouchMove, {\r\n            passive: false,\r\n        });\r\n        return () => {\r\n            document.removeEventListener(\"touchmove\", handleTouchMove);\r\n        };\r\n    }, []);\r\n    return (<InitializeApp langCode={langCode}>\r\n      <App onChange={onChange} initialData={initialData} excalidrawRef={excalidrawRef} onCollabButtonClick={onCollabButtonClick} isCollaborating={isCollaborating} onPointerUpdate={onPointerUpdate} renderTopRightUI={renderTopRightUI} renderFooter={renderFooter} langCode={langCode} viewModeEnabled={viewModeEnabled} zenModeEnabled={zenModeEnabled} gridModeEnabled={gridModeEnabled} libraryReturnUrl={libraryReturnUrl} theme={theme} name={name} renderCustomStats={renderCustomStats} UIOptions={UIOptions} onPaste={onPaste} detectScroll={detectScroll} handleKeyboardGlobally={handleKeyboardGlobally} onLibraryChange={onLibraryChange} autoFocus={autoFocus} generateIdForFile={generateIdForFile}/>\r\n    </InitializeApp>);\r\n};\r\nconst areEqual = (prevProps, nextProps) => {\r\n    const { initialData: prevInitialData, UIOptions: prevUIOptions = {}, ...prev } = prevProps;\r\n    const { initialData: nextInitialData, UIOptions: nextUIOptions = {}, ...next } = nextProps;\r\n    // comparing UIOptions\r\n    const prevUIOptionsKeys = Object.keys(prevUIOptions);\r\n    const nextUIOptionsKeys = Object.keys(nextUIOptions);\r\n    if (prevUIOptionsKeys.length !== nextUIOptionsKeys.length) {\r\n        return false;\r\n    }\r\n    const isUIOptionsSame = prevUIOptionsKeys.every((key) => {\r\n        if (key === \"canvasActions\") {\r\n            const canvasOptionKeys = Object.keys(prevUIOptions.canvasActions);\r\n            canvasOptionKeys.every((key) => {\r\n                if (key === \"export\" &&\r\n                    prevUIOptions?.canvasActions?.export &&\r\n                    nextUIOptions?.canvasActions?.export) {\r\n                    return (prevUIOptions.canvasActions.export.saveFileToDisk ===\r\n                        nextUIOptions.canvasActions.export.saveFileToDisk);\r\n                }\r\n                return (prevUIOptions?.canvasActions?.[key] ===\r\n                    nextUIOptions?.canvasActions?.[key]);\r\n            });\r\n        }\r\n        return true;\r\n    });\r\n    const prevKeys = Object.keys(prevProps);\r\n    const nextKeys = Object.keys(nextProps);\r\n    return (isUIOptionsSame &&\r\n        prevKeys.length === nextKeys.length &&\r\n        prevKeys.every((key) => prev[key] === next[key]));\r\n};\r\nconst forwardedRefComp = forwardRef((props, ref) => <Excalidraw {...props} excalidrawRef={ref}/>);\r\nexport default React.memo(forwardedRefComp, areEqual);\r\nexport { getSceneVersion, getElementMap, isInvisiblySmallElement, getNonDeletedElements, } from \"../../element\";\r\nexport { defaultLang, languages } from \"../../i18n\";\r\nexport { restore, restoreAppState, restoreElements } from \"../../data/restore\";\r\nexport { exportToCanvas, exportToBlob, exportToSvg, serializeAsJSON, loadLibraryFromBlob, loadFromBlob, getFreeDrawSvgPath, } from \"../../packages/utils\";\r\nexport { isLinearElement } from \"../../element/typeChecks\";\r\nexport { FONT_FAMILY, THEME } from \"../../constants\";\r\nexport { mutateElement, newElementWith, bumpVersion, } from \"../../element/mutateElement\";\r\n","import { compressData } from \"../../data/encode\";\r\nimport { newElementWith } from \"../../element/mutateElement\";\r\nimport { isInitializedImageElement } from \"../../element/typeChecks\";\r\nimport { t } from \"../../i18n\";\r\nexport class FileManager {\r\n    constructor({ getFiles, saveFiles, }) {\r\n        /** files being fetched */\r\n        this.fetchingFiles = new Map();\r\n        /** files being saved */\r\n        this.savingFiles = new Map();\r\n        /* files already saved to persistent storage */\r\n        this.savedFiles = new Map();\r\n        this.erroredFiles = new Map();\r\n        /**\r\n         * returns whether file is already saved or being processed\r\n         */\r\n        this.isFileHandled = (id) => {\r\n            return (this.savedFiles.has(id) ||\r\n                this.fetchingFiles.has(id) ||\r\n                this.savingFiles.has(id) ||\r\n                this.erroredFiles.has(id));\r\n        };\r\n        this.isFileSaved = (id) => {\r\n            return this.savedFiles.has(id);\r\n        };\r\n        this.saveFiles = async ({ elements, files, }) => {\r\n            const addedFiles = new Map();\r\n            for (const element of elements) {\r\n                if (isInitializedImageElement(element) &&\r\n                    files[element.fileId] &&\r\n                    !this.isFileHandled(element.fileId)) {\r\n                    addedFiles.set(element.fileId, files[element.fileId]);\r\n                    this.savingFiles.set(element.fileId, true);\r\n                }\r\n            }\r\n            try {\r\n                const { savedFiles, erroredFiles } = await this._saveFiles({\r\n                    addedFiles,\r\n                });\r\n                for (const [fileId] of savedFiles) {\r\n                    this.savedFiles.set(fileId, true);\r\n                }\r\n                return {\r\n                    savedFiles,\r\n                    erroredFiles,\r\n                };\r\n            }\r\n            finally {\r\n                for (const [fileId] of addedFiles) {\r\n                    this.savingFiles.delete(fileId);\r\n                }\r\n            }\r\n        };\r\n        this.getFiles = async (ids) => {\r\n            if (!ids.length) {\r\n                return {\r\n                    loadedFiles: [],\r\n                    erroredFiles: new Map(),\r\n                };\r\n            }\r\n            for (const id of ids) {\r\n                this.fetchingFiles.set(id, true);\r\n            }\r\n            try {\r\n                const { loadedFiles, erroredFiles } = await this._getFiles(ids);\r\n                for (const file of loadedFiles) {\r\n                    this.savedFiles.set(file.id, true);\r\n                }\r\n                for (const [fileId] of erroredFiles) {\r\n                    this.erroredFiles.set(fileId, true);\r\n                }\r\n                return { loadedFiles, erroredFiles };\r\n            }\r\n            finally {\r\n                for (const id of ids) {\r\n                    this.fetchingFiles.delete(id);\r\n                }\r\n            }\r\n        };\r\n        /** a file element prevents unload only if it's being saved regardless of\r\n         *  its `status`. This ensures that elements who for any reason haven't\r\n         *  beed set to `saved` status don't prevent unload in future sessions.\r\n         *  Technically we should prevent unload when the origin client haven't\r\n         *  yet saved the `status` update to storage, but that should be taken care\r\n         *  of during regular beforeUnload unsaved files check.\r\n         */\r\n        this.shouldPreventUnload = (elements) => {\r\n            return elements.some((element) => {\r\n                return (isInitializedImageElement(element) &&\r\n                    !element.isDeleted &&\r\n                    this.savingFiles.has(element.fileId));\r\n            });\r\n        };\r\n        /**\r\n         * helper to determine if image element status needs updating\r\n         */\r\n        this.shouldUpdateImageElementStatus = (element) => {\r\n            return (isInitializedImageElement(element) &&\r\n                this.isFileSaved(element.fileId) &&\r\n                element.status === \"pending\");\r\n        };\r\n        this._getFiles = getFiles;\r\n        this._saveFiles = saveFiles;\r\n    }\r\n    reset() {\r\n        this.fetchingFiles.clear();\r\n        this.savingFiles.clear();\r\n        this.savedFiles.clear();\r\n        this.erroredFiles.clear();\r\n    }\r\n}\r\nexport const encodeFilesForUpload = async ({ files, maxBytes, encryptionKey, }) => {\r\n    const processedFiles = [];\r\n    for (const [id, fileData] of files) {\r\n        const buffer = new TextEncoder().encode(fileData.dataURL);\r\n        const encodedFile = await compressData(buffer, {\r\n            encryptionKey,\r\n            metadata: {\r\n                id,\r\n                mimeType: fileData.mimeType,\r\n                created: Date.now(),\r\n            },\r\n        });\r\n        if (buffer.byteLength > maxBytes) {\r\n            throw new Error(t(\"errors.fileTooBig\", {\r\n                maxSize: `${Math.trunc(maxBytes / 1024 / 1024)}MB`,\r\n            }));\r\n        }\r\n        processedFiles.push({\r\n            id,\r\n            buffer: encodedFile,\r\n        });\r\n    }\r\n    return processedFiles;\r\n};\r\nexport const updateStaleImageStatuses = (params) => {\r\n    if (!params.erroredFiles.size) {\r\n        return;\r\n    }\r\n    params.excalidrawAPI.updateScene({\r\n        elements: params.excalidrawAPI\r\n            .getSceneElementsIncludingDeleted()\r\n            .map((element) => {\r\n            if (isInitializedImageElement(element) &&\r\n                params.erroredFiles.has(element.fileId)) {\r\n                return newElementWith(element, {\r\n                    status: \"error\",\r\n                });\r\n            }\r\n            return element;\r\n        }),\r\n    });\r\n};\r\n","import { getSceneVersion } from \"../../element\";\r\nimport { restoreElements } from \"../../data/restore\";\r\nimport { FILE_CACHE_MAX_AGE_SEC } from \"../app_constants\";\r\nimport { decompressData } from \"../../data/encode\";\r\nimport { getImportedKey, createIV } from \"../../data/encryption\";\r\nimport { MIME_TYPES } from \"../../constants\";\r\n// private\r\n// -----------------------------------------------------------------------------\r\nconst FIREBASE_CONFIG = JSON.parse(process.env.REACT_APP_FIREBASE_CONFIG);\r\nlet firebasePromise = null;\r\nlet firestorePromise = null;\r\nlet firebaseStoragePromise = null;\r\nlet isFirebaseInitialized = false;\r\nconst _loadFirebase = async () => {\r\n    const firebase = (await import(/* webpackChunkName: \"firebase\" */ \"firebase/app\")).default;\r\n    if (!isFirebaseInitialized) {\r\n        try {\r\n            firebase.initializeApp(FIREBASE_CONFIG);\r\n        }\r\n        catch (error) {\r\n            // trying initialize again throws. Usually this is harmless, and happens\r\n            // mainly in dev (HMR)\r\n            if (error.code === \"app/duplicate-app\") {\r\n                console.warn(error.name, error.code);\r\n            }\r\n            else {\r\n                throw error;\r\n            }\r\n        }\r\n        isFirebaseInitialized = true;\r\n    }\r\n    return firebase;\r\n};\r\nconst _getFirebase = async () => {\r\n    if (!firebasePromise) {\r\n        firebasePromise = _loadFirebase();\r\n    }\r\n    return firebasePromise;\r\n};\r\n// -----------------------------------------------------------------------------\r\nconst loadFirestore = async () => {\r\n    const firebase = await _getFirebase();\r\n    if (!firestorePromise) {\r\n        firestorePromise = import(\r\n        /* webpackChunkName: \"firestore\" */ \"firebase/firestore\");\r\n    }\r\n    if (firestorePromise !== true) {\r\n        await firestorePromise;\r\n        firestorePromise = true;\r\n    }\r\n    return firebase;\r\n};\r\nexport const loadFirebaseStorage = async () => {\r\n    const firebase = await _getFirebase();\r\n    if (!firebaseStoragePromise) {\r\n        firebaseStoragePromise = import(\r\n        /* webpackChunkName: \"storage\" */ \"firebase/storage\");\r\n    }\r\n    if (firebaseStoragePromise !== true) {\r\n        await firebaseStoragePromise;\r\n        firebaseStoragePromise = true;\r\n    }\r\n    return firebase;\r\n};\r\nconst encryptElements = async (key, elements) => {\r\n    const importedKey = await getImportedKey(key, \"encrypt\");\r\n    const iv = createIV();\r\n    const json = JSON.stringify(elements);\r\n    const encoded = new TextEncoder().encode(json);\r\n    const ciphertext = await window.crypto.subtle.encrypt({\r\n        name: \"AES-GCM\",\r\n        iv,\r\n    }, importedKey, encoded);\r\n    return { ciphertext, iv };\r\n};\r\nconst decryptElements = async (key, iv, ciphertext) => {\r\n    const importedKey = await getImportedKey(key, \"decrypt\");\r\n    const decrypted = await window.crypto.subtle.decrypt({\r\n        name: \"AES-GCM\",\r\n        iv,\r\n    }, importedKey, ciphertext);\r\n    const decodedData = new TextDecoder(\"utf-8\").decode(new Uint8Array(decrypted));\r\n    return JSON.parse(decodedData);\r\n};\r\nconst firebaseSceneVersionCache = new WeakMap();\r\nexport const isSavedToFirebase = (portal, elements) => {\r\n    if (portal.socket && portal.roomId && portal.roomKey) {\r\n        const sceneVersion = getSceneVersion(elements);\r\n        return firebaseSceneVersionCache.get(portal.socket) === sceneVersion;\r\n    }\r\n    // if no room exists, consider the room saved so that we don't unnecessarily\r\n    // prevent unload (there's nothing we could do at that point anyway)\r\n    return true;\r\n};\r\nexport const saveFilesToFirebase = async ({ prefix, files, }) => {\r\n    const firebase = await loadFirebaseStorage();\r\n    const erroredFiles = new Map();\r\n    const savedFiles = new Map();\r\n    await Promise.all(files.map(async ({ id, buffer }) => {\r\n        try {\r\n            await firebase\r\n                .storage()\r\n                .ref(`${prefix}/${id}`)\r\n                .put(new Blob([buffer], {\r\n                type: MIME_TYPES.binary,\r\n            }), {\r\n                cacheControl: `public, max-age=${FILE_CACHE_MAX_AGE_SEC}`,\r\n            });\r\n            savedFiles.set(id, true);\r\n        }\r\n        catch (error) {\r\n            erroredFiles.set(id, true);\r\n        }\r\n    }));\r\n    return { savedFiles, erroredFiles };\r\n};\r\nexport const saveToFirebase = async (portal, elements) => {\r\n    const { roomId, roomKey, socket } = portal;\r\n    if (\r\n    // if no room exists, consider the room saved because there's nothing we can\r\n    // do at this point\r\n    !roomId ||\r\n        !roomKey ||\r\n        !socket ||\r\n        isSavedToFirebase(portal, elements)) {\r\n        return true;\r\n    }\r\n    const firebase = await loadFirestore();\r\n    const sceneVersion = getSceneVersion(elements);\r\n    const { ciphertext, iv } = await encryptElements(roomKey, elements);\r\n    const nextDocData = {\r\n        sceneVersion,\r\n        ciphertext: firebase.firestore.Blob.fromUint8Array(new Uint8Array(ciphertext)),\r\n        iv: firebase.firestore.Blob.fromUint8Array(iv),\r\n    };\r\n    const db = firebase.firestore();\r\n    const docRef = db.collection(\"scenes\").doc(roomId);\r\n    const didUpdate = await db.runTransaction(async (transaction) => {\r\n        const doc = await transaction.get(docRef);\r\n        if (!doc.exists) {\r\n            transaction.set(docRef, nextDocData);\r\n            return true;\r\n        }\r\n        const prevDocData = doc.data();\r\n        if (prevDocData.sceneVersion >= nextDocData.sceneVersion) {\r\n            return false;\r\n        }\r\n        transaction.update(docRef, nextDocData);\r\n        return true;\r\n    });\r\n    if (didUpdate) {\r\n        firebaseSceneVersionCache.set(socket, sceneVersion);\r\n    }\r\n    return didUpdate;\r\n};\r\nexport const loadFromFirebase = async (roomId, roomKey, socket) => {\r\n    const firebase = await loadFirestore();\r\n    const db = firebase.firestore();\r\n    const docRef = db.collection(\"scenes\").doc(roomId);\r\n    const doc = await docRef.get();\r\n    if (!doc.exists) {\r\n        return null;\r\n    }\r\n    const storedScene = doc.data();\r\n    const ciphertext = storedScene.ciphertext.toUint8Array();\r\n    const iv = storedScene.iv.toUint8Array();\r\n    const elements = await decryptElements(roomKey, iv, ciphertext);\r\n    if (socket) {\r\n        firebaseSceneVersionCache.set(socket, getSceneVersion(elements));\r\n    }\r\n    return restoreElements(elements, null);\r\n};\r\nexport const loadFilesFromFirebase = async (prefix, decryptionKey, filesIds) => {\r\n    const loadedFiles = [];\r\n    const erroredFiles = new Map();\r\n    await Promise.all([...new Set(filesIds)].map(async (id) => {\r\n        try {\r\n            const url = `https://firebasestorage.googleapis.com/v0/b/${FIREBASE_CONFIG.storageBucket}/o/${encodeURIComponent(prefix.replace(/^\\//, \"\"))}%2F${id}`;\r\n            const response = await fetch(`${url}?alt=media`);\r\n            if (response.status < 400) {\r\n                const arrayBuffer = await response.arrayBuffer();\r\n                const { data, metadata } = await decompressData(new Uint8Array(arrayBuffer), {\r\n                    decryptionKey,\r\n                });\r\n                const dataURL = new TextDecoder().decode(data);\r\n                loadedFiles.push({\r\n                    mimeType: metadata.mimeType || MIME_TYPES.binary,\r\n                    id,\r\n                    dataURL,\r\n                    created: metadata?.created || Date.now(),\r\n                });\r\n            }\r\n            else {\r\n                erroredFiles.set(id, true);\r\n            }\r\n        }\r\n        catch (error) {\r\n            erroredFiles.set(id, true);\r\n            console.error(error);\r\n        }\r\n    }));\r\n    return { loadedFiles, erroredFiles };\r\n};\r\n","import { createIV, generateEncryptionKey, getImportedKey, IV_LENGTH_BYTES, } from \"../../data/encryption\";\r\nimport { serializeAsJSON } from \"../../data/json\";\r\nimport { restore } from \"../../data/restore\";\r\nimport { isInitializedImageElement } from \"../../element/typeChecks\";\r\nimport { t } from \"../../i18n\";\r\nimport { FILE_UPLOAD_MAX_BYTES } from \"../app_constants\";\r\nimport { encodeFilesForUpload } from \"./FileManager\";\r\nimport { saveFilesToFirebase } from \"./firebase\";\r\nconst byteToHex = (byte) => `0${byte.toString(16)}`.slice(-2);\r\nconst BACKEND_V2_GET = process.env.REACT_APP_BACKEND_V2_GET_URL;\r\nconst BACKEND_V2_POST = process.env.REACT_APP_BACKEND_V2_POST_URL;\r\nconst generateRandomID = async () => {\r\n    const arr = new Uint8Array(10);\r\n    window.crypto.getRandomValues(arr);\r\n    return Array.from(arr, byteToHex).join(\"\");\r\n};\r\nexport const SOCKET_SERVER = process.env.REACT_APP_SOCKET_SERVER_URL;\r\nexport const encryptAESGEM = async (data, key) => {\r\n    const importedKey = await getImportedKey(key, \"encrypt\");\r\n    const iv = createIV();\r\n    return {\r\n        data: await window.crypto.subtle.encrypt({\r\n            name: \"AES-GCM\",\r\n            iv,\r\n        }, importedKey, data),\r\n        iv,\r\n    };\r\n};\r\nexport const decryptAESGEM = async (data, key, iv) => {\r\n    try {\r\n        const importedKey = await getImportedKey(key, \"decrypt\");\r\n        const decrypted = await window.crypto.subtle.decrypt({\r\n            name: \"AES-GCM\",\r\n            iv,\r\n        }, importedKey, data);\r\n        const decodedData = new TextDecoder(\"utf-8\").decode(new Uint8Array(decrypted));\r\n        return JSON.parse(decodedData);\r\n    }\r\n    catch (error) {\r\n        window.alert(t(\"alerts.decryptFailed\"));\r\n        console.error(error);\r\n    }\r\n    return {\r\n        type: \"INVALID_RESPONSE\",\r\n    };\r\n};\r\nexport const getCollaborationLinkData = (link) => {\r\n    const hash = new URL(link).hash;\r\n    const match = hash.match(/^#room=([a-zA-Z0-9_-]+),([a-zA-Z0-9_-]+)$/);\r\n    if (match && match[2].length !== 22) {\r\n        window.alert(t(\"alerts.invalidEncryptionKey\"));\r\n        return null;\r\n    }\r\n    return match ? { roomId: match[1], roomKey: match[2] } : null;\r\n};\r\nexport const generateCollaborationLinkData = async () => {\r\n    const roomId = await generateRandomID();\r\n    const roomKey = await generateEncryptionKey();\r\n    if (!roomKey) {\r\n        throw new Error(\"Couldn't generate room key\");\r\n    }\r\n    return { roomId, roomKey };\r\n};\r\nexport const getCollaborationLink = (data) => {\r\n    return `${window.location.origin}${window.location.pathname}#room=${data.roomId},${data.roomKey}`;\r\n};\r\nexport const decryptImported = async (iv, encrypted, privateKey) => {\r\n    const key = await getImportedKey(privateKey, \"decrypt\");\r\n    return window.crypto.subtle.decrypt({\r\n        name: \"AES-GCM\",\r\n        iv,\r\n    }, key, encrypted);\r\n};\r\nconst importFromBackend = async (id, privateKey) => {\r\n    try {\r\n        const response = await fetch(`${BACKEND_V2_GET}${id}`);\r\n        if (!response.ok) {\r\n            window.alert(t(\"alerts.importBackendFailed\"));\r\n            return {};\r\n        }\r\n        const buffer = await response.arrayBuffer();\r\n        let decrypted;\r\n        try {\r\n            // Buffer should contain both the IV (fixed length) and encrypted data\r\n            const iv = buffer.slice(0, IV_LENGTH_BYTES);\r\n            const encrypted = buffer.slice(IV_LENGTH_BYTES, buffer.byteLength);\r\n            decrypted = await decryptImported(iv, encrypted, privateKey);\r\n        }\r\n        catch (error) {\r\n            // Fixed IV (old format, backward compatibility)\r\n            const fixedIv = new Uint8Array(IV_LENGTH_BYTES);\r\n            decrypted = await decryptImported(fixedIv, buffer, privateKey);\r\n        }\r\n        // We need to convert the decrypted array buffer to a string\r\n        const string = new window.TextDecoder(\"utf-8\").decode(new Uint8Array(decrypted));\r\n        const data = JSON.parse(string);\r\n        return {\r\n            elements: data.elements || null,\r\n            appState: data.appState || null,\r\n        };\r\n    }\r\n    catch (error) {\r\n        window.alert(t(\"alerts.importBackendFailed\"));\r\n        console.error(error);\r\n        return {};\r\n    }\r\n};\r\nexport const loadScene = async (id, privateKey, \r\n// Supply local state even if importing from backend to ensure we restore\r\n// localStorage user settings which we do not persist on server.\r\n// Non-optional so we don't forget to pass it even if `undefined`.\r\nlocalDataState) => {\r\n    let data;\r\n    if (id != null && privateKey != null) {\r\n        // the private key is used to decrypt the content from the server, take\r\n        // extra care not to leak it\r\n        data = restore(await importFromBackend(id, privateKey), localDataState?.appState, localDataState?.elements);\r\n    }\r\n    else {\r\n        data = restore(localDataState || null, null, null);\r\n    }\r\n    return {\r\n        elements: data.elements,\r\n        appState: data.appState,\r\n        // note: this will always be empty because we're not storing files\r\n        // in the scene database/localStorage, and instead fetch them async\r\n        // from a different database\r\n        files: data.files,\r\n        commitToHistory: false,\r\n    };\r\n};\r\nexport const exportToBackend = async (elements, appState, files) => {\r\n    const json = serializeAsJSON(elements, appState, files, \"database\");\r\n    const encoded = new TextEncoder().encode(json);\r\n    const cryptoKey = await window.crypto.subtle.generateKey({\r\n        name: \"AES-GCM\",\r\n        length: 128,\r\n    }, true, // extractable\r\n    [\"encrypt\", \"decrypt\"]);\r\n    const iv = createIV();\r\n    // We use symmetric encryption. AES-GCM is the recommended algorithm and\r\n    // includes checks that the ciphertext has not been modified by an attacker.\r\n    const encrypted = await window.crypto.subtle.encrypt({\r\n        name: \"AES-GCM\",\r\n        iv,\r\n    }, cryptoKey, encoded);\r\n    // Concatenate IV with encrypted data (IV does not have to be secret).\r\n    const payloadBlob = new Blob([iv.buffer, encrypted]);\r\n    const payload = await new Response(payloadBlob).arrayBuffer();\r\n    // We use jwk encoding to be able to extract just the base64 encoded key.\r\n    // We will hardcode the rest of the attributes when importing back the key.\r\n    const exportedKey = await window.crypto.subtle.exportKey(\"jwk\", cryptoKey);\r\n    try {\r\n        const filesMap = new Map();\r\n        for (const element of elements) {\r\n            if (isInitializedImageElement(element) && files[element.fileId]) {\r\n                filesMap.set(element.fileId, files[element.fileId]);\r\n            }\r\n        }\r\n        const encryptionKey = exportedKey.k;\r\n        const filesToUpload = await encodeFilesForUpload({\r\n            files: filesMap,\r\n            encryptionKey,\r\n            maxBytes: FILE_UPLOAD_MAX_BYTES,\r\n        });\r\n        const response = await fetch(BACKEND_V2_POST, {\r\n            method: \"POST\",\r\n            body: payload,\r\n        });\r\n        const json = await response.json();\r\n        if (json.id) {\r\n            const url = new URL(window.location.href);\r\n            // We need to store the key (and less importantly the id) as hash instead\r\n            // of queryParam in order to never send it to the server\r\n            url.hash = `json=${json.id},${encryptionKey}`;\r\n            const urlString = url.toString();\r\n            await saveFilesToFirebase({\r\n                prefix: `/files/shareLinks/${json.id}`,\r\n                files: filesToUpload,\r\n            });\r\n            window.prompt(`${t(\"alerts.uploadedSecurly\")}`, urlString);\r\n        }\r\n        else if (json.error_class === \"RequestTooLargeError\") {\r\n            window.alert(t(\"alerts.couldNotCreateShareableLinkTooBig\"));\r\n        }\r\n        else {\r\n            window.alert(t(\"alerts.couldNotCreateShareableLink\"));\r\n        }\r\n    }\r\n    catch (error) {\r\n        console.error(error);\r\n        window.alert(t(\"alerts.couldNotCreateShareableLink\"));\r\n    }\r\n};\r\n","import { clearAppStateForLocalStorage, getDefaultAppState, } from \"../../appState\";\r\nimport { clearElementsForLocalStorage } from \"../../element\";\r\nimport { STORAGE_KEYS as APP_STORAGE_KEYS } from \"../../constants\";\r\nexport const STORAGE_KEYS = {\r\n    LOCAL_STORAGE_ELEMENTS: \"chalkboard\",\r\n    LOCAL_STORAGE_APP_STATE: \"chalkboard-state\",\r\n    LOCAL_STORAGE_COLLAB: \"chalkboard-collab\",\r\n    LOCAL_STORAGE_KEY_COLLAB_FORCE_FLAG: \"collabLinkForceLoadFlag\",\r\n};\r\nexport const saveUsernameToLocalStorage = (username) => {\r\n    try {\r\n        localStorage.setItem(STORAGE_KEYS.LOCAL_STORAGE_COLLAB, JSON.stringify({ username }));\r\n    }\r\n    catch (error) {\r\n        // Unable to access window.localStorage\r\n        console.error(error);\r\n    }\r\n};\r\nexport const importUsernameFromLocalStorage = () => {\r\n    try {\r\n        const data = localStorage.getItem(STORAGE_KEYS.LOCAL_STORAGE_COLLAB);\r\n        if (data) {\r\n            return JSON.parse(data).username;\r\n        }\r\n    }\r\n    catch (error) {\r\n        // Unable to access localStorage\r\n        console.error(error);\r\n    }\r\n    return null;\r\n};\r\nexport const saveToLocalStorage = (elements, appState) => {\r\n    try {\r\n        localStorage.setItem(STORAGE_KEYS.LOCAL_STORAGE_ELEMENTS, JSON.stringify(clearElementsForLocalStorage(elements)));\r\n        localStorage.setItem(STORAGE_KEYS.LOCAL_STORAGE_APP_STATE, JSON.stringify(clearAppStateForLocalStorage(appState)));\r\n    }\r\n    catch (error) {\r\n        // Unable to access window.localStorage\r\n        console.error(error);\r\n    }\r\n};\r\nexport const importFromLocalStorage = () => {\r\n    let savedElements = null;\r\n    let savedState = null;\r\n    try {\r\n        savedElements = localStorage.getItem(STORAGE_KEYS.LOCAL_STORAGE_ELEMENTS);\r\n        savedState = localStorage.getItem(STORAGE_KEYS.LOCAL_STORAGE_APP_STATE);\r\n    }\r\n    catch (error) {\r\n        // Unable to access localStorage\r\n        console.error(error);\r\n    }\r\n    let elements = [];\r\n    if (savedElements) {\r\n        try {\r\n            elements = clearElementsForLocalStorage(JSON.parse(savedElements));\r\n        }\r\n        catch (error) {\r\n            console.error(error);\r\n            // Do nothing because elements array is already empty\r\n        }\r\n    }\r\n    let appState = null;\r\n    if (savedState) {\r\n        try {\r\n            appState = {\r\n                ...getDefaultAppState(),\r\n                ...clearAppStateForLocalStorage(JSON.parse(savedState)),\r\n            };\r\n        }\r\n        catch (error) {\r\n            console.error(error);\r\n            // Do nothing because appState is already null\r\n        }\r\n    }\r\n    return { elements, appState };\r\n};\r\nexport const getElementsStorageSize = () => {\r\n    try {\r\n        const elements = localStorage.getItem(STORAGE_KEYS.LOCAL_STORAGE_ELEMENTS);\r\n        const elementsSize = elements?.length || 0;\r\n        return elementsSize;\r\n    }\r\n    catch (error) {\r\n        console.error(error);\r\n        return 0;\r\n    }\r\n};\r\nexport const getTotalStorageSize = () => {\r\n    try {\r\n        const appState = localStorage.getItem(STORAGE_KEYS.LOCAL_STORAGE_APP_STATE);\r\n        const collab = localStorage.getItem(STORAGE_KEYS.LOCAL_STORAGE_COLLAB);\r\n        const library = localStorage.getItem(APP_STORAGE_KEYS.LOCAL_STORAGE_LIBRARY);\r\n        const appStateSize = appState?.length || 0;\r\n        const collabSize = collab?.length || 0;\r\n        const librarySize = library?.length || 0;\r\n        return appStateSize + collabSize + librarySize + getElementsStorageSize();\r\n    }\r\n    catch (error) {\r\n        console.error(error);\r\n        return 0;\r\n    }\r\n};\r\n","import { encryptAESGEM, } from \"../data\";\r\nimport { BROADCAST, FILE_UPLOAD_TIMEOUT, SCENE } from \"../app_constants\";\r\nimport { trackEvent } from \"../../analytics\";\r\nimport { throttle } from \"lodash\";\r\nimport { newElementWith } from \"../../element/mutateElement\";\r\nclass Portal {\r\n    constructor(collab) {\r\n        this.socket = null;\r\n        this.socketInitialized = false; // we don't want the socket to emit any updates until it is fully initialized\r\n        this.roomId = null;\r\n        this.roomKey = null;\r\n        this.broadcastedElementVersions = new Map();\r\n        this.queueFileUpload = throttle(async () => {\r\n            try {\r\n                await this.collab.fileManager.saveFiles({\r\n                    elements: this.collab.excalidrawAPI.getSceneElementsIncludingDeleted(),\r\n                    files: this.collab.excalidrawAPI.getFiles(),\r\n                });\r\n            }\r\n            catch (error) {\r\n                if (error.name !== \"AbortError\") {\r\n                    this.collab.excalidrawAPI.updateScene({\r\n                        appState: {\r\n                            errorMessage: error.message,\r\n                        },\r\n                    });\r\n                }\r\n            }\r\n            this.collab.excalidrawAPI.updateScene({\r\n                elements: this.collab.excalidrawAPI\r\n                    .getSceneElementsIncludingDeleted()\r\n                    .map((element) => {\r\n                    if (this.collab.fileManager.shouldUpdateImageElementStatus(element)) {\r\n                        // this will signal collaborators to pull image data from server\r\n                        // (using mutation instead of newElementWith otherwise it'd break\r\n                        // in-progress dragging)\r\n                        return newElementWith(element, { status: \"saved\" });\r\n                    }\r\n                    return element;\r\n                }),\r\n            });\r\n        }, FILE_UPLOAD_TIMEOUT);\r\n        this.broadcastScene = async (sceneType, allElements, syncAll) => {\r\n            if (sceneType === SCENE.INIT && !syncAll) {\r\n                throw new Error(\"syncAll must be true when sending SCENE.INIT\");\r\n            }\r\n            // sync out only the elements we think we need to to save bandwidth.\r\n            // periodically we'll resync the whole thing to make sure no one diverges\r\n            // due to a dropped message (server goes down etc).\r\n            const syncableElements = allElements.reduce((acc, element, idx, elements) => {\r\n                if ((syncAll ||\r\n                    !this.broadcastedElementVersions.has(element.id) ||\r\n                    element.version >\r\n                        this.broadcastedElementVersions.get(element.id)) &&\r\n                    this.collab.isSyncableElement(element)) {\r\n                    acc.push({\r\n                        ...element,\r\n                        // z-index info for the reconciler\r\n                        parent: idx === 0 ? \"^\" : elements[idx - 1]?.id,\r\n                    });\r\n                }\r\n                return acc;\r\n            }, []);\r\n            const data = {\r\n                type: sceneType,\r\n                payload: {\r\n                    elements: syncableElements,\r\n                },\r\n            };\r\n            for (const syncableElement of syncableElements) {\r\n                this.broadcastedElementVersions.set(syncableElement.id, syncableElement.version);\r\n            }\r\n            const broadcastPromise = this._broadcastSocketData(data);\r\n            this.queueFileUpload();\r\n            if (syncAll && this.collab.isCollaborating) {\r\n                await Promise.all([\r\n                    broadcastPromise,\r\n                    this.collab.saveCollabRoomToFirebase(syncableElements),\r\n                ]);\r\n            }\r\n            else {\r\n                await broadcastPromise;\r\n            }\r\n        };\r\n        this.broadcastIdleChange = (userState) => {\r\n            if (this.socket?.id) {\r\n                const data = {\r\n                    type: \"IDLE_STATUS\",\r\n                    payload: {\r\n                        socketId: this.socket.id,\r\n                        userState,\r\n                        username: this.collab.state.username,\r\n                    },\r\n                };\r\n                return this._broadcastSocketData(data, true);\r\n            }\r\n        };\r\n        this.broadcastMouseLocation = (payload) => {\r\n            if (this.socket?.id) {\r\n                const data = {\r\n                    type: \"MOUSE_LOCATION\",\r\n                    payload: {\r\n                        socketId: this.socket.id,\r\n                        pointer: payload.pointer,\r\n                        button: payload.button || \"up\",\r\n                        selectedElementIds: this.collab.excalidrawAPI.getAppState().selectedElementIds,\r\n                        username: this.collab.state.username,\r\n                    },\r\n                };\r\n                return this._broadcastSocketData(data, true);\r\n            }\r\n        };\r\n        this.collab = collab;\r\n    }\r\n    open(socket, id, key) {\r\n        this.socket = socket;\r\n        this.roomId = id;\r\n        this.roomKey = key;\r\n        // Initialize socket listeners\r\n        this.socket.on(\"init-room\", () => {\r\n            if (this.socket) {\r\n                this.socket.emit(\"join-room\", this.roomId);\r\n                trackEvent(\"share\", \"room joined\");\r\n            }\r\n        });\r\n        this.socket.on(\"new-user\", async (_socketId) => {\r\n            this.broadcastScene(SCENE.INIT, this.collab.getSceneElementsIncludingDeleted(), \r\n            /* syncAll */ true);\r\n        });\r\n        this.socket.on(\"room-user-change\", (clients) => {\r\n            this.collab.setCollaborators(clients);\r\n        });\r\n    }\r\n    close() {\r\n        if (!this.socket) {\r\n            return;\r\n        }\r\n        this.queueFileUpload.flush();\r\n        this.socket.close();\r\n        this.socket = null;\r\n        this.roomId = null;\r\n        this.roomKey = null;\r\n        this.socketInitialized = false;\r\n        this.broadcastedElementVersions = new Map();\r\n    }\r\n    isOpen() {\r\n        return !!(this.socketInitialized &&\r\n            this.socket &&\r\n            this.roomId &&\r\n            this.roomKey);\r\n    }\r\n    async _broadcastSocketData(data, volatile = false) {\r\n        if (this.isOpen()) {\r\n            const json = JSON.stringify(data);\r\n            const encoded = new TextEncoder().encode(json);\r\n            const encrypted = await encryptAESGEM(encoded, this.roomKey);\r\n            this.socket?.emit(volatile ? BROADCAST.SERVER_VOLATILE : BROADCAST.SERVER, this.roomId, encrypted.data, encrypted.iv);\r\n        }\r\n    }\r\n}\r\nexport default Portal;\r\n","import React, { useRef } from \"react\";\r\nimport { copyTextToSystemClipboard } from \"../../clipboard\";\r\nimport { Dialog } from \"../../components/Dialog\";\r\nimport { clipboard, start, stop, share, shareIOS, shareWindows, } from \"../../components/icons\";\r\nimport { ToolButton } from \"../../components/ToolButton\";\r\nimport { t } from \"../../i18n\";\r\nimport \"./RoomDialog.scss\";\r\nimport Stack from \"../../components/Stack\";\r\nconst getShareIcon = () => {\r\n    const navigator = window.navigator;\r\n    const isAppleBrowser = /Apple/.test(navigator.vendor);\r\n    const isWindowsBrowser = navigator.appVersion.indexOf(\"Win\") !== -1;\r\n    if (isAppleBrowser) {\r\n        return shareIOS;\r\n    }\r\n    else if (isWindowsBrowser) {\r\n        return shareWindows;\r\n    }\r\n    return share;\r\n};\r\nconst RoomDialog = ({ handleClose, activeRoomLink, username, onUsernameChange, onRoomCreate, onRoomDestroy, setErrorMessage, theme, }) => {\r\n    const roomLinkInput = useRef(null);\r\n    const copyRoomLink = async () => {\r\n        try {\r\n            await copyTextToSystemClipboard(activeRoomLink);\r\n        }\r\n        catch (error) {\r\n            setErrorMessage(error.message);\r\n        }\r\n        if (roomLinkInput.current) {\r\n            roomLinkInput.current.select();\r\n        }\r\n    };\r\n    const shareRoomLink = async () => {\r\n        try {\r\n            await navigator.share({\r\n                title: t(\"roomDialog.shareTitle\"),\r\n                text: t(\"roomDialog.shareTitle\"),\r\n                url: activeRoomLink,\r\n            });\r\n        }\r\n        catch (error) {\r\n            // Just ignore.\r\n        }\r\n    };\r\n    const selectInput = (event) => {\r\n        if (event.target !== document.activeElement) {\r\n            event.preventDefault();\r\n            event.target.select();\r\n        }\r\n    };\r\n    const renderRoomDialog = () => {\r\n        return (<div className=\"RoomDialog-modal\">\r\n        {!activeRoomLink && (<>\r\n            <p>{t(\"roomDialog.desc_intro\")}</p>\r\n            <p>{` ${t(\"roomDialog.desc_privacy\")}`}</p>\r\n            <div className=\"RoomDialog-sessionStartButtonContainer\">\r\n              <ToolButton className=\"RoomDialog-startSession\" type=\"button\" icon={start} title={t(\"roomDialog.button_startSession\")} aria-label={t(\"roomDialog.button_startSession\")} showAriaLabel={true} onClick={onRoomCreate}/>\r\n            </div>\r\n          </>)}\r\n        {activeRoomLink && (<>\r\n            <p>{t(\"roomDialog.desc_inProgressIntro\")}</p>\r\n            <p>{t(\"roomDialog.desc_shareLink\")}</p>\r\n            <div className=\"RoomDialog-linkContainer\">\r\n              <Stack.Row gap={2}>\r\n                {\"share\" in navigator ? (<ToolButton type=\"button\" icon={getShareIcon()} title={t(\"labels.share\")} aria-label={t(\"labels.share\")} onClick={shareRoomLink}/>) : null}\r\n                <ToolButton type=\"button\" icon={clipboard} title={t(\"labels.copy\")} aria-label={t(\"labels.copy\")} onClick={copyRoomLink}/>\r\n              </Stack.Row>\r\n              <input value={activeRoomLink} readOnly={true} className=\"RoomDialog-link\" ref={roomLinkInput} onPointerDown={selectInput}/>\r\n            </div>\r\n            <div className=\"RoomDialog-usernameContainer\">\r\n              <label className=\"RoomDialog-usernameLabel\" htmlFor=\"username\">\r\n                {t(\"labels.yourName\")}\r\n              </label>\r\n              <input id=\"username\" value={username || \"\"} className=\"RoomDialog-username TextInput\" onChange={(event) => onUsernameChange(event.target.value)} onKeyPress={(event) => event.key === \"Enter\" && handleClose()}/>\r\n            </div>\r\n            <p>\r\n              <span role=\"img\" aria-hidden=\"true\" className=\"RoomDialog-emoji\">\r\n                {\"\"}\r\n              </span>{\" \"}\r\n              {t(\"roomDialog.desc_privacy\")}\r\n            </p>\r\n            <p>{t(\"roomDialog.desc_exitSession\")}</p>\r\n            <div className=\"RoomDialog-sessionStartButtonContainer\">\r\n              <ToolButton className=\"RoomDialog-stopSession\" type=\"button\" icon={stop} title={t(\"roomDialog.button_stopSession\")} aria-label={t(\"roomDialog.button_stopSession\")} showAriaLabel={true} onClick={onRoomDestroy}/>\r\n            </div>\r\n          </>)}\r\n      </div>);\r\n    };\r\n    return (<Dialog small onCloseRequest={handleClose} title={t(\"labels.liveCollaboration\")} theme={theme}>\r\n      {renderRoomDialog()}\r\n    </Dialog>);\r\n};\r\nexport default RoomDialog;\r\n","const shouldDiscardRemoteElement = (localAppState, local, remote) => {\r\n    if (local &&\r\n        // local element is being edited\r\n        (local.id === localAppState.editingElement?.id ||\r\n            local.id === localAppState.resizingElement?.id ||\r\n            local.id === localAppState.draggingElement?.id ||\r\n            // local element is newer\r\n            local.version > remote.version ||\r\n            // resolve conflicting edits deterministically by taking the one with\r\n            // the lowest versionNonce\r\n            (local.version === remote.version &&\r\n                local.versionNonce < remote.versionNonce))) {\r\n        return true;\r\n    }\r\n    return false;\r\n};\r\nconst getElementsMapWithIndex = (elements) => elements.reduce((acc, element, idx) => {\r\n    acc[element.id] = [element, idx];\r\n    return acc;\r\n}, {});\r\nexport const reconcileElements = (localElements, remoteElements, localAppState) => {\r\n    const localElementsData = getElementsMapWithIndex(localElements);\r\n    const reconciledElements = localElements.slice();\r\n    const duplicates = new WeakMap();\r\n    let cursor = 0;\r\n    let offset = 0;\r\n    let remoteElementIdx = -1;\r\n    for (const remoteElement of remoteElements) {\r\n        remoteElementIdx++;\r\n        const local = localElementsData[remoteElement.id];\r\n        if (shouldDiscardRemoteElement(localAppState, local?.[0], remoteElement)) {\r\n            if (remoteElement.parent) {\r\n                delete remoteElement.parent;\r\n            }\r\n            continue;\r\n        }\r\n        if (local) {\r\n            // mark for removal since it'll be replaced with the remote element\r\n            duplicates.set(local[0], true);\r\n        }\r\n        // parent may not be defined in case the remote client is running an older\r\n        // excalidraw version\r\n        const parent = remoteElement.parent || remoteElements[remoteElementIdx - 1]?.id || null;\r\n        if (parent != null) {\r\n            delete remoteElement.parent;\r\n            // ^ indicates the element is the first in elements array\r\n            if (parent === \"^\") {\r\n                offset++;\r\n                if (cursor === 0) {\r\n                    reconciledElements.unshift(remoteElement);\r\n                    localElementsData[remoteElement.id] = [\r\n                        remoteElement,\r\n                        cursor - offset,\r\n                    ];\r\n                }\r\n                else {\r\n                    reconciledElements.splice(cursor + 1, 0, remoteElement);\r\n                    localElementsData[remoteElement.id] = [\r\n                        remoteElement,\r\n                        cursor + 1 - offset,\r\n                    ];\r\n                    cursor++;\r\n                }\r\n            }\r\n            else {\r\n                let idx = localElementsData[parent]\r\n                    ? localElementsData[parent][1]\r\n                    : null;\r\n                if (idx != null) {\r\n                    idx += offset;\r\n                }\r\n                if (idx != null && idx >= cursor) {\r\n                    reconciledElements.splice(idx + 1, 0, remoteElement);\r\n                    offset++;\r\n                    localElementsData[remoteElement.id] = [\r\n                        remoteElement,\r\n                        idx + 1 - offset,\r\n                    ];\r\n                    cursor = idx + 1;\r\n                }\r\n                else if (idx != null) {\r\n                    reconciledElements.splice(cursor + 1, 0, remoteElement);\r\n                    offset++;\r\n                    localElementsData[remoteElement.id] = [\r\n                        remoteElement,\r\n                        cursor + 1 - offset,\r\n                    ];\r\n                    cursor++;\r\n                }\r\n                else {\r\n                    reconciledElements.push(remoteElement);\r\n                    localElementsData[remoteElement.id] = [\r\n                        remoteElement,\r\n                        reconciledElements.length - 1 - offset,\r\n                    ];\r\n                }\r\n            }\r\n            // no parent z-index information, local element exists  replace in place\r\n        }\r\n        else if (local) {\r\n            reconciledElements[local[1]] = remoteElement;\r\n            localElementsData[remoteElement.id] = [remoteElement, local[1]];\r\n            // otherwise push to the end\r\n        }\r\n        else {\r\n            reconciledElements.push(remoteElement);\r\n            localElementsData[remoteElement.id] = [\r\n                remoteElement,\r\n                reconciledElements.length - 1 - offset,\r\n            ];\r\n        }\r\n    }\r\n    const ret = reconciledElements.filter((element) => !duplicates.has(element));\r\n    return ret;\r\n};\r\n","import throttle from \"lodash.throttle\";\r\nimport { PureComponent } from \"react\";\r\nimport { ErrorDialog } from \"../../components/ErrorDialog\";\r\nimport { APP_NAME, ENV, EVENT } from \"../../constants\";\r\nimport { getSceneVersion } from \"../../packages/excalidraw/index\";\r\nimport {\r\n  preventUnload,\r\n  resolvablePromise,\r\n  withBatchedUpdates,\r\n} from \"../../utils\";\r\nimport {\r\n  FILE_UPLOAD_MAX_BYTES,\r\n  FIREBASE_STORAGE_PREFIXES,\r\n  INITIAL_SCENE_UPDATE_TIMEOUT,\r\n  LOAD_IMAGES_TIMEOUT,\r\n  SCENE,\r\n  SYNC_FULL_SCENE_INTERVAL_MS,\r\n} from \"../app_constants\";\r\nimport {\r\n  decryptAESGEM,\r\n  generateCollaborationLinkData,\r\n  getCollaborationLink,\r\n  SOCKET_SERVER,\r\n} from \"../data\";\r\nimport {\r\n  isSavedToFirebase,\r\n  loadFilesFromFirebase,\r\n  loadFromFirebase,\r\n  saveFilesToFirebase,\r\n  saveToFirebase,\r\n} from \"../data/firebase\";\r\nimport {\r\n  importUsernameFromLocalStorage,\r\n  saveUsernameToLocalStorage,\r\n  STORAGE_KEYS,\r\n} from \"../data/localStorage\";\r\nimport Portal from \"./Portal\";\r\nimport RoomDialog from \"./RoomDialog\";\r\nimport { createInverseContext } from \"../../createInverseContext\";\r\nimport { t } from \"../../i18n\";\r\nimport { UserIdleState } from \"../../types\";\r\nimport { IDLE_THRESHOLD, ACTIVE_THRESHOLD } from \"../../constants\";\r\nimport { trackEvent } from \"../../analytics\";\r\nimport { isInvisiblySmallElement } from \"../../element\";\r\nimport {\r\n  encodeFilesForUpload,\r\n  FileManager,\r\n  updateStaleImageStatuses,\r\n} from \"../data/FileManager\";\r\nimport { AbortError } from \"../../errors\";\r\nimport {\r\n  isImageElement,\r\n  isInitializedImageElement,\r\n} from \"../../element/typeChecks\";\r\nimport { newElementWith } from \"../../element/mutateElement\";\r\nimport { reconcileElements as _reconcileElements } from \"./reconciliation\";\r\nconst {\r\n  Context: CollabContext,\r\n  Consumer: CollabContextConsumer,\r\n  Provider: CollabContextProvider,\r\n} = createInverseContext({ api: null });\r\nexport { CollabContext, CollabContextConsumer };\r\nclass CollabWrapper extends PureComponent {\r\n  constructor(props) {\r\n    super(props);\r\n    this.isCollaborating = false;\r\n    this.lastBroadcastedOrReceivedSceneVersion = -1;\r\n    this.collaborators = new Map();\r\n    this.onUnload = () => {\r\n      this.destroySocketClient({ isUnload: true });\r\n    };\r\n    this.beforeUnload = withBatchedUpdates((event) => {\r\n      const syncableElements = this.getSyncableElements(\r\n        this.getSceneElementsIncludingDeleted()\r\n      );\r\n      if (\r\n        this.isCollaborating &&\r\n        (this.fileManager.shouldPreventUnload(syncableElements) ||\r\n          !isSavedToFirebase(this.portal, syncableElements))\r\n      ) {\r\n        // this won't run in time if user decides to leave the site, but\r\n        //  the purpose is to run in immediately after user decides to stay\r\n        this.saveCollabRoomToFirebase(syncableElements);\r\n        preventUnload(event);\r\n      }\r\n      if (this.isCollaborating || this.portal.roomId) {\r\n        try {\r\n          localStorage?.setItem(\r\n            STORAGE_KEYS.LOCAL_STORAGE_KEY_COLLAB_FORCE_FLAG,\r\n            JSON.stringify({\r\n              timestamp: Date.now(),\r\n              room: this.portal.roomId,\r\n            })\r\n          );\r\n        } catch {}\r\n      }\r\n    });\r\n    this.saveCollabRoomToFirebase = async (\r\n      syncableElements = this.getSyncableElements(\r\n        this.excalidrawAPI.getSceneElementsIncludingDeleted()\r\n      )\r\n    ) => {\r\n      try {\r\n        await saveToFirebase(this.portal, syncableElements);\r\n      } catch (error) {\r\n        console.error(error);\r\n      }\r\n    };\r\n    this.openPortal = async () => {\r\n      trackEvent(\"share\", \"room creation\");\r\n      return this.initializeSocketClient(null);\r\n    };\r\n    this.closePortal = () => {\r\n      this.queueBroadcastAllElements.cancel();\r\n      this.loadImageFiles.cancel();\r\n      this.saveCollabRoomToFirebase();\r\n      if (window.confirm(t(\"alerts.collabStopOverridePrompt\"))) {\r\n        window.history.pushState({}, APP_NAME, window.location.origin);\r\n        this.destroySocketClient();\r\n        trackEvent(\"share\", \"room closed\");\r\n        this.props.onRoomClose?.();\r\n        const elements = this.excalidrawAPI\r\n          .getSceneElementsIncludingDeleted()\r\n          .map((element) => {\r\n            if (isImageElement(element) && element.status === \"saved\") {\r\n              return newElementWith(element, { status: \"pending\" });\r\n            }\r\n            return element;\r\n          });\r\n        this.excalidrawAPI.updateScene({\r\n          elements,\r\n          commitToHistory: false,\r\n        });\r\n      }\r\n    };\r\n    this.destroySocketClient = (opts) => {\r\n      if (!opts?.isUnload) {\r\n        this.collaborators = new Map();\r\n        this.excalidrawAPI.updateScene({\r\n          collaborators: this.collaborators,\r\n        });\r\n        this.setState({\r\n          activeRoomLink: \"\",\r\n        });\r\n        this.isCollaborating = false;\r\n      }\r\n      this.lastBroadcastedOrReceivedSceneVersion = -1;\r\n      this.portal.close();\r\n      this.fileManager.reset();\r\n    };\r\n    this.fetchImageFilesFromFirebase = async (scene) => {\r\n      const unfetchedImages = scene.elements\r\n        .filter((element) => {\r\n          return (\r\n            isInitializedImageElement(element) &&\r\n            !this.fileManager.isFileHandled(element.fileId) &&\r\n            !element.isDeleted &&\r\n            element.status === \"saved\"\r\n          );\r\n        })\r\n        .map((element) => element.fileId);\r\n      return await this.fileManager.getFiles(unfetchedImages);\r\n    };\r\n    this.initializeSocketClient = async (existingRoomLinkData) => {\r\n      if (this.portal.socket) {\r\n        return null;\r\n      }\r\n      let roomId;\r\n      let roomKey;\r\n      if (existingRoomLinkData) {\r\n        ({ roomId, roomKey } = existingRoomLinkData);\r\n      } else {\r\n        ({ roomId, roomKey } = await generateCollaborationLinkData());\r\n        window.history.pushState(\r\n          {},\r\n          APP_NAME,\r\n          getCollaborationLink({ roomId, roomKey })\r\n        );\r\n      }\r\n      const scenePromise = resolvablePromise();\r\n      this.isCollaborating = true;\r\n      const { default: socketIOClient } = await import(\r\n        /* webpackChunkName: \"socketIoClient\" */ \"socket.io-client\"\r\n      );\r\n      this.portal.open(socketIOClient(SOCKET_SERVER), roomId, roomKey);\r\n      if (existingRoomLinkData) {\r\n        this.excalidrawAPI.resetScene();\r\n        try {\r\n          const elements = await loadFromFirebase(\r\n            roomId,\r\n            roomKey,\r\n            this.portal.socket\r\n          );\r\n          if (elements) {\r\n            scenePromise.resolve({\r\n              elements,\r\n              scrollToContent: true,\r\n            });\r\n          }\r\n        } catch (error) {\r\n          // log the error and move on. other peers will sync us the scene.\r\n          console.error(error);\r\n        }\r\n      } else {\r\n        const elements = this.excalidrawAPI\r\n          .getSceneElements()\r\n          .map((element) => {\r\n            if (isImageElement(element) && element.status === \"saved\") {\r\n              return newElementWith(element, { status: \"pending\" });\r\n            }\r\n            return element;\r\n          });\r\n        // remove deleted elements from elements array & history to ensure we don't\r\n        // expose potentially sensitive user data in case user manually deletes\r\n        // existing elements (or clears scene), which would otherwise be persisted\r\n        // to database even if deleted before creating the room.\r\n        this.excalidrawAPI.history.clear();\r\n        this.excalidrawAPI.updateScene({\r\n          elements,\r\n          commitToHistory: true,\r\n        });\r\n        this.broadcastElements(elements);\r\n        const syncableElements = this.getSyncableElements(elements);\r\n        this.saveCollabRoomToFirebase(syncableElements);\r\n      }\r\n      // fallback in case you're not alone in the room but still don't receive\r\n      // initial SCENE_UPDATE message\r\n      this.socketInitializationTimer = window.setTimeout(() => {\r\n        this.initializeSocket();\r\n        scenePromise.resolve(null);\r\n      }, INITIAL_SCENE_UPDATE_TIMEOUT);\r\n      // All socket listeners are moving to Portal\r\n      this.portal.socket.on(\"client-broadcast\", async (encryptedData, iv) => {\r\n        if (!this.portal.roomKey) {\r\n          return;\r\n        }\r\n        const decryptedData = await decryptAESGEM(\r\n          encryptedData,\r\n          this.portal.roomKey,\r\n          iv\r\n        );\r\n        switch (decryptedData.type) {\r\n          case \"INVALID_RESPONSE\":\r\n            return;\r\n          case SCENE.INIT: {\r\n            if (!this.portal.socketInitialized) {\r\n              this.initializeSocket();\r\n              const remoteElements = decryptedData.payload.elements;\r\n              const reconciledElements = this.reconcileElements(remoteElements);\r\n              this.handleRemoteSceneUpdate(reconciledElements, {\r\n                init: true,\r\n              });\r\n              // noop if already resolved via init from firebase\r\n              scenePromise.resolve({\r\n                elements: reconciledElements,\r\n                scrollToContent: true,\r\n              });\r\n            }\r\n            break;\r\n          }\r\n          case SCENE.UPDATE:\r\n            this.handleRemoteSceneUpdate(\r\n              this.reconcileElements(decryptedData.payload.elements)\r\n            );\r\n            break;\r\n          case \"MOUSE_LOCATION\": {\r\n            const { pointer, button, username, selectedElementIds } =\r\n              decryptedData.payload;\r\n            const socketId =\r\n              decryptedData.payload.socketId ||\r\n              // @ts-ignore legacy, see #2094 (#2097)\r\n              decryptedData.payload.socketID;\r\n            const collaborators = new Map(this.collaborators);\r\n            const user = collaborators.get(socketId) || {};\r\n            user.pointer = pointer;\r\n            user.button = button;\r\n            user.selectedElementIds = selectedElementIds;\r\n            user.username = username;\r\n            collaborators.set(socketId, user);\r\n            this.excalidrawAPI.updateScene({\r\n              collaborators,\r\n            });\r\n            break;\r\n          }\r\n          case \"IDLE_STATUS\": {\r\n            const { userState, socketId, username } = decryptedData.payload;\r\n            const collaborators = new Map(this.collaborators);\r\n            const user = collaborators.get(socketId) || {};\r\n            user.userState = userState;\r\n            user.username = username;\r\n            this.excalidrawAPI.updateScene({\r\n              collaborators,\r\n            });\r\n            break;\r\n          }\r\n        }\r\n      });\r\n      this.portal.socket.on(\"first-in-room\", () => {\r\n        if (this.portal.socket) {\r\n          this.portal.socket.off(\"first-in-room\");\r\n        }\r\n        this.initializeSocket();\r\n        scenePromise.resolve(null);\r\n      });\r\n      this.initializeIdleDetector();\r\n      this.setState({\r\n        activeRoomLink: window.location.href,\r\n      });\r\n      return scenePromise;\r\n    };\r\n    this.initializeSocket = () => {\r\n      this.portal.socketInitialized = true;\r\n      clearTimeout(this.socketInitializationTimer);\r\n    };\r\n    this.reconcileElements = (remoteElements) => {\r\n      const localElements = this.getSceneElementsIncludingDeleted();\r\n      const appState = this.excalidrawAPI.getAppState();\r\n      const reconciledElements = _reconcileElements(\r\n        localElements,\r\n        remoteElements,\r\n        appState\r\n      );\r\n      // Avoid broadcasting to the rest of the collaborators the scene\r\n      // we just received!\r\n      // Note: this needs to be set before updating the scene as it\r\n      // synchronously calls render.\r\n      this.setLastBroadcastedOrReceivedSceneVersion(\r\n        getSceneVersion(reconciledElements)\r\n      );\r\n      return reconciledElements;\r\n    };\r\n    this.loadImageFiles = throttle(async () => {\r\n      const { loadedFiles, erroredFiles } =\r\n        await this.fetchImageFilesFromFirebase({\r\n          elements: this.excalidrawAPI.getSceneElementsIncludingDeleted(),\r\n        });\r\n      this.excalidrawAPI.addFiles(loadedFiles);\r\n      updateStaleImageStatuses({\r\n        excalidrawAPI: this.excalidrawAPI,\r\n        erroredFiles,\r\n        elements: this.excalidrawAPI.getSceneElementsIncludingDeleted(),\r\n      });\r\n    }, LOAD_IMAGES_TIMEOUT);\r\n    this.handleRemoteSceneUpdate = (elements, { init = false } = {}) => {\r\n      this.excalidrawAPI.updateScene({\r\n        elements,\r\n        commitToHistory: !!init,\r\n      });\r\n      // We haven't yet implemented multiplayer undo functionality, so we clear the undo stack\r\n      // when we receive any messages from another peer. This UX can be pretty rough -- if you\r\n      // undo, a user makes a change, and then try to redo, your element(s) will be lost. However,\r\n      // right now we think this is the right tradeoff.\r\n      this.excalidrawAPI.history.clear();\r\n      this.loadImageFiles();\r\n    };\r\n    this.onPointerMove = () => {\r\n      if (this.idleTimeoutId) {\r\n        window.clearTimeout(this.idleTimeoutId);\r\n        this.idleTimeoutId = null;\r\n      }\r\n      this.idleTimeoutId = window.setTimeout(this.reportIdle, IDLE_THRESHOLD);\r\n      if (!this.activeIntervalId) {\r\n        this.activeIntervalId = window.setInterval(\r\n          this.reportActive,\r\n          ACTIVE_THRESHOLD\r\n        );\r\n      }\r\n    };\r\n    this.onVisibilityChange = () => {\r\n      if (document.hidden) {\r\n        if (this.idleTimeoutId) {\r\n          window.clearTimeout(this.idleTimeoutId);\r\n          this.idleTimeoutId = null;\r\n        }\r\n        if (this.activeIntervalId) {\r\n          window.clearInterval(this.activeIntervalId);\r\n          this.activeIntervalId = null;\r\n        }\r\n        this.onIdleStateChange(UserIdleState.AWAY);\r\n      } else {\r\n        this.idleTimeoutId = window.setTimeout(this.reportIdle, IDLE_THRESHOLD);\r\n        this.activeIntervalId = window.setInterval(\r\n          this.reportActive,\r\n          ACTIVE_THRESHOLD\r\n        );\r\n        this.onIdleStateChange(UserIdleState.ACTIVE);\r\n      }\r\n    };\r\n    this.reportIdle = () => {\r\n      this.onIdleStateChange(UserIdleState.IDLE);\r\n      if (this.activeIntervalId) {\r\n        window.clearInterval(this.activeIntervalId);\r\n        this.activeIntervalId = null;\r\n      }\r\n    };\r\n    this.reportActive = () => {\r\n      this.onIdleStateChange(UserIdleState.ACTIVE);\r\n    };\r\n    this.initializeIdleDetector = () => {\r\n      document.addEventListener(EVENT.POINTER_MOVE, this.onPointerMove);\r\n      document.addEventListener(\r\n        EVENT.VISIBILITY_CHANGE,\r\n        this.onVisibilityChange\r\n      );\r\n    };\r\n    this.setLastBroadcastedOrReceivedSceneVersion = (version) => {\r\n      this.lastBroadcastedOrReceivedSceneVersion = version;\r\n    };\r\n    this.getLastBroadcastedOrReceivedSceneVersion = () => {\r\n      return this.lastBroadcastedOrReceivedSceneVersion;\r\n    };\r\n    this.getSceneElementsIncludingDeleted = () => {\r\n      return this.excalidrawAPI.getSceneElementsIncludingDeleted();\r\n    };\r\n    this.onPointerUpdate = (payload) => {\r\n      payload.pointersMap.size < 2 &&\r\n        this.portal.socket &&\r\n        this.portal.broadcastMouseLocation(payload);\r\n    };\r\n    this.onIdleStateChange = (userState) => {\r\n      this.setState({ userState });\r\n      this.portal.broadcastIdleChange(userState);\r\n    };\r\n    this.broadcastElements = (elements) => {\r\n      if (\r\n        getSceneVersion(elements) >\r\n        this.getLastBroadcastedOrReceivedSceneVersion()\r\n      ) {\r\n        this.portal.broadcastScene(SCENE.UPDATE, elements, false);\r\n        this.lastBroadcastedOrReceivedSceneVersion = getSceneVersion(elements);\r\n        this.queueBroadcastAllElements();\r\n      }\r\n    };\r\n    this.queueBroadcastAllElements = throttle(() => {\r\n      this.portal.broadcastScene(\r\n        SCENE.UPDATE,\r\n        this.excalidrawAPI.getSceneElementsIncludingDeleted(),\r\n        true\r\n      );\r\n      const currentVersion = this.getLastBroadcastedOrReceivedSceneVersion();\r\n      const newVersion = Math.max(\r\n        currentVersion,\r\n        getSceneVersion(this.getSceneElementsIncludingDeleted())\r\n      );\r\n      this.setLastBroadcastedOrReceivedSceneVersion(newVersion);\r\n    }, SYNC_FULL_SCENE_INTERVAL_MS);\r\n    this.handleClose = () => {\r\n      this.setState({ modalIsShown: false });\r\n    };\r\n    this.onUsernameChange = (username) => {\r\n      this.setState({ username });\r\n      saveUsernameToLocalStorage(username);\r\n    };\r\n    this.onCollabButtonClick = () => {\r\n      this.setState({\r\n        modalIsShown: true,\r\n      });\r\n    };\r\n    this.isSyncableElement = (element) => {\r\n      return element.isDeleted || !isInvisiblySmallElement(element);\r\n    };\r\n    this.getSyncableElements = (elements) =>\r\n      elements.filter((element) => this.isSyncableElement(element));\r\n    /** PRIVATE. Use `this.getContextValue()` instead. */\r\n    this.contextValue = null;\r\n    /** Getter of context value. Returned object is stable. */\r\n    this.getContextValue = () => {\r\n      if (!this.contextValue) {\r\n        this.contextValue = {};\r\n      }\r\n      this.contextValue.isCollaborating = () => this.isCollaborating;\r\n      this.contextValue.username = this.state.username;\r\n      this.contextValue.onPointerUpdate = this.onPointerUpdate;\r\n      this.contextValue.initializeSocketClient = this.initializeSocketClient;\r\n      this.contextValue.onCollabButtonClick = this.onCollabButtonClick;\r\n      this.contextValue.broadcastElements = this.broadcastElements;\r\n      this.contextValue.fetchImageFilesFromFirebase =\r\n        this.fetchImageFilesFromFirebase;\r\n      return this.contextValue;\r\n    };\r\n    this.state = {\r\n      modalIsShown: false,\r\n      errorMessage: \"\",\r\n      username: importUsernameFromLocalStorage() || \"\",\r\n      userState: UserIdleState.ACTIVE,\r\n      activeRoomLink: \"\",\r\n    };\r\n    this.portal = new Portal(this);\r\n    this.fileManager = new FileManager({\r\n      getFiles: async (fileIds) => {\r\n        const { roomId, roomKey } = this.portal;\r\n        if (!roomId || !roomKey) {\r\n          throw new AbortError();\r\n        }\r\n        return loadFilesFromFirebase(`files/rooms/${roomId}`, roomKey, fileIds);\r\n      },\r\n      saveFiles: async ({ addedFiles }) => {\r\n        const { roomId, roomKey } = this.portal;\r\n        if (!roomId || !roomKey) {\r\n          throw new AbortError();\r\n        }\r\n        return saveFilesToFirebase({\r\n          prefix: `${FIREBASE_STORAGE_PREFIXES.collabFiles}/${roomId}`,\r\n          files: await encodeFilesForUpload({\r\n            files: addedFiles,\r\n            encryptionKey: roomKey,\r\n            maxBytes: FILE_UPLOAD_MAX_BYTES,\r\n          }),\r\n        });\r\n      },\r\n    });\r\n    this.excalidrawAPI = props.excalidrawAPI;\r\n    this.activeIntervalId = null;\r\n    this.idleTimeoutId = null;\r\n  }\r\n  componentDidMount() {\r\n    window.addEventListener(EVENT.BEFORE_UNLOAD, this.beforeUnload);\r\n    window.addEventListener(EVENT.UNLOAD, this.onUnload);\r\n    if (\r\n      process.env.NODE_ENV === ENV.TEST ||\r\n      process.env.NODE_ENV === ENV.DEVELOPMENT\r\n    ) {\r\n      window.collab = window.collab || {};\r\n      Object.defineProperties(window, {\r\n        collab: {\r\n          configurable: true,\r\n          value: this,\r\n        },\r\n      });\r\n    }\r\n  }\r\n  componentWillUnmount() {\r\n    window.removeEventListener(EVENT.BEFORE_UNLOAD, this.beforeUnload);\r\n    window.removeEventListener(EVENT.UNLOAD, this.onUnload);\r\n    window.removeEventListener(EVENT.POINTER_MOVE, this.onPointerMove);\r\n    window.removeEventListener(\r\n      EVENT.VISIBILITY_CHANGE,\r\n      this.onVisibilityChange\r\n    );\r\n    if (this.activeIntervalId) {\r\n      window.clearInterval(this.activeIntervalId);\r\n      this.activeIntervalId = null;\r\n    }\r\n    if (this.idleTimeoutId) {\r\n      window.clearTimeout(this.idleTimeoutId);\r\n      this.idleTimeoutId = null;\r\n    }\r\n  }\r\n  setCollaborators(sockets) {\r\n    this.setState((state) => {\r\n      const collaborators = new Map();\r\n      for (const socketId of sockets) {\r\n        if (this.collaborators.has(socketId)) {\r\n          collaborators.set(socketId, this.collaborators.get(socketId));\r\n        } else {\r\n          collaborators.set(socketId, {});\r\n        }\r\n      }\r\n      this.collaborators = collaborators;\r\n      this.excalidrawAPI.updateScene({ collaborators });\r\n    });\r\n  }\r\n  render() {\r\n    const { modalIsShown, username, errorMessage, activeRoomLink } = this.state;\r\n    return (\r\n      <>\r\n        {modalIsShown && (\r\n          <RoomDialog\r\n            handleClose={this.handleClose}\r\n            activeRoomLink={activeRoomLink}\r\n            username={username}\r\n            onUsernameChange={this.onUsernameChange}\r\n            onRoomCreate={this.openPortal}\r\n            onRoomDestroy={this.closePortal}\r\n            setErrorMessage={(errorMessage) => {\r\n              this.setState({ errorMessage });\r\n            }}\r\n            theme={this.excalidrawAPI.getAppState().theme}\r\n          />\r\n        )}\r\n        {errorMessage && (\r\n          <ErrorDialog\r\n            message={errorMessage}\r\n            onClose={() => this.setState({ errorMessage: \"\" })}\r\n          />\r\n        )}\r\n        <CollabContextProvider\r\n          value={{\r\n            api: this.getContextValue(),\r\n          }}\r\n        />\r\n      </>\r\n    );\r\n  }\r\n}\r\nif (\r\n  process.env.NODE_ENV === ENV.TEST ||\r\n  process.env.NODE_ENV === ENV.DEVELOPMENT\r\n) {\r\n  window.collab = window.collab || {};\r\n}\r\nexport default CollabWrapper;\r\n","import React from \"react\";\r\nexport const createInverseContext = (initialValue) => {\r\n    const Context = React.createContext(initialValue);\r\n    class InverseConsumer extends React.Component {\r\n        constructor(props) {\r\n            super(props);\r\n            this.state = { value: initialValue };\r\n            Context._updateProviderValue = (value) => this.setState({ value });\r\n        }\r\n        render() {\r\n            return (<Context.Provider value={this.state.value}>\r\n          {this.props.children}\r\n        </Context.Provider>);\r\n        }\r\n    }\r\n    class InverseProvider extends React.Component {\r\n        componentDidMount() {\r\n            Context._updateProviderValue?.(this.props.value);\r\n        }\r\n        componentDidUpdate() {\r\n            Context._updateProviderValue?.(this.props.value);\r\n        }\r\n        render() {\r\n            return <Context.Consumer>{() => this.props.children}</Context.Consumer>;\r\n        }\r\n    }\r\n    return {\r\n        Context,\r\n        Consumer: InverseConsumer,\r\n        Provider: InverseProvider,\r\n    };\r\n};\r\n","import { useEffect, useState } from \"react\";\r\nimport { debounce, getVersion, nFormatter } from \"../utils\";\r\nimport { getElementsStorageSize, getTotalStorageSize, } from \"./data/localStorage\";\r\nimport { DEFAULT_VERSION } from \"../constants\";\r\nimport { t } from \"../i18n\";\r\nimport { copyTextToSystemClipboard } from \"../clipboard\";\r\nconst STORAGE_SIZE_TIMEOUT = 500;\r\nconst getStorageSizes = debounce((cb) => {\r\n    cb({\r\n        scene: getElementsStorageSize(),\r\n        total: getTotalStorageSize(),\r\n    });\r\n}, STORAGE_SIZE_TIMEOUT);\r\nconst CustomStats = (props) => {\r\n    const [storageSizes, setStorageSizes] = useState({\r\n        scene: 0,\r\n        total: 0,\r\n    });\r\n    useEffect(() => {\r\n        getStorageSizes((sizes) => {\r\n            setStorageSizes(sizes);\r\n        });\r\n    });\r\n    useEffect(() => () => getStorageSizes.cancel(), []);\r\n    const version = getVersion();\r\n    let hash;\r\n    let timestamp;\r\n    if (version !== DEFAULT_VERSION) {\r\n        timestamp = version.slice(0, 16).replace(\"T\", \" \");\r\n        hash = version.slice(21);\r\n    }\r\n    else {\r\n        timestamp = t(\"stats.versionNotAvailable\");\r\n    }\r\n    return (<>\r\n      <tr>\r\n        <th colSpan={2}>{t(\"stats.storage\")}</th>\r\n      </tr>\r\n      <tr>\r\n        <td>{t(\"stats.scene\")}</td>\r\n        <td>{nFormatter(storageSizes.scene, 1)}</td>\r\n      </tr>\r\n      <tr>\r\n        <td>{t(\"stats.total\")}</td>\r\n        <td>{nFormatter(storageSizes.total, 1)}</td>\r\n      </tr>\r\n      <tr>\r\n        <th colSpan={2}>{t(\"stats.version\")}</th>\r\n      </tr>\r\n      <tr>\r\n        <td colSpan={2} style={{ textAlign: \"center\", cursor: \"pointer\" }} onClick={async () => {\r\n            try {\r\n                await copyTextToSystemClipboard(getVersion());\r\n                props.setToastMessage(t(\"toast.copyToClipboard\"));\r\n            }\r\n            catch { }\r\n        }} title={t(\"stats.versionCopy\")}>\r\n          {timestamp}\r\n          <br />\r\n          {hash}\r\n        </td>\r\n      </tr>\r\n    </>);\r\n};\r\nexport default CustomStats;\r\n","import { createIcon } from \"../../components/icons\";\r\nexport const excalidrawPlusIcon = createIcon(<>\r\n    <path d=\"M72.652 63.598c-1.368.91-1.191 2.833-.953 4.572.702 5.104.47 5.323 1.073 7.016.649 1.826.433 2.553-.08 3.292-.406.588-1.207 1.371-1.906 1.516-.98.204-2.967.01-3.922-.246-.643-.174-1.292-.94-1.598-1.53-.389-.751-1.256-1.951-.694-3.593.56-1.64 1.325-5.374 1.363-6.108.098-1.904.02-3.934-1.085-5.014-1.104-1.082-3.941-1.055-5.739-1.038-1.723.017-3.583 1.207-5.045 1.141-1.343-.061-2.939-.686-3.728-1.536-.79-.852-1.082-2.469-1.007-3.57.074-1.1.726-2.398 1.454-3.033.727-.635 1.91-.867 2.909-.777 1.472.13 4.1 1.342 5.928 1.564 1.67.203 4.016.501 5.04-.227 1.021-.73 1.048-2.717 1.094-4.145.07-2.063-1.021-6.528-.683-8.23.22-1.098 1.709-1.696 2.717-1.979 1.007-.282 2.521-.125 3.328.285.788.398 1.499 1.29 1.516 2.173.031 1.68-1.209 5.66-1.322 7.905-.058 1.133-.61 3.124.482 3.764 1.264.74 2.95 1.778 7.1.673 1.765-.47 3.157-.689 4.62-.622 1.342.06 2.939.685 3.728 1.536.787.85 1.08 2.468 1.006 3.568-.074 1.101-.726 2.4-1.454 3.035-.727.634-1.908.866-2.908.777-1.473-.13-3.164-.68-4.88-1.248-2.526-.835-5.176-.708-6.354.079z\" fill=\"currentColor\"/>\r\n    <path d=\"M51.396 25.807c0 .237-.285.474-.617.474-.284 0-1.09 1.328-1.708 2.941-1.897 4.934-20.873 42.46-20.92 41.273 0-.616-.285-1.043-.76-1.043-.664 0-.759.38-.474 2.23.284 2.134.095 2.609-6.642 15.702-3.795 7.448-7.875 15.228-9.06 17.316-1.234 2.182-2.183 4.554-2.278 5.55-.142 1.708.047 1.945 4.175 5.503 2.372 2.088 5.408 4.697 6.736 5.883 5.978 5.456 8.777 7.638 9.536 7.496 1.138-.19 18.739-18.644 18.786-19.688 0-.475-.854-7.685-1.898-16.035-1.802-14.232-3.51-30.884-3.32-32.497.142-.996-.57-6.024-1.092-8.207-.426-1.708-.237-2.42 3.179-10.2 1.992-4.601 4.602-10.247 5.74-12.524 1.091-2.277 2.04-4.27 2.04-4.412 0-.142-.332-.237-.711-.237-.38 0-.712.19-.712.475zM40.485 61.245c.522 3.32 1.565 11.29 2.324 17.695 1.47 11.765 3.179 24.811 3.653 28.132.285 1.66.095 1.992-2.989 5.408-5.36 6.025-11.053 11.955-12.998 13.473l-1.803 1.423-9.25-8.634c-8.54-7.875-9.252-8.681-8.73-9.63.285-.522 2.704-4.934 5.361-9.773 2.657-4.839 6.167-11.29 7.78-14.327 1.66-3.084 3.179-5.74 3.463-5.882.332-.19.427 4.601.332 14.8-.19 15.23-.142 15.277 1.376 14.945.19 0 .332-7.686.332-17.031V74.86l4.981-9.963c2.752-5.503 5.03-9.915 5.124-9.867.095.047.57 2.846 1.044 6.215zM20.228 3.842c-3.51 2.799-8.919 7.543-13.189 11.623l-3.368 3.178.617 4.175c.332 2.277.949 6.736 1.328 9.867.427 3.132.854 6.073.996 6.5.19.57 0 .854-.521.854-.902 0-.95-.237 1.518 7.59.901 2.989 1.755 5.74 1.85 6.025.095.332.474.474.901.332.427-.19.664-.57.522-.901-.142-.38.095-.76.474-.902.522-.19.475-.569-.332-1.945-1.28-2.134-4.554-20.352-4.744-26.234-.142-4.175-.142-4.222 1.613-6.594 1.708-2.325 5.646-5.835 11.718-10.295 1.708-1.28 3.416-2.704 3.89-3.178.712-.854 1.044-.617 7.021 5.74 3.463 3.653 7.306 7.4 8.54 8.35l2.277 1.707-1.756 3.7c-.948 1.993-4.791 9.678-8.586 16.984-7.923 15.37-6.31 13.9-15.513 14.043l-5.978.047-1.992 2.277c-2.088 2.42-2.372 3.32-1.376 4.839.38.522.664 1.376.664 1.898 0 .854.332.996 2.23 1.09 1.186.048 2.277.19 2.42.333.142.142.331 3.083.474 6.547l.19 6.262-3.179 6.831c-5.266 11.386-7.353 16.604-7.353 18.312 0 .901.19 1.66.38 1.66.474 0 .474-.047 19.782-40.324 8.966-18.691 17.458-36.292 18.881-39.185 1.423-2.894 2.704-5.55 2.799-5.93.095-.427-3.178-3.7-8.397-8.303-4.696-4.174-8.824-7.97-9.203-8.396-1.091-1.329-2.704-.902-5.598 1.423zm-2.372 62.147c-.38.996-1.376 3.083-2.183 4.649-1.328 2.656-1.47 2.751-1.802 1.66-.19-.664-.332-2.61-.38-4.364-.047-3.464-.142-3.416 3.843-3.653l1.28-.048-.758 1.756zm3.985-7.59c-2.183 4.221-2.277 4.269-8.255 4.553-5.266.285-5.36.238-5.36-.759 0-.569-.19-1.328-.428-1.708-.284-.426-.094-1.186.57-2.23l1.043-1.612h4.744c2.61-.048 5.598-.237 6.642-.427 1.044-.19 1.945-.285 2.04-.237.095.047-.38 1.138-.996 2.42zm-.19-43.266c-.854.616-1.091 1.233-1.091 2.799 0 1.85.142 2.134 1.423 2.656 1.28.522 1.613.475 3.084-.522 1.945-1.328 1.992-1.66.569-3.795-1.234-1.85-2.467-2.182-3.985-1.138z\" fill=\"currentColor\"/>\r\n    <path d=\"M50.141 24.917c.352-.615 1.06-1.085 1.967-1.085.804 0 1.477.34 1.734.597.342.342.477.74.477 1.14 0 .089-.006.305-.119.612-.168.461-1.056 2.337-2.08 4.471-1.131 2.264-3.724 7.875-5.708 12.457-1.671 3.806-2.558 5.881-2.97 7.216-.301.975-.279 1.406-.123 2.032.558 2.33 1.27 7.704 1.122 8.73-.187 1.596 1.537 18.06 3.32 32.136 1.056 8.446 1.91 15.74 1.91 16.22l-.002.07c-.009.184-.087.607-.447 1.14-.506.747-1.932 2.414-3.805 4.476-4.242 4.672-10.806 11.46-13.673 14.059-.682.617-1.199 1.023-1.472 1.182a1.872 1.872 0 01-.612.236c-.41.077-1.225-.015-2.35-.737-1.495-.959-4.19-3.217-8.46-7.114-1.327-1.184-4.36-3.79-6.718-5.865-1.712-1.476-2.767-2.405-3.411-3.096-.677-.727-.994-1.291-1.16-1.839-.165-.544-.18-1.09-.117-1.847.104-1.1 1.103-3.737 2.466-6.15 1.182-2.08 5.247-9.833 9.031-17.26 3.34-6.491 5.06-9.853 5.906-11.859.677-1.603.696-2.113.587-2.93-.18-1.168-.195-1.884-.111-2.308.1-.511.321-.851.58-1.1.346-.331.813-.55 1.488-.55.199 0 .391.024.574.07 4.068-7.268 18.093-35.143 19.705-39.334.585-1.53 1.353-2.823 1.794-3.288.228-.24.462-.39.677-.482zM38.72 59.573a448.835 448.835 0 00-3.06 5.995l-4.823 9.646v16.63c0 8.501-.124 15.643-.287 16.987-.142 1.166-1.002 1.462-1.384 1.526l.16-.017c-.671.147-1.214.135-1.647-.047-.495-.209-1.058-.629-1.33-1.813-.332-1.439-.336-5.202-.22-14.563.04-4.272.047-7.59.016-9.984-.33.582-.666 1.188-.986 1.783-1.615 3.04-5.13 9.5-7.79 14.345-2.383 4.34-4.576 8.338-5.207 9.493.131.186.356.489.61.77 1.165 1.287 3.451 3.428 7.667 7.316l8.316 7.76.798-.63c1.917-1.495 7.517-7.35 12.808-13.295.898-.995 1.544-1.72 2-2.29.37-.464.594-.76.675-1.06.067-.247.004-.478-.051-.8l-.007-.041c-.475-3.324-2.184-16.382-3.657-28.168-.757-6.384-1.797-14.328-2.317-17.639l-.004-.023c-.089-.635-.185-1.272-.28-1.881zM19.289 2.67c1.673-1.343 3-2.096 4.04-2.364 1.537-.394 2.687.004 3.621 1.119.396.44 4.46 4.165 9.071 8.264 4.274 3.769 7.265 6.676 8.244 7.909.69.868.68 1.598.625 1.844-.002.013-.006.026-.009.038-.1.398-1.416 3.195-2.908 6.228-1.423 2.893-9.912 20.488-18.875 39.173C7.581 97.252 4.465 103.75 3.6 105.058c-.497.751-.885.854-1.111.924a1.729 1.729 0 01-.526.076c-.42 0-.964-.148-1.368-.767-.223-.342-.511-1.288-.511-2.394 0-.606.19-1.592.67-3.03.955-2.866 3.1-7.864 6.821-15.911l3.03-6.513-.178-5.89a153.908 153.908 0 00-.33-5.346c-.352-.041-.773-.081-1.14-.096-.98-.049-1.616-.131-2.03-.261-.645-.204-1.016-.535-1.267-.928-.221-.348-.358-.79-.358-1.4 0-.282-.173-.735-.377-1.016l-.04-.059c-.621-.945-.859-1.757-.79-2.608.085-1.023.72-2.222 2.283-4.034l1.607-1.836c-.218-.687-.996-3.199-1.807-5.89-1.558-4.942-2.122-6.841-2.152-7.56-.034-.83.282-1.245.57-1.51a1.53 1.53 0 01.406-.265c-.217-1.235-.55-3.498-.875-5.878a488.89 488.89 0 00-1.323-9.829l-.617-4.175a1.5 1.5 0 01.455-1.31l3.361-3.172c4.301-4.11 9.749-8.888 13.287-11.709zm-3.879 71.31c-.31.283-.612.394-.858.441a1.547 1.547 0 01-1.04-.132l.103 3.418v.018l1.795-3.746zm12.426 1.473a23.55 23.55 0 01-.225.553 43.912 43.912 0 01-.763 1.686c.328-.11.65-.094.966.015l.022.008v-2.262zm1.524-3.996l-.032.037a1.575 1.575 0 01-.862.5c.042.411.057.798 0 1.25l.894-1.787zM16.286 65.87c-.566.056-1.034.117-1.267.149-.014.118-.03.275-.035.408-.012.4-.001.889.007 1.466.006.237.014.477.024.716.49-.997.97-2.02 1.271-2.739zm4.486-3.076a4.31 4.31 0 01-.88.654c.136.22.21.469.22.721l.281-.585.38-.79zm-.299-5.017c-1.381.168-3.98.324-6.29.365h-3.956l-.594.92c-.19.298-.36.7-.429.874.215.444.399 1.073.478 1.666h.014c.771.012 1.964-.048 3.819-.148 2.63-.125 3.979-.11 4.898-.616.326-.18.561-.453.817-.83.374-.551.75-1.276 1.243-2.23zm4.52-3.77a6.345 6.345 0 01-1.098.892c.156.141.3.333.383.595l.714-1.487zm15.241-3.122c-.47.934-.941 1.866-1.41 2.789.6-.264 1.192-.034 1.288.014.079.04.308.15.517.425a27.335 27.335 0 00-.224-1.044c-.185-.74-.289-1.336-.17-2.184zM24.148 5.38c-.758.673-2.198 1.856-3.649 2.944-5.896 4.33-9.738 7.717-11.4 9.978-.594.803-.97 1.279-1.177 1.801-.316.802-.217 1.685-.143 3.852.132 4.065 1.762 14.092 3.157 20.466.555 2.535 1.023 4.46 1.383 5.059.528.9.771 1.5.842 1.889.088.484.016.86-.118 1.167a1.86 1.86 0 01-.27.446l2.687-.021c1.825-.028 3.22.008 4.349-.038.897-.038 1.587-.111 2.187-.396.71-.336 1.26-.968 1.948-2.018 1.313-2.003 2.904-5.314 5.721-10.782 3.785-7.286 7.618-14.95 8.563-16.935l1.23-2.593-1.311-.984c-1.258-.967-5.182-4.782-8.717-8.51-2.604-2.769-4.52-4.608-5.282-5.325zm-11.86 47.181l-.001-.003-.026-.064.027.067zm-1.503-1.764l.059-.024a1.07 1.07 0 00-.059.024zm42.106-24.884l-.002.022.001-.009.001-.013zm.003-.035l.002-.071-.002.071zM20.773 13.917c-1.241.896-1.713 1.74-1.713 4.015 0 1.663.252 2.444.727 3.002.334.391.822.714 1.63 1.043.743.303 1.275.437 1.771.44.735.005 1.457-.254 2.72-1.109 1.495-1.02 2.072-1.825 2.19-2.615.111-.744-.188-1.715-1.214-3.254-.872-1.307-1.805-2.006-2.727-2.266-1.036-.292-2.15-.105-3.356.723l-.028.02zm4.263 4.285c-.128-.242-.375-.69-.648-1.099-.4-.598-.691-1.03-1.123-1.056-.24-.015-.473.123-.744.308-.461.337-.461.721-.461 1.577 0 .417.04.883.058 1.064.1.052.282.142.431.203.283.115.47.216.66.218.084 0 .152-.057.255-.113.215-.115.46-.275.757-.476.311-.213.632-.472.815-.626zM19.293 2.669l-.005.003.005-.003z\" fill=\"currentColor\"/>\r\n  </>, { width: 89, height: 131, style: { transform: \"translateX(4px)\" } });\r\n","import React from \"react\";\r\nimport { Card } from \"../../components/Card\";\r\nimport { ToolButton } from \"../../components/ToolButton\";\r\nimport { serializeAsJSON } from \"../../data/json\";\r\nimport { loadFirebaseStorage, saveFilesToFirebase } from \"../data/firebase\";\r\nimport { nanoid } from \"nanoid\";\r\nimport { t } from \"../../i18n\";\r\nimport { excalidrawPlusIcon } from \"./icons\";\r\nimport { encryptData, generateEncryptionKey } from \"../../data/encryption\";\r\nimport { isInitializedImageElement } from \"../../element/typeChecks\";\r\nimport { FILE_UPLOAD_MAX_BYTES } from \"../app_constants\";\r\nimport { encodeFilesForUpload } from \"../data/FileManager\";\r\nimport { MIME_TYPES } from \"../../constants\";\r\nconst exportToExcalidrawPlus = async (elements, appState, files) => {\r\n    const firebase = await loadFirebaseStorage();\r\n    const id = `${nanoid(12)}`;\r\n    const encryptionKey = (await generateEncryptionKey());\r\n    const encryptedData = await encryptData(encryptionKey, serializeAsJSON(elements, appState, files, \"database\"));\r\n    const blob = new Blob([encryptedData.iv, new Uint8Array(encryptedData.encryptedBuffer)], {\r\n        type: MIME_TYPES.binary,\r\n    });\r\n    await firebase\r\n        .storage()\r\n        .ref(`/migrations/scenes/${id}`)\r\n        .put(blob, {\r\n        customMetadata: {\r\n            data: JSON.stringify({ version: 2, name: appState.name }),\r\n            created: Date.now().toString(),\r\n        },\r\n    });\r\n    const filesMap = new Map();\r\n    for (const element of elements) {\r\n        if (isInitializedImageElement(element) && files[element.fileId]) {\r\n            filesMap.set(element.fileId, files[element.fileId]);\r\n        }\r\n    }\r\n    if (filesMap.size) {\r\n        const filesToUpload = await encodeFilesForUpload({\r\n            files: filesMap,\r\n            encryptionKey,\r\n            maxBytes: FILE_UPLOAD_MAX_BYTES,\r\n        });\r\n        await saveFilesToFirebase({\r\n            prefix: `/migrations/files/scenes/${id}`,\r\n            files: filesToUpload,\r\n        });\r\n    }\r\n    window.open(`https://plus.excalidraw.com/import?excalidraw=${id},${encryptionKey}`);\r\n};\r\nexport const ExportToExcalidrawPlus = ({ elements, appState, files, onError }) => {\r\n    return (<Card color=\"indigo\">\r\n      <div className=\"Card-icon\">{excalidrawPlusIcon}</div>\r\n      <h2>Excalidraw+</h2>\r\n      <div className=\"Card-details\">\r\n        {t(\"exportDialog.excalidrawplus_description\")}\r\n      </div>\r\n      <ToolButton className=\"Card-button\" type=\"button\" title={t(\"exportDialog.excalidrawplus_button\")} aria-label={t(\"exportDialog.excalidrawplus_button\")} showAriaLabel={true} onClick={async () => {\r\n            try {\r\n                await exportToExcalidrawPlus(elements, appState, files);\r\n            }\r\n            catch (error) {\r\n                console.error(error);\r\n                if (error.name !== \"AbortError\") {\r\n                    onError(new Error(t(\"exportDialog.excalidrawplus_exportError\")));\r\n                }\r\n            }\r\n        }}/>\r\n    </Card>);\r\n};\r\n","import LanguageDetector from \"i18next-browser-languagedetector\";\r\nimport { useCallback, useContext, useEffect, useRef, useState } from \"react\";\r\nimport { trackEvent } from \"../analytics\";\r\nimport { getDefaultAppState } from \"../appState\";\r\nimport { ErrorDialog } from \"../components/ErrorDialog\";\r\nimport { TopErrorBoundary } from \"../components/TopErrorBoundary\";\r\nimport { APP_NAME, EVENT, STORAGE_KEYS, TITLE_TIMEOUT, URL_HASH_KEYS, VERSION_TIMEOUT, } from \"../constants\";\r\nimport { loadFromBlob } from \"../data/blob\";\r\nimport { useCallbackRefState } from \"../hooks/useCallbackRefState\";\r\nimport { t } from \"../i18n\";\r\nimport Excalidraw, { defaultLang, languages, } from \"../packages/excalidraw/index\";\r\nimport { debounce, getVersion, preventUnload, resolvablePromise, } from \"../utils\";\r\nimport { FIREBASE_STORAGE_PREFIXES, SAVE_TO_LOCAL_STORAGE_TIMEOUT, } from \"./app_constants\";\r\nimport CollabWrapper, { CollabContext, CollabContextConsumer, } from \"./collab/CollabWrapper\";\r\nimport { exportToBackend, getCollaborationLinkData, loadScene } from \"./data\";\r\nimport { importFromLocalStorage, saveToLocalStorage, } from \"./data/localStorage\";\r\nimport CustomStats from \"./CustomStats\";\r\nimport { restoreAppState } from \"../data/restore\";\r\nimport { Tooltip } from \"../components/Tooltip\";\r\nimport { shield } from \"../components/icons\";\r\nimport \"./index.scss\";\r\nimport { ExportToExcalidrawPlus } from \"./components/ExportToExcalidrawPlus\";\r\nimport { getMany, set, del, keys, createStore } from \"idb-keyval\";\r\nimport { FileManager, updateStaleImageStatuses } from \"./data/FileManager\";\r\nimport { newElementWith } from \"../element/mutateElement\";\r\nimport { isInitializedImageElement } from \"../element/typeChecks\";\r\nimport { loadFilesFromFirebase } from \"./data/firebase\";\r\nconst filesStore = createStore(\"files-db\", \"files-store\");\r\nconst clearObsoleteFilesFromIndexedDB = async (opts) => {\r\n    const allIds = await keys(filesStore);\r\n    for (const id of allIds) {\r\n        if (!opts.currentFileIds.includes(id)) {\r\n            del(id, filesStore);\r\n        }\r\n    }\r\n};\r\nconst localFileStorage = new FileManager({\r\n    getFiles(ids) {\r\n        return getMany(ids, filesStore).then((filesData) => {\r\n            const loadedFiles = [];\r\n            const erroredFiles = new Map();\r\n            filesData.forEach((data, index) => {\r\n                const id = ids[index];\r\n                if (data) {\r\n                    loadedFiles.push(data);\r\n                }\r\n                else {\r\n                    erroredFiles.set(id, true);\r\n                }\r\n            });\r\n            return { loadedFiles, erroredFiles };\r\n        });\r\n    },\r\n    async saveFiles({ addedFiles }) {\r\n        const savedFiles = new Map();\r\n        const erroredFiles = new Map();\r\n        await Promise.all([...addedFiles].map(async ([id, fileData]) => {\r\n            try {\r\n                await set(id, fileData, filesStore);\r\n                savedFiles.set(id, true);\r\n            }\r\n            catch (error) {\r\n                console.error(error);\r\n                erroredFiles.set(id, true);\r\n            }\r\n        }));\r\n        return { savedFiles, erroredFiles };\r\n    },\r\n});\r\nconst languageDetector = new LanguageDetector();\r\nlanguageDetector.init({\r\n    languageUtils: {\r\n        formatLanguageCode: (langCode) => langCode,\r\n        isWhitelisted: () => true,\r\n    },\r\n    checkWhitelist: false,\r\n});\r\nconst saveDebounced = debounce(async (elements, appState, files, onFilesSaved) => {\r\n    saveToLocalStorage(elements, appState);\r\n    await localFileStorage.saveFiles({\r\n        elements,\r\n        files,\r\n    });\r\n    onFilesSaved();\r\n}, SAVE_TO_LOCAL_STORAGE_TIMEOUT);\r\nconst onBlur = () => {\r\n    saveDebounced.flush();\r\n};\r\nconst initializeScene = async (opts) => {\r\n    const searchParams = new URLSearchParams(window.location.search);\r\n    const id = searchParams.get(\"id\");\r\n    const jsonBackendMatch = window.location.hash.match(/^#json=([0-9]+),([a-zA-Z0-9_-]+)$/);\r\n    const externalUrlMatch = window.location.hash.match(/^#url=(.*)$/);\r\n    const localDataState = null;\r\n    let scene = await loadScene(null, null, localDataState);\r\n    let roomLinkData = getCollaborationLinkData(window.location.href);\r\n    const isExternalScene = !!(id || jsonBackendMatch || roomLinkData);\r\n    if (isExternalScene) {\r\n        if (\r\n        // don't prompt if scene is empty\r\n        !scene.elements.length ||\r\n            // don't prompt for collab scenes because we don't override local storage\r\n            roomLinkData ||\r\n            // otherwise, prompt whether user wants to override current scene\r\n            window.confirm(t(\"alerts.loadSceneOverridePrompt\"))) {\r\n            if (jsonBackendMatch) {\r\n                scene = await loadScene(jsonBackendMatch[1], jsonBackendMatch[2], localDataState);\r\n            }\r\n            scene.scrollToContent = true;\r\n            if (!roomLinkData) {\r\n                window.history.replaceState({}, APP_NAME, window.location.origin);\r\n            }\r\n        }\r\n        else {\r\n            // https://github.com/excalidraw/excalidraw/issues/1919\r\n            if (document.hidden) {\r\n                return new Promise((resolve, reject) => {\r\n                    window.addEventListener(\"focus\", () => initializeScene(opts).then(resolve).catch(reject), {\r\n                        once: true,\r\n                    });\r\n                });\r\n            }\r\n            roomLinkData = null;\r\n            window.history.replaceState({}, APP_NAME, window.location.origin);\r\n        }\r\n    }\r\n    else if (externalUrlMatch) {\r\n        window.history.replaceState({}, APP_NAME, window.location.origin);\r\n        const url = externalUrlMatch[1];\r\n        try {\r\n            const request = await fetch(window.decodeURIComponent(url));\r\n            const data = await loadFromBlob(await request.blob(), null, null);\r\n            if (!scene.elements.length ||\r\n                window.confirm(t(\"alerts.loadSceneOverridePrompt\"))) {\r\n                return { scene: data, isExternalScene };\r\n            }\r\n        }\r\n        catch (error) {\r\n            return {\r\n                scene: {\r\n                    appState: {\r\n                        errorMessage: t(\"alerts.invalidSceneUrl\"),\r\n                    },\r\n                },\r\n                isExternalScene,\r\n            };\r\n        }\r\n    }\r\n    if (roomLinkData) {\r\n        return {\r\n            scene: await opts.collabAPI.initializeSocketClient(roomLinkData),\r\n            isExternalScene: true,\r\n            id: roomLinkData.roomId,\r\n            key: roomLinkData.roomKey,\r\n        };\r\n    }\r\n    else if (scene) {\r\n        return isExternalScene && jsonBackendMatch\r\n            ? {\r\n                scene,\r\n                isExternalScene,\r\n                id: jsonBackendMatch[1],\r\n                key: jsonBackendMatch[2],\r\n            }\r\n            : { scene, isExternalScene: false };\r\n    }\r\n    return { scene: null, isExternalScene: false };\r\n};\r\n\r\nconst ExcalidrawWrapper = () => {\r\n    const [errorMessage, setErrorMessage] = useState(\"\");\r\n    let currentLangCode = languageDetector.detect() || defaultLang.code;\r\n    if (Array.isArray(currentLangCode)) {\r\n        currentLangCode = currentLangCode[0];\r\n    }\r\n    const [langCode, setLangCode] = useState(currentLangCode);\r\n    // initial state\r\n    // ---------------------------------------------------------------------------\r\n    const initialStatePromiseRef = useRef({ promise: null });\r\n    if (!initialStatePromiseRef.current.promise) {\r\n        initialStatePromiseRef.current.promise =\r\n            resolvablePromise();\r\n    }\r\n    useEffect(() => {\r\n        // Delayed so that the app has a time to load the latest SW\r\n        setTimeout(() => {\r\n            trackEvent(\"load\", \"version\", getVersion());\r\n        }, VERSION_TIMEOUT);\r\n    }, []);\r\n    const [excalidrawAPI, excalidrawRefCallback] = useCallbackRefState();\r\n    const collabAPI = useContext(CollabContext)?.api;\r\n    useEffect(() => {\r\n        if (!collabAPI || !excalidrawAPI) {\r\n            return;\r\n        }\r\n        const loadImages = (data, isInitialLoad = false) => {\r\n            if (!data.scene) {\r\n                return;\r\n            }\r\n            if (collabAPI.isCollaborating()) {\r\n                if (data.scene.elements) {\r\n                    collabAPI\r\n                        .fetchImageFilesFromFirebase({\r\n                        elements: data.scene.elements,\r\n                    })\r\n                        .then(({ loadedFiles, erroredFiles }) => {\r\n                        excalidrawAPI.addFiles(loadedFiles);\r\n                        updateStaleImageStatuses({\r\n                            excalidrawAPI,\r\n                            erroredFiles,\r\n                            elements: excalidrawAPI.getSceneElementsIncludingDeleted(),\r\n                        });\r\n                    });\r\n                }\r\n            }\r\n            else {\r\n                const fileIds = data.scene.elements?.reduce((acc, element) => {\r\n                    if (isInitializedImageElement(element)) {\r\n                        return acc.concat(element.fileId);\r\n                    }\r\n                    return acc;\r\n                }, []) || [];\r\n                if (data.isExternalScene) {\r\n                    loadFilesFromFirebase(`${FIREBASE_STORAGE_PREFIXES.shareLinkFiles}/${data.id}`, data.key, fileIds).then(({ loadedFiles, erroredFiles }) => {\r\n                        excalidrawAPI.addFiles(loadedFiles);\r\n                        updateStaleImageStatuses({\r\n                            excalidrawAPI,\r\n                            erroredFiles,\r\n                            elements: excalidrawAPI.getSceneElementsIncludingDeleted(),\r\n                        });\r\n                    });\r\n                }\r\n                else if (isInitialLoad) {\r\n                    if (fileIds.length) {\r\n                        localFileStorage\r\n                            .getFiles(fileIds)\r\n                            .then(({ loadedFiles, erroredFiles }) => {\r\n                            if (loadedFiles.length) {\r\n                                excalidrawAPI.addFiles(loadedFiles);\r\n                            }\r\n                            updateStaleImageStatuses({\r\n                                excalidrawAPI,\r\n                                erroredFiles,\r\n                                elements: excalidrawAPI.getSceneElementsIncludingDeleted(),\r\n                            });\r\n                        });\r\n                    }\r\n                    // on fresh load, clear unused files from IDB (from previous\r\n                    // session)\r\n                    clearObsoleteFilesFromIndexedDB({ currentFileIds: fileIds });\r\n                }\r\n            }\r\n            try {\r\n                data.scene.libraryItems =\r\n                    JSON.parse(localStorage.getItem(STORAGE_KEYS.LOCAL_STORAGE_LIBRARY)) || [];\r\n            }\r\n            catch (error) {\r\n                console.error(error);\r\n            }\r\n        };\r\n        initializeScene({ collabAPI }).then((data) => {\r\n            loadImages(data, /* isInitialLoad */ true);\r\n            initialStatePromiseRef.current.promise.resolve(data.scene);\r\n        });\r\n        const onHashChange = (event) => {\r\n            event.preventDefault();\r\n            const hash = new URLSearchParams(window.location.hash.slice(1));\r\n            const libraryUrl = hash.get(URL_HASH_KEYS.addLibrary);\r\n            if (libraryUrl) {\r\n                // If hash changed and it contains library url, import it and replace\r\n                // the url to its previous state (important in case of collaboration\r\n                // and similar).\r\n                // Using history API won't trigger another hashchange.\r\n                window.history.replaceState({}, \"\", event.oldURL);\r\n                excalidrawAPI.importLibrary(libraryUrl, hash.get(\"token\"));\r\n            }\r\n            else {\r\n                initializeScene({ collabAPI }).then((data) => {\r\n                    loadImages(data);\r\n                    if (data.scene) {\r\n                        excalidrawAPI.updateScene({\r\n                            ...data.scene,\r\n                            appState: restoreAppState(data.scene.appState, null),\r\n                        });\r\n                    }\r\n                });\r\n            }\r\n        };\r\n        const titleTimeout = setTimeout(() => (document.title = APP_NAME), TITLE_TIMEOUT);\r\n        window.addEventListener(EVENT.HASHCHANGE, onHashChange, false);\r\n        window.addEventListener(EVENT.UNLOAD, onBlur, false);\r\n        window.addEventListener(EVENT.BLUR, onBlur, false);\r\n        return () => {\r\n            window.removeEventListener(EVENT.HASHCHANGE, onHashChange, false);\r\n            window.removeEventListener(EVENT.UNLOAD, onBlur, false);\r\n            window.removeEventListener(EVENT.BLUR, onBlur, false);\r\n            clearTimeout(titleTimeout);\r\n        };\r\n    }, [collabAPI, excalidrawAPI]);\r\n    useEffect(() => {\r\n        const unloadHandler = (event) => {\r\n            saveDebounced.flush();\r\n            if (excalidrawAPI &&\r\n                localFileStorage.shouldPreventUnload(excalidrawAPI.getSceneElements())) {\r\n                preventUnload(event);\r\n            }\r\n        };\r\n        window.addEventListener(EVENT.BEFORE_UNLOAD, unloadHandler);\r\n        return () => {\r\n            window.removeEventListener(EVENT.BEFORE_UNLOAD, unloadHandler);\r\n        };\r\n    }, [excalidrawAPI]);\r\n    useEffect(() => {\r\n        languageDetector.cacheUserLanguage(langCode);\r\n    }, [langCode]);\r\n    const onChange = (elements, appState, files) => {\r\n        if (collabAPI?.isCollaborating()) {\r\n            collabAPI.broadcastElements(elements);\r\n        }\r\n        else {\r\n            saveDebounced(elements, appState, files, () => {\r\n                if (excalidrawAPI) {\r\n                    let didChange = false;\r\n                    let pendingImageElement = appState.pendingImageElement;\r\n                    const elements = excalidrawAPI\r\n                        .getSceneElementsIncludingDeleted()\r\n                        .map((element) => {\r\n                        if (localFileStorage.shouldUpdateImageElementStatus(element)) {\r\n                            didChange = true;\r\n                            const newEl = newElementWith(element, { status: \"saved\" });\r\n                            if (pendingImageElement === element) {\r\n                                pendingImageElement = newEl;\r\n                            }\r\n                            return newEl;\r\n                        }\r\n                        return element;\r\n                    });\r\n                    if (didChange) {\r\n                        excalidrawAPI.updateScene({\r\n                            elements,\r\n                            appState: {\r\n                                pendingImageElement,\r\n                            },\r\n                        });\r\n                    }\r\n                }\r\n            });\r\n        }\r\n    };\r\n    const onExportToBackend = async (exportedElements, appState, files, canvas) => {\r\n        if (exportedElements.length === 0) {\r\n            return window.alert(t(\"alerts.cannotExportEmptyCanvas\"));\r\n        }\r\n        if (canvas) {\r\n            try {\r\n                await exportToBackend(exportedElements, {\r\n                    ...appState,\r\n                    viewBackgroundColor: appState.exportBackground\r\n                        ? appState.viewBackgroundColor\r\n                        : getDefaultAppState().viewBackgroundColor,\r\n                }, files);\r\n            }\r\n            catch (error) {\r\n                if (error.name !== \"AbortError\") {\r\n                    const { width, height } = canvas;\r\n                    console.error(error, { width, height });\r\n                    setErrorMessage(error.message);\r\n                }\r\n            }\r\n        }\r\n    };\r\n    const renderTopRightUI = useCallback((isMobile, appState) => {\r\n        if (isMobile) {\r\n            return null;\r\n        }\r\n        return (<div style={{\r\n                width: \"24ch\",\r\n                fontSize: \"0.7em\",\r\n                textAlign: \"center\",\r\n            }}>\r\n          {/* <GitHubCorner theme={appState.theme} dir={document.dir} /> */}\r\n          {/* FIXME remove after 2021-05-20 */}\r\n        </div>);\r\n    }, []);\r\n    const renderFooter = useCallback((isMobile) => {\r\n        const renderEncryptedIcon = () => (<a className=\"encrypted-icon tooltip\" href=\"https://blog.excalidraw.com/end-to-end-encryption/\" target=\"_blank\" rel=\"noopener noreferrer\" aria-label={t(\"encrypted.link\")}>\r\n          <Tooltip label={t(\"encrypted.tooltip\")} long={true}>\r\n            {shield}\r\n          </Tooltip>\r\n        </a>);\r\n        if (isMobile) {\r\n            const isTinyDevice = window.innerWidth < 362;\r\n            return (<div style={{\r\n                    display: \"flex\",\r\n                    flexDirection: isTinyDevice ? \"column\" : \"row\",\r\n                }}>\r\n            <fieldset>\r\n              <legend>{t(\"labels.language\")}</legend>\r\n            </fieldset>\r\n            {/* FIXME remove after 2021-05-20 */}\r\n            <div style={{\r\n                    width: \"24ch\",\r\n                    fontSize: \"0.7em\",\r\n                    textAlign: \"center\",\r\n                    marginTop: isTinyDevice ? 16 : undefined,\r\n                    marginLeft: \"auto\",\r\n                    marginRight: isTinyDevice ? \"auto\" : undefined,\r\n                    padding: \"4px 2px\",\r\n                    border: \"1px dashed #aaa\",\r\n                    borderRadius: 12,\r\n                }}>\r\n              \r\n            </div>\r\n          </div>);\r\n        }\r\n        return (<>\r\n          {/* {renderEncryptedIcon()} */}\r\n        </>);\r\n    }, [langCode]);\r\n    const renderCustomStats = () => {\r\n        return (<CustomStats setToastMessage={(message) => excalidrawAPI.setToastMessage(message)}/>);\r\n    };\r\n    const onLibraryChange = async (items) => {\r\n        if (!items.length) {\r\n            localStorage.removeItem(STORAGE_KEYS.LOCAL_STORAGE_LIBRARY);\r\n            return;\r\n        }\r\n        const serializedItems = JSON.stringify(items);\r\n        localStorage.setItem(STORAGE_KEYS.LOCAL_STORAGE_LIBRARY, serializedItems);\r\n    };\r\n    const onRoomClose = useCallback(() => {\r\n        localFileStorage.reset();\r\n    }, []);\r\n    return (<>\r\n      <Excalidraw ref={excalidrawRefCallback} onChange={onChange} initialData={initialStatePromiseRef.current.promise} onCollabButtonClick={collabAPI?.onCollabButtonClick} isCollaborating={collabAPI?.isCollaborating()} onPointerUpdate={collabAPI?.onPointerUpdate} UIOptions={{\r\n            canvasActions: {\r\n                export: {\r\n                    onExportToBackend,\r\n                    renderCustomUI: (elements, appState, files) => {\r\n                        return (<ExportToExcalidrawPlus elements={elements} appState={appState} files={files} onError={(error) => {\r\n                                excalidrawAPI?.updateScene({\r\n                                    appState: {\r\n                                        errorMessage: error.message,\r\n                                    },\r\n                                });\r\n                            }}/>);\r\n                    },\r\n                },\r\n            },\r\n        }} renderTopRightUI={renderTopRightUI} renderFooter={renderFooter} langCode={langCode} renderCustomStats={renderCustomStats} detectScroll={false} handleKeyboardGlobally={true} onLibraryChange={onLibraryChange} autoFocus={true}/>\r\n      {excalidrawAPI && (<CollabWrapper excalidrawAPI={excalidrawAPI} onRoomClose={onRoomClose}/>)}\r\n      {errorMessage && (<ErrorDialog message={errorMessage} onClose={() => setErrorMessage(\"\")}/>)}\r\n    </>);\r\n};\r\nconst ExcalidrawApp = () => {\r\n    return (<TopErrorBoundary>\r\n      <CollabContextConsumer>\r\n        <ExcalidrawWrapper />\r\n      </CollabContextConsumer>\r\n    </TopErrorBoundary>);\r\n};\r\nexport default ExcalidrawApp;\r\n","import * as Sentry from \"@sentry/browser\";\r\nimport * as SentryIntegrations from \"@sentry/integrations\";\r\nconst SentryEnvHostnameMap = {\r\n    \"excalidraw.com\": \"production\",\r\n    \"vercel.app\": \"staging\",\r\n};\r\nconst REACT_APP_DISABLE_SENTRY = process.env.REACT_APP_DISABLE_SENTRY === \"true\";\r\n// Disable Sentry locally or inside the Docker to avoid noise/respect privacy\r\nconst onlineEnv = !REACT_APP_DISABLE_SENTRY &&\r\n    Object.keys(SentryEnvHostnameMap).find((item) => window.location.hostname.indexOf(item) >= 0);\r\nSentry.init({\r\n    dsn: onlineEnv\r\n        ? \"https://7bfc596a5bf945eda6b660d3015a5460@sentry.io/5179260\"\r\n        : undefined,\r\n    environment: onlineEnv ? SentryEnvHostnameMap[onlineEnv] : undefined,\r\n    release: process.env.REACT_APP_GIT_SHA,\r\n    ignoreErrors: [\r\n        \"undefined is not an object (evaluating 'window.__pad.performLoop')\", // Only happens on Safari, but spams our servers. Doesn't break anything\r\n    ],\r\n    integrations: [\r\n        new SentryIntegrations.CaptureConsole({\r\n            levels: [\"error\"],\r\n        }),\r\n    ],\r\n    beforeSend(event) {\r\n        if (event.request?.url) {\r\n            event.request.url = event.request.url.replace(/#.*$/, \"\");\r\n        }\r\n        return event;\r\n    },\r\n});\r\n","import ChalkBoard from \"./excalidraw-app\";\r\n\r\nimport \"./excalidraw-app/sentry\";\r\nwindow.__EXCALIDRAW_SHA__ = process.env.REACT_APP_GIT_SHA;\r\n\r\nexport default ChalkBoard","import { js, css, html } from \"../actions\";\r\n\r\nconst JSCode = `$(function () {\r\n\t$(\".sidebar-link\").click(function () {\r\n\t $(\".sidebar-link\").removeClass(\"is-active\");\r\n\t $(this).addClass(\"is-active\");\r\n\t});\r\n   });\r\n   \r\n   $(window)\r\n\t.resize(function () {\r\n\t if ($(window).width() > 1090) {\r\n\t  $(\".sidebar\").removeClass(\"collapse\");\r\n\t } else {\r\n\t  $(\".sidebar\").addClass(\"collapse\");\r\n\t }\r\n\t})\r\n\t.resize();\r\n   \r\n   const allVideos = document.querySelectorAll(\".video\");\r\n   \r\n   allVideos.forEach((v) => {\r\n\tv.addEventListener(\"mouseover\", () => {\r\n\t const video = v.querySelector(\"video\");\r\n\t video.play();\r\n\t});\r\n\tv.addEventListener(\"mouseleave\", () => {\r\n\t const video = v.querySelector(\"video\");\r\n\t video.pause();\r\n\t});\r\n   });\r\n   \r\n   $(function () {\r\n\t$(\".logo, .logo-expand, .discover\").on(\"click\", function (e) {\r\n\t $(\".main-container\").removeClass(\"show\");\r\n\t $(\".main-container\").scrollTop(0);\r\n\t});\r\n\t$(\".trending, .video\").on(\"click\", function (e) {\r\n\t $(\".main-container\").addClass(\"show\");\r\n\t $(\".main-container\").scrollTop(0);\r\n\t $(\".sidebar-link\").removeClass(\"is-active\");\r\n\t $(\".trending\").addClass(\"is-active\");\r\n\t});\r\n   \r\n\t$(\".video\").click(function () {\r\n\t var source = $(this).find(\"source\").attr(\"src\");\r\n\t var title = $(this).find(\".video-name\").text();\r\n\t var person = $(this).find(\".video-by\").text();\r\n\t var img = $(this).find(\".author-img\").attr(\"src\");\r\n\t $(\".video-stream video\").stop();\r\n\t $(\".video-stream source\").attr(\"src\", source);\r\n\t $(\".video-stream video\").load();\r\n\t $(\".video-p-title\").text(title);\r\n\t $(\".video-p-name\").text(person);\r\n\t $(\".video-detail .author-img\").attr(\"src\", img);\r\n\t});\r\n   });\r\n   `;\r\n\r\nconst CSSCode = `@import url(\"https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&display=swap\");\r\n* {\r\n  outline: none;\r\n  box-sizing: border-box;\r\n}\r\n\r\nhtml {\r\n  box-sizing: border-box;\r\n  -webkit-font-smoothing: antialiased;\r\n}\r\n\r\nimg {\r\n  max-width: 100%;\r\n}\r\n\r\n:root {\r\n  --body-font: \"Inter\", sans-serif;\r\n  --theme-bg: #1f1d2b;\r\n  --body-color: #808191;\r\n  --button-bg: #353340;\r\n  --border-color: rgb(128 129 145 / 24%);\r\n  --video-bg: #252936;\r\n  --delay: 0s;\r\n}\r\n\r\nbody {\r\n  font-family: var(--body-font);\r\n  color: var(--body-color);\r\n  background-image: url(\"https://images.unsplash.com/photo-1445251836269-d158eaa028a6?ixlib=rb-1.2.1&ixid=MXwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHw%3D&auto=format&fit=crop&w=1951&q=80\");\r\n  background-image: url(https://images.unsplash.com/photo-1520045892732-304bc3ac5d8e?ixlib=rb-1.2.1&ixid=MXwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHw%3D&auto=format&fit=crop&w=1950&q=80);\r\n  background-position: center;\r\n  background-size: cover;\r\n  background-repeat: no-repeat;\r\n  background-blend-mode: color-dodge;\r\n  background-color: rgba(18, 21, 39, 0.86);\r\n  display: flex;\r\n  justify-content: center;\r\n  align-items: center;\r\n  flex-direction: column;\r\n  padding: 1em 2em;\r\n  width: 100%;\r\n  height: 100vh;\r\n  overflow: hidden;\r\n}\r\nbody:before {\r\n  position: absolute;\r\n  left: 0;\r\n  top: 0;\r\n  width: 100%;\r\n  height: 100%;\r\n  background: linear-gradient(163deg, #1f1d2b 21%, rgba(31, 29, 43, 0.3113620448) 64%);\r\n  opacity: 0.4;\r\n  content: \"\";\r\n}\r\n\r\n.container {\r\n  background-color: var(--theme-bg);\r\n  max-width: 1240px;\r\n  max-height: 900px;\r\n  height: 95vh;\r\n  display: flex;\r\n  overflow: hidden;\r\n  width: 100%;\r\n  border-radius: 20px;\r\n  font-size: 15px;\r\n  font-weight: 500;\r\n  box-shadow: 0 20px 50px rgba(0, 0, 0, 0.3);\r\n  position: relative;\r\n}\r\n\r\n.sidebar {\r\n  width: 220px;\r\n  height: 100%;\r\n  padding: 30px;\r\n  display: flex;\r\n  flex-direction: column;\r\n  flex-shrink: 0;\r\n  transition-duration: 0.2s;\r\n  overflow-y: auto;\r\n  overflow-x: hidden;\r\n}\r\n.sidebar .logo {\r\n  display: none;\r\n  width: 30px;\r\n  height: 30px;\r\n  background-color: #22b07d;\r\n  flex-shrink: 0;\r\n  color: #fff;\r\n  align-items: center;\r\n  border-radius: 50%;\r\n  justify-content: center;\r\n}\r\n.sidebar .logo-expand {\r\n  text-decoration: none;\r\n  color: #fff;\r\n  font-size: 19px;\r\n  font-weight: 600;\r\n  line-height: 34px;\r\n  position: sticky;\r\n  top: 0;\r\n}\r\n.sidebar .logo-expand:before {\r\n  content: \"\";\r\n  position: absolute;\r\n  top: -30px;\r\n  left: 0;\r\n  background: var(--theme-bg);\r\n  width: 200px;\r\n  height: 70px;\r\n  z-index: -1;\r\n}\r\n.sidebar-link:hover, .sidebar-link.is-active {\r\n  color: #fff;\r\n  font-weight: 600;\r\n}\r\n.sidebar-link:hover:nth-child(2n+1) svg, .sidebar-link.is-active:nth-child(2n+1) svg {\r\n  background: #ff7551;\r\n}\r\n.sidebar-link:hover:nth-child(2n) svg, .sidebar-link.is-active:nth-child(2n) svg {\r\n  background: #32a7e2;\r\n}\r\n.sidebar-link:hover:nth-child(2n+3) svg, .sidebar-link.is-active:nth-child(2n+3) svg {\r\n  background: #6c5ecf;\r\n}\r\n.sidebar.collapse {\r\n  width: 90px;\r\n  border-right: 1px solid var(--border-color);\r\n}\r\n.sidebar.collapse .logo-expand,\r\n.sidebar.collapse .side-title {\r\n  display: none;\r\n}\r\n.sidebar.collapse .logo {\r\n  display: flex;\r\n}\r\n.sidebar.collapse .side-wrapper {\r\n  width: 30px;\r\n}\r\n.sidebar.collapse .side-menu svg {\r\n  margin-right: 30px;\r\n}\r\n\r\n@-webkit-keyframes bottom {\r\n  0% {\r\n    transform: translateY(100px);\r\n    opacity: 0;\r\n  }\r\n  100% {\r\n    opacity: 1;\r\n    transform: none;\r\n  }\r\n}\r\n\r\n@keyframes bottom {\r\n  0% {\r\n    transform: translateY(100px);\r\n    opacity: 0;\r\n  }\r\n  100% {\r\n    opacity: 1;\r\n    transform: none;\r\n  }\r\n}\r\n.side-menu {\r\n  display: flex;\r\n  flex-direction: column;\r\n}\r\n.side-menu a {\r\n  display: flex;\r\n  align-items: center;\r\n  text-decoration: none;\r\n  color: var(--body-color);\r\n}\r\n.side-menu a + a {\r\n  margin-top: 26px;\r\n}\r\n.side-menu svg {\r\n  width: 30px;\r\n  padding: 8px;\r\n  border-radius: 10px;\r\n  background-color: var(--button-bg);\r\n  flex-shrink: 0;\r\n  margin-right: 16px;\r\n}\r\n.side-menu svg:hover {\r\n  color: #fff;\r\n}\r\n\r\n.side-title {\r\n  font-size: 12px;\r\n  letter-spacing: 0.07em;\r\n  margin-bottom: 24px;\r\n}\r\n\r\n.side-wrapper {\r\n  border-bottom: 1px solid var(--border-color);\r\n  padding: 36px 0;\r\n  width: 145px;\r\n}\r\n.side-wrapper + .side-wrapper {\r\n  border-bottom: none;\r\n}\r\n\r\n.wrapper {\r\n  display: flex;\r\n  flex-direction: column;\r\n  flex-grow: 1;\r\n}\r\n\r\n.header {\r\n  display: flex;\r\n  align-items: center;\r\n  flex-shrink: 0;\r\n  padding: 30px;\r\n}\r\n\r\n.search-bar {\r\n  height: 34px;\r\n  display: flex;\r\n  width: 100%;\r\n  max-width: 450px;\r\n}\r\n.search-bar input {\r\n  width: 100%;\r\n  height: 100%;\r\n  border: none;\r\n  background-color: var(--button-bg);\r\n  border-radius: 8px;\r\n  font-family: var(--body-font);\r\n  font-size: 14px;\r\n  font-weight: 500;\r\n  padding: 0 40px 0 16px;\r\n  box-shadow: 0 0 0 2px rgba(134, 140, 160, 0.02);\r\n  background-image: url(\"data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 56.966 56.966' fill='%23717790c7'%3e%3cpath d='M55.146 51.887L41.588 37.786A22.926 22.926 0 0046.984 23c0-12.682-10.318-23-23-23s-23 10.318-23 23 10.318 23 23 23c4.761 0 9.298-1.436 13.177-4.162l13.661 14.208c.571.593 1.339.92 2.162.92.779 0 1.518-.297 2.079-.837a3.004 3.004 0 00.083-4.242zM23.984 6c9.374 0 17 7.626 17 17s-7.626 17-17 17-17-7.626-17-17 7.626-17 17-17z'/%3e%3c/svg%3e\");\r\n  background-size: 14px;\r\n  background-repeat: no-repeat;\r\n  background-position: 96%;\r\n  color: #fff;\r\n}\r\n\r\n.user-settings {\r\n  display: flex;\r\n  align-items: center;\r\n  padding-left: 20px;\r\n  flex-shrink: 0;\r\n  margin-left: auto;\r\n}\r\n.user-settings svg {\r\n  width: 10px;\r\n  flex-shrink: 0;\r\n}\r\n@media screen and (max-width: 575px) {\r\n  .user-settings svg {\r\n    display: none;\r\n  }\r\n}\r\n.user-settings .notify {\r\n  position: relative;\r\n}\r\n.user-settings .notify svg {\r\n  width: 20px;\r\n  margin-left: 24px;\r\n  flex-shrink: 0;\r\n}\r\n.user-settings .notify .notification {\r\n  width: 8px;\r\n  height: 8px;\r\n  border-radius: 50%;\r\n  background-color: #ec5252;\r\n  position: absolute;\r\n  right: 1px;\r\n  border: 1px solid var(--theme-bg);\r\n  top: -2px;\r\n}\r\n@media screen and (max-width: 575px) {\r\n  .user-settings .notify .notification {\r\n    display: none;\r\n  }\r\n}\r\n.user-img {\r\n  width: 30px;\r\n  height: 30px;\r\n  flex-shrink: 0;\r\n  -o-object-fit: cover;\r\n     object-fit: cover;\r\n  border-radius: 50%;\r\n}\r\n.user-name {\r\n  color: #fff;\r\n  font-size: 14px;\r\n  margin: 0 6px 0 12px;\r\n}\r\n@media screen and (max-width: 575px) {\r\n  .user-name {\r\n    display: none;\r\n  }\r\n}\r\n\r\n.main-container {\r\n  display: flex;\r\n  flex-direction: column;\r\n  padding: 0 30px 30px;\r\n  flex-grow: 1;\r\n  overflow: auto;\r\n}\r\n\r\n.anim {\r\n  -webkit-animation: bottom 0.8s var(--delay) both;\r\n          animation: bottom 0.8s var(--delay) both;\r\n}\r\n\r\n.main-header {\r\n  font-size: 30px;\r\n  color: #fff;\r\n  font-weight: 700;\r\n  padding-bottom: 20px;\r\n  position: sticky;\r\n  top: 0;\r\n  left: 0;\r\n  background: linear-gradient(to bottom, #1f1d2b 0%, #1f1d2b 78%, rgba(31, 29, 43, 0) 100%);\r\n  z-index: 11;\r\n}\r\n\r\n.small-header {\r\n  font-size: 24px;\r\n  font-weight: 500;\r\n  color: #fff;\r\n  margin: 30px 0 20px;\r\n}\r\n\r\n.main-blogs {\r\n  display: flex;\r\n  align-items: center;\r\n}\r\n.main-blog__author {\r\n  display: flex;\r\n  align-items: center;\r\n  padding-bottom: 10px;\r\n}\r\n.main-blog__author.tips {\r\n  flex-direction: column-reverse;\r\n  align-items: flex-start;\r\n}\r\n.main-blog__title {\r\n  font-size: 25px;\r\n  max-width: 12ch;\r\n  font-weight: 600;\r\n  letter-spacing: 1px;\r\n  color: #fff;\r\n  margin-bottom: 30px;\r\n}\r\n.main-blog {\r\n  background-image: url(\"https://assets.codepen.io/3364143/skate-removebg-preview.png\");\r\n  background-size: 80%;\r\n  background-position-x: 150px;\r\n  background-color: #31abbd;\r\n  display: flex;\r\n  flex-direction: column;\r\n  width: 65%;\r\n  padding: 30px;\r\n  border-radius: 20px;\r\n  align-self: stretch;\r\n  overflow: hidden;\r\n  position: relative;\r\n  transition: background 0.3s;\r\n  background-repeat: no-repeat;\r\n}\r\n.main-blog + .main-blog {\r\n  margin-left: 20px;\r\n  width: 35%;\r\n  background-image: url(https://c0.anyrgb.com/images/1020/945/venice-beach-2018-outdoors-sport-men-jumping-desert-sunset-extreme-sports-one-person-action.jpg);\r\n  background-color: unset;\r\n  background-position-x: 0;\r\n  background-size: 139%;\r\n  filter: saturate(1.4);\r\n}\r\n.main-blog + .main-blog .author-img {\r\n  border-color: rgba(255, 255, 255, 0.75);\r\n  margin-top: 14px;\r\n}\r\n.main-blog + .main-blog .author-img__wrapper svg {\r\n  border-color: #ffe6b2;\r\n  color: #e7bb7d;\r\n}\r\n.main-blog + .main-blog .author-detail {\r\n  margin-left: 0;\r\n}\r\n@media screen and (max-width: 905px) {\r\n  .main-blog, .main-blog + .main-blog {\r\n    width: 50%;\r\n    padding: 30px;\r\n  }\r\n  .main-blog {\r\n    background-size: cover;\r\n    background-position-x: center;\r\n    background-blend-mode: overlay;\r\n  }\r\n}\r\n.main-blog__time {\r\n  background: rgba(21, 13, 13, 0.44);\r\n  color: #fff;\r\n  padding: 3px 8px;\r\n  font-size: 12px;\r\n  border-radius: 6px;\r\n  position: absolute;\r\n  right: 20px;\r\n  bottom: 20px;\r\n}\r\n\r\n.author-img {\r\n  width: 52px;\r\n  height: 52px;\r\n  border: 1px solid rgba(255, 255, 255, 0.75);\r\n  padding: 4px;\r\n  border-radius: 50%;\r\n  -o-object-fit: cover;\r\n     object-fit: cover;\r\n}\r\n.author-img__wrapper {\r\n  position: relative;\r\n  flex-shrink: 0;\r\n}\r\n.author-img__wrapper svg {\r\n  width: 16px;\r\n  padding: 2px;\r\n  background-color: #fff;\r\n  color: #0daabc;\r\n  border-radius: 50%;\r\n  border: 2px solid #0daabc;\r\n  position: absolute;\r\n  bottom: 5px;\r\n  right: 0;\r\n}\r\n.author-name {\r\n  font-size: 15px;\r\n  color: #fff;\r\n  font-weight: 500;\r\n  margin-bottom: 8px;\r\n}\r\n.author-info {\r\n  font-size: 13px;\r\n  font-weight: 400;\r\n  color: #fff;\r\n}\r\n.author-detail {\r\n  margin-left: 16px;\r\n}\r\n\r\n.seperate {\r\n  width: 3px;\r\n  height: 3px;\r\n  display: inline-block;\r\n  vertical-align: middle;\r\n  border-radius: 50%;\r\n  background-color: #fff;\r\n  margin: 0 6px;\r\n}\r\n.seperate.video-seperate {\r\n  background-color: var(--body-color);\r\n}\r\n\r\n.videos {\r\n  display: grid;\r\n  width: 100%;\r\n  grid-template-columns: repeat(4, 1fr);\r\n  grid-column-gap: 20px;\r\n  grid-row-gap: 20px;\r\n}\r\n@media screen and (max-width: 980px) {\r\n  .videos {\r\n    grid-template-columns: repeat(2, 1fr);\r\n  }\r\n}\r\n\r\n.video {\r\n  position: relative;\r\n  background-color: var(--video-bg);\r\n  border-radius: 20px;\r\n  overflow: hidden;\r\n  transition: 0.4s;\r\n}\r\n.video-wrapper {\r\n  position: relative;\r\n}\r\n.video-name {\r\n  color: #fff;\r\n  font-size: 16px;\r\n  line-height: 1.4em;\r\n  padding: 12px 20px 0;\r\n  overflow: hidden;\r\n  background-color: var(--video-bg);\r\n  z-index: 9;\r\n  position: relative;\r\n  display: -webkit-box;\r\n  -webkit-line-clamp: 2;\r\n  -webkit-box-orient: vertical;\r\n}\r\n.video-view {\r\n  font-size: 12px;\r\n  padding: 12px 20px 20px;\r\n  background-color: var(--video-bg);\r\n  position: relative;\r\n}\r\n.video-by {\r\n  transition: 0.3s;\r\n  padding: 20px 20px 0px;\r\n  display: inline-flex;\r\n  position: relative;\r\n}\r\n.video-by:before {\r\n  content: \"\";\r\n  background-color: #22b07d;\r\n  width: 6px;\r\n  height: 6px;\r\n  border-radius: 50%;\r\n  position: absolute;\r\n  top: 26px;\r\n  right: 5px;\r\n}\r\n.video-by.offline:before {\r\n  background-color: #ff7551;\r\n}\r\n.video-time {\r\n  position: absolute;\r\n  background: rgba(21, 13, 13, 0.44);\r\n  color: rgba(255, 255, 255, 0.85);\r\n  padding: 3px 8px;\r\n  font-size: 12px;\r\n  border-radius: 6px;\r\n  top: 10px;\r\n  z-index: 1;\r\n  right: 8px;\r\n}\r\n.video:hover video {\r\n  transform: scale(1.6);\r\n  transform-origin: center;\r\n}\r\n.video:hover .video-time {\r\n  display: none;\r\n}\r\n.video:hover .video-author {\r\n  bottom: -65px;\r\n  transform: scale(0.6);\r\n  right: -3px;\r\n  z-index: 10;\r\n}\r\n.video:hover .video-by {\r\n  opacity: 0;\r\n}\r\n.video-author {\r\n  position: absolute;\r\n  right: 10px;\r\n  transition: 0.4s;\r\n  bottom: -25px;\r\n}\r\n.video-author svg {\r\n  background-color: #0aa0f7;\r\n  color: #fff;\r\n  border-color: var(--video-bg);\r\n}\r\n\r\nvideo {\r\n  max-width: 100%;\r\n  width: 100%;\r\n  border-radius: 20px 20px 0 0;\r\n  display: block;\r\n  cursor: pointer;\r\n  transition: 0.4s;\r\n}\r\n\r\n.stream-area {\r\n  display: none;\r\n}\r\n@media screen and (max-width: 940px) {\r\n  .stream-area {\r\n    flex-direction: column;\r\n  }\r\n  .stream-area .video-stream {\r\n    width: 100%;\r\n  }\r\n  .stream-area .chat-stream {\r\n    margin-left: 0;\r\n    margin-top: 30px;\r\n  }\r\n  .stream-area .video-js.vjs-fluid {\r\n    min-height: 250px;\r\n  }\r\n  .stream-area .msg__content {\r\n    max-width: 100%;\r\n  }\r\n}\r\n\r\n.show .stream-area {\r\n  display: flex;\r\n}\r\n.show .main-header,\r\n.show .main-blogs,\r\n.show .small-header,\r\n.show .videos {\r\n  display: none;\r\n}\r\n\r\n.video-stream {\r\n  width: 65%;\r\n  -o-object-fit: cover;\r\n     object-fit: cover;\r\n  transition: 0.3s;\r\n}\r\n.video-stream:hover .video-js .vjs-big-play-button {\r\n  opacity: 1;\r\n}\r\n\r\n.video-p {\r\n  margin-right: 12px;\r\n  -o-object-fit: cover;\r\n     object-fit: cover;\r\n  flex-shrink: 0;\r\n  border-radius: 50%;\r\n  position: relative;\r\n  top: 0;\r\n  left: 0;\r\n}\r\n.video-p .author-img {\r\n  border: 0;\r\n}\r\n.video-p-wrapper {\r\n  display: flex;\r\n  align-items: center;\r\n}\r\n.video-p-wrapper .author-img {\r\n  border: 0;\r\n}\r\n.video-p-wrapper svg {\r\n  width: 20px;\r\n  padding: 4px;\r\n}\r\n@media screen and (max-width: 650px) {\r\n  .video-p-wrapper {\r\n    flex-direction: column;\r\n  }\r\n  .video-p-wrapper .button-wrapper {\r\n    margin: 20px auto 0;\r\n  }\r\n  .video-p-wrapper .video-p-detail {\r\n    display: flex;\r\n    flex-direction: column;\r\n    align-items: center;\r\n  }\r\n  .video-p-wrapper .video-p {\r\n    margin-right: 0;\r\n  }\r\n}\r\n.video-p-sub {\r\n  font-size: 12px;\r\n}\r\n.video-p-title {\r\n  font-size: 24px;\r\n  color: #fff;\r\n  line-height: 1.4em;\r\n  margin: 16px 0 20px;\r\n}\r\n.video-p-subtitle {\r\n  font-size: 14px;\r\n  line-height: 1.5em;\r\n  max-width: 60ch;\r\n}\r\n.video-p-subtitle + .video-p-subtitle {\r\n  margin-top: 16px;\r\n}\r\n.video-p-name {\r\n  margin-bottom: 8px;\r\n  color: #fff;\r\n  display: flex;\r\n  align-items: center;\r\n}\r\n.video-p-name:after {\r\n  content: \"\";\r\n  width: 6px;\r\n  height: 6px;\r\n  background-color: #22b07d;\r\n  border-radius: 50%;\r\n  margin-left: 8px;\r\n  display: inline-block;\r\n}\r\n.video-p-name.offline:after {\r\n  background-color: #ff7551;\r\n}\r\n\r\n.video-content {\r\n  width: 100%;\r\n}\r\n\r\n.button-wrapper {\r\n  display: flex;\r\n  align-items: center;\r\n  margin-left: auto;\r\n}\r\n\r\n.like {\r\n  display: flex;\r\n  align-items: center;\r\n  background-color: var(--button-bg);\r\n  color: #fff;\r\n  border: 0;\r\n  font-family: var(--body-font);\r\n  border-radius: 8px;\r\n  padding: 10px 16px;\r\n  font-size: 14px;\r\n  cursor: pointer;\r\n}\r\n.like.red {\r\n  background-color: #ea5f5f;\r\n}\r\n.like svg {\r\n  width: 18px;\r\n  flex-shrink: 0;\r\n  margin-right: 10px;\r\n  padding: 0;\r\n}\r\n.like + .like {\r\n  margin-left: 16px;\r\n}\r\n\r\n.video-stats {\r\n  margin-left: 30px;\r\n}\r\n\r\n.video-detail {\r\n  display: flex;\r\n  margin-top: 30px;\r\n  width: 100%;\r\n}\r\n\r\n.chat-header {\r\n  display: flex;\r\n  align-items: center;\r\n  padding: 20px 0;\r\n  font-size: 16px;\r\n  font-weight: 600;\r\n  color: #fff;\r\n  position: sticky;\r\n  top: 0;\r\n  background-color: #252836;\r\n  left: 0;\r\n  z-index: 1;\r\n  border-bottom: 1px solid var(--border-color);\r\n}\r\n.chat-header svg {\r\n  width: 15px;\r\n  margin-right: 6px;\r\n  flex-shrink: 0;\r\n}\r\n.chat-header span {\r\n  margin-left: auto;\r\n  color: var(--body-color);\r\n  font-size: 12px;\r\n  display: flex;\r\n  align-items: center;\r\n}\r\n\r\n.chat-stream {\r\n  flex-grow: 1;\r\n  margin-left: 30px;\r\n}\r\n\r\n.chat {\r\n  background-color: #252836;\r\n  border-radius: 20px;\r\n  padding: 0 20px;\r\n  max-height: 414px;\r\n  overflow: auto;\r\n}\r\n.chat-footer {\r\n  display: flex;\r\n  align-items: center;\r\n  position: sticky;\r\n  bottom: 0;\r\n  left: 0;\r\n  width: calc(100% + 20px);\r\n  padding-bottom: 12px;\r\n  background-color: #252836;\r\n}\r\n.chat-footer input {\r\n  width: 100%;\r\n  border: 0;\r\n  background-color: #2d303e;\r\n  border-radius: 20px;\r\n  font-size: 12px;\r\n  color: #fff;\r\n  margin-left: -10px;\r\n  padding: 12px 40px;\r\n  font-weight: 500;\r\n  font-family: var(--body-font);\r\n  background-image: url(\"data:image/svg+xml;charset=UTF-8,%3csvg width='24' height='24' fill='none' xmlns='http://www.w3.org/2000/svg'%3e%3cpath fill-rule='evenodd' clip-rule='evenodd' d='M2 12C2 6.48 6.47 2 12 2c5.52 0 10 4.48 10 10s-4.48 10-10 10C6.47 22 2 17.52 2 12zm5.52 1.2c-.66 0-1.2-.54-1.2-1.2 0-.66.54-1.2 1.2-1.2.66 0 1.19.54 1.19 1.2 0 .66-.53 1.2-1.19 1.2zM10.8 12c0 .66.54 1.2 1.2 1.2.66 0 1.19-.54 1.19-1.2a1.194 1.194 0 10-2.39 0zm4.48 0a1.195 1.195 0 102.39 0 1.194 1.194 0 10-2.39 0z' fill='%236c6e78'/%3e%3c/svg%3e\");\r\n  background-repeat: no-repeat;\r\n  background-size: 24px;\r\n  background-position: 8px;\r\n}\r\n.chat-footer input::-moz-placeholder {\r\n  color: #6c6e78;\r\n}\r\n.chat-footer input:-ms-input-placeholder {\r\n  color: #6c6e78;\r\n}\r\n.chat-footer input::placeholder {\r\n  color: #6c6e78;\r\n}\r\n.chat-footer:before {\r\n  content: \"\";\r\n  position: absolute;\r\n  background-image: url(\"data:image/svg+xml;charset=UTF-8,%3csvg viewBox='0 0 24 24' fill='white' xmlns='http://www.w3.org/2000/svg'%3e%3cpath d='M21.435 2.582a1.933 1.933 0 00-1.93-.503L3.408 6.759a1.92 1.92 0 00-1.384 1.522c-.142.75.355 1.704 1.003 2.102l5.033 3.094a1.304 1.304 0 001.61-.194l5.763-5.799a.734.734 0 011.06 0c.29.292.29.765 0 1.067l-5.773 5.8c-.428.43-.508 1.1-.193 1.62l3.075 5.083c.36.604.98.946 1.66.946.08 0 .17 0 .251-.01.78-.1 1.4-.634 1.63-1.39l4.773-16.075c.21-.685.02-1.43-.48-1.943z'/%3e%3c/svg%3e\");\r\n  background-repeat: no-repeat;\r\n  background-size: 14px;\r\n  background-position: center;\r\n  width: 18px;\r\n  height: 18px;\r\n  background-color: #6c5ecf;\r\n  padding: 4px;\r\n  border-radius: 50%;\r\n  right: 16px;\r\n}\r\n.chat-vid__title {\r\n  color: #fff;\r\n  font-size: 18px;\r\n}\r\n.chat-vid__container {\r\n  margin-top: 40px;\r\n}\r\n.chat-vid__wrapper {\r\n  display: flex;\r\n  align-items: center;\r\n  margin-top: 26px;\r\n}\r\n.chat-vid__name {\r\n  color: #fff;\r\n  font-size: 14px;\r\n  line-height: 1.3em;\r\n  display: -webkit-box;\r\n  -webkit-line-clamp: 2;\r\n  overflow: hidden;\r\n  -webkit-box-orient: vertical;\r\n}\r\n.chat-vid__img {\r\n  width: 100px;\r\n  height: 80px;\r\n  border-radius: 10px;\r\n  -o-object-fit: cover;\r\n     object-fit: cover;\r\n  -o-object-position: right;\r\n     object-position: right;\r\n  margin-right: 16px;\r\n  transition: 0.3s;\r\n}\r\n.chat-vid__img:hover {\r\n  transform: scale(1.02);\r\n}\r\n.chat-vid__content {\r\n  max-width: 20ch;\r\n}\r\n.chat-vid__by, .chat-vid__info {\r\n  color: var(--body-color);\r\n  font-size: 13px;\r\n}\r\n.chat-vid__by {\r\n  margin: 6px 0;\r\n}\r\n.chat-vid__button {\r\n  background-color: #6c5ecf;\r\n  border: 0;\r\n  color: #fff;\r\n  font-size: 13px;\r\n  margin-top: 26px;\r\n  display: flex;\r\n  padding: 0 10px;\r\n  align-items: center;\r\n  justify-content: center;\r\n  height: 40px;\r\n  border-radius: 10px;\r\n  cursor: pointer;\r\n  transition: 0.3s;\r\n}\r\n.chat-vid__button:hover {\r\n  background-color: #5847d0;\r\n}\r\n\r\n.message {\r\n  display: flex;\r\n  align-items: center;\r\n  margin-top: 18px;\r\n}\r\n.message:last-child {\r\n  margin-bottom: 18px;\r\n}\r\n.message-container .author-img__wrapper svg {\r\n  width: 15px;\r\n}\r\n\r\n.msg__name {\r\n  font-size: 13px;\r\n}\r\n.msg__content {\r\n  line-height: 1.4em;\r\n  max-width: 26ch;\r\n  display: -webkit-box;\r\n  overflow: hidden;\r\n  -webkit-line-clamp: 2;\r\n  -webkit-box-orient: vertical;\r\n}\r\n\r\n.video-js .vjs-control-bar {\r\n  display: flex;\r\n  align-items: center;\r\n}\r\n\r\n.vjs-poster {\r\n  background-size: 150%;\r\n}\r\n\r\n.video-js .vjs-control-bar {\r\n  width: 100%;\r\n  position: absolute;\r\n  bottom: 14px;\r\n  padding-left: 36px;\r\n  left: 14px;\r\n  width: calc(100% - 28px);\r\n  right: 0;\r\n  border-radius: 10px;\r\n  height: 4em;\r\n  background-color: #2b333f;\r\n  background-color: rgba(43, 51, 63, 0.7);\r\n}\r\n@media screen and (max-width: 625px) {\r\n  .video-js .vjs-control-bar {\r\n    padding-left: 0;\r\n  }\r\n}\r\n\r\n.video-js:hover .vjs-big-play-button {\r\n  background-color: rgba(43, 51, 63, 0.5);\r\n}\r\n\r\n.video-js .vjs-big-play-button {\r\n  transition: 0.3s;\r\n  opacity: 0;\r\n  border: 0;\r\n  top: 50%;\r\n  left: 50%;\r\n  transform: translate(-50%, -50%);\r\n}\r\n.video-js .vjs-big-play-button:hover {\r\n  background-color: rgba(43, 51, 63, 0.7);\r\n  border-color: transparent;\r\n}\r\n\r\n.vjs-play-control:after {\r\n  content: \"LIVE\";\r\n  position: absolute;\r\n  left: -66px;\r\n  top: 7px;\r\n  background-color: #8941e3;\r\n  height: 24px;\r\n  font-family: var(--body-font);\r\n  font-size: 10px;\r\n  padding: 0 12px 0 26px;\r\n  display: flex;\r\n  font-weight: 700;\r\n  letter-spacing: 0.03em;\r\n  align-items: center;\r\n  border-radius: 6px;\r\n  background-image: url(\"data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' fill='%23fff' stroke='%23fff' stroke-width='2' stroke-linecap='round' stroke-linejoin='round' class='feather feather-circle'%3e%3ccircle cx='12' cy='12' r='10'/%3e%3c/svg%3e\");\r\n  background-repeat: no-repeat;\r\n  background-size: 6px;\r\n  background-position: 12px;\r\n}\r\n@media screen and (max-width: 625px) {\r\n  .vjs-play-control:after {\r\n    display: none;\r\n  }\r\n}\r\n\r\n.vjs-menu-button-inline .vjs-menu {\r\n  top: 4px;\r\n}\r\n\r\n.video-js .vjs-control:before,\r\n.video-js .vjs-time-control {\r\n  line-height: 40px;\r\n}\r\n\r\n.video-js .vjs-tech {\r\n  -o-object-fit: cover;\r\n     object-fit: cover;\r\n}\r\n\r\nbutton.vjs-play-control.vjs-control.vjs-button {\r\n  margin-left: 40px;\r\n}\r\n@media screen and (max-width: 625px) {\r\n  button.vjs-play-control.vjs-control.vjs-button {\r\n    margin-left: 0;\r\n  }\r\n}\r\n\r\n.vjs-icon-fullscreen-enter:before,\r\n.video-js .vjs-fullscreen-control:before {\r\n  content: \"\";\r\n  position: absolute;\r\n  display: block;\r\n  background-image: url(\"data:image/svg+xml;charset=UTF-8,%3csvg width='20' height='20' fill='none' xmlns='http://www.w3.org/2000/svg'%3e%3cpath fill-rule='evenodd' clip-rule='evenodd' d='M2.54 0h3.38c1.41 0 2.54 1.15 2.54 2.561V5.97c0 1.42-1.13 2.56-2.54 2.56H2.54C1.14 8.53 0 7.39 0 5.97V2.561C0 1.15 1.14 0 2.54 0zm0 11.47h3.38c1.41 0 2.54 1.14 2.54 2.56v3.41c0 1.41-1.13 2.56-2.54 2.56H2.54C1.14 20 0 18.85 0 17.44v-3.41c0-1.42 1.14-2.56 2.54-2.56zM17.46 0h-3.38c-1.41 0-2.54 1.15-2.54 2.561V5.97c0 1.42 1.13 2.56 2.54 2.56h3.38c1.4 0 2.54-1.14 2.54-2.56V2.561C20 1.15 18.86 0 17.46 0zm-3.38 11.47h3.38c1.4 0 2.54 1.14 2.54 2.56v3.41c0 1.41-1.14 2.56-2.54 2.56h-3.38c-1.41 0-2.54-1.15-2.54-2.56v-3.41c0-1.42 1.13-2.56 2.54-2.56z' fill='%23fff'/%3e%3c/svg%3e\");\r\n  background-size: 11px;\r\n  background-position: center;\r\n  background-position-y: 14px;\r\n  background-repeat: no-repeat;\r\n  opacity: 0.6;\r\n}\r\n\r\n.vjs-playback-rate .vjs-playback-rate-value {\r\n  font-size: 1.1em;\r\n  line-height: 3.5em;\r\n  opacity: 0.6;\r\n  font-weight: 700;\r\n  font-family: var(--body-font);\r\n}\r\n\r\n.video-js .vjs-playback-rate {\r\n  width: 2.2em;\r\n}\r\n\r\n.video-js.vjs-fluid {\r\n  border-radius: 20px;\r\n  overflow: hidden;\r\n  min-height: 414px;\r\n}\r\n\r\n@media screen and (max-width: 735px) {\r\n  .main-blogs {\r\n    flex-wrap: wrap;\r\n  }\r\n\r\n  .main-blog,\r\n.main-blog + .main-blog {\r\n    width: 100%;\r\n  }\r\n\r\n  .videos {\r\n    grid-template-columns: 1fr;\r\n  }\r\n\r\n  .main-blog + .main-blog {\r\n    margin-left: 0;\r\n    margin-top: 20px;\r\n    background-size: cover;\r\n  }\r\n}\r\n@media screen and (max-width: 475px) {\r\n  .main-blog__title {\r\n    font-size: 20px;\r\n  }\r\n\r\n  .author-name {\r\n    font-size: 14px;\r\n  }\r\n\r\n  .main-blog__author {\r\n    flex-direction: column-reverse;\r\n    align-items: flex-start;\r\n  }\r\n\r\n  .author-detail {\r\n    margin-left: 0;\r\n  }\r\n\r\n  .main-blog .author-img {\r\n    margin-top: 14px;\r\n  }\r\n\r\n  .main-container {\r\n    padding: 0 20px 20px;\r\n  }\r\n\r\n  .header {\r\n    padding: 20px;\r\n  }\r\n\r\n  .sidebar.collapse {\r\n    width: 40px;\r\n  }\r\n\r\n  .sidebar {\r\n    align-items: center;\r\n  }\r\n\r\n  body {\r\n    padding: 0;\r\n  }\r\n\r\n  .container {\r\n    height: 100vh;\r\n    border-radius: 0;\r\n    max-height: 100%;\r\n  }\r\n}\r\n::-webkit-scrollbar {\r\n  width: 6px;\r\n  border-radius: 10px;\r\n}\r\n\r\n::-webkit-scrollbar-thumb {\r\n  background-color: rgba(21, 20, 26, 0.63);\r\n  border-radius: 10px;\r\n}`;\r\n\r\nconst HTMLCode = `<div class=\"container\">\r\n<div class=\"sidebar\">\r\n <span class=\"logo\">S</span>\r\n <a class=\"logo-expand\" href=\"#\">skateboard</a>\r\n <div class=\"side-wrapper\">\r\n  <div class=\"side-title\">MENU</div>\r\n  <div class=\"side-menu\">\r\n   <a class=\"sidebar-link discover is-active\" href=\"#\">\r\n\t<svg viewBox=\"0 0 24 24\" fill=\"currentColor\">\r\n\t <path d=\"M9.135 20.773v-3.057c0-.78.637-1.414 1.423-1.414h2.875c.377 0 .74.15 1.006.414.267.265.417.625.417 1v3.057c-.002.325.126.637.356.867.23.23.544.36.87.36h1.962a3.46 3.46 0 002.443-1 3.41 3.41 0 001.013-2.422V9.867c0-.735-.328-1.431-.895-1.902l-6.671-5.29a3.097 3.097 0 00-3.949.072L3.467 7.965A2.474 2.474 0 002.5 9.867v8.702C2.5 20.464 4.047 22 5.956 22h1.916c.68 0 1.231-.544 1.236-1.218l.027-.009z\" />\r\n\t</svg>\r\n\tDiscover\r\n   </a>\r\n   <a class=\"sidebar-link trending\" href=\"#\">\r\n\t<svg viewBox=\"0 0 24 24\" fill=\"currentColor\">\r\n\t <path fill-rule=\"evenodd\" clip-rule=\"evenodd\" d=\"M10.835 12.007l.002.354c.012 1.404.096 2.657.242 3.451 0 .015.16.802.261 1.064.16.38.447.701.809.905a2 2 0 00.91.219c.249-.012.66-.137.954-.242l.244-.094c1.617-.642 4.707-2.74 5.891-4.024l.087-.09.39-.42c.245-.322.375-.715.375-1.138 0-.379-.116-.758-.347-1.064-.07-.099-.18-.226-.28-.334l-.379-.397c-1.305-1.321-4.129-3.175-5.593-3.79 0-.013-.91-.393-1.343-.407h-.057c-.665 0-1.286.379-1.603.991-.087.168-.17.496-.233.784l-.114.544c-.13.874-.216 2.216-.216 3.688zm-6.332-1.525C3.673 10.482 3 11.162 3 12a1.51 1.51 0 001.503 1.518l3.7-.328c.65 0 1.179-.532 1.179-1.19 0-.658-.528-1.191-1.18-1.191l-3.699-.327z\" />\r\n\t</svg>\r\n\tTrending\r\n   </a>\r\n   <a class=\"sidebar-link\" href=\"#\">\r\n\t<svg viewBox=\"0 0 24 24\" fill=\"currentColor\">\r\n\t <path d=\"M11.23 7.29V3.283c0-.427.34-.782.77-.782.385 0 .711.298.763.677l.007.104v4.01h4.78c2.38 0 4.335 1.949 4.445 4.38l.005.215v5.04c0 2.447-1.887 4.456-4.232 4.569l-.208.005H6.44c-2.38 0-4.326-1.94-4.435-4.379L2 16.905v-5.03c0-2.447 1.878-4.466 4.222-4.58l.208-.004h4.8v6.402l-1.6-1.652a.755.755 0 00-1.09 0 .81.81 0 00-.22.568c0 .157.045.32.14.459l.08.099 2.91 3.015c.14.155.34.237.55.237a.735.735 0 00.465-.166l.075-.071 2.91-3.015c.3-.31.3-.816 0-1.126a.755.755 0 00-1.004-.077l-.086.077-1.59 1.652V7.291h-1.54z\" />\r\n\t</svg>\r\n\tStreaming\r\n   </a>\r\n   <a class=\"sidebar-link\" href=\"#\">\r\n\t<svg viewBox=\"0 0 24 24\" fill=\"currentColor\">\r\n\t <path fill-rule=\"evenodd\" clip-rule=\"evenodd\" d=\"M12.1535 16.64L14.995 13.77C15.2822 13.47 15.2822 13 14.9851 12.71C14.698 12.42 14.2327 12.42 13.9455 12.71L12.3713 14.31V9.49C12.3713 9.07 12.0446 8.74 11.6386 8.74C11.2327 8.74 10.896 9.07 10.896 9.49V14.31L9.32178 12.71C9.03465 12.42 8.56931 12.42 8.28218 12.71C7.99505 13 7.99505 13.47 8.28218 13.77L11.1139 16.64C11.1832 16.71 11.2624 16.76 11.3515 16.8C11.4406 16.84 11.5396 16.86 11.6386 16.86C11.7376 16.86 11.8267 16.84 11.9158 16.8C12.005 16.76 12.0842 16.71 12.1535 16.64ZM19.3282 9.02561C19.5609 9.02292 19.8143 9.02 20.0446 9.02C20.302 9.02 20.5 9.22 20.5 9.47V17.51C20.5 19.99 18.5 22 16.0446 22H8.17327C5.58911 22 3.5 19.89 3.5 17.29V6.51C3.5 4.03 5.4901 2 7.96535 2H13.2525C13.5 2 13.7079 2.21 13.7079 2.46V5.68C13.7079 7.51 15.1931 9.01 17.0149 9.02C17.4333 9.02 17.8077 9.02318 18.1346 9.02595C18.3878 9.02809 18.6125 9.03 18.8069 9.03C18.9479 9.03 19.1306 9.02789 19.3282 9.02561ZM19.6045 7.5661C18.7916 7.5691 17.8322 7.5661 17.1421 7.5591C16.047 7.5591 15.145 6.6481 15.145 5.5421V2.9061C15.145 2.4751 15.6629 2.2611 15.9579 2.5721C16.7203 3.37199 17.8873 4.5978 18.8738 5.63395C19.2735 6.05379 19.6436 6.44249 19.945 6.7591C20.2342 7.0621 20.0223 7.5651 19.6045 7.5661Z\" />\r\n\t</svg>\r\n\tPlaylist\r\n   </a>\r\n   <a class=\"sidebar-link\" href=\"#\">\r\n\t<svg viewBox=\"0 0 24 24\" fill=\"currentColor\">\r\n\t <path fill-rule=\"evenodd\" clip-rule=\"evenodd\" d=\"M17.769 8.382H22C22 4.985 19.964 3 16.516 3H7.484C4.036 3 2 4.985 2 8.338v7.324C2 19.015 4.036 21 7.484 21h9.032C19.964 21 22 19.015 22 15.662v-.313h-4.231c-1.964 0-3.556-1.552-3.556-3.466 0-1.915 1.592-3.467 3.556-3.467v-.034zm0 1.49h3.484c.413 0 .747.326.747.728v2.531a.746.746 0 01-.747.728H17.85c-.994.013-1.864-.65-2.089-1.595a1.982 1.982 0 01.433-1.652 2.091 2.091 0 011.576-.74zm.151 2.661h.329a.755.755 0 00.764-.745.755.755 0 00-.764-.746h-.329a.766.766 0 00-.54.213.727.727 0 00-.224.524c0 .413.34.75.764.754zM6.738 8.382h5.644a.755.755 0 00.765-.746.755.755 0 00-.765-.745H6.738a.755.755 0 00-.765.737c0 .413.341.75.765.754z\" />\r\n\t</svg>\r\n\tBookmark\r\n   </a>\r\n  </div>\r\n </div>\r\n <div class=\"side-wrapper\">\r\n  <div class=\"side-title\">CATEGORY</div>\r\n  <div class=\"side-menu\">\r\n   <a class=\"sidebar-link\" href=\"#\">\r\n\t<svg viewBox=\"0 0 24 24\" fill=\"currentColor\">\r\n\t <path fill-rule=\"evenodd\" clip-rule=\"evenodd\" d=\"M15.164 6.083l.948.011c3.405 0 5.888 2.428 5.888 5.78v4.307c0 3.353-2.483 5.78-5.888 5.78A193.5 193.5 0 0112.01 22c-1.374 0-2.758-.01-4.122-.038-3.405 0-5.888-2.428-5.888-5.78v-4.307c0-3.353 2.483-5.78 5.898-5.78 1.286-.02 2.6-.04 3.935-.04v-.163c0-.665-.56-1.204-1.226-1.204h-.972c-1.109 0-2.012-.886-2.012-1.965 0-.395.334-.723.736-.723.412 0 .736.328.736.723 0 .289.246.52.54.52h.972c1.481.01 2.688 1.194 2.698 2.64v.183c.619 0 1.238.008 1.859.017zm-4.312 8.663h-1.03v1.02a.735.735 0 01-.737.723.728.728 0 01-.736-.722v-1.021H7.31a.728.728 0 01-.736-.723c0-.395.334-.722.736-.722h1.04v-1.012c0-.395.324-.723.736-.723.403 0 .736.328.736.723v1.012h1.03c.403 0 .737.327.737.722a.728.728 0 01-.736.723zm4.17-1.629h.099a.728.728 0 00.736-.722.735.735 0 00-.736-.723h-.098a.722.722 0 100 1.445zm1.679 3.315h.098a.728.728 0 00.736-.723.735.735 0 00-.736-.723H16.7a.722.722 0 100 1.445z\" />\r\n\t</svg>\r\n\tLive Stream\r\n   </a>\r\n   <a class=\"sidebar-link\" href=\"#\">\r\n\t<svg viewBox=\"0 0 24 24\" fill=\"currentColor\">\r\n\t <path fill-rule=\"evenodd\" clip-rule=\"evenodd\" d=\"M7.33 2h9.34c3.4 0 5.32 1.93 5.33 5.33v9.34c0 3.4-1.93 5.33-5.33 5.33H7.33C3.93 22 2 20.07 2 16.67V7.33C2 3.93 3.93 2 7.33 2zm4.72 15.86c.43 0 .79-.32.83-.75V6.92a.815.815 0 00-.38-.79.84.84 0 00-1.28.79v10.19c.05.43.41.75.83.75zm4.6 0c.42 0 .78-.32.83-.75v-3.28a.839.839 0 00-1.28-.79.806.806 0 00-.38.79v3.28c.04.43.4.75.83.75zm-8.43-.75a.827.827 0 01-.83.75c-.43 0-.79-.32-.83-.75V10.2a.84.84 0 01.39-.79c.27-.17.61-.17.88 0s.42.48.39.79v6.91z\" />\r\n\t</svg>\r\n\tTutorial\r\n   </a>\r\n   <a class=\"sidebar-link\" href=\"#\">\r\n\t<svg viewBox=\"0 0 24 24\" fill=\"currentColor\">\r\n\t <path fill-rule=\"evenodd\" clip-rule=\"evenodd\" d=\"M19.761 12.001c0 .814.668 1.475 1.489 1.475.414 0 .75.333.75.743v2.677C22 19.159 20.142 21 17.858 21H6.143C3.859 21 2 19.159 2 16.896v-2.677c0-.41.336-.743.75-.743.822 0 1.49-.662 1.49-1.475 0-.793-.641-1.39-1.49-1.39a.752.752 0 01-.53-.217.74.74 0 01-.22-.525l.002-2.764C2.002 4.842 3.86 3 6.144 3h11.712c2.284 0 4.143 1.842 4.143 4.105L22 9.782a.741.741 0 01-.219.526.753.753 0 01-.531.218c-.821 0-1.489.662-1.489 1.475zm-5.509.647l1.179-1.137a.73.73 0 00-.409-1.25l-1.629-.236-.729-1.462a.737.737 0 00-.662-.41H12a.74.74 0 00-.663.409l-.729 1.463-1.626.235a.735.735 0 00-.6.498.724.724 0 00.187.753l1.179 1.137-.278 1.608a.727.727 0 00.295.719.742.742 0 00.777.054L12 14.27l1.455.757a.733.733 0 00.78-.053.723.723 0 00.296-.718l-.279-1.608z\" />\r\n\t</svg>\r\n\tCompetation\r\n   </a>\r\n   <a class=\"sidebar-link\" href=\"#\">\r\n\t<svg viewBox=\"0 0 24 24\" fill=\"currentColor\">\r\n\t <path fill-rule=\"evenodd\" clip-rule=\"evenodd\" d=\"M16.158 8.233a4.207 4.207 0 01-4.209 4.234 4.207 4.207 0 01-4.21-4.234A4.206 4.206 0 0111.95 4a4.206 4.206 0 014.21 4.233zM11.95 20c-3.431 0-6.36-.544-6.36-2.72 0-2.177 2.91-2.74 6.36-2.74 3.431 0 6.361.544 6.361 2.72S15.399 20 11.949 20zm6.008-11.69a5.765 5.765 0 01-.984 3.24.158.158 0 00.107.245 3.4 3.4 0 00.483.046c1.643.044 3.118-1.02 3.525-2.621.604-2.379-1.168-4.514-3.425-4.514-.245 0-.48.026-.708.073-.031.007-.064.021-.082.05-.022.034-.006.08.016.11a5.807 5.807 0 011.068 3.37zm2.721 5.203c1.104.217 1.83.66 2.131 1.304a1.923 1.923 0 010 1.67c-.46.998-1.944 1.319-2.52 1.402-.12.018-.215-.086-.203-.206.295-2.767-2.048-4.08-2.654-4.381-.026-.014-.032-.034-.03-.047.003-.009.013-.023.033-.026 1.312-.024 2.722.156 3.243.284zM6.438 11.84c.164-.004.325-.019.483-.046a.158.158 0 00.106-.245 5.765 5.765 0 01-.984-3.24c0-1.25.39-2.416 1.068-3.372.022-.03.037-.075.016-.11-.017-.027-.051-.042-.082-.05a3.52 3.52 0 00-.71-.072c-2.255 0-4.027 2.135-3.423 4.514.407 1.6 1.882 2.664 3.525 2.621zm.159 1.414c.003.013-.003.033-.028.047-.607.302-2.95 1.614-2.656 4.38.013.121-.082.224-.201.207-.577-.083-2.06-.404-2.52-1.402a1.917 1.917 0 010-1.67c.3-.644 1.026-1.087 2.13-1.305.522-.127 1.93-.307 3.244-.283.02.003.03.017.03.026z\" />\r\n\t</svg>\r\n\tCommunity\r\n   </a>\r\n  </div>\r\n </div>\r\n</div>\r\n<div class=\"wrapper\">\r\n <div class=\"header\">\r\n  <div class=\"search-bar\">\r\n   <input type=\"text\" placeholder=\"Search\">\r\n  </div>\r\n  <div class=\"user-settings\">\r\n   <img class=\"user-img\" src=\"https://images.unsplash.com/photo-1587918842454-870dbd18261a?ixlib=rb-1.2.1&ixid=MXwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHw%3D&auto=format&fit=crop&w=943&q=80\" alt=\"\">\r\n   <div class=\"user-name\">Thomas</div>\r\n   <svg viewBox=\"0 0 492 492\" fill=\"currentColor\">\r\n\t<path d=\"M484.13 124.99l-16.11-16.23a26.72 26.72 0 00-19.04-7.86c-7.2 0-13.96 2.79-19.03 7.86L246.1 292.6 62.06 108.55c-5.07-5.06-11.82-7.85-19.03-7.85s-13.97 2.79-19.04 7.85L7.87 124.68a26.94 26.94 0 000 38.06l219.14 219.93c5.06 5.06 11.81 8.63 19.08 8.63h.09c7.2 0 13.96-3.57 19.02-8.63l218.93-219.33A27.18 27.18 0 00492 144.1c0-7.2-2.8-14.06-7.87-19.12z\"></path>\r\n   </svg>\r\n   <div class=\"notify\">\r\n\t<div class=\"notification\"></div>\r\n\t<svg viewBox=\"0 0 24 24\" fill=\"currentColor\">\r\n\t <path fill-rule=\"evenodd\" clip-rule=\"evenodd\" d=\"M18.707 8.796c0 1.256.332 1.997 1.063 2.85.553.628.73 1.435.73 2.31 0 .874-.287 1.704-.863 2.378a4.537 4.537 0 01-2.9 1.413c-1.571.134-3.143.247-4.736.247-1.595 0-3.166-.068-4.737-.247a4.532 4.532 0 01-2.9-1.413 3.616 3.616 0 01-.864-2.378c0-.875.178-1.682.73-2.31.754-.854 1.064-1.594 1.064-2.85V8.37c0-1.682.42-2.781 1.283-3.858C7.861 2.942 9.919 2 11.956 2h.09c2.08 0 4.204.987 5.466 2.625.82 1.054 1.195 2.108 1.195 3.745v.426zM9.074 20.061c0-.504.462-.734.89-.833.5-.106 3.545-.106 4.045 0 .428.099.89.33.89.833-.025.48-.306.904-.695 1.174a3.635 3.635 0 01-1.713.731 3.795 3.795 0 01-1.008 0 3.618 3.618 0 01-1.714-.732c-.39-.269-.67-.694-.695-1.173z\" />\r\n\t</svg>\r\n   </div>\r\n  </div>\r\n </div>\r\n <div class=\"main-container\">\r\n  <div class=\"main-header anim\" style=\"--delay: 0s\">Discover</div>\r\n  <div class=\"main-blogs\">\r\n   <div class=\"main-blog anim\" style=\"--delay: .1s\">\r\n\t<div class=\"main-blog__title\">How to do Basic Jumping and how to landing safely</div>\r\n\t<div class=\"main-blog__author\">\r\n\t <div class=\"author-img__wrapper\">\r\n\t  <svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"3\" stroke-linecap=\"round\" stroke-linejoin=\"round\" class=\"feather feather-check\">\r\n\t   <path d=\"M20 6L9 17l-5-5\" />\r\n\t  </svg>\r\n\t  <img class=\"author-img\" src=\"https://images.unsplash.com/photo-1560941001-d4b52ad00ecc?ixid=MXwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHw%3D&ixlib=rb-1.2.1&auto=format&fit=crop&w=1650&q=80\" />\r\n\t </div>\r\n\t <div class=\"author-detail\">\r\n\t  <div class=\"author-name\">Thomas Hope</div>\r\n\t  <div class=\"author-info\">53K views <span class=\"seperate\"></span>2 weeks ago</div>\r\n\t </div>\r\n\t</div>\r\n\t<div class=\"main-blog__time\">7 min</div>\r\n   </div>\r\n   <div class=\"main-blog anim\" style=\"--delay: .2s\">\r\n\t<div class=\"main-blog__title\">Skateboard Tips You need to know</div>\r\n\t<div class=\"main-blog__author tips\">\r\n\t <div class=\"main-blog__time\">7 min</div>\r\n\t <div class=\"author-img__wrapper\">\r\n\t  <svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"3\" stroke-linecap=\"round\" stroke-linejoin=\"round\" class=\"feather feather-check\">\r\n\t   <path d=\"M20 6L9 17l-5-5\" />\r\n\t  </svg>\r\n\t  <img class=\"author-img\" src=\"https://images.unsplash.com/photo-1496345875659-11f7dd282d1d?ixid=MXwxMjA3fDB8MHxzZWFyY2h8Mzl8fG1lbnxlbnwwfHwwfA%3D%3D&ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=60\" />\r\n\t </div>\r\n\t <div class=\"author-detail\">\r\n\t  <div class=\"author-name\">Tony Andrew</div>\r\n\t  <div class=\"author-info\">53K views <span></span>2 weeks ago</div>\r\n\t </div>\r\n\t</div>\r\n   </div>\r\n  </div>\r\n  <div class=\"small-header anim\" style=\"--delay: .3s\">Most Watched</div>\r\n  <div class=\"videos\">\r\n   <div class=\"video anim\" style=\"--delay: .4s\">\r\n\t<div class=\"video-time\">8 min</div>\r\n\t<div class=\"video-wrapper\">\r\n\t <video muted=\"\">\r\n\t  <source src=\"https://player.vimeo.com/external/436572488.sd.mp4?s=eae5fb490e214deb9ff532dd98d101efe94e7a8b&profile_id=139&oauth2_token_id=57447761\" type=\"video/mp4\">\r\n\t </video>\r\n\t <div class=\"author-img__wrapper video-author\">\r\n\t  <svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"3\" stroke-linecap=\"round\" stroke-linejoin=\"round\" class=\"feather feather-check\">\r\n\t   <path d=\"M20 6L9 17l-5-5\" />\r\n\t  </svg>\r\n\t  <img class=\"author-img\" src=\"https://images.pexels.com/photos/1680172/pexels-photo-1680172.jpeg?auto=compress&cs=tinysrgb&dpr=2&w=500\" />\r\n\t </div>\r\n\t</div>\r\n\t<div class=\"video-by\">Andy William</div>\r\n\t<div class=\"video-name\">Basic how to ride your skateboard comfortly</div>\r\n\t<div class=\"video-view\">54K views<span class=\"seperate video-seperate\"></span>1 week ago</div>\r\n   </div>\r\n   <div class=\"video anim\" style=\"--delay: .5s\">\r\n\t<div class=\"video-time\">5 min</div>\r\n\t<div class=\"video-wrapper\">\r\n\t <video muted=\"\">\r\n\t  <source src=\"https://player.vimeo.com/external/449972745.sd.mp4?s=9943177fe8a6147b7bc4598259401f06ec57878a&profile_id=139&oauth2_token_id=57447761\" type=\"video/mp4\">\r\n\t </video>\r\n\t <div class=\"author-img__wrapper video-author\">\r\n\t  <svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"3\" stroke-linecap=\"round\" stroke-linejoin=\"round\" class=\"feather feather-check\">\r\n\t   <path d=\"M20 6L9 17l-5-5\" />\r\n\t  </svg>\r\n\t  <img class=\"author-img\" src=\"https://images.pexels.com/photos/3370021/pexels-photo-3370021.jpeg?auto=compress&cs=tinysrgb&dpr=2&w=500\" />\r\n\t </div>\r\n\t</div>\r\n\t<div class=\"video-by offline\">Gerard Bind</div>\r\n\t<div class=\"video-name\">Prepare for your first skateboard jump</div>\r\n\t<div class=\"video-view\">42K views<span class=\"seperate video-seperate\"></span>1 week ago</div>\r\n   </div>\r\n   <div class=\"video anim\" style=\"--delay: .6s\">\r\n\t<div class=\"video-time\">7 min</div>\r\n\t<div class=\"video-wrapper\">\r\n\t <video muted=\"\">\r\n\t  <source src=\"https://player.vimeo.com/external/436553499.sd.mp4?s=0e44527f269278743db448761e35c5e39cfaa52c&profile_id=139&oauth2_token_id=57447761\" type=\"video/mp4\">\r\n\t </video>\r\n\t <div class=\"author-img__wrapper video-author\">\r\n\t  <svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"3\" stroke-linecap=\"round\" stroke-linejoin=\"round\" class=\"feather feather-check\">\r\n\t   <path d=\"M20 6L9 17l-5-5\" />\r\n\t  </svg>\r\n\t  <img class=\"author-img\" src=\"https://images.pexels.com/photos/1870163/pexels-photo-1870163.jpeg?auto=compress&cs=tinysrgb&dpr=2&w=500\" />\r\n\t </div>\r\n\t</div>\r\n\t<div class=\"video-by offline\">John Wise</div>\r\n\t<div class=\"video-name\">Basic equipment to play skateboard safely</div>\r\n\t<div class=\"video-view\">64K views<span class=\"seperate video-seperate\"></span>2 week ago</div>\r\n   </div>\r\n   <div class=\"video anim\" style=\"--delay: .7s\">\r\n\t<div class=\"video-time\">6 min</div>\r\n\t<div class=\"video-wrapper\">\r\n\t <video muted=\"\">\r\n\t  <source src=\"https://player.vimeo.com/external/361861493.sd.mp4?s=19d8275ca755d653042a87ef28b2f0b2eabf57d0&profile_id=139&oauth2_token_id=57447761\" type=\"video/mp4\">\r\n\t </video>\r\n\t <div class=\"author-img__wrapper video-author\">\r\n\t  <svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"3\" stroke-linecap=\"round\" stroke-linejoin=\"round\" class=\"feather feather-check\">\r\n\t   <path d=\"M20 6L9 17l-5-5\" />\r\n\t  </svg>\r\n\t  <img class=\"author-img\" src=\"https://images.pexels.com/photos/2889942/pexels-photo-2889942.jpeg?auto=compress&cs=tinysrgb&dpr=2&w=500\" />\r\n\t </div>\r\n\t</div>\r\n\t<div class=\"video-by\">Budi Hakim</div>\r\n\t<div class=\"video-name\">Tips to playing skateboard on the ramp</div>\r\n\t<div class=\"video-view\">50K views<span class=\"seperate video-seperate\"></span>1 week ago</div>\r\n   </div>\r\n  </div>\r\n  <div class=\"stream-area\">\r\n   <div class=\"video-stream\">\r\n\t<video id=\"my_video_1\" class=\"video-js vjs-default-skin anim\" width=\"640px\" height=\"267px\" controls preload=\"none\" poster='https://images.unsplash.com/photo-1476801071117-fbc157ae3f01?ixlib=rb-1.2.1&ixid=MXwxMjA3fDB8MHxwaG90by1yZWxhdGVkfDh8fHxlbnwwfHx8&w=1000&q=80' data-setup='{ \"aspectRatio\":\"940:620\", \"playbackRates\": [1, 1.5, 2] }'>\r\n\t <source src=\"https://player.vimeo.com/external/390402719.sd.mp4?s=20cfdb066c4253047562b65bd4e411b86a004bc5&profile_id=139&oauth2_token_id=57447761\" type='video/mp4' />\r\n\t <source src=\"https://player.vimeo.com/external/390402719.sd.mp4?s=20cfdb066c4253047562b65bd4e411b86a004bc5&profile_id=139&oauth2_token_id=57447761\" type='video/webm' />\r\n\t</video>\r\n\t<div class=\"video-detail\">\r\n\t <div class=\"video-content\">\r\n\t  <div class=\"video-p-wrapper anim\" style=\"--delay: .1s\">\r\n\t   <div class=\"author-img__wrapper video-author video-p\">\r\n\t\t<svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"3\" stroke-linecap=\"round\" stroke-linejoin=\"round\" class=\"feather feather-check\">\r\n\t\t <path d=\"M20 6L9 17l-5-5\" />\r\n\t\t</svg>\r\n\t\t<img class=\"author-img\" src=\"https://images.pexels.com/photos/1680172/pexels-photo-1680172.jpeg?auto=compress&cs=tinysrgb&dpr=2&w=500\" />\r\n\t   </div>\r\n\t   <div class=\"video-p-detail\">\r\n\t\t<div class=\"video-p-name\">Andy William</div>\r\n\t\t<div class=\"video-p-sub\">1,980,893 subscribers</div>\r\n\t   </div>\r\n\t   <div class=\"button-wrapper\">\r\n\t\t<button class=\"like\">\r\n\t\t <svg viewBox=\"0 0 24 24\" fill=\"currentColor\" xmlns=\"http://www.w3.org/2000/svg\">\r\n\t\t  <path d=\"M21.435 2.582a1.933 1.933 0 00-1.93-.503L3.408 6.759a1.92 1.92 0 00-1.384 1.522c-.142.75.355 1.704 1.003 2.102l5.033 3.094a1.304 1.304 0 001.61-.194l5.763-5.799a.734.734 0 011.06 0c.29.292.29.765 0 1.067l-5.773 5.8c-.428.43-.508 1.1-.193 1.62l3.075 5.083c.36.604.98.946 1.66.946.08 0 .17 0 .251-.01.78-.1 1.4-.634 1.63-1.39l4.773-16.075c.21-.685.02-1.43-.48-1.943z\" />\r\n\t\t </svg>\r\n\t\t Share\r\n\t\t</button>\r\n\t\t<button class=\"like red\">\r\n\t\t <svg viewBox=\"0 0 24 24\" fill=\"currentColor\" xmlns=\"http://www.w3.org/2000/svg\">\r\n\t\t  <path fill-rule=\"evenodd\" clip-rule=\"evenodd\" d=\"M15.85 2.5c.63 0 1.26.09 1.86.29 3.69 1.2 5.02 5.25 3.91 8.79a12.728 12.728 0 01-3.01 4.81 38.456 38.456 0 01-6.33 4.96l-.25.15-.26-.16a38.093 38.093 0 01-6.37-4.96 12.933 12.933 0 01-3.01-4.8c-1.13-3.54.2-7.59 3.93-8.81.29-.1.59-.17.89-.21h.12c.28-.04.56-.06.84-.06h.11c.63.02 1.24.13 1.83.33h.06c.04.02.07.04.09.06.22.07.43.15.63.26l.38.17c.092.05.195.125.284.19.056.04.107.077.146.1l.05.03c.085.05.175.102.25.16a6.263 6.263 0 013.85-1.3zm2.66 7.2c.41-.01.76-.34.79-.76v-.12a3.3 3.3 0 00-2.11-3.16.8.8 0 00-1.01.5c-.14.42.08.88.5 1.03.64.24 1.07.87 1.07 1.57v.03a.86.86 0 00.19.62c.14.17.35.27.57.29z\" />\r\n\t\t </svg>\r\n\t\t Liked\r\n\t\t</button>\r\n\t   </div>\r\n\t  </div>\r\n\t  <div class=\"video-p-title anim\" style=\"--delay: .2s\">Basic how to ride your Skateboard</div>\r\n\t  <div class=\"video-p-subtitle anim\" style=\"--delay: .3s\">Lorem ipsum dolor sit amet consectetur adipisicing elit. Repellendus illum tempora consequuntur. Lorem ipsum dolor sit amet consectetur adipisicing elit. Debitis earum velit accusantium maiores qui sit quas, laborum voluptatibus vero quidem tempore facilis voluptate tempora deserunt! </div>\r\n\t  <div class=\"video-p-subtitle anim\" style=\"--delay: .4s\">Lorem ipsum dolor sit amet consectetur adipisicing elit. Temporibus laborum qui dolorum fugiat eius accusantium repellendus illum tempora consequuntur. Lorem ipsum dolor, sit amet consectetur adipisicing elit.</div>\r\n\t </div>\r\n\t</div>\r\n   </div>\r\n   <div class=\"chat-stream\">\r\n\t<div class=\"chat\">\r\n\t <div class=\"chat-header anim\">Live Chat<span><svg viewBox=\"0 0 24 24\" fill=\"currentColor\" xmlns=\"http://www.w3.org/2000/svg\">\r\n\t\t<path fill-rule=\"evenodd\" clip-rule=\"evenodd\" d=\"M14.212 7.762c0 2.644-2.163 4.763-4.863 4.763-2.698 0-4.863-2.119-4.863-4.763C4.486 5.12 6.651 3 9.35 3c2.7 0 4.863 2.119 4.863 4.762zM2 17.917c0-2.447 3.386-3.06 7.35-3.06 3.985 0 7.349.634 7.349 3.083 0 2.448-3.386 3.06-7.35 3.06C5.364 21 2 20.367 2 17.917zM16.173 7.85a6.368 6.368 0 01-1.137 3.646c-.075.107-.008.252.123.275.182.03.369.048.56.052 1.898.048 3.601-1.148 4.072-2.95.697-2.675-1.35-5.077-3.957-5.077a4.16 4.16 0 00-.818.082c-.036.008-.075.025-.095.055-.025.04-.007.09.019.124a6.414 6.414 0 011.233 3.793zm3.144 5.853c1.276.245 2.115.742 2.462 1.467a2.107 2.107 0 010 1.878c-.531 1.123-2.245 1.485-2.912 1.578a.207.207 0 01-.234-.232c.34-3.113-2.367-4.588-3.067-4.927-.03-.017-.036-.04-.034-.055.002-.01.015-.025.038-.028 1.515-.028 3.145.176 3.747.32z\" />\r\n\t   </svg>\r\n\t   15,988 people\r\n\t  </span>\r\n\t </div>\r\n\t <div class=\"message-container\">\r\n\t  <div class=\"message anim\" style=\"--delay: .1s\">\r\n\t   <div class=\"author-img__wrapper video-author video-p\">\r\n\t\t<svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"3\" stroke-linecap=\"round\" stroke-linejoin=\"round\" class=\"feather feather-check\">\r\n\t\t <path d=\"M20 6L9 17l-5-5\" />\r\n\t\t</svg>\r\n\t\t<img class=\"author-img\" src=\"https://images.unsplash.com/photo-1560941001-d4b52ad00ecc?ixid=MXwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHw%3D&ixlib=rb-1.2.1&auto=format&fit=crop&w=1650&q=80\" />\r\n\t   </div>\r\n\t   <div class=\"msg-wrapper\">\r\n\t\t<div class=\"msg__name video-p-name\"> Wijaya Adabi</div>\r\n\t\t<div class=\"msg__content video-p-sub\"> Lorem ipsum clor sit, ame conse quae debitis</div>\r\n\t   </div>\r\n\t  </div>\r\n\t  <div class=\"message anim\" style=\"--delay: .2s\">\r\n\t   <div class=\"author-img__wrapper video-author video-p\">\r\n\t\t<svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"3\" stroke-linecap=\"round\" stroke-linejoin=\"round\" class=\"feather feather-check\">\r\n\t\t <path d=\"M20 6L9 17l-5-5\" />\r\n\t\t</svg>\r\n\t\t<img class=\"author-img\" src=\"https://images.pexels.com/photos/2889942/pexels-photo-2889942.jpeg?auto=compress&cs=tinysrgb&dpr=2&w=500\" />\r\n\t   </div>\r\n\t   <div class=\"msg-wrapper\">\r\n\t\t<div class=\"msg__name video-p-name offline\"> Johny Wise</div>\r\n\t\t<div class=\"msg__content video-p-sub\"> Suscipit eos atque voluptates labore</div>\r\n\t   </div>\r\n\t  </div>\r\n\t  <div class=\"message anim\" style=\"--delay: .3s\">\r\n\t   <div class=\"author-img__wrapper video-author video-p\">\r\n\t\t<svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"3\" stroke-linecap=\"round\" stroke-linejoin=\"round\" class=\"feather feather-check\">\r\n\t\t <path d=\"M20 6L9 17l-5-5\" />\r\n\t\t</svg>\r\n\t\t<img class=\"author-img\" src=\"https://images.unsplash.com/photo-1496345875659-11f7dd282d1d?ixid=MXwxMjA3fDB8MHxzZWFyY2h8Mzl8fG1lbnxlbnwwfHwwfA%3D%3D&ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=60\" />\r\n\t   </div>\r\n\t   <div class=\"msg-wrapper\">\r\n\t\t<div class=\"msg__name video-p-name offline\"> Budi Hakim</div>\r\n\t\t<div class=\"msg__content video-p-sub\">Dicta quidem sunt adipisci</div>\r\n\t   </div>\r\n\t  </div>\r\n\t  <div class=\"message anim\" style=\"--delay: .4s\">\r\n\t   <div class=\"author-img__wrapper video-author video-p\">\r\n\t\t<svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"3\" stroke-linecap=\"round\" stroke-linejoin=\"round\" class=\"feather feather-check\">\r\n\t\t <path d=\"M20 6L9 17l-5-5\" />\r\n\t\t</svg>\r\n\t\t<img class=\"author-img\" src=\"https://images.pexels.com/photos/1870163/pexels-photo-1870163.jpeg?auto=compress&cs=tinysrgb&dpr=2&w=500\" />\r\n\t   </div>\r\n\t   <div class=\"msg-wrapper\">\r\n\t\t<div class=\"msg__name video-p-name\"> Thomas Hope</div>\r\n\t\t<div class=\"msg__content video-p-sub\"> recusandae doloremque aperiam alias molestias</div>\r\n\t   </div>\r\n\t  </div>\r\n\t  <div class=\"message anim\" style=\"--delay: .5s\">\r\n\t   <div class=\"author-img__wrapper video-author video-p\">\r\n\t\t<svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"3\" stroke-linecap=\"round\" stroke-linejoin=\"round\" class=\"feather feather-check\">\r\n\t\t <path d=\"M20 6L9 17l-5-5\" />\r\n\t\t</svg>\r\n\t\t<img class=\"author-img\" src=\"https://images.pexels.com/photos/1680172/pexels-photo-1680172.jpeg?auto=compress&cs=tinysrgb&dpr=2&w=500\" />\r\n\t   </div>\r\n\t   <div class=\"msg-wrapper\">\r\n\t\t<div class=\"msg__name video-p-name\"> Gerard Will</div>\r\n\t\t<div class=\"msg__content video-p-sub\">Dicta quidem sunt adipisci</div>\r\n\t   </div>\r\n\t  </div>\r\n\t  <div class=\"message anim\" style=\"--delay: .6s\">\r\n\t   <div class=\"author-img__wrapper video-author video-p\">\r\n\t\t<svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"3\" stroke-linecap=\"round\" stroke-linejoin=\"round\" class=\"feather feather-check\">\r\n\t\t <path d=\"M20 6L9 17l-5-5\" />\r\n\t\t</svg>\r\n\t\t<img class=\"author-img\" src=\"https://images.pexels.com/photos/2889942/pexels-photo-2889942.jpeg?auto=compress&cs=tinysrgb&dpr=2&w=500\" />\r\n\t   </div>\r\n\t   <div class=\"msg-wrapper\">\r\n\t\t<div class=\"msg__name video-p-name offline\">Johny Wise</div>\r\n\t\t<div class=\"msg__content video-p-sub\"> recusandae doloremque aperiam alias molestias</div>\r\n\t   </div>\r\n\t  </div>\r\n\t </div>\r\n\t <div class=\"chat-footer anim\" style=\"--delay: .1s\">\r\n\t  <input type=\"text\" placeholder=\"Write your message\">\r\n\t </div>\r\n\t</div>\r\n\t<div class=\"chat-vid__container\">\r\n\t <div class=\"chat-vid__title anim\" style=\"--delay: .3s\">Related Videos</div>\r\n\t <div class=\"chat-vid anim\" style=\"--delay: .4s\">\r\n\t  <div class=\"chat-vid__wrapper\">\r\n\t   <img class=\"chat-vid__img\" src=\"https://cdn.nohat.cc/thumb/f/720/3b55eddcfffa4e87897d.jpg\" />\r\n\t   <div class=\"chat-vid__content\">\r\n\t\t<div class=\"chat-vid__name\">Prepare for your first skateboard jump</div>\r\n\t\t<div class=\"chat-vid__by\">Jordan Wise</div>\r\n\t\t<div class=\"chat-vid__info\">125.908 views <span class=\"seperate\"></span>2 days ago</div>\r\n\t   </div>\r\n\t  </div>\r\n\t </div>\r\n\t <div class=\"chat-vid anim\" style=\"--delay: .5s\">\r\n\t  <div class=\"chat-vid__wrapper\">\r\n\t   <img class=\"chat-vid__img\" src=\"https://iamaround.it/wp-content/uploads/2015/02/pexels-photo-4663818.jpeg\" />\r\n\t   <div class=\"chat-vid__content\">\r\n\t\t<div class=\"chat-vid__name\">Prepare for your first skateboard jump</div>\r\n\t\t<div class=\"chat-vid__by\">Jordan Wise</div>\r\n\t\t<div class=\"chat-vid__info\">125.908 views <span class=\"seperate\"></span>2 days ago</div>\r\n\t   </div>\r\n\t  </div>\r\n\t </div>\r\n\t <div class=\"chat-vid__button anim\" style=\"--delay: .6s\">See All related videos (32)</div>\r\n\t</div>\r\n   </div>\r\n  </div>\r\n </div>\r\n</div>\r\n</div>\r\n\r\n<script src=\"https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js\"></script>`;\r\n\r\nconst CCode = ``;\r\n\r\nconst Cpp99Code = ``\r\n\r\nconst CppCode = ``\r\n\r\nconst Cpp14Code = ``\r\n\r\nconst Cpp17Code = ``\r\n\r\nconst Python2Code = ``\r\n\r\nconst Python3Code = ``\r\n\r\nconst files = {\r\n  \"script.js\": {\r\n    type: \"file\",\r\n    name: \"script.js\",\r\n    language: \"javascript\",\r\n    value: JSCode,\r\n    class : \"jsfile\",\r\n    icon : \"fab fa-js-square\",\r\n    btntext : \"script\",\r\n    func : js()\r\n  },\r\n  \"style.css\": {\r\n    type: \"file\",\r\n    name: \"style.css\",\r\n    language: \"css\",\r\n    value: CSSCode,\r\n    class : \"cssfile\",\r\n    icon : \"fab fa-css3-alt\",\r\n    btntext : \"style\",\r\n    func : css()\r\n  },\r\n  \"index.html\": {\r\n    type: \"file\",\r\n    name: \"index.html\",\r\n    language: \"html\",\r\n    value: HTMLCode,\r\n    class : \"htmlfile\",\r\n    icon : \"fab fa-html5\",\r\n    btntext : \"html\",\r\n    func : html()\r\n  },\r\n  \"c\": {\r\n    type: \"file\",\r\n    name: \"main.c\",\r\n    language: \"cpp\",\r\n    value: CCode\r\n  },\r\n  \"c99\": {\r\n    type: \"file\",\r\n    name: \"main.cpp\",\r\n    language: \"cpp\",\r\n    value: Cpp99Code\r\n  },\r\n  \"cpp\": {\r\n    type: \"file\",\r\n    name: \"main.cpp\",\r\n    language: \"cpp\",\r\n    value: CppCode\r\n  },\r\n  \"cpp14\": {\r\n    type: \"file\",\r\n    name: \"main.cpp\",\r\n    language: \"cpp\",\r\n    value: Cpp14Code\r\n  },\r\n  \"cpp17\": {\r\n    type: \"file\",\r\n    name: \"main.cpp\",\r\n    language: \"cpp\",\r\n    value: Cpp17Code\r\n  },\r\n  \"python2\": {\r\n    type: \"file\",\r\n    name: \"python\",\r\n    language: \"python\",\r\n    value: JSCode\r\n  },\r\n  \"python3\": {\r\n    type: \"file\",\r\n    name: \"python\",\r\n    language: \"python\",\r\n    value: Python3Code\r\n  }\r\n};\r\n\r\nexport const webDFiles = [\r\n  {\r\n      \"type\": \"directory\",\r\n      \"name\": \"test_folder\",\r\n      \"children\": [\r\n          \"5s3NmK28yQTyqV3UWVceg\",\r\n          \"sa1GQ3eYSvOv1kRvhEoQV\",\r\n          \"wjS-tGoSLre8AUnuLXiim\",\r\n          \"o-KZ6TIhTfeClAUkKFhwF\"\r\n      ],\r\n      \"id\": \"zQWR3ITnahzb-SK-aP7Ao\",\r\n      \"content\": \"\"\r\n  },\r\n  {\r\n      \"type\": \"directory\",\r\n      \"name\": \"another_folder\",\r\n      \"id\": \"5s3NmK28yQTyqV3UWVceg\",\r\n      \"children\": [\r\n          \"6zgImNpHX5gcQq9AMCsGF\"\r\n      ],\r\n      \"content\": \"\"\r\n  },\r\n  {\r\n      \"type\": \"file\",\r\n      \"name\": \"index.html\",\r\n      \"id\": \"sa1GQ3eYSvOv1kRvhEoQV\",\r\n      \"children\": [],\r\n      \"content\": \"\"\r\n  },\r\n  {\r\n      \"type\": \"file\",\r\n      \"name\": \"index.html\",\r\n      \"id\": \"6zgImNpHX5gcQq9AMCsGF\",\r\n      \"children\": [],\r\n      \"content\": \"aman\"\r\n  },\r\n  {\r\n      \"type\": \"file\",\r\n      \"name\": \"script.js\",\r\n      \"id\": \"wjS-tGoSLre8AUnuLXiim\",\r\n      \"children\": [],\r\n      \"content\": \"aman\"\r\n  },\r\n  {\r\n      \"type\": \"file\",\r\n      \"name\": \"style.css\",\r\n      \"id\": \"o-KZ6TIhTfeClAUkKFhwF\",\r\n      \"children\": [],\r\n      \"content\": \"aman\"\r\n  }\r\n]\r\n\r\nexport default files;\r\n","export const js = () => {\r\n    return {\r\n        type: \"js\"\r\n    };\r\n};\r\n\r\nexport const css = () => {\r\n    return {\r\n        type: \"css\"\r\n    };\r\n};\r\n\r\nexport const html = () => {\r\n    return {\r\n        type: \"html\"\r\n    };\r\n};\r\n\r\nexport const outputModalTrue = () => {\r\n    return {\r\n        type: \"outputtrue\"\r\n    };\r\n};\r\n\r\nexport const outputModalFalse = () => {\r\n    return {\r\n        type: \"outputfalse\"\r\n    };\r\n};\r\n\r\nexport const setSrcDocs = () => {\r\n    return {\r\n        type : \"setSrcdoc\",\r\n    }\r\n}\r\n\r\nexport const c = () => {\r\n    return {\r\n        type : \"c\",\r\n    }\r\n}\r\n\r\nexport const c99 = () => {\r\n    return {\r\n        type : \"c99\",\r\n    }\r\n}\r\n\r\nexport const cpp = () => {\r\n    return {\r\n        type : \"cpp\",\r\n    }\r\n}\r\n\r\nexport const cpp14 = () => {\r\n    return {\r\n        type : \"cpp14\",\r\n    }\r\n}\r\n\r\nexport const cpp17 = () => {\r\n    return {\r\n        type : \"cpp17\",\r\n    }\r\n}\r\n\r\nexport const python2 = () => {\r\n    return {\r\n        type : \"python2\",\r\n    }\r\n}\r\n\r\nexport const python3 = () => {\r\n    return {\r\n        type : \"python3\",\r\n    }\r\n}\r\n\r\nexport const changefile = (file_id) => {\r\n    return {\r\n        type : \"changefile\",\r\n        f_id : file_id\r\n    }\r\n}\r\n\r\nexport const uploadfile = (files) => {\r\n    return {\r\n        type : \"uploadfile\",\r\n        file : files\r\n    }\r\n}","import React, { useState, useEffect, useRef } from \"react\";\r\nimport { useSelector, useDispatch } from \"react-redux\";\r\nimport { Hook, Console, Unhook } from \"console-feed\";\r\nimport Editor from \"@monaco-editor/react\";\r\nimport Split from \"react-split\";\r\nimport { js, css, html, setSrcDocs, changefile, uploadfile } from \"../actions\";\r\nimport files from \"../assets/files\";\r\nimport { nanoid } from 'nanoid'\r\nimport \"./style.css\";\r\nimport ChalkBoard from \"../ChalkBoard\";\r\n\r\nfunction TextEditor(props) {\r\n  const srcDoc = useSelector((state) => state.srcDocs);\r\n  const [logs, setLogs] = useState([]);\r\n  const fileName = useSelector((state) => state.fileName);\r\n  const webDFiles = useSelector((state) => state.files);\r\n  const [Ln, setLn] = useState(1);\r\n  const [Col, setCol] = useState(1);\r\n  const dispatch = useDispatch();\r\n  const editorRef = useRef(null);\r\n  var editorLang = \"html\";\r\n  const file = files[\"index.html\"];\r\n  const curr = useSelector((state) => state.fileName);\r\n\r\n  function handleEditorChange(value) {\r\n    file.value = value;\r\n  }\r\n\r\n  function handleEditorDidMount(editor, monaco) {\r\n    editorRef.current = editor;\r\n    \r\n    //monaco editor custom language color\r\n    // https://microsoft.github.io/monaco-editor/playground.html#extending-language-services-custom-language\r\n    monaco.editor.defineTheme('ace', {\r\n      base: 'vs',\r\n      inherit: true,\r\n      rules: [\r\n        { token: '', foreground: '5c6773' },\r\n        { token: 'invalid', foreground: 'ff3333' },\r\n        { token: 'emphasis', fontStyle: 'italic' },\r\n        { token: 'strong', fontStyle: 'bold' },\r\n        { token: 'variable', foreground: '5c6773' },\r\n        { token: 'variable.predefined', foreground: '5c6773' },\r\n        { token: 'constant', foreground: 'f08c36' },\r\n        { token: 'comment', foreground: 'abb0b6', fontStyle: 'italic' },\r\n        { token: 'number', foreground: 'f08c36' },\r\n        { token: 'number.hex', foreground: 'f08c36' },\r\n        { token: 'regexp', foreground: '4dbf99' },\r\n        { token: 'annotation', foreground: '41a6d9' },\r\n        { token: 'type', foreground: '41a6d9' },\r\n        { token: 'delimiter', foreground: '5c6773' },\r\n        { token: 'delimiter.html', foreground: '5c6773' },\r\n        { token: 'delimiter.xml', foreground: '5c6773' },\r\n        { token: 'tag', foreground: 'e7c547' },\r\n        { token: 'tag.id.jade', foreground: 'e7c547' },\r\n        { token: 'tag.class.jade', foreground: 'e7c547' },\r\n        { token: 'meta.scss', foreground: 'e7c547' },\r\n        { token: 'metatag', foreground: 'e7c547' },\r\n        { token: 'metatag.content.html', foreground: '86b300' },\r\n        { token: 'metatag.html', foreground: 'e7c547' },\r\n        { token: 'metatag.xml', foreground: 'e7c547' },\r\n        { token: 'metatag.php', fontStyle: 'bold' },\r\n        { token: 'key', foreground: '41a6d9' },\r\n        { token: 'string.key.json', foreground: '41a6d9' },\r\n        { token: 'string.value.json', foreground: '86b300' },\r\n        { token: 'attribute.name', foreground: 'f08c36' },\r\n        { token: 'attribute.value', foreground: '0451A5' },\r\n        { token: 'attribute.value.number', foreground: 'abb0b6' },\r\n        { token: 'attribute.value.unit', foreground: '86b300' },\r\n        { token: 'attribute.value.html', foreground: '86b300' },\r\n        { token: 'attribute.value.xml', foreground: '86b300' },\r\n        { token: 'string', foreground: '86b300' },\r\n        { token: 'string.html', foreground: '86b300' },\r\n        { token: 'string.sql', foreground: '86b300' },\r\n        { token: 'string.yaml', foreground: '86b300' },\r\n        { token: 'keyword', foreground: 'f2590c' },\r\n        { token: 'keyword.json', foreground: 'f2590c' },\r\n        { token: 'keyword.flow', foreground: 'f2590c' },\r\n        { token: 'keyword.flow.scss', foreground: 'f2590c' },\r\n        { token: 'operator.scss', foreground: '666666' }, //\r\n        { token: 'operator.sql', foreground: '778899' }, //\r\n        { token: 'operator.swift', foreground: '666666' }, //\r\n        { token: 'predefined.sql', foreground: 'FF00FF' }, //\r\n      ],\r\n      colors: {\r\n        'editor.background': '#fafafa',\r\n        'editor.foreground': '#5c6773',\r\n        'editorIndentGuide.background': '#ecebec',\r\n        'editorIndentGuide.activeBackground': '#e0e0e0',\r\n      },\r\n    });\r\n\r\n    // monaco.editor.setTheme('ace');\r\n  }\r\n\r\n  function handleEditorSearch() {\r\n    editorRef.current.focus();\r\n    editorRef.current.trigger('', 'actions.find');\r\n  }\r\n  function handleFullScreen() {\r\n    let eve2 = new KeyboardEvent(\"keydown\", {\r\n      altKey: false,\r\n      bubbles: true,\r\n      cancelBubble: false,\r\n      cancelable: true,\r\n      charCode: 0,\r\n      code: \"ControlLeft\",\r\n      composed: true,\r\n      ctrlKey: true,\r\n      currentTarget: null,\r\n      defaultPrevented: false,\r\n      detail: 0,\r\n      eventPhase: 0,\r\n      isComposing: false,\r\n      key: \"Control\",\r\n      keyCode: 17,\r\n      location: 1,\r\n    });\r\n    let eve = new KeyboardEvent(\"keydown\", {\r\n      altKey: false,\r\n      bubbles: true,\r\n      cancelBubble: false,\r\n      cancelable: true,\r\n      charCode: 0,\r\n      code: \"KeyF\",\r\n      composed: true,\r\n      ctrlKey: false,\r\n      currentTarget: null,\r\n      defaultPrevented: false,\r\n      detail: 0,\r\n      eventPhase: 0,\r\n      isComposing: false,\r\n      key: \"f\",\r\n      keyCode: 70,\r\n      location: 0,\r\n    });\r\n    document.dispatchEvent(eve2);\r\n    document.dispatchEvent(eve);\r\n  }\r\n\r\n  useEffect(() => {\r\n    let timer;\r\n    let consoleView = false;\r\n    let selectedSidebar = false;\r\n    const waitTime = 500; //in ms\r\n    const codeText = document.getElementsByClassName(\"code_text\")[0]\r\n    dispatch(setSrcDocs());\r\n      codeText\r\n      .addEventListener(\"keyup\", function () {\r\n        setLn(editorRef.current.getPosition().lineNumber);\r\n        setCol(editorRef.current.getPosition().column);\r\n      });\r\n      codeText\r\n      .addEventListener(\"keyup\", function () {\r\n        clearTimeout(timer);\r\n        timer = setTimeout(() => {\r\n          dispatch(setSrcDocs());\r\n        }, waitTime);\r\n      });\r\n\r\n      codeText\r\n      .addEventListener(\"click\", function () {\r\n        clearTimeout(timer);\r\n        timer = setTimeout(() => {\r\n          dispatch(setSrcDocs());\r\n        }, waitTime);\r\n        setLn(editorRef.current.getPosition().lineNumber);\r\n        setCol(editorRef.current.getPosition().column);\r\n      });\r\n\r\n    document.addEventListener(\"keydown\", function (e) {\r\n      console.log(e);\r\n    });\r\n    document.getElementsByClassName(\"suprise_button\")[0].addEventListener(\"click\", async function () {\r\n      const directoryHandle = await window.showDirectoryPicker()\r\n      let folderName = `${directoryHandle.name}`;\r\n\r\n      const dir = [ \r\n        {\r\n          type : 'directory',\r\n          name : folderName,\r\n          children : [],\r\n          id : nanoid(),\r\n          content : '',\r\n        },\r\n      ] \r\n      let i = 0\r\n      async function handleFolder(child, directoryhandle) {\r\n\r\n        for await (let [fileName, handle] of directoryhandle) {\r\n         \r\n         if(handle.kind === \"directory\"){\r\n           dir.push({\r\n             type : 'directory',\r\n             name : fileName,\r\n             id : nanoid(),\r\n             children : [],\r\n             content : ''\r\n           })\r\n           i++;\r\n           child.push(dir[i].id);\r\n           handleFolder(dir[i].children, handle);\r\n         }\r\n         else if(handle.kind === \"file\") {\r\n          const file = await handle.getFile();\r\n          const fileContent = await file.text()\r\n          dir.push({\r\n            type : 'file',\r\n            name : fileName,\r\n            id : nanoid(),\r\n            children : [],\r\n            content : fileContent\r\n          })\r\n          i++;\r\n          child.push(dir[i].id);\r\n         }\r\n        }\r\n      }\r\n\r\n      handleFolder(dir[i].children, directoryHandle);\r\n      dispatch(uploadfile(dir));\r\n      console.log('', dir)\r\n    });\r\n\r\n      document\r\n      .getElementsByClassName(\"closechalkboard\")[0]\r\n      .addEventListener(\"click\", function () {\r\n        document.getElementsByClassName(\"chalkboardweb\")[0].style.display =\r\n          \"none\";\r\n      });\r\n\r\n    document\r\n      .getElementsByClassName(\"output\")[0]\r\n      .addEventListener(\"click\", function () {\r\n        document.getElementsByClassName(\"chalkboardweb\")[0].style.display =\r\n          \"block\";\r\n      });\r\n\r\n    document\r\n      .getElementsByClassName(\"fas fa-times\")[0]\r\n      .addEventListener(\"click\", function () {\r\n        document.getElementsByClassName(\"console-window\")[0].style.display =\r\n          \"none\";\r\n      });\r\n\r\n    document\r\n      .getElementsByClassName(\"folder\")[0]\r\n      .addEventListener(\"click\", function () {\r\n        if (selectedSidebar === true) {\r\n          document.getElementsByClassName(\"selected-sidebar\")[0].style.display =\r\n            \"none\";\r\n          document.getElementsByClassName(\"folder\")[0].className =\r\n            \"folder sidenav-buttons\";\r\n          selectedSidebar = false;\r\n        } else {\r\n          document.getElementsByClassName(\"selected-sidebar\")[0].style.display =\r\n            \"flex\";\r\n          document.getElementsByClassName(\"folder\")[0].className =\r\n            \"folder sidenav-buttons sidenav_button_active\";\r\n          selectedSidebar = true;\r\n        }\r\n      });\r\n\r\n    document\r\n      .getElementsByClassName(\"console-button\")[0]\r\n      .addEventListener(\"click\", function () {\r\n        if (consoleView === true) {\r\n          document.getElementsByClassName(\"console-window\")[0].style.display =\r\n            \"none\";\r\n          consoleView = false;\r\n        } else {\r\n          document.getElementsByClassName(\"console-window\")[0].style.display =\r\n            \"block\";\r\n          consoleView = true;\r\n        }\r\n      });\r\n    if (document.getElementsByClassName(\"outputiframe\")[0].contentWindow) {\r\n      Hook(\r\n        document.getElementsByClassName(\"outputiframe\")[0].contentWindow\r\n          .console,\r\n        (log) => setLogs((currLogs) => [...currLogs, log]),\r\n        false\r\n      );\r\n      // return () => Unhook(document.getElementsByClassName(\"outputiframe\")[0].contentWindow.console)\r\n    }\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    var frame =\r\n      document.getElementsByClassName(\"outputiframe\")[0].contentDocument;\r\n\r\n    frame.open();\r\n    frame.write(\"\");\r\n    frame.write(srcDoc);\r\n    frame.close();\r\n  }, [srcDoc]);\r\n\r\n  return (\r\n    <div className=\"text-editor\"> \r\n      <div className=\"editor-sidebar\">\r\n        <button className=\"suprise_button sidenav-buttons\">\r\n          <i className=\"fas fa-laugh-wink\"></i>\r\n        </button>\r\n        <button className=\"folder sidenav-buttons\">\r\n          <i className=\"far fa-folder\"></i>\r\n        </button>\r\n        <button className=\"full sidenav-buttons\" onClick={handleFullScreen}>\r\n          <i className=\"fas fa-expand-arrows-alt\"></i>\r\n        </button>\r\n        <button className=\"full sidenav-buttons\" onClick={handleEditorSearch}>\r\n          <i className=\"fas fa-search\"></i>\r\n        </button>\r\n        <button className=\"output sidenav-buttons\">\r\n          {\" \"}\r\n          <i className=\"fas fa-chalkboard-teacher\"></i>\r\n        </button>\r\n      </div>\r\n      <div className=\"selected-sidebar\">\r\n        <div className=\"sidebar-heading\">\r\n          <span id=\"explorer-spam\">Explorer</span>\r\n          <button className=\"sidebar-add-file\"></button>\r\n        </div>\r\n        <div className=\"sidebar-navbutton\">\r\n\r\n          {webDFiles.map((node) => {\r\n            let class_name = node.name.split('.').pop() + 'file';\r\n            let class_name_span = \"buttontext \" + node.name.split('.').pop();\r\n            let class_name_icon = '';\r\n            let func;\r\n            switch (node.name.split('.').pop()) {\r\n              case \"html\":\r\n                class_name_icon = \"fab fa-html5\";\r\n                editorLang = \"html\";\r\n                break;\r\n              case \"css\":\r\n                class_name_icon = \"fab fa-css3-alt\"; \r\n                editorLang = \"css\";       \r\n                break;\r\n              case \"js\":\r\n                class_name_icon = \"fab fa-js-square\"; \r\n                editorLang = \"javascript\";\r\n                break;\r\n              default:\r\n                break;\r\n            }\r\n            return(\r\n              <button\r\n              className= {class_name}\r\n              disabled={curr.id === node.id}\r\n              onClick={() => dispatch(changefile(node.id))}\r\n            >\r\n              <i className={class_name_icon}></i>{\" \"}\r\n              <span className={class_name_span}>{node.name} </span>\r\n            </button>\r\n            )\r\n          })}\r\n\r\n          {/* <button\r\n            className=\"htmlfile\"\r\n            disabled={fileName === \"index.html\"}\r\n            onClick={() => dispatch(html())}\r\n          >\r\n            <i className=\"fab fa-html5\"></i>{\" \"}\r\n            <span className=\"buttontext html\">{files[\"index.html\"].name} </span>\r\n          </button>\r\n\r\n          <button\r\n            className=\"cssfile\"\r\n            disabled={fileName === \"style.css\"}\r\n            onClick={() => dispatch(css())}\r\n          >\r\n            <i className=\"fab fa-css3-alt\"></i>{\" \"}\r\n            <span className=\"buttontext style\">{files[\"style.css\"].name} </span>\r\n          </button>\r\n\r\n          <button\r\n            className=\"jsfile\"\r\n            disabled={fileName === \"script.js\"}\r\n            onClick={() => dispatch(js())}\r\n          >\r\n            <i className=\"fab fa-js-square\"></i>{\" \"}\r\n            <span className=\"buttontext script\">\r\n              {files[\"script.js\"].name}{\" \"}\r\n            </span>\r\n          </button> */}\r\n        </div>\r\n        {/* <div className=\"sidebar-footer\">\r\n\r\n \r\n        </div>  */}\r\n      </div>\r\n\r\n      <div className=\"editor\">\r\n        <Split\r\n          sizes={[65, 35]}\r\n          direction=\"horizontal\"\r\n          cursor=\"col-resize\"\r\n          className=\"split-flex\"\r\n        >\r\n          <div className=\"editor-window\">\r\n            <div className=\"editor-header\">\r\n              <button\r\n                className=\"top_ui_buttons htmlfile_2\"\r\n                disabled={fileName === \"index.html\"}\r\n                onClick={() => dispatch(html())}\r\n              >\r\n                <i className=\"fab fa-html5\"></i>\r\n                <span className=\"buttontext html\">\r\n                  {files[\"index.html\"].name}{\" \"}\r\n                </span>\r\n              </button>\r\n\r\n              <button\r\n                className=\"top_ui_buttons cssfile_2\"\r\n                disabled={fileName === \"style.css\"}\r\n                onClick={() => dispatch(css())}\r\n              >\r\n                <i className=\"fab fa-css3-alt\"></i>\r\n                <span className=\"buttontext style\">\r\n                  {files[\"style.css\"].name}{\" \"}\r\n                </span>\r\n              </button>\r\n\r\n              <button\r\n                className=\"top_ui_buttons jsfile_2\"\r\n                disabled={fileName === \"script.js\"}\r\n                onClick={() => dispatch(js())}\r\n              >\r\n                <i className=\"fab fa-js-square\"></i>\r\n                <span className=\"buttontext script\">\r\n                  {files[\"script.js\"].name}\r\n                </span>\r\n              </button>\r\n            </div>\r\n            <Editor\r\n              height=\"calc(100vh - 2.4vh - 35px)\"\r\n              theme=\"vs-dark\"\r\n              path={curr.name}\r\n              defaultLanguage={editorLang}\r\n              defaultValue={curr.content}\r\n              saveViewState={true}\r\n              onMount={handleEditorDidMount}\r\n              onChange={handleEditorChange}\r\n              cursorSmoothCaretAnimation=\"true\"\r\n              value={curr.content}\r\n              className=\"code_text\"\r\n            />\r\n          </div>\r\n\r\n          <iframe\r\n            height=\"97.6vh\"\r\n            src=\"./output/output.html\"\r\n            title=\"output\"\r\n            className=\"outputiframe\"\r\n            frameBorder=\"0\"\r\n          />\r\n        </Split>\r\n      </div>\r\n      <div className=\"console-window\">\r\n        <div className=\"console-heading\">\r\n          <span style={{ marginLeft: \"15px\" }}>Console</span>{\" \"}\r\n          <i\r\n            style={{ marginRight: \"15px\", marginTop: \"4px\" }}\r\n            className=\"fas fa-times\"\r\n          ></i>\r\n        </div>\r\n        <Console logs={logs} variant=\"dark\" />\r\n      </div>\r\n      <div className=\"chalkboardweb\">\r\n        <button className=\"closechalkboard\">\r\n          <i className=\" fas fa-window-close\"></i>\r\n        </button>\r\n        <ChalkBoard />\r\n      </div>\r\n\r\n      <footer className=\"texteditor_footer\">\r\n        <div className=\"side_footer\">\r\n          <span className=\"footer_text l_footer\">\r\n            <i className=\"fas fa-user-tie\"></i> Instructor\r\n          </span>\r\n          <span className=\"footer_text l_footer error\">\r\n            <i className=\"far fa-times-circle\"></i>\r\n            {\"  \"} 0\r\n          </span>\r\n          <span className=\"footer_text l_footer warnings\">\r\n            <i className=\"fas fa-exclamation-triangle\"></i> {\"  \"}0\r\n          </span>\r\n        </div>\r\n        <div className=\"side_footer\">\r\n          <span className=\"footer_text r_footer line-col-num\">{`Ln ${Ln}, Col ${Col}`}</span>\r\n          <span className=\"footer_text r_footer\">Layout: US</span>\r\n          <span className=\"footer_text r_footer language\">\r\n            <i className=\"fab fa-markdown\"></i> {editorLang}\r\n          </span>\r\n          <span className=\"footer_text r_footer\">CRLF</span>\r\n          <span className=\"footer_text r_footer\">UTF-8</span>\r\n          <span className=\"footer_text r_footer console-button\">\r\n            <i className=\"fas fa-terminal\"></i> Console\r\n          </span>\r\n        </div>\r\n      </footer>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default TextEditor;\r\n","import React, { useState, useEffect } from \"react\";\r\nimport Editor from \"@monaco-editor/react\";\r\nimport files from \"../assets/files\";\r\nimport ChalkBoard from \"../ChalkBoard\";\r\nimport { c, c99, cpp, cpp14, cpp17, python2, python3 } from \"../actions\";\r\nimport { useSelector, useDispatch } from \"react-redux\";\r\nimport { runCode } from \"../actions/outputAction\";\r\nimport \"./style.css\";\r\nfunction MultiFile(props) {\r\n  console.log(props)\r\n\r\n  const [language, setLanguage] = useState(\"python2\");\r\n  const [modalActive, setModal] = useState(false);\r\n  const dispatch = useDispatch();\r\n  const [outputValue, setOutputValue] = useState(\"\");\r\n  const [inputValue, setInputValue] = useState(\"\");\r\n  const file = files[language];\r\n\r\n  function handleEditorChange(value) {\r\n    file.value = value;\r\n  }\r\n\r\n  function handleEditorWillMount(monaco) {\r\n    monaco.editor.defineTheme(\"my-cool-theme\", {\r\n      base: \"vs-dark\",\r\n      inherit: true,\r\n      rules: [],\r\n      colors: { \"editor.background\": \"#293738\" },\r\n    });\r\n  }\r\n\r\n  function handleModal() {\r\n    setModal(true);\r\n  }\r\n\r\n  function handleInput(e) {\r\n    setInputValue(e.target.value);\r\n  }\r\n\r\n  useEffect(() => {\r\n    if(props.language){\r\n      setLanguage(props.language)\r\n    }\r\n    const selectLang = document.getElementsByClassName(\"language\")[0]\r\n    document\r\n      .getElementsByClassName(\"closechalkboard\")[0]\r\n      .addEventListener(\"click\", function () {\r\n        document.getElementsByClassName(\"chalkboardweb\")[0].style.display =\r\n          \"none\";\r\n      });\r\n\r\n    document\r\n      .getElementsByClassName(\"showModal\")[0]\r\n      .addEventListener(\"click\", function () {\r\n        document.getElementsByClassName(\"chalkboardweb\")[0].style.display =\r\n          \"block\";\r\n      });\r\n      if(props.language){\r\n        selectLang.style.display=\"none\"\r\n      }\r\n      selectLang.addEventListener(\"click\", (e) => {\r\n        setLanguage(e.target.value)\r\n      })\r\n  }, []);\r\n\r\n  function handleOutput(e) {\r\n    if (e.isTrusted) {\r\n      const words = file.value.split(\"\\r\");\r\n      let code = \"\";\r\n      for (let i = 0; i < words.length; i++) {\r\n        code = code + words[i];\r\n      }\r\n      setOutputValue(\"Wait ... \")\r\n      dispatch(runCode(language, code, inputValue)).then((e) => {\r\n        setOutputValue(e.data.output);\r\n        const data = {\r\n          output: e.data.output,\r\n        };\r\n        //creating a custom like predefined events like click or mousemove and more\r\n        const event = new CustomEvent(\"output\", { detail: data });\r\n        //dispatching the event in document.documentElement where we listen for it in while recording\r\n        document.documentElement.dispatchEvent(event);\r\n      });\r\n    }\r\n  }\r\n\r\n  return (\r\n    <>\r\n      <div className=\"multilanguageIde\">\r\n        <div className=\"navbar\">\r\n          <div className=\"editor\">\r\n            <div className=\"navbar\">\r\n              <div className=\"langInfo\">\r\n              <span className=\"fileName\">\r\n                main\r\n                {language === \"python2\" || language === \"python3\"\r\n                  ? \".py\"\r\n                  : \".cpp\"}\r\n              </span>\r\n              <select className=\"language\">\r\n                  <option value=\"python2\">Python 2</option>\r\n                  <option value=\"python3\">Python 3</option>\r\n                  <option value=\"cpp\">C++</option>\r\n                  <option value=\"c99\">C99</option>\r\n                  <option value=\"c\">C</option>\r\n                  <option value=\"cpp14\">C++ 14</option>\r\n                  <option value=\"cpp17\">C++ 17</option>\r\n              </select>\r\n              </div>\r\n              <div className=\"optionButton\">\r\n                <button className=\"showModal\" onClick={handleModal}>\r\n                  <i className=\"fas fa-chalkboard-teacher\"></i>\r\n                </button>\r\n                <button className=\"showCodeOutput\" onClick={handleOutput}>\r\n                  <i className=\"fas fa-play\"></i> Execute\r\n                </button>\r\n              </div>\r\n            </div>\r\n            <Editor\r\n              height=\"95.3vh\"\r\n              width=\"80vw\"\r\n              theme=\"vs-dark\"\r\n              language=\"python\"\r\n              options={{ fontSize: 18, fontWeight: 400, fontFamily: \"cursive\" }}\r\n              onChange={handleEditorChange}\r\n              value={file.value}\r\n              beforeMount={handleEditorWillMount}\r\n            />\r\n          </div>\r\n          <div className=\"inputOutput\">\r\n            <div className=\"inputArea\">\r\n              <h3>Input</h3>\r\n              <textarea\r\n                rows=\"20\"\r\n                cols=\"52\"\r\n                className=\"userInputArea\"\r\n                onChange={handleInput}\r\n                placeholder=\"Enter Input\"\r\n              ></textarea>\r\n            </div>\r\n            <div className=\"outputArea\">\r\n              <h3>Output</h3>\r\n              <textarea\r\n                rows=\"20\"\r\n                cols=\"52\"\r\n                className=\"userOutputArea\"\r\n                defaultValue={outputValue}\r\n              ></textarea>\r\n            </div>\r\n          </div>\r\n        </div>\r\n        <div className=\"chalkboardweb\">\r\n          <button className=\"closechalkboard\">\r\n            <i className=\" fas fa-window-close\"></i>\r\n          </button>\r\n          <ChalkBoard />\r\n        </div>\r\n      </div>\r\n    </>\r\n  );\r\n}\r\n\r\nexport default MultiFile;\r\n","import axios from \"axios\";\r\n\r\nconst env = process.env.NODE_ENV; // current environment\r\n\r\nexport const runCode = (language, code, input) => async dispatch => {\r\n    let url\r\n    if(env === \"development\") {\r\n        url = 'http://localhost:5000/'\r\n    }else{\r\n        url = 'https://fierce-reef-05156.herokuapp.com/' \r\n    }\r\n    return await axios.post( url+'api/compile', {\r\n        language: language, \r\n        stdin:input,\r\n        versionIndex: \"0\",\r\n        script:code\r\n    })\r\n}\r\n","import React from 'react';\r\nimport TextEditor from './TextEditor/TextEditor';\r\nimport MultiFile from './MultilanguageEditor/multiFile';\r\n\r\nfunction App(props) {\r\n  console.log(props)\r\n  return (\r\n    <>\r\n    {props.name === \"ide\" ? <TextEditor refresh = {props.refresh}/> :<MultiFile language={props.language} refresh = {props.refresh}/>}\r\n    </>\r\n  )\r\n}\r\n\r\nexport default App;","import React, {useState} from \"react\";\r\nimport IDE from \"../IDE\";\r\nimport ChalkBoard from \"../ChalkBoard/index\";\r\nimport files from \"../assets/files\";\r\nimport MicRecorder from \"mic-recorder-to-mp3\";\r\nimport axios from \"axios\";\r\nimport \"./style.css\";\r\nvar startTime;\r\nconst env = process.env.NODE_ENV; // current environment\r\n\r\nlet url;\r\nif (env === \"development\") {\r\n  url = \"http://localhost:5000/savelecture\";\r\n} else {\r\n  url = \"https://fierce-reef-05156.herokuapp.com/savelecture\";\r\n}\r\n\r\nexport default function Recorder(props) {\r\n  const name = props.location.state.lectureType;\r\n  const language = props.location.state.languageType;\r\n  const [file, setFile] = useState(null);\r\n  console.log(name);\r\n  const Recording = { events: [] };\r\n  var lastMouse = { x: 0, y: 0 };\r\n  var lastKey = \"\";\r\n  var audioString;\r\n  var imageString;\r\n  let fileName;\r\n  if (name === \"dsa\") {\r\n    fileName = language;\r\n  } else if (name === \"ide\") {\r\n    fileName = \"index.html\";\r\n  }\r\n  let childValue;\r\n  var lastKeyClass = \"\";\r\n\r\n  function callbackFunction(childData) {\r\n    childValue = childData;\r\n    //console.log(childValue)\r\n  }\r\n\r\n  function handleChange(e) {\r\n    console.log(e)\r\n    setFile(e.target.files[0]);\r\n  }\r\n\r\n  // Record each type of event\r\n  const handlers = [\r\n    {\r\n      eventName: \"pointerup\",\r\n      handler: function handleMouseMove(e) {\r\n        Recording.events.push({\r\n          type: e.type,\r\n          bubbles: e.bubbles,\r\n          clientX: e.clientX,\r\n          clientY: e.clientY,\r\n          offsetX: e.offsetX,\r\n          offsetY: e.offsetY,\r\n          pointerType: e.pointerType,\r\n          target: e.target.className,\r\n          time: Date.now() - startTime,\r\n        });\r\n      },\r\n    },\r\n    {\r\n      eventName: \"pointerdown\",\r\n      handler: function handleMouseMove(e) {\r\n        Recording.events.push({\r\n          type: \"pointerdown\",\r\n          bubbles: e.bubbles,\r\n          clientX: e.clientX,\r\n          clientY: e.clientY,\r\n          offsetX: e.offsetX,\r\n          offsetY: e.offsetY,\r\n          pointerType: e.pointerType,\r\n          target: e.target.className,\r\n          time: Date.now() - startTime,\r\n        });\r\n      },\r\n    },\r\n    {\r\n      eventName: \"pointermove\",\r\n      handler: function handleMouseMove(e) {\r\n        lastMouse = { x: e.pageX, y: e.pageY };\r\n        Recording.events.push({\r\n          type: e.type,\r\n          bubbles: e.bubbles,\r\n          clientX: e.clientX,\r\n          clientY: e.clientY,\r\n          offsetX: e.offsetX,\r\n          offsetY: e.offsetY,\r\n          pointerType: e.pointerType,\r\n          target: e.target.className,\r\n          x: e.x,\r\n          y: e.y,\r\n          time: Date.now() - startTime,\r\n        });\r\n      },\r\n    },\r\n    {\r\n      eventName: \"dblclick\",\r\n      handler: function handleMouseMove(e) {\r\n        console.log(e);\r\n        Recording.events.push({\r\n          type: \"dblclick\",\r\n          button: e.button,\r\n          clientX: e.clientX,\r\n          clientY: e.clientY,\r\n          shiftKey: e.shiftKey,\r\n          altKey: e.altKey,\r\n          time: Date.now() - startTime,\r\n        });\r\n      },\r\n    },\r\n    {\r\n      eventName: \"click\",\r\n      handler: function handleClick(e) {\r\n        if (\r\n          e.target.className === \"cssfile\" ||\r\n          e.target.className === \"buttontext style\" ||\r\n          e.target.className === \"fab fa-css3-alt\"\r\n        )\r\n          fileName = \"style.css\";\r\n        if (\r\n          e.target.className === \"jsfile\" ||\r\n          e.target.className === \"buttontext script\" ||\r\n          e.target.className === \" fa-js-square\"\r\n        )\r\n          fileName = \"script.js\";\r\n        if (\r\n          e.target.className === \"htmlfile\" ||\r\n          e.target.className === \"buttontext html\" ||\r\n          e.target.className === \"fab fa-html5fab\"\r\n        )\r\n        fileName = \"index.html\";\r\n        console.log(e.target.className);\r\n        Recording.events.push({\r\n          type: \"click\",\r\n          target: e.target.className,\r\n          x: e.pageX,\r\n          fileName: fileName,\r\n          y: e.pageY,\r\n          time: Date.now() - startTime,\r\n        });\r\n      },\r\n    },\r\n    {\r\n      eventName: \"keyup\",\r\n      handler: function handleKeyPress(e) {\r\n        console.log(files[fileName]);\r\n        if (name === \"ide\" || name === \"dsa\") {\r\n          lastKey = childValue;\r\n          lastKeyClass = e.target.className;\r\n          Recording.events.push({\r\n            type: \"keyup\",\r\n            target: e.target.className,\r\n            x: lastMouse.x,\r\n            y: lastMouse.y,\r\n            fileName: fileName,\r\n            value:\r\n              e.target.className === \"userInputArea\"\r\n                ? e.target.value\r\n                : files[fileName].value,\r\n            keyCode: e.keyCode,\r\n            time: Date.now() - startTime,\r\n          });\r\n        }\r\n      },\r\n    },\r\n    {\r\n      eventName: \"keydown\",\r\n      handler: function handleKeyPress(e) {\r\n        let value = null;\r\n        if(document.getElementsByClassName(\"canvas_text\")[0]) value = document.getElementsByClassName(\"canvas_text\")[0].value;\r\n        Recording.events.push({\r\n          type: \"keydown\",\r\n          key: e.key,\r\n          code: e.code,\r\n          isComposing: e.isComposing,\r\n          shiftKey: e.shiftKey,\r\n          value: value,\r\n          time: Date.now() - startTime,\r\n        });\r\n      },\r\n    },\r\n    {\r\n      eventName: \"mousedown\",\r\n      handler: function handleKeyPress(e) {\r\n        if(e.target.className === 'gutter gutter-horizontal'){\r\n          Recording.events.push({\r\n            clientX: e.clientX,\r\n            clientY: e.clientY,\r\n            offsetX: e.offsetX,\r\n            offsetY: e.offsetY,\r\n            bubbles: e.bubbles,\r\n            button: e.button,\r\n            target: e.target.className,\r\n            type: e.type,\r\n            time: Date.now() - startTime,\r\n          });\r\n        }\r\n      },\r\n    },\r\n    {\r\n      eventName: \"mouseup\",\r\n      handler: function handleKeyPress(e) {\r\n        //console.log(e)\r\n        if(e.target.className === 'gutter gutter-horizontal'){\r\n          Recording.events.push({\r\n            clientX: e.clientX,\r\n            clientY: e.clientY,\r\n            offsetX: e.offsetX,\r\n            offsetY: e.offsetY,\r\n            bubbles: e.bubbles,\r\n            button: e.button,\r\n            target: e.target.className,\r\n            type: e.type,\r\n            time: Date.now() - startTime,\r\n          });\r\n        }\r\n      },\r\n    },\r\n    {\r\n      eventName: \"mousemove\",\r\n      handler: function handleKeyPress(e) {\r\n        if(e.target.className === 'gutter gutter-horizontal'){\r\n          Recording.events.push({\r\n            clientX: e.clientX,\r\n            clientY: e.clientY,\r\n            offsetX: e.offsetX,\r\n            offsetY: e.offsetY,\r\n            bubbles: e.bubbles,\r\n            button: e.button,\r\n            target: e.target.className,\r\n            type: e.type,\r\n            time: Date.now() - startTime,\r\n          });\r\n        }\r\n      },\r\n    },\r\n    // {\r\n    //   eventName: \"click\",\r\n    //   handler: function handleClick(e) {\r\n    //     if(name === \"dsa\"){\r\n    //       if(language  === \"c\" ||\r\n    //       language === \"c99\" ||\r\n    //       language === \"cpp\" ||\r\n    //       language === \"cpp14\" ||\r\n    //       language === \"cpp17\" ||\r\n    //       language === \"python2\" ||\r\n    //       language === \"python3\"){\r\n    //         fileName = language\r\n    //       }\r\n    //       Recording.events.push({\r\n    //         type: \"click\",\r\n    //         target: e.target.className,\r\n    //         x: e.pageX,\r\n    //         fileName :fileName,\r\n    //         y: e.pageY,\r\n    //         value:files[fileName].value,\r\n    //         time: Date.now() - startTime,\r\n    //       });\r\n    //     }\r\n    //   },\r\n    //   },\r\n    {\r\n      eventName:\"selectstart\",\r\n      handler: function handleChange(e) {\r\n        console.log(e)\r\n      },\r\n    },\r\n    {\r\n      eventName: \"output\",\r\n      handler: function handleChange(e) {\r\n        Recording.events.push({\r\n          type: \"output\",\r\n          target: \"userOutputArea\",\r\n          time: Date.now() - startTime,\r\n          value: e.detail.output,\r\n        });\r\n      },\r\n    },\r\n  ];\r\n\r\n  const Mp3Recorder = new MicRecorder({\r\n    bitRate: 128,\r\n    prefix: \"data:audio/wav;base64,\",\r\n  });\r\n\r\n  function listeniframe(eventName, handler) {\r\n    return document.documentElement.getElementsByClassName(\"outputiframe\")[0].contentDocument.addEventListener(eventName, handler, true);\r\n  }\r\n\r\n  function listen(eventName, handler) {\r\n    return document.documentElement.addEventListener(eventName, handler, true);\r\n  }\r\n\r\n  function startRecording() {\r\n    startTime = Date.now();\r\n    Recording.events = [];\r\n    handlers.map((x) => listen(x.eventName, x.handler));\r\n    if(name === \"ide\"){\r\n      handlers.map((x) => listeniframe(x.eventName, x.handler));\r\n    }\r\n    Mp3Recorder.start()\r\n      .then(() => {\r\n        console.log(\"Started recording\");\r\n      })\r\n      .catch((e) => console.error(e));\r\n  }\r\n\r\n  function removeListener(eventName, handler) {\r\n    return document.documentElement.removeEventListener(\r\n      eventName,\r\n      handler,\r\n      true\r\n    );\r\n  }\r\n\r\n  function handleClick(e) {\r\n    e.preventDefault();\r\n    document.getElementsByClassName(\"record\")[0].style.display = \"none\";\r\n    document.getElementsByClassName(\"stop-record\")[0].style.display = \"block\";\r\n    startRecording();\r\n    console.log(\"The Button was clicked.\");\r\n  }\r\n\r\n  function stopRecording() {\r\n    // stop recording\r\n    handlers.map((x) => removeListener(x.eventName, x.handler));\r\n    //localStorage.setItem(\"recording\", JSON.stringify(Recording));\r\n    document.getElementsByClassName(\"stop-record\")[0].style.display = \"none\";\r\n    document.getElementsByClassName(\"record\")[0].style.display = \"block\";\r\n    Mp3Recorder.stop()\r\n      .getMp3()\r\n      .then(async ([buffer, blob]) => {\r\n        console.log(blob);\r\n        var reader = new FileReader();\r\n        reader.readAsDataURL(blob);\r\n        reader.onloadend = () => {\r\n          audioString = reader.result;\r\n        };\r\n      })\r\n      .catch((e) => console.log(e));\r\n  }\r\n\r\n  function uploadRecording() {\r\n    // upload recording\r\n    const recordingString = JSON.stringify(Recording);\r\n    console.log(Recording);\r\n      const lectureData = {\r\n        recording: recordingString,\r\n        audio: audioString,\r\n        name: props.location.state.lectureName,\r\n        type: props.location.state.lectureType,\r\n        creator: props.location.state.lectureCreator,\r\n        language : props.location.state.languageType,\r\n        image:imageString\r\n      };\r\n      axios.post(url, {\r\n        lectureData,\r\n      }).then(response => {\r\n        if(response.data) {\r\n          alert(\"Lecture Saved\")\r\n        }\r\n      })\r\n  }\r\n\r\n  function handleStop(e) {\r\n    e.preventDefault();\r\n    stopRecording();\r\n    console.log(\"Recording Stopped.\");\r\n  }\r\n  //console.log(Recording)\r\n  return (\r\n    <>\r\n      <div className=\"recorder\">\r\n        <div className=\"recorder-button\">\r\n          <i className=\"fas fa-microphone record\" onClick={handleClick}></i>\r\n          <i\r\n            className=\"fas fa-microphone-slash stop-record\"\r\n            onClick={handleStop}\r\n          ></i>\r\n        </div>\r\n        <div className=\"upload-button\">\r\n          <i class=\"fas fa-file-upload record\" onClick={uploadRecording}></i>\r\n        </div>\r\n        {/* <form className=\"uploadForm\">\r\n          <input id=\"thumnail\" type=\"file\" onChange={handleChange}/>\r\n        </form> */}\r\n        {name === \"dra\" ? (\r\n          <div className=\"chalk\">\r\n            {\" \"}\r\n            <ChalkBoard />{\" \"}\r\n          </div>\r\n        ) : (\r\n          <IDE\r\n            name={name}\r\n            language={language}\r\n            parentCallBack={callbackFunction}\r\n          />\r\n        )}\r\n      </div>\r\n    </>\r\n  );\r\n}\r\n","export default \"data:image/png;base64,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\"","import React, { useEffect, useState } from \"react\";\r\nimport IDE from \"../IDE\";\r\nimport files from \"../assets/files\";\r\nimport { useDispatch } from \"react-redux\";\r\nimport { useParams } from \"react-router\";\r\n\r\nimport {\r\n  js,\r\n  css,\r\n  html,\r\n  outputModalTrue,\r\n  outputModalFalse,\r\n  setSrcDocs,\r\n} from \"../actions\";\r\nimport \"./style.css\";\r\nimport ChalkBoard from \"../ChalkBoard/index\";\r\nimport img from \"../assets/Gear-0.2s-200px.png\";\r\nimport axios from \"axios\";\r\n\r\nfunction Preloader() {\r\n  return (\r\n    <div className=\"loader\">\r\n      <div className=\"preloader\">\r\n        <div className=\"load\">\r\n          <img src={img} border=\"0\" />\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default function Video(props) {\r\n  //lecture fetching from firebase and which text editor to open\r\n  const { id, type } = useParams();\r\n  const name = type.slice(0, 3);\r\n  const language = type.slice(3, 10);\r\n\r\n  //TODO needed to reload the text editor\r\n  const [refresh, setRefresh] = useState(\"\");\r\n\r\n  const dispatch = useDispatch();\r\n\r\n  useEffect(() => {\r\n    //TODO naming of var\r\n    const playerBlock = document.getElementsByClassName(\"player-content\")[0];\r\n    const videoPlayer = document.getElementsByClassName(\"videoplayer\")[0];\r\n    const playButton = document.getElementsByClassName(\"playButton\")[0];\r\n    const audioPlayer = document.getElementById(\"audio_player\");\r\n    var startPlay;\r\n    let offsetPlay = 0;\r\n    var i = 0;\r\n    var paused = false;\r\n\r\n    localStorage.setItem(\"lastSessionTimeStamp\", JSON.stringify(offsetPlay));\r\n    let recording = { events: [] };\r\n    axios.get(`http://localhost:5000/savelecture/${id}`).then(result => {\r\n      recording =JSON.parse(result.data.recordingString)\r\n      audioPlayer.src = result.data.audio\r\n    })\r\n\r\n    //fake cursor for playing, create and append\r\n    const fakeCursor = document.createElement(\"div\");\r\n    fakeCursor.className = \"customCursor\";\r\n    document.getElementById(\"root\").appendChild(fakeCursor);\r\n    fakeCursor.style.display = 'none'\r\n\r\n    function playerPlay() {\r\n      playButton.style.display=\"none\"\r\n      playfunction();\r\n      const data = {\r\n        status:false\r\n      }\r\n      const event = new CustomEvent(\"status\", { detail: data });\r\n      document.dispatchEvent(event);\r\n    }\r\n\r\n    function playerPause() {\r\n      console.log(\"clicked pause\");\r\n      const data = {\r\n        status:true\r\n      }\r\n      const event = new CustomEvent(\"status\", { detail: data });\r\n      document.dispatchEvent(event);\r\n      pausefunction();\r\n    }\r\n\r\n\r\n    //pause/play on spacebar and dispach an event acc\r\n    playerBlock.addEventListener(\"keypress\", (e) => {\r\n      if(e.charCode === 32){\r\n        if(audioPlayer.paused){\r\n          audioPlayer.play()\r\n          playerPlay()\r\n          console.log(\"audio play\")\r\n        }else{\r\n          audioPlayer.pause()\r\n          playerPause()\r\n        }\r\n      }\r\n    });\r\n\r\n    //init player\r\n    audioPlayer.addEventListener(\"canplay\", () => {\r\n      document.getElementsByClassName(\"player-content\")[0].style.display =\r\n        \"block\";\r\n      document.getElementsByClassName(\"loader\")[0].style.display = \"none\";\r\n      console.log(\"loaded\");\r\n    });\r\n\r\n    //TODO\r\n    audioPlayer.addEventListener(\"play\", () => {\r\n      playerPlay()\r\n      console.log(\"audio play\")\r\n    })\r\n    \r\n    //TODO\r\n    audioPlayer.addEventListener(\"pause\", () => {\r\n      playerPause()\r\n    })\r\n    \r\n    audioPlayer.addEventListener(\"ended\", () => {\r\n      pausefunction();\r\n      console.log(\"ended audio\");\r\n    });\r\n\r\n    audioPlayer.addEventListener(\"seeking\", () => {\r\n      fakeCursor.style.display = \"none\";\r\n      pausefunction();\r\n      audioPlayer.pause();\r\n      //returns the time at which the audio is after seeking it\r\n      const curTime = audioPlayer.currentTime;\r\n\r\n      //TODO: Implement binary search or lower bound\r\n      for (let x = 0; x < recording.events.length; x++) {\r\n        if (recording.events[x].time >= curTime * 1000) {\r\n          i = x;\r\n          break;\r\n        }\r\n      }\r\n\r\n      if (recording.events[i].time > curTime * 1000) {\r\n        localStorage.setItem(\"lastSessionTimeStamp\", recording.events[i].time);\r\n      } else {\r\n        localStorage.setItem(\"lastSessionTimeStamp\", curTime * 1000);\r\n      }\r\n    });\r\n\r\n    playButton.addEventListener(\"click\", () => {\r\n      playButton.style.display = \"none\";\r\n      videoPlayer.style.display = \"flex\";\r\n      audioPlayer.play();\r\n      playfunction();\r\n    });\r\n\r\n    function pausefunction() {\r\n      fakeCursor.style.display = \"none\";\r\n      paused = true;\r\n      localStorage.setItem(\"lastSessionTimeStamp\", JSON.stringify(offsetPlay));\r\n    }\r\n\r\n    function playfunction() {\r\n      if (document.getElementsByClassName(\"videoscreen\")[0] != null)\r\n        document.getElementsByClassName(\"videoscreen\")[0].className =\r\n          \"visiblescreen\";\r\n      //append fake cursor when user clicks play button\r\n      fakeCursor.style.display = \"block\";\r\n      startPlay = Date.now();\r\n      paused = false;\r\n      var frames;\r\n      //draw event to play all events in requestAnimationFrames\r\n      function draw() {\r\n        //select an event and check if its empty\r\n        let event = recording.events[i];\r\n        if (!event) {\r\n          return;\r\n        }\r\n\r\n        //must have pause before\r\n        if (localStorage.getItem(\"lastSessionTimeStamp\") !== null) {\r\n          offsetPlay =\r\n            JSON.parse(localStorage.getItem(\"lastSessionTimeStamp\")) +\r\n            Date.now() -\r\n            startPlay;\r\n        } else {\r\n          offsetPlay = (Date.now() - startPlay) * 1;\r\n        }\r\n\r\n        if (event.time <= offsetPlay) {\r\n          //draws event amd matches with listner\r\n          drawEvent(event, fakeCursor);\r\n          i++;\r\n        }\r\n\r\n        if (i >= recording.events.length || paused) {\r\n          clearInterval(frames);\r\n          //  if(i >= (recording.events.length - 1)){\r\n          //    paused = true\r\n          //  }\r\n        }\r\n      }\r\n\r\n      frames = setInterval(() => {\r\n        if (!paused) draw();\r\n      }, 1);\r\n    }\r\n\r\n    function handleButtonEvents(target) {\r\n      switch (target) {\r\n        case \"outputtext\":\r\n          dispatch(setSrcDocs());\r\n          dispatch(outputModalTrue());\r\n          break;\r\n        case \"output\":\r\n          dispatch(setSrcDocs());\r\n          dispatch(outputModalTrue());\r\n          break;\r\n        case \"buttontext output\":\r\n          dispatch(setSrcDocs());\r\n          dispatch(outputModalTrue());\r\n          break;\r\n        case \"fas fa-play\":\r\n          dispatch(setSrcDocs());\r\n          dispatch(outputModalTrue());\r\n          break;\r\n        case \"fas fa-window-close\":\r\n          dispatch(outputModalFalse());\r\n          break;\r\n        case \"style.css\":\r\n          dispatch(css());\r\n          break;\r\n        case \"buttontext style\":\r\n          dispatch(css());\r\n          break;\r\n        case \"index.html\":\r\n          dispatch(html());\r\n          break;\r\n        case \"script.js\":\r\n          dispatch(js());\r\n          break;\r\n        case \"buttontext script\":\r\n          dispatch(js());\r\n          break;\r\n        default:\r\n          break;\r\n      }\r\n    }\r\n\r\n    function drawEvent(event, fakeCursor) {\r\n      if (event.type === \"pointerdown\") {\r\n        let eve = new PointerEvent(\"pointerdown\", {\r\n          bubbles: event.bubbles,\r\n          clientX: event.clientX,\r\n          clientY: event.clientY,\r\n          offsetX: event.offsetX,\r\n          offsetY: event.offsetY,\r\n          pointerType: event.pointerType,\r\n        });\r\n        console.log(event.target);\r\n        if (document.getElementsByClassName(event.target)[0])\r\n          document.getElementsByClassName(event.target)[0].dispatchEvent(eve);\r\n      } else if (event.type === \"pointermove\") {\r\n        // TODO: Add e.buttons too\r\n        let eve = new PointerEvent(\"pointermove\", {\r\n          bubbles: event.bubbles,\r\n          clientX: event.clientX,\r\n          clientY: event.clientY,\r\n          offsetX: event.offsetX,\r\n          offsetY: event.offsetY,\r\n          pointerType: event.pointerType,\r\n        });\r\n\r\n        if (document.getElementsByClassName(event.target)[0]) {\r\n          document.getElementsByClassName(event.target)[0].dispatchEvent(eve);\r\n        }\r\n\r\n        //document.getElementsByClassName(\"cursor\")[0].style.top = JSON.stringify(event.y) + \"px\";\r\n        fakeCursor.style.left = JSON.stringify(event.x) + \"px\";\r\n        fakeCursor.style.top = JSON.stringify(event.y) + \"px\";\r\n        const path = event.target;\r\n        handleButtonEvents(event.fileName);\r\n        var tar = document.getElementsByClassName(path)[0];\r\n        if (tar != null) {\r\n          tar.focus();\r\n        }\r\n      } else if (event.type === \"pointerup\") {\r\n        let eve = new PointerEvent(\"pointerup\", {\r\n          bubbles: event.bubbles,\r\n          clientX: event.clientX,\r\n          clientY: event.clientY,\r\n          offsetX: event.offsetX,\r\n          offsetY: event.offsetY,\r\n          pointerType: event.pointerType,\r\n        });\r\n        if (document.getElementsByClassName(event.target)[0])\r\n          document.getElementsByClassName(event.target)[0].dispatchEvent(eve);\r\n      } else if (event.type === \"keydown\") {\r\n\r\n        let eve = new KeyboardEvent(\"keydown\", {\r\n          key: event.key,\r\n          shiftKey: event.shiftKey,\r\n          code: event.code,\r\n          isComposing: event.isComposing,\r\n          bubbles: true,\r\n          cancelable: true,\r\n        });\r\n        \r\n        if (document.getElementsByClassName(\"canvas_text\")[0]) {\r\n          // document.getElementsByClassName(\"canvas_text\")[0].dispatchEvent(eve_up);\r\n          document.getElementsByClassName(\"canvas_text\")[0].value = event.value;  \r\n          document.getElementsByClassName(\"canvas_text\")[0].dispatchEvent(eve); \r\n        }\r\n      }\r\n      else if (event.type === \"mousedown\") {\r\n        let eve = new MouseEvent(\"mousedown\", {\r\n          clientX: event.clientX,\r\n          clientY: event.clientY,\r\n          offsetX: event.offsetX,\r\n          offsetY: event.offsetY,\r\n          bubbles: event.bubbles,\r\n          button: event.button,\r\n        });\r\n        if (document.getElementsByClassName(event.target)[0])\r\n          document.getElementsByClassName(event.target)[0].dispatchEvent(eve);\r\n        }\r\n      else if (event.type === \"mouseup\") {\r\n        let eve = new MouseEvent(\"mouseup\", {\r\n          clientX: event.clientX,\r\n          clientY: event.clientY,\r\n          offsetX: event.offsetX,\r\n          offsetY: event.offsetY,\r\n          bubbles: event.bubbles,\r\n          button: event.button,\r\n        });\r\n        if (document.getElementsByClassName(event.target)[0])\r\n          document.getElementsByClassName(event.target)[0].dispatchEvent(eve);\r\n      }\r\n      else if (event.type === \"mousemove\") {\r\n        let eve = new MouseEvent(\"mousemove\", {\r\n          clientX: event.clientX,\r\n          clientY: event.clientY,\r\n          offsetX: event.offsetX,\r\n          offsetY: event.offsetY,\r\n          bubbles: event.bubbles,\r\n          button: event.button,\r\n        });\r\n        console.log(event.target)\r\n        if (document.getElementsByClassName(event.target)[0])\r\n          document.getElementsByClassName(event.target)[0].dispatchEvent(eve);\r\n      }\r\n      else if(event.type === \"dblclick\"){\r\n        let eve = new PointerEvent(\"dblclick\", {\r\n          bubbles: true,\r\n          cancelable: true,\r\n          button: event.button,\r\n          clientX: event.clientX,\r\n          clientY: event.clientY,\r\n          shiftKey: event.shiftKey,\r\n        });\r\n        if (document.getElementsByClassName(event.target)[0])\r\n          document.getElementsByClassName(event.target)[0].dispatchEvent(eve);\r\n      }  else if (event.type === \"click\") {\r\n        if (document.getElementsByClassName(event.target)[0] !== undefined) {\r\n          let clickEvent = new MouseEvent(\"click\", {\r\n            pageX: event.x,\r\n            pageY: event.y,\r\n            bubbles: true,\r\n            cancelable: true,\r\n          });\r\n\r\n          document\r\n            .getElementsByClassName(event.target)[0]\r\n            .dispatchEvent(clickEvent);\r\n        }\r\n        if (\r\n          event.target === \"rectangle\" ||\r\n          event.target === \"ellipse\" ||\r\n          event.target === \"arrow\" ||\r\n          event.target === \"selection\"\r\n        )\r\n          document.getElementsByClassName(event.target)[0].click();\r\n        flashClass(fakeCursor, \"click\");\r\n        tar = document.getElementsByClassName(event.target)[0];\r\n        if (tar != null) {\r\n          handleButtonEvents(event.fileName);\r\n          handleButtonEvents(event.target);\r\n          flashClass(tar, \"clicked\");\r\n        }\r\n      } else if (event.type === \"keyup\") {\r\n        let eve = new KeyboardEvent(\"keyup\", {\r\n          key: event.key,\r\n          shiftKey: event.shiftKey,\r\n          code: event.code,\r\n          isComposing: event.isComposing,\r\n          bubbles: true,\r\n          cancelable: true,\r\n        });\r\n        const path = event.target;\r\n        if(document.getElementsByClassName(path)[0]) document.getElementsByClassName(path)[0].dispatchEvent(eve); \r\n        tar = document.getElementsByClassName(path)[0];\r\n        if (tar != null) {\r\n          tar.focus();\r\n          if (path === \"userInputArea\") {\r\n            tar.value = event.value;\r\n          } else {\r\n            files[event.fileName].value = event.value;\r\n            handleButtonEvents(event.fileName);\r\n            setRefresh(event.value);\r\n          }\r\n        }\r\n      } else if (event.type === \"output\") {\r\n        const path = event.target;\r\n        tar = document.getElementsByClassName(path)[0];\r\n        if (tar != null) {\r\n          tar.focus();\r\n          if (path === \"userOutputArea\") {\r\n            tar.value = event.value;\r\n          }\r\n        }\r\n      }\r\n    }\r\n\r\n    function flashClass(el, className) {\r\n      el.classList.add(className);\r\n      setTimeout(function () {\r\n        el.classList.remove(className);\r\n      }, 200);\r\n    }\r\n  }, []);\r\n\r\n  return (\r\n    <div>\r\n      <Preloader />\r\n      <div className=\"player-content\">\r\n        <div className=\"videoscreen\">\r\n          {/* <IDE name={name} refresh = {refresh}/> */}\r\n          {name === \"dra\" ? (\r\n            <div className=\"chalk\">\r\n              <ChalkBoard />\r\n            </div>\r\n          ) : (\r\n            <IDE name={name} language={language} refresh={refresh} />\r\n          )}\r\n        </div>\r\n        <div className=\"playButton\">\r\n          <div className=\"container\">\r\n            <a className=\"button button-play\"></a>\r\n          </div>\r\n        </div>\r\n        <div className=\"videoplayer\">\r\n          <audio\r\n            id=\"audio_player\"\r\n            controls=\"controls\"\r\n            controlsList=\"nodownload\"\r\n          ></audio>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n","import \"./style.css\";\r\nimport firebase from \"firebase/app\";\r\nimport \"firebase/firestore\";\r\nimport { useEffect } from \"react\";\r\n\r\nexport default function Test() {\r\n  useEffect(() => {\r\n    const firebaseConfig = {\r\n      apiKey: \"AIzaSyAp2cQvNNp8fUKOv6kO_7wR5IsKROCoh14\",\r\n      authDomain: \"engage-6ef42.firebaseapp.com\",\r\n      projectId: \"engage-6ef42\",\r\n      storageBucket: \"engage-6ef42.appspot.com\",\r\n      messagingSenderId: \"27842359842\",\r\n      appId: \"1:27842359842:web:e8f5b15f6a86ac66fa507b\",\r\n      measurementId: \"G-EVEY2DP36T\",\r\n    };\r\n\r\n    if (!firebase.apps.length) {\r\n      firebase.initializeApp(firebaseConfig);\r\n    }\r\n    const firestore = firebase.firestore();\r\n\r\n    const servers = {\r\n      iceServers: [\r\n        {\r\n          urls: [\r\n            \"stun:stun1.l.google.com:19302\",\r\n            \"stun:stun2.l.google.com:19302\",\r\n          ],\r\n        },\r\n      ],\r\n      iceCandidatePoolSize: 10,\r\n    };\r\n\r\n    // Global State\r\n    const pc = new RTCPeerConnection(servers);\r\n    let localStream = null;\r\n    let remoteStream = null;\r\n\r\n    // HTML elements\r\n    const webcamButton = document.getElementById(\"webcamButton\");\r\n    const webcamVideo = document.getElementById(\"webcamVideo\");\r\n    const callButton = document.getElementById(\"callButton\");\r\n    const callInput = document.getElementById(\"callInput\");\r\n    const answerButton = document.getElementById(\"answerButton\");\r\n    const remoteVideo = document.getElementById(\"remoteVideo\");\r\n    const hangupButton = document.getElementById(\"hangupButton\");\r\n\r\n    // 1. Setup media sources\r\n\r\n    webcamButton.onclick = async () => {\r\n      localStream = await navigator.mediaDevices.getUserMedia({\r\n        video: true,\r\n        audio: true,\r\n      });\r\n      remoteStream = new MediaStream();\r\n\r\n      // Push tracks from local stream to peer connection\r\n      localStream.getTracks().forEach((track) => {\r\n        pc.addTrack(track, localStream);\r\n      });\r\n\r\n      // Pull tracks from remote stream, add to video stream\r\n      pc.ontrack = (event) => {\r\n        event.streams[0].getTracks().forEach((track) => {\r\n          remoteStream.addTrack(track);\r\n        });\r\n      };\r\n\r\n      webcamVideo.srcObject = localStream;\r\n      remoteVideo.srcObject = remoteStream;\r\n\r\n      callButton.disabled = false;\r\n      answerButton.disabled = false;\r\n      webcamButton.disabled = true;\r\n    };\r\n\r\n    // 2. Create an offer\r\n    callButton.onclick = async () => {\r\n      // Reference Firestore collections for signaling\r\n      const callDoc = firestore.collection(\"calls\").doc();\r\n      const offerCandidates = callDoc.collection(\"offerCandidates\");\r\n      const answerCandidates = callDoc.collection(\"answerCandidates\");\r\n\r\n      callInput.value = callDoc.id;\r\n\r\n      // Get candidates for caller, save to db\r\n      pc.onicecandidate = (event) => {\r\n        event.candidate && offerCandidates.add(event.candidate.toJSON());\r\n      };\r\n\r\n      // Create offer\r\n      const offerDescription = await pc.createOffer();\r\n      await pc.setLocalDescription(offerDescription);\r\n\r\n      const offer = {\r\n        sdp: offerDescription.sdp,\r\n        type: offerDescription.type,\r\n      };\r\n\r\n      await callDoc.set({ offer });\r\n\r\n      // Listen for remote answer\r\n      callDoc.onSnapshot((snapshot) => {\r\n        const data = snapshot.data();\r\n        if (!pc.currentRemoteDescription && data?.answer) {\r\n          const answerDescription = new RTCSessionDescription(data.answer);\r\n          pc.setRemoteDescription(answerDescription);\r\n        }\r\n      });\r\n\r\n      // When answered, add candidate to peer connection\r\n      answerCandidates.onSnapshot((snapshot) => {\r\n        snapshot.docChanges().forEach((change) => {\r\n          if (change.type === \"added\") {\r\n            const candidate = new RTCIceCandidate(change.doc.data());\r\n            pc.addIceCandidate(candidate);\r\n          }\r\n        });\r\n      });\r\n\r\n      hangupButton.disabled = false;\r\n    };\r\n\r\n    // 3. Answer the call with the unique ID\r\n    answerButton.onclick = async () => {\r\n      const callId = callInput.value;\r\n      const callDoc = firestore.collection(\"calls\").doc(callId);\r\n      const answerCandidates = callDoc.collection(\"answerCandidates\");\r\n      const offerCandidates = callDoc.collection(\"offerCandidates\");\r\n\r\n      pc.onicecandidate = (event) => {\r\n        event.candidate && answerCandidates.add(event.candidate.toJSON());\r\n      };\r\n\r\n      const callData = (await callDoc.get()).data();\r\n\r\n      const offerDescription = callData.offer;\r\n      await pc.setRemoteDescription(\r\n        new RTCSessionDescription(offerDescription)\r\n      );\r\n\r\n      const answerDescription = await pc.createAnswer();\r\n      await pc.setLocalDescription(answerDescription);\r\n\r\n      const answer = {\r\n        type: answerDescription.type,\r\n        sdp: answerDescription.sdp,\r\n      };\r\n\r\n      await callDoc.update({ answer });\r\n\r\n      offerCandidates.onSnapshot((snapshot) => {\r\n        snapshot.docChanges().forEach((change) => {\r\n          console.log(change);\r\n          if (change.type === \"added\") {\r\n            let data = change.doc.data();\r\n            pc.addIceCandidate(new RTCIceCandidate(data));\r\n          }\r\n        });\r\n      });\r\n    };\r\n  }, []);\r\n  return (\r\n    <>\r\n      <h2>1. Start your Webcam</h2>\r\n      <div className=\"videos\">\r\n        <span>\r\n          <h3>Local Stream</h3>\r\n          <video id=\"webcamVideo\" autoPlay playsInline></video>\r\n        </span>\r\n        <span>\r\n          <h3>Remote Stream</h3>\r\n          <video id=\"remoteVideo\" autoPlay playsInline></video>\r\n        </span>\r\n      </div>\r\n\r\n      <button id=\"webcamButton\">Start webcam</button>\r\n      <h2>2. Create a new Call</h2>\r\n      <button id=\"callButton\" disabled>\r\n        Create Call (offer)\r\n      </button>\r\n\r\n      <h2>3. Join a Call</h2>\r\n      <p>Answer the call from a different browser window or device</p>\r\n\r\n      <input id=\"callInput\" />\r\n      <button id=\"answerButton\" disabled>\r\n        Answer\r\n      </button>\r\n\r\n      <h2>4. Hangup</h2>\r\n\r\n      <button id=\"hangupButton\" disabled>\r\n        Hangup\r\n      </button>\r\n    </>\r\n  );\r\n}","import React from \"react\";\r\nimport \"./styles.css\";\r\nimport { Link } from \"react-router-dom\";\r\nimport {motion} from 'framer-motion';\r\nimport { v4 as uuidv4 } from 'uuid';\r\n\r\nfunction UserSection() {\r\n  const classid = uuidv4();\r\n  return (\r\n    <motion.section className = \"usersection\" initial= {{opacity:0, scale: 0.8 }} animate={{opacity:1, scale: 1}} transition= {{duration: 0.2}}>\r\n      \r\n<main className=\"us_main\">\r\n\t<div className=\"responsive-wrapper\">\r\n\t\t<div className=\"main-header\">\r\n\t\t\t<h1>Engage Proof of Concept Demo</h1>\r\n\t\t</div>\r\n\t\t<div className=\"horizontal-tabs\">\r\n\t\t\t<a href=\"#\" className=\"active\">Applications</a>\r\n\t\t\t<Link to = \"/lectures\">Watch Lectures</Link>\r\n\t\t</div>\r\n\t\t<div className=\"content-header\">\r\n\t\t\t<div className=\"content-header-intro\">\r\n\t\t\t\t<h2>Intergrations and connected apps</h2>\r\n\t\t\t\t<p>Supercharge your Productivity.</p>\r\n\t\t\t</div>\r\n\t\t\t<div className=\"content-header-actions\">\r\n                <a href=\"#\" className=\"us_button\">\r\n\t\t\t\t\t<span>Live Classes</span>\r\n\t\t\t\t</a>\r\n                <Link to = \"/recordform\">\r\n\t\t\t\t<div className=\"us_button\">\r\n\t\t\t\t\t<span>Record A Lecture</span>\r\n\t\t\t\t</div>\r\n                </Link>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t\t<div className=\"content\">\r\n\t\t\t<div className=\"content-panel\">\r\n\t\t\t\t<div className=\"vertical-tabs\">\r\n\t\t\t\t\t<a href=\"#\" className=\"active\">View all</a>\r\n\t\t\t\t\t<a href=\"#\">Teaching tools</a>\r\n\t\t\t\t\t<a href=\"#\">Computer Science</a>\r\n\t\t\t\t\t<a href=\"#\">Chemistry</a>\r\n\t\t\t\t\t<a href=\"#\">Physics</a>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t\t<div className=\"content-main\">\r\n\t\t\t\t<div className=\"us-card-grid\">\r\n                    <Link to=\"/drawboard\">\r\n\t\t\t\t\t<article className=\"uscard\">\r\n\t\t\t\t\t\t<div className=\"card-header\">\r\n\t\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t\t<span><img  className = \"us_img\" src=\"https://assets.codepen.io/285131/zeplin.svg\" /></span>\r\n\t\t\t\t\t\t\t\t<h3>Chalk Board</h3>\r\n\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div className=\"card-body\">\r\n\t\t\t\t\t\t\t<p>Custom ChalkBoard specially designed for teaching, tailored made UI/UX for different subjects</p>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div className=\"card-footer\">\r\n\t\t\t\t\t\t\t<div>View integration</div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</article>\r\n                    </Link>\r\n                    \r\n\t\t\t\t\t<Link to=\"/webd\">\r\n                    <article className=\"uscard\">\r\n\t\t\t\t\t\t<div className=\"card-header\">\r\n\t\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t\t<span><img className = \"us_img\" src=\"https://assets.codepen.io/285131/zeplin.svg\" /></span>\r\n\t\t\t\t\t\t\t\t<h3>WebD IDE</h3>\r\n\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div className=\"card-body\">\r\n\t\t\t\t\t\t\t<p>Web Development IDE for beginners, that works on vscode editor</p>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div className=\"card-footer\">\r\n\t\t\t\t\t\t\t<div>View integration</div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</article>\r\n                    </Link>\r\n                    \r\n\t\t\t\t\t<Link\r\n\t\t\t\t\tto={{\r\n\t\t\t\t\t\tpathname: \"/dsaide\",\r\n\t\t\t\t\t\tstate: { recording: false }\r\n\t\t\t\t\t  }}>\r\n                    <article className=\"uscard\">\r\n\t\t\t\t\t\t<div className=\"card-header\">\r\n\t\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t\t<span><img  className = \"us_img\" src=\"https://assets.codepen.io/285131/zeplin.svg\" /></span>\r\n\t\t\t\t\t\t\t\t<h3>C++ IDE</h3>\r\n\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div className=\"card-body\">\r\n\t\t\t\t\t\t\t<p>Learn DSA in C++, using the c++ compiler and IDE</p>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div className=\"card-footer\">\r\n\t\t\t\t\t\t\t<div>View integration</div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</article>\r\n                    </Link>\r\n\t\t\t\t\t<Link to=\"/classform\">\r\n                    <article className=\"uscard\">\r\n\t\t\t\t\t\t<div className=\"card-header\">\r\n\t\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t\t<span><img  className = \"us_img\" src=\"https://assets.codepen.io/285131/zeplin.svg\" /></span>\r\n\t\t\t\t\t\t\t\t<h3>Live Classes</h3>\r\n\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div className=\"card-body\">\r\n\t\t\t\t\t\t\t<p>Conduct a Live Class Room Session</p>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div className=\"card-footer\">\r\n\t\t\t\t\t\t\t<div>View integration</div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</article>\r\n                    </Link>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t</div>\r\n</main>\r\n    </motion.section>\r\n  );\r\n}\r\n\r\nexport default UserSection;\r\n","import React, { useEffect} from 'react'\r\nimport {useHistory} from \"react-router-dom\";\r\nimport axios from \"axios\";\r\nimport { motion } from \"framer-motion\";\r\nimport \"./style.css\"\r\nimport { v4 as uuidv4 } from 'uuid';\r\nfunction RecorderForm() {\r\n    const classid = uuidv4();\r\n    const path = document.location.pathname\r\n    const history = useHistory();\r\n    var imageString;\r\n    let lectureName;\r\n    let lectureType;\r\n    let lectureCreator;\r\n    let languageType;\r\n    const languageList = {\r\n        \"Python 2\": \"python2\", \r\n        C: \"c\",\r\n        \"C-99\": \"c99\",\r\n        \"C++\": \"cpp\",\r\n        \"C++ 14\": \"cpp14\",\r\n        \"C++ 17\": \"cpp17\",\r\n        \"Python 3\": \"python3\",\r\n      };\r\n    \r\n\r\n    useEffect(() => {\r\n        const navigateToRecorderWeb = () => history.push({\r\n            pathname:'/recorder',\r\n            state:{lectureType, lectureName, lectureCreator, languageType}}\r\n        );\r\n        const navigateToLiveClass = () => history.push({\r\n            pathname:`/emitter/${lectureType+languageType}/${classid}`,\r\n            state:{lectureType, lectureName, lectureCreator, languageType}}\r\n        );\r\n        const select = document.getElementById(\"language\");\r\n        for (let key in languageList) {\r\n          var option = document.createElement(\"option\");\r\n          option.text = key;\r\n          option.value = languageList[key];\r\n          option.className = languageList[key];\r\n          select.add(option);\r\n        }\r\n\r\n        const type = document.getElementById(\"lectureType\")\r\n        const name = document.getElementById(\"lectureName\")\r\n        const creator = document.getElementById(\"creator\")\r\n        const button = document.getElementById(\"submit\")\r\n        const thumNailButton = document.getElementsByClassName('thumnailImage')[0]\r\n        const thumNailPreview = document.getElementsByClassName('thumNailPreview')[0]\r\n        button.addEventListener(\"click\", () => {\r\n            lectureType = type.value\r\n            lectureName = name.value\r\n            lectureCreator = creator.value\r\n            if(lectureType === \"dsa\"){\r\n                languageType = select.value\r\n            }else{\r\n                languageType = ''\r\n            }\r\n            if(lectureName && lectureCreator){\r\n                if( path===\"/classform\") navigateToLiveClass()\r\n                else navigateToRecorderWeb()   \r\n               }else{\r\n                   alert(\"Fill The Form\")\r\n               }\r\n            axios.post(\"http://localhost:5000/savelecture/thum\", {\r\n                imageString,\r\n              }).then(response => {\r\n                if(response.data) {\r\n                  alert(\"Lecture Saved\")\r\n                }\r\n              })\r\n        })\r\n        thumNailButton.addEventListener(\"change\", (e) => {\r\n            console.log(e.target.files[0])\r\n            if(e.target.files[0].type === \"image/jpeg\" && e.target.files[0].size<=100000) {\r\n                var reader = new FileReader();\r\n                reader.readAsDataURL(e.target.files[0]);\r\n                reader.onloadend = () => {\r\n                    console.log(reader)\r\n                    console.log(e.target.files[0])\r\n                    thumNailPreview.src = reader.result\r\n                    imageString = reader.result\r\n                    thumNailPreview.style.display = \"block\"\r\n                };\r\n            }else{\r\n                alert(\"Improper image type\")\r\n            }\r\n        })\r\n        type.addEventListener(\"change\", (e) =>{\r\n            if(e.target.value === \"dsa\"){\r\n                select.style.display = \"block\"\r\n            }else{\r\n                select.style.display = \"none\"\r\n            }\r\n        })\r\n    },[])\r\n    \r\n    return (\r\n        <motion.div  initial= {{opacity:0, scale: 0.8 }} animate={{opacity:1, scale: 1, duration:0.5}} transition= {{type: \"Tween\"}}>\r\n        <form className=\"lectureForm\">\r\n            <input id=\"lectureName\" placeholder=\"Lecture Title\"/>\r\n            <input id=\"creator\" placeholder=\"Creator\"/>\r\n            <select id=\"lectureType\">\r\n                <option value=\"ide\">Web Developerment</option>\r\n                <option value=\"dsa\">DSA</option>\r\n                <option value=\"dra\">Chalk Board</option>\r\n            </select>\r\n            <input type = 'file' className=\"thumnailImage\"/>\r\n            <img className='thumNailPreview'></img>\r\n            <select name=\"language\" id=\"language\"></select>\r\n            <button type=\"button\" id=\"submit\">Submit</button>\r\n        </form>\r\n        </motion.div>\r\n    )\r\n}\r\n\r\nexport default RecorderForm","import React, { useEffect, useRef, useState } from \"react\";\r\nimport ChalkBoard from \"../ChalkBoard/index\";\r\nimport files from \"../assets/files\";\r\nimport Peer from \"simple-peer\";\r\nimport * as io from \"socket.io-client\";\r\nimport { motion } from \"framer-motion\";\r\nimport \"./style.css\";\r\nimport IDE from \"../IDE\";\r\nimport { useParams } from \"react-router\";\r\nconst env = process.env.NODE_ENV; // current environment\r\n\r\nlet url;\r\nif (env === \"development\") {\r\n  url = \"http://localhost:3000/receiver/\";\r\n} else {\r\n  url = \"https://fierce-reef-05156.herokuapp.com/receiver/\";\r\n}\r\nlet socketUrl;\r\nif (env === \"development\") {\r\n  socketUrl = \"http://localhost:5000\";\r\n} else {\r\n  socketUrl = \"https://fierce-reef-05156.herokuapp.com\";\r\n}\r\n\r\nvar constraints = {\r\n  audio: {\r\n    echoCancellationType: \"system\",\r\n    echoCancellation: true,\r\n    noiseSuppression: true,\r\n    sampleRate: 24000,\r\n    sampleSize: 16,\r\n    channelCount: 2,\r\n    volume: 0.5,\r\n  },\r\n  video: true,\r\n};\r\n\r\nfunction LiveClassEmitter() {\r\n  const { classid, type } = useParams();\r\n  const name = type.slice(0, 3);\r\n  var lastMouse = { x: 0, y: 0 };\r\n  const language = type.slice(3, 10);\r\n  var lastKey = \"\";\r\n  let fileName;\r\n  if (name === \"dsa\") {\r\n    fileName = language;\r\n  } else if (name === \"ide\") {\r\n    fileName = \"index.html\";\r\n  }\r\n  let childValue;\r\n  var lastKeyClass = \"\";\r\n  const joinLink = url + name + language + \"/\" + classid;\r\n  //TODO needed to reload the text editor\r\n  const [refresh, setRefresh] = useState(\"\");\r\n  const socketRef = useRef();\r\n  const [stream, setStream] = useState();\r\n  //while in development mode change document.location.origin to http://localhost:5000\r\n  socketRef.current = io.connect(socketUrl);\r\n  // Record each type of event\r\n  const myVideo = useRef();\r\n  const userVideo = useRef();\r\n  const connectionRef = useRef();\r\n  useEffect(() => {\r\n    socketRef.current.emit(\"admin-class\", { classid: classid });\r\n    const inviteButton = document.getElementsByClassName(\"inviteButton\")[0];\r\n    const inviteLink = document.getElementsByClassName(\"inviteLink\")[0];\r\n\r\n    navigator.mediaDevices.getUserMedia(constraints).then((stream) => {\r\n      setStream(stream);\r\n      myVideo.current.srcObject = stream;\r\n    });\r\n\r\n    inviteButton.addEventListener(\"click\", () => {\r\n      navigator.clipboard.writeText(inviteLink.value);\r\n      alert(\"link Copied\");\r\n    });\r\n  }, []);\r\n\r\n  const handlers = [\r\n    {\r\n      eventName: \"pointerup\",\r\n      handler: function handleMouseMove(e) {\r\n        const data = {\r\n          type: e.type,\r\n          bubbles: e.bubbles,\r\n          clientX: e.clientX,\r\n          clientY: e.clientY,\r\n          offsetX: e.offsetX,\r\n          offsetY: e.offsetY,\r\n          pointerType: e.pointerType,\r\n          target: e.target.className,\r\n        };\r\n        sendData(data);\r\n      },\r\n    },\r\n    {\r\n      eventName: \"pointerdown\",\r\n      handler: function handleMouseMove(e) {\r\n        const data = {\r\n          type: \"pointerdown\",\r\n          bubbles: e.bubbles,\r\n          clientX: e.clientX,\r\n          clientY: e.clientY,\r\n          offsetX: e.offsetX,\r\n          offsetY: e.offsetY,\r\n          pointerType: e.pointerType,\r\n          target: e.target.className,\r\n        };\r\n        sendData(data);\r\n      },\r\n    },\r\n    {\r\n      eventName: \"pointermove\",\r\n      handler: function handleMouseMove(e) {\r\n        const data = {\r\n          type: e.type,\r\n          bubbles: e.bubbles,\r\n          clientX: e.clientX,\r\n          clientY: e.clientY,\r\n          offsetX: e.offsetX,\r\n          offsetY: e.offsetY,\r\n          pointerType: e.pointerType,\r\n          target: e.target.className,\r\n          x: e.x,\r\n          y: e.y,\r\n        };\r\n        sendData(data);\r\n      },\r\n    },\r\n    {\r\n      eventName: \"mousedown\",\r\n      handler: function handleMouseMove(e) {\r\n        const data = {\r\n          clientX: e.clientX,\r\n          clientY: e.clientY,\r\n          offsetX: e.offsetX,\r\n          offsetY: e.offsetY,\r\n          bubbles: e.bubbles,\r\n          button: e.button,\r\n          target: e.target.className,\r\n          type: e.type,\r\n        };\r\n        if(e.target.className === 'gutter gutter-horizontal'){\r\n          sendData(data);\r\n        }\r\n      },\r\n    },\r\n    {\r\n      eventName: \"mousemove\",\r\n      handler: function handleMouseMove(e) {\r\n        const data = {\r\n          clientX: e.clientX,\r\n          clientY: e.clientY,\r\n          offsetX: e.offsetX,\r\n          offsetY: e.offsetY,\r\n          bubbles: e.bubbles,\r\n          button: e.button,\r\n          target: e.target.className,\r\n          type: e.type,\r\n        };\r\n        if(e.target.className === 'gutter gutter-horizontal'){\r\n          sendData(data);\r\n        }\r\n      },\r\n    },\r\n    {\r\n      eventName: \"mouseup\",\r\n      handler: function handleMouseMove(e) {\r\n        const data = {\r\n          clientX: e.clientX,\r\n          clientY: e.clientY,\r\n          offsetX: e.offsetX,\r\n          offsetY: e.offsetY,\r\n          bubbles: e.bubbles,\r\n          button: e.button,\r\n          target: e.target.className,\r\n          type: e.type,\r\n        };\r\n        if(e.target.className === 'gutter gutter-horizontal'){\r\n          sendData(data);\r\n        }\r\n      },\r\n    },\r\n    {\r\n      eventName: \"click\",\r\n      handler: function handleMouseMove(e) {\r\n        if (\r\n          e.target.className === \"cssfile\" ||\r\n          e.target.className === \"buttontext style\" ||\r\n          e.target.className === \"fab fa-css3-alt\"\r\n        )\r\n          fileName = \"style.css\";\r\n        if (\r\n          e.target.className === \"jsfile\" ||\r\n          e.target.className === \"buttontext script\" ||\r\n          e.target.className === \" fa-js-square\"\r\n        )\r\n          fileName = \"script.js\";\r\n        if (\r\n          e.target.className === \"htmlfile\" ||\r\n          e.target.className === \"buttontext html\" ||\r\n          e.target.className === \"fab fa-html5fab\"\r\n        )\r\n          fileName = \"index.html\";\r\n        console.log(e.target.className);\r\n        const data = {\r\n          type: \"click\",\r\n          target: e.target.className,\r\n          x: e.pageX,\r\n          fileName: fileName,\r\n          y: e.pageY,\r\n        };\r\n        sendData(data);\r\n      },\r\n    },\r\n    {\r\n      eventName: \"keyup\",\r\n      handler: function handleKeyPress(e) {\r\n        console.log(files[fileName]);\r\n        if (name === \"ide\" || name === \"dsa\") {\r\n          lastKey = childValue;\r\n          lastKeyClass = e.target.className;\r\n          const data = {\r\n            type: \"keyup\",\r\n            target: e.target.className,\r\n            x: lastMouse.x,\r\n            y: lastMouse.y,\r\n            fileName: fileName,\r\n            value:\r\n              e.target.className === \"userInputArea\"\r\n                ? e.target.value\r\n                : files[fileName].value,\r\n            keyCode: e.keyCode,\r\n          };\r\n          sendData(data);\r\n        }\r\n      },\r\n    },\r\n    {\r\n      eventName: \"output\",\r\n      handler: function handleChange(e) {\r\n        const data = {\r\n          type: \"output\",\r\n          target: \"userOutputArea\",\r\n          value: e.detail.output,\r\n        };\r\n        sendData(data);\r\n      },\r\n    },\r\n  ];\r\n\r\n  function sendData(data) {\r\n    socketRef.current.emit(\"emitData\", classid, data);\r\n  }\r\n\r\n  function removeListener(eventName, handler) {\r\n    return document.documentElement.removeEventListener(\r\n      eventName,\r\n      handler,\r\n      true\r\n    );\r\n  }\r\n\r\n  function listen(eventName, handler) {\r\n    return document.documentElement.addEventListener(eventName, handler, true);\r\n  }\r\n\r\n  function startLive() {\r\n    const peer = new Peer({\r\n      initiator: true,\r\n      trickle: false,\r\n      config: {\r\n        iceServers: [\r\n          {\r\n            urls: \"stun:numb.viagenie.ca\",\r\n            username: \"sultan1640@gmail.com\",\r\n            credential: \"98376683\",\r\n          },\r\n          {\r\n            urls: \"turn:numb.viagenie.ca\",\r\n            username: \"sultan1640@gmail.com\",\r\n            credential: \"98376683\",\r\n          },\r\n        ],\r\n      },\r\n      stream: stream,\r\n    });\r\n\r\n    peer.on(\"signal\", (data) => {\r\n      socketRef.current.emit(\"sendStream\", {\r\n        signalData: data,\r\n        classid: classid,\r\n      });\r\n    });\r\n\r\n    socketRef.current.on(\"callAccepted\", (data) => {\r\n      console.log(data.signalData);\r\n      peer.signal(data.signalData);\r\n    });\r\n    handlers.map((x) => listen(x.eventName, x.handler));\r\n  }\r\n\r\n  function stopLive() {\r\n    handlers.map((x) => removeListener(x.eventName, x.handler));\r\n  }\r\n\r\n  return (\r\n    <>\r\n      <div style={{ display: \"flex\", flexDirection: \"row-reverse\" }}>\r\n        <button onClick={() => startLive()} className=\"inviteButton\">\r\n          <input className=\"inviteLink\" defaultValue={joinLink} />\r\n          <i className=\"fas fa-clipboard-list\"></i>\r\n        </button>\r\n        <motion.div\r\n          drag={true}\r\n          dragConstraints={{ left: -1000, top: -800, right: 0, bottom: 0 }}\r\n          dragTransition={{ bounceStiffness: 600, bounceDamping: 20 }}\r\n          dragElastic={0.5}\r\n          whileTap={{ cursor: \"grabbing\" }}\r\n          style={{ cursor: \"grab\", overflow: \"hidden\" }}\r\n          className=\"streamingWindow\"\r\n        >\r\n          {stream && (\r\n            <video\r\n              className=\"instructorStream\"\r\n              playsInline\r\n              muted\r\n              ref={myVideo}\r\n              autoPlay\r\n              style={{ width: \"300px\" }}\r\n            />\r\n          )}\r\n        </motion.div>\r\n      </div>\r\n\r\n      {name === \"dra\" ? (\r\n        <div className=\"chalk\">\r\n          <ChalkBoard />\r\n        </div>\r\n      ) : (\r\n        <IDE name={name} language={language} refresh={refresh} />\r\n      )}\r\n    </>\r\n  );\r\n}\r\n\r\nexport default LiveClassEmitter;\r\n","import React, { useEffect, useState, useRef } from \"react\";\r\nimport ChalkBoard from \"../ChalkBoard/index\";\r\nimport Peer from \"simple-peer\";\r\nimport IDE from \"../IDE\";\r\nimport files from \"../assets/files\";\r\nimport { useDispatch } from \"react-redux\";\r\nimport {\r\n  js,\r\n  css,\r\n  html,\r\n  outputModalTrue,\r\n  outputModalFalse,\r\n  setSrcDocs,\r\n} from \"../actions\";\r\nimport * as io from \"socket.io-client\";\r\nimport { useParams } from \"react-router\";\r\nimport img from \"../assets/Gear-0.2s-200px.png\";\r\nimport { motion } from \"framer-motion\"\r\nconst env = process.env.NODE_ENV; // current environment\r\n\r\nfunction Preloader() {\r\n  return (\r\n    <div className=\"loader\">\r\n      <div className=\"preloader\">\r\n        <div className=\"preloaderText\">Please Wait ...</div>\r\n        <button className=\"answerButton\">Enter</button>\r\n        <div className=\"load\">\r\n          <img src={img} border=\"0\" />\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nlet socketUrl;\r\nif (env === \"development\") {\r\n  socketUrl = \"http://localhost:5000\";\r\n} else {\r\n  socketUrl = \"https://fierce-reef-05156.herokuapp.com\";\r\n}\r\n\r\nfunction LiveClassReceiver() {\r\n  const { classid, type } = useParams();\r\n  const name = type.slice(0, 3);\r\n  const language = type.slice(3, 10);\r\n  const socketRef = useRef();\r\n  const [stream, setStream] = useState();\r\n  const [receivingCall, setReceivingCall] = useState(false);\r\n  const [callerSignal, setCallerSignal] = useState();\r\n  const dispatch = useDispatch();\r\n  //TODO needed to reload the text editor\r\n  const [refresh, setRefresh] = useState(\"\");\r\n  const userVideo = useRef();\r\n  //while in development mode change document.location.origin to http://localhost:5000\r\n  socketRef.current = io.connect(socketUrl);\r\n  function handleButtonEvents(target) {\r\n    switch (target) {\r\n      case \"outputtext\":\r\n        dispatch(setSrcDocs());\r\n        dispatch(outputModalTrue());\r\n        break;\r\n      case \"output\":\r\n        dispatch(setSrcDocs());\r\n        dispatch(outputModalTrue());\r\n        break;\r\n      case \"buttontext output\":\r\n        dispatch(setSrcDocs());\r\n        dispatch(outputModalTrue());\r\n        break;\r\n      case \"fas fa-play\":\r\n        dispatch(setSrcDocs());\r\n        dispatch(outputModalTrue());\r\n        break;\r\n      case \"fas fa-window-close\":\r\n        dispatch(outputModalFalse());\r\n        break;\r\n      case \"style.css\":\r\n        dispatch(css());\r\n        break;\r\n      case \"buttontext style\":\r\n        dispatch(css());\r\n        break;\r\n      case \"index.html\":\r\n        dispatch(html());\r\n        break;\r\n      case \"script.js\":\r\n        dispatch(js());\r\n        break;\r\n      case \"buttontext script\":\r\n        dispatch(js());\r\n        break;\r\n      default:\r\n        break;\r\n    }\r\n  }\r\n\r\n  useEffect(() => {\r\n    socketRef.current.emit(\"join-class\", { classid: classid });\r\n    const answerButton = document.getElementsByClassName(\"answerButton\")[0];\r\n    const contentWindow = document.getElementsByClassName(\"contentWindow\")[0];\r\n    socketRef.current.on(\"receiveData\", (data) => {\r\n      const drawStatus = {\r\n        status: false,\r\n      };\r\n      const eve = new CustomEvent(\"status\", { detail: drawStatus });\r\n      document.dispatchEvent(eve);\r\n      if (data.type === \"pointerdown\") {\r\n        let eve = new PointerEvent(\"pointerdown\", {\r\n          bubbles: data.bubbles,\r\n          clientX: data.clientX,\r\n          clientY: data.clientY,\r\n          offsetX: data.offsetX,\r\n          offsetY: data.offsetY,\r\n          pointerType: data.pointerType,\r\n        });\r\n        if (document.getElementsByClassName(data.target)[0])\r\n          document.getElementsByClassName(data.target)[0].dispatchEvent(eve);\r\n      } else if (data.type === \"pointermove\") {\r\n        let eve = new PointerEvent(\"pointermove\", {\r\n          bubbles: data.bubbles,\r\n          clientX: data.clientX,\r\n          clientY: data.clientY,\r\n          offsetX: data.offsetX,\r\n          offsetY: data.offsetY,\r\n          pointerType: data.pointerType,\r\n        });\r\n\r\n        if (document.getElementsByClassName(data.target)[0]) {\r\n          document.getElementsByClassName(data.target)[0].dispatchEvent(eve);\r\n        }\r\n        const path = data.target;\r\n        var tar = document.getElementsByClassName(path)[0];\r\n        if (tar != null) {\r\n          tar.focus();\r\n        }\r\n      } else if (data.type === \"pointerup\") {\r\n        let eve = new PointerEvent(\"pointerup\", {\r\n          bubbles: data.bubbles,\r\n          clientX: data.clientX,\r\n          clientY: data.clientY,\r\n          offsetX: data.offsetX,\r\n          offsetY: data.offsetY,\r\n          pointerType: data.pointerType,\r\n        });\r\n        if (document.getElementsByClassName(data.target)[0])\r\n          document.getElementsByClassName(data.target)[0].dispatchEvent(eve);\r\n      }\r\n      else if (data.type === \"mousedown\") {\r\n        let eve = new MouseEvent(\"mousedown\", {\r\n          clientX: data.clientX,\r\n          clientY: data.clientY,\r\n          offsetX: data.offsetX,\r\n          offsetY: data.offsetY,\r\n          bubbles: data.bubbles,\r\n          button: data.button,\r\n        });\r\n        if (document.getElementsByClassName(data.target)[0])\r\n          document.getElementsByClassName(data.target)[0].dispatchEvent(eve);\r\n      } \r\n      else if (data.type === \"mousemove\") {\r\n        let eve = new MouseEvent(\"mousemove\", {\r\n          clientX: data.clientX,\r\n          clientY: data.clientY,\r\n          offsetX: data.offsetX,\r\n          offsetY: data.offsetY,\r\n          bubbles: data.bubbles,\r\n          button: data.button,\r\n        });\r\n        if (document.getElementsByClassName(data.target)[0])\r\n          document.getElementsByClassName(data.target)[0].dispatchEvent(eve);\r\n      } \r\n      else if (data.type === \"mouseup\") {\r\n        let eve = new MouseEvent(\"mouseup\", {\r\n          clientX: data.clientX,\r\n          clientY: data.clientY,\r\n          offsetX: data.offsetX,\r\n          offsetY: data.offsetY,\r\n          bubbles: data.bubbles,\r\n          button: data.button,\r\n        });\r\n        if (document.getElementsByClassName(data.target)[0])\r\n          document.getElementsByClassName(data.target)[0].dispatchEvent(eve);\r\n      }  \r\n      else if (data.type === \"click\") {\r\n        if (document.getElementsByClassName(data.target)[0] !== undefined) {\r\n          let clickEvent = new MouseEvent(\"click\", {\r\n            pageX: data.x,\r\n            pageY: data.y,\r\n            bubbles: true,\r\n            cancelable: true,\r\n          });\r\n\r\n          document\r\n            .getElementsByClassName(data.target)[0]\r\n            .dispatchEvent(clickEvent);\r\n        }\r\n        if (\r\n          data.target === \"rectangle\" ||\r\n          data.target === \"ellipse\" ||\r\n          data.target === \"arrow\" ||\r\n          data.target === \"selection\"\r\n        )\r\n          document.getElementsByClassName(data.target)[0].click();\r\n        tar = document.getElementsByClassName(data.target)[0];\r\n        if (tar != null) {\r\n          handleButtonEvents(data.fileName);\r\n          handleButtonEvents(data.target);\r\n        }\r\n      } else if (data.type === \"keyup\") {\r\n        const path = data.target;\r\n        tar = document.getElementsByClassName(path)[0];\r\n        if (tar != null) {\r\n          tar.focus();\r\n          if (path === \"userInputArea\") {\r\n            tar.value = data.value;\r\n          } else {\r\n            files[data.fileName].value = data.value;\r\n            handleButtonEvents(data.fileName);\r\n            setRefresh(data.value);\r\n          }\r\n        }\r\n      } else if (data.type === \"output\") {\r\n        const path = data.target;\r\n        tar = document.getElementsByClassName(path)[0];\r\n        if (tar != null) {\r\n          tar.focus();\r\n          if (path === \"userOutputArea\") {\r\n            tar.value = data.value;\r\n          }\r\n        }\r\n      } else if (data.type === \"keydown\") {\r\n        if (document.getElementsByClassName(\"canvas_text\")[0]) {\r\n          document.getElementsByClassName(\"canvas_text\")[0].innerText =\r\n            data.innerText;\r\n        }\r\n      }\r\n    });\r\n\r\n    socketRef.current.on(\"emitStream\", (data) => {\r\n      console.log(data);\r\n      document.getElementsByClassName(\"load\")[0].style.display = \"none\";\r\n      console.log(\"loaded\");\r\n      answerButton.style.display = \"block\";\r\n      setCallerSignal(data);\r\n      answerButton.addEventListener(\"click\", () => {\r\n        console.log(\"working\");\r\n        const peer = new Peer({\r\n          initiator: false,\r\n          trickle: false,\r\n          stream: stream,\r\n        });\r\n\r\n        peer.on(\"signal\", (data) => {\r\n          socketRef.current.emit(\"answerCall\", {\r\n            signalData: data,\r\n            classid: classid,\r\n          });\r\n        });\r\n        console.log(callerSignal);\r\n        peer.signal(data);\r\n\r\n        peer.on(\"stream\", (stream) => {\r\n          setStream(stream);\r\n          userVideo.current.srcObject = stream;\r\n        });\r\n        document.getElementsByClassName(\"loader\")[0].style.display = \"none\";\r\n        contentWindow.style.display = \"block\";\r\n      });\r\n    });\r\n  }, []);\r\n\r\n  return (\r\n    <div>\r\n      <Preloader />\r\n      <div className=\"contentWindow\">\r\n        <div style={{ display: \"flex\", flexDirection: \"row-reverse\" }}>\r\n          <div\r\n            className=\"streamingWindow\"\r\n            style={{\r\n              position: \"absolute\",\r\n              zIndex: \"3\",\r\n              display: \"flex\",\r\n              flexDirection: \"column\",\r\n              paddingRight: \"10px\",\r\n            }}\r\n          >\r\n            {stream && (\r\n              <video\r\n                playsInline\r\n                ref={userVideo}\r\n                autoPlay\r\n                style={{ width: \"300px\" }}\r\n              />\r\n            )}\r\n          </div>\r\n        </div>\r\n        {name === \"dra\" ? (\r\n          <div className=\"chalk\">\r\n            <ChalkBoard />\r\n          </div>\r\n        ) : (\r\n          <IDE name={name} language={language} refresh={refresh} />\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default LiveClassReceiver;\r\n","import React from 'react'\r\nimport { Link } from \"react-router-dom\";\r\nimport { motion } from \"framer-motion\";\r\nimport './styles.css'\r\nfunction Card(props) {\r\n    console.log(props.lectures)\r\n    return (\r\n        <>\r\n            <motion.section  initial= {{opacity:0, scale: 0.8 }} animate={{opacity:1, scale: 1, duration:0.5}} transition= {{type: \"Tween\"}} className=\"hero-section\">\r\n                <div className=\"card-grid\">\r\n                {props.lectures.map((lecture) => {\r\n                    const id = lecture.id;\r\n                    const type = `${lecture.type}${lecture.language}`;\r\n                    const thumbnail = lecture.imageThumnail\r\n                    return(\r\n                    <div key={lecture.id}>\r\n                        <Link to = {`/player/${type}/${id}`}>\r\n                        <div className=\"card\">\r\n                        <div className=\"card__background\" style={{backgroundImage:`url(${thumbnail})`}}></div>\r\n                        <div className=\"card__content\">\r\n                            <p className=\"card__category\">{lecture.creator}</p>\r\n                            <h3 className=\"card__heading\">{lecture.name}</h3> \r\n                        </div>\r\n                        </div>\r\n                        </Link>\r\n                    </div>)\r\n                })}\r\n                </div>\r\n            </motion.section>\r\n        </>    \r\n    )\r\n}\r\n\r\nexport default Card","import React , {useEffect, useLayoutEffect, useState} from 'react'\r\nimport firebase from 'firebase/app'\r\nimport 'firebase/firestore'\r\nimport Card from '../Card/card'\r\nimport axios from \"axios\";\r\nconst env = process.env.NODE_ENV; // current environment\r\n\r\nlet url;\r\nif (env === \"development\") {\r\n  url = \"http://localhost:5000/savelecture\";\r\n} else {\r\n  url = \"https://fierce-reef-05156.herokuapp.com/savelecture\";\r\n}\r\n\r\nfunction Preloader(){\r\n    return(\r\n      <div className = \"loader\">\r\n      <div className =\"preloader\">\r\n      <div className =\"box\">\r\n          <div className =\"box__inner\">\r\n              <div className =\"box__back-flap\"></div>\r\n              <div className =\"box__right-flap\"></div>\r\n              <div className =\"box__front-flap\"></div>\r\n              <div className =\"box__left-flap\"></div>\r\n              <div className =\"box__front\"></div>\r\n          </div>\r\n      </div>\r\n      <div className =\"box\">\r\n          <div className =\"box__inner\">\r\n              <div className =\"box__back-flap\"></div>\r\n              <div className =\"box__right-flap\"></div>\r\n              <div className =\"box__front-flap\"></div>\r\n              <div className =\"box__left-flap\"></div>\r\n              <div className =\"box__front\"></div>\r\n          </div>\r\n      </div>\r\n      <div className =\"line\">\r\n          <div className =\"line__inner\"></div>\r\n      </div>\r\n      <div className =\"line\">\r\n          <div className =\"line__inner\"></div>\r\n      </div>\r\n      <div className =\"line\">\r\n          <div className =\"line__inner\"></div>\r\n      </div>\r\n      <div className =\"line\">\r\n          <div className =\"line__inner\"></div>\r\n      </div>\r\n      <div className =\"line\">\r\n          <div className =\"line__inner\"></div>\r\n      </div>\r\n      <div className =\"line\">\r\n          <div className =\"line__inner\"></div>\r\n      </div>\r\n      <div className =\"line\">\r\n          <div className =\"line__inner\"></div>\r\n      </div>\r\n  </div>\r\n  </div>\r\n    )\r\n  }\r\nfunction AllLectures() {\r\n    const [lectures, setLectures] = useState('')\r\n    let lecturesArray = []\r\n    const [isLoading, setLoading] = useState(false)\r\n    useEffect(() => {\r\n        console.log(\"WROING\")\r\n        axios.get(url).then(result => {\r\n            console.log(result.data)\r\n            setLectures(result.data)\r\n            setLoading(true)\r\n        })\r\n    }, [])\r\n    return (\r\n        <>\r\n            {isLoading ? <Card lectures={lectures}/>: <Preloader/>}\r\n        </>\r\n    )\r\n}\r\n\r\nexport default AllLectures","import { webDFiles } from \"../assets/files\";\r\n\r\nvar fi = webDFiles;\r\n\r\nexport const files = (state = webDFiles, action) => {\r\n  switch(action.type){\r\n    case \"uploadfile\":\r\n      state = action.file;\r\n      fi = webDFiles\r\n      return state;\r\n    default:\r\n      return state;\r\n  }\r\n}\r\n\r\nconst filenameReducer = (state = files[0], action) => {\r\n  switch (action.type) {\r\n    case \"changefile\":\r\n      state = fi.find( (file) => file.id === action.f_id )\r\n      console.log(files.find( (file) => file.id === action.f_id ));\r\n      return state;\r\n    case \"js\":\r\n      state = \"script.js\";\r\n      return state;\r\n    case \"css\":\r\n      state = \"style.css\";\r\n      return state;\r\n    case \"html\":\r\n      state = \"index.html\";\r\n      return state;\r\n    default:\r\n      return state;\r\n  }\r\n};\r\n\r\nexport default filenameReducer;\r\n","import files from \"../assets/files\"\r\n\r\nconst outputModalReducer = (state = false, action) => {\r\n\r\n    switch(action.type){\r\n        case \"outputtrue\":\r\n            state = true\r\n            return state\r\n        case \"outputfalse\":\r\n            state = false\r\n            return state\r\n        default:\r\n            return state\r\n    }\r\n}\r\n\r\nexport const outputSrcReducer = (state = \"\", action) => {\r\n\r\n    switch(action.type){\r\n        case \"setSrcdoc\":\r\n            state = `\r\n            <html>\r\n              <body>${files[\"index.html\"].value}</body>\r\n              <style>${files[\"style.css\"].value}</style>\r\n              <script>${files[\"script.js\"].value}</script>\r\n            </html>\r\n          `\r\n            return state\r\n        default:\r\n            return state\r\n    }\r\n}\r\n\r\nexport default outputModalReducer;","const languageReducer = (state=\"c\", action) => {\r\n    switch(action.type){\r\n      case \"c\":\r\n        state = \"c\";\r\n        return state;\r\n      case \"c99\":\r\n        state = \"c99\";\r\n        return state;\r\n      case \"cpp\":\r\n        state = \"cpp\";\r\n        return state;\r\n      case \"cpp14\":\r\n        state = \"cpp14\";\r\n        return state;\r\n      case \"cpp17\":\r\n        state = \"cpp17\";\r\n        return state;\r\n      case \"python2\":\r\n        state = \"python2\";\r\n        return state;\r\n      case \"python3\":\r\n        state = \"python3\";\r\n        return state;\r\n      default:\r\n        return state;\r\n    }\r\n  }\r\n  \r\n  export default languageReducer;\r\n  ","import filenameReducer, { files } from \"./filenameSelection\";\r\nimport outputModalReducer, { outputSrcReducer } from \"./outputModalReducer\";\r\nimport { combineReducers } from \"redux\";\r\nimport languageReducer from \"./languageSelection\";\r\nconst allReducers = combineReducers({\r\n    files : files,\r\n    fileName: filenameReducer,\r\n    outputModal: outputModalReducer,\r\n    srcDocs: outputSrcReducer,\r\n    language:languageReducer\r\n})\r\n\r\nexport default allReducers;\r\n","import { BrowserRouter as Router, Route, Switch } from \"react-router-dom\";\r\nimport ChalkBoard from \"./ChalkBoard\";\r\nimport TextEditor from \"./TextEditor/TextEditor\";\r\nimport Recorder from \"./Recorder\";\r\nimport Player from \"./Player\";\r\nimport Test from \"./TestComponent\";\r\nimport UserSection from \"./UserSection\";\r\nimport { createStore, compose, applyMiddleware } from \"redux\";\r\nimport RecorderForm from \"./RecorderForm/recorderForm\";\r\nimport MultiFile from \"./MultilanguageEditor/multiFile\";\r\nimport Video from \"./Player\";\r\nimport LiveClassEmitter from \"./LiveClasses/liveClassEmitter\";\r\nimport LiveClassReceiver from \"./LiveClasses/liveClassReceiver\";\r\nimport AllLectures from \"./Lectures/allLectures\";\r\nimport allReducer from \"./reducers\";\r\nimport thunk from \"redux-thunk\";\r\nimport { Provider } from \"react-redux\";\r\nimport \"./App.css\";\r\n\r\n\r\nconst middleware = [thunk];\r\n\r\nconst composeEnhancer = window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__ || compose;\r\n\r\nconst store = createStore(\r\n  allReducer,\r\n  composeEnhancer(applyMiddleware(...middleware))\r\n);\r\n\r\nfunction App() {\r\n  return (\r\n    <>\r\n      <Provider store={store}>\r\n        <Router>\r\n          <Route exact path=\"/\" component={UserSection} />\r\n          <Route exact path=\"/lectures\" component={AllLectures} />\r\n          <Route exact path=\"/player/:type/:id\" component={Player} />\r\n          <Route path=\"/emitter/:type/:classid\" component={LiveClassEmitter} />\r\n          <Route\r\n            exact\r\n            path=\"/receiver/:type/:classid\"\r\n            component={LiveClassReceiver}\r\n          />\r\n          <Route exact path=\"/drawboard\" component={ChalkBoard} />\r\n          <Route exact path=\"/webd\" component={TextEditor} />\r\n          <Route exact path=\"/dsaide\" component={MultiFile} />\r\n          <Route exact path=\"/recordform\" component={RecorderForm} />\r\n          <Route exact path=\"/classform\" component={RecorderForm} />\r\n          <Route exact path=\"/videoplayer\" component={Video} />\r\n          <Route exact path=\"/test\" component={Test} />\r\n          <Route exact path=\"/recorder\" component={Recorder} ide=\"web\" />\r\n        </Router>\r\n      </Provider>\r\n    </>\r\n  );\r\n}\r\n\r\nexport default App;","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport App from './App';\r\n\r\n\r\nReactDOM.render(<App />,\r\n  document.getElementById('root')\r\n);\r\n\r\n","import { deflate, inflate } from \"pako\";\r\nimport { encryptData, decryptData } from \"./encryption\";\r\n// -----------------------------------------------------------------------------\r\n// byte (binary) strings\r\n// -----------------------------------------------------------------------------\r\n// fast, Buffer-compatible implem\r\nexport const toByteString = (data) => {\r\n    return new Promise((resolve, reject) => {\r\n        const blob = typeof data === \"string\"\r\n            ? new Blob([new TextEncoder().encode(data)])\r\n            : new Blob([data instanceof Uint8Array ? data : new Uint8Array(data)]);\r\n        const reader = new FileReader();\r\n        reader.onload = (event) => {\r\n            if (!event.target || typeof event.target.result !== \"string\") {\r\n                return reject(new Error(\"couldn't convert to byte string\"));\r\n            }\r\n            resolve(event.target.result);\r\n        };\r\n        reader.readAsBinaryString(blob);\r\n    });\r\n};\r\nconst byteStringToArrayBuffer = (byteString) => {\r\n    const buffer = new ArrayBuffer(byteString.length);\r\n    const bufferView = new Uint8Array(buffer);\r\n    for (let i = 0, len = byteString.length; i < len; i++) {\r\n        bufferView[i] = byteString.charCodeAt(i);\r\n    }\r\n    return buffer;\r\n};\r\nconst byteStringToString = (byteString) => {\r\n    return new TextDecoder(\"utf-8\").decode(byteStringToArrayBuffer(byteString));\r\n};\r\n// -----------------------------------------------------------------------------\r\n// base64\r\n// -----------------------------------------------------------------------------\r\n/**\r\n * @param isByteString set to true if already byte string to prevent bloat\r\n *  due to reencoding\r\n */\r\nexport const stringToBase64 = async (str, isByteString = false) => {\r\n    return isByteString ? window.btoa(str) : window.btoa(await toByteString(str));\r\n};\r\n// async to align with stringToBase64\r\nexport const base64ToString = async (base64, isByteString = false) => {\r\n    return isByteString\r\n        ? window.atob(base64)\r\n        : byteStringToString(window.atob(base64));\r\n};\r\n/**\r\n * Encodes (and potentially compresses via zlib) text to byte string\r\n */\r\nexport const encode = async ({ text, compress, }) => {\r\n    let deflated;\r\n    if (compress !== false) {\r\n        try {\r\n            deflated = await toByteString(deflate(text));\r\n        }\r\n        catch (error) {\r\n            console.error(\"encode: cannot deflate\", error);\r\n        }\r\n    }\r\n    return {\r\n        version: \"1\",\r\n        encoding: \"bstring\",\r\n        compressed: !!deflated,\r\n        encoded: deflated || (await toByteString(text)),\r\n    };\r\n};\r\nexport const decode = async (data) => {\r\n    let decoded;\r\n    switch (data.encoding) {\r\n        case \"bstring\":\r\n            // if compressed, do not double decode the bstring\r\n            decoded = data.compressed\r\n                ? data.encoded\r\n                : await byteStringToString(data.encoded);\r\n            break;\r\n        default:\r\n            throw new Error(`decode: unknown encoding \"${data.encoding}\"`);\r\n    }\r\n    if (data.compressed) {\r\n        return inflate(new Uint8Array(byteStringToArrayBuffer(decoded)), {\r\n            to: \"string\",\r\n        });\r\n    }\r\n    return decoded;\r\n};\r\n// -----------------------------------------------------------------------------\r\nconst CONCAT_BUFFERS_VERSION = 1;\r\n/** how many bytes we use to encode how many bytes the next chunk has.\r\n * Corresponds to DataView setter methods (setUint32, setUint16, etc).\r\n *\r\n * NOTE ! values must not be changed, which would be backwards incompatible !\r\n */\r\nconst VERSION_DATAVIEW_BYTES = 4;\r\nconst NEXT_CHUNK_SIZE_DATAVIEW_BYTES = 4;\r\n// -----------------------------------------------------------------------------\r\nconst DATA_VIEW_BITS_MAP = { 1: 8, 2: 16, 4: 32 };\r\n/**\r\n * abstraction over DataView that serves as a typed getter/setter in case\r\n * you're using constants for the byte size and want to ensure there's no\r\n * discrepenancy in the encoding across refactors.\r\n *\r\n * DataView serves for an endian-agnostic handling of numbers in ArrayBuffers.\r\n */\r\nfunction dataView(buffer, bytes, offset, value) {\r\n    if (value != null) {\r\n        if (value > Math.pow(2, DATA_VIEW_BITS_MAP[bytes]) - 1) {\r\n            throw new Error(`attempting to set value higher than the allocated bytes (value: ${value}, bytes: ${bytes})`);\r\n        }\r\n        const method = `setUint${DATA_VIEW_BITS_MAP[bytes]}`;\r\n        new DataView(buffer.buffer)[method](offset, value);\r\n        return buffer;\r\n    }\r\n    const method = `getUint${DATA_VIEW_BITS_MAP[bytes]}`;\r\n    return new DataView(buffer.buffer)[method](offset);\r\n}\r\n// -----------------------------------------------------------------------------\r\n/**\r\n * Resulting concatenated buffer has this format:\r\n *\r\n * [\r\n *   VERSION chunk (4 bytes)\r\n *   LENGTH chunk 1 (4 bytes)\r\n *   DATA chunk 1 (up to 2^32 bits)\r\n *   LENGTH chunk 2 (4 bytes)\r\n *   DATA chunk 2 (up to 2^32 bits)\r\n *   ...\r\n * ]\r\n *\r\n * @param buffers each buffer (chunk) must be at most 2^32 bits large (~4GB)\r\n */\r\nconst concatBuffers = (...buffers) => {\r\n    const bufferView = new Uint8Array(VERSION_DATAVIEW_BYTES +\r\n        NEXT_CHUNK_SIZE_DATAVIEW_BYTES * buffers.length +\r\n        buffers.reduce((acc, buffer) => acc + buffer.byteLength, 0));\r\n    let cursor = 0;\r\n    // as the first chunk we'll encode the version for backwards compatibility\r\n    dataView(bufferView, VERSION_DATAVIEW_BYTES, cursor, CONCAT_BUFFERS_VERSION);\r\n    cursor += VERSION_DATAVIEW_BYTES;\r\n    for (const buffer of buffers) {\r\n        dataView(bufferView, NEXT_CHUNK_SIZE_DATAVIEW_BYTES, cursor, buffer.byteLength);\r\n        cursor += NEXT_CHUNK_SIZE_DATAVIEW_BYTES;\r\n        bufferView.set(buffer, cursor);\r\n        cursor += buffer.byteLength;\r\n    }\r\n    return bufferView;\r\n};\r\n/** can only be used on buffers created via `concatBuffers()` */\r\nconst splitBuffers = (concatenatedBuffer) => {\r\n    const buffers = [];\r\n    let cursor = 0;\r\n    // first chunk is the version (ignored for now)\r\n    cursor += VERSION_DATAVIEW_BYTES;\r\n    while (true) {\r\n        const chunkSize = dataView(concatenatedBuffer, NEXT_CHUNK_SIZE_DATAVIEW_BYTES, cursor);\r\n        cursor += NEXT_CHUNK_SIZE_DATAVIEW_BYTES;\r\n        buffers.push(concatenatedBuffer.slice(cursor, cursor + chunkSize));\r\n        cursor += chunkSize;\r\n        if (cursor >= concatenatedBuffer.byteLength) {\r\n            break;\r\n        }\r\n    }\r\n    return buffers;\r\n};\r\n// helpers for (de)compressing data with JSON metadata including encryption\r\n// -----------------------------------------------------------------------------\r\n/** @private */\r\nconst _encryptAndCompress = async (data, encryptionKey) => {\r\n    const { encryptedBuffer, iv } = await encryptData(encryptionKey, deflate(data));\r\n    return { iv, buffer: new Uint8Array(encryptedBuffer) };\r\n};\r\n/**\r\n * The returned buffer has following format:\r\n * `[]` refers to a buffers wrapper (see `concatBuffers`)\r\n *\r\n * [\r\n *   encodingMetadataBuffer,\r\n *   iv,\r\n *   [\r\n *      contentsMetadataBuffer\r\n *      contentsBuffer\r\n *   ]\r\n * ]\r\n */\r\nexport const compressData = async (dataBuffer, options) => {\r\n    const fileInfo = {\r\n        version: 2,\r\n        compression: \"pako@1\",\r\n        encryption: \"AES-GCM\",\r\n    };\r\n    const encodingMetadataBuffer = new TextEncoder().encode(JSON.stringify(fileInfo));\r\n    const contentsMetadataBuffer = new TextEncoder().encode(JSON.stringify(options.metadata || null));\r\n    const { iv, buffer } = await _encryptAndCompress(concatBuffers(contentsMetadataBuffer, dataBuffer), options.encryptionKey);\r\n    return concatBuffers(encodingMetadataBuffer, iv, buffer);\r\n};\r\n/** @private */\r\nconst _decryptAndDecompress = async (iv, decryptedBuffer, decryptionKey, isCompressed) => {\r\n    decryptedBuffer = new Uint8Array(await decryptData(iv, decryptedBuffer, decryptionKey));\r\n    if (isCompressed) {\r\n        return inflate(decryptedBuffer);\r\n    }\r\n    return decryptedBuffer;\r\n};\r\nexport const decompressData = async (bufferView, options) => {\r\n    // first chunk is encoding metadata (ignored for now)\r\n    const [encodingMetadataBuffer, iv, buffer] = splitBuffers(bufferView);\r\n    const encodingMetadata = JSON.parse(new TextDecoder().decode(encodingMetadataBuffer));\r\n    try {\r\n        const [contentsMetadataBuffer, contentsBuffer] = splitBuffers(await _decryptAndDecompress(iv, buffer, options.decryptionKey, !!encodingMetadata.compression));\r\n        const metadata = JSON.parse(new TextDecoder().decode(contentsMetadataBuffer));\r\n        return {\r\n            /** metadata source is always JSON so we can decode it here */\r\n            metadata,\r\n            /** data can be anything so the caller must decode it */\r\n            data: contentsBuffer,\r\n        };\r\n    }\r\n    catch (error) {\r\n        console.error(`Error during decompressing and decrypting the file.`, encodingMetadata);\r\n        throw error;\r\n    }\r\n};\r\n// -----------------------------------------------------------------------------\r\n"],"sourceRoot":""}